warning: `VIRTUAL_ENV=venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead
Using CPython 3.11.0rc1 interpreter at: /usr/bin/python3.11
Creating virtual environment at: .venv
Resolved 217 packages in 3.20s
warning: The package `gymnasium==1.1.1` does not have an extra named `accept-rom-license`
   Building flax @ file:///app
Downloading opencv-python (60.1MiB)
Downloading nvidia-cuda-cupti-cu12 (8.5MiB)
Downloading matplotlib (8.2MiB)
Downloading sympy (6.0MiB)
Downloading grpcio (5.7MiB)
Downloading ml-dtypes (4.5MiB)
Downloading debugpy (3.0MiB)
Downloading jax (2.7MiB)
Downloading sphinx-design (2.1MiB)
Downloading widgetsnbextension (2.1MiB)
Downloading networkx (1.6MiB)
Downloading jedi (1.5MiB)
Downloading kiwisolver (1.4MiB)
Downloading numpy (15.6MiB)
Downloading pillow (4.4MiB)
Downloading pydata-sphinx-theme (4.4MiB)
Downloading nvidia-cuda-nvrtc-cu12 (22.6MiB)
Downloading tensorflow (615.0MiB)
Downloading nvidia-cublas-cu12 (374.9MiB)
Downloading pytype (4.5MiB)
Downloading libclang (23.4MiB)
Downloading nvidia-nvjitlink-cu12 (18.8MiB)
Downloading tensorflow-io-gcs-filesystem (4.9MiB)
Downloading nvidia-curand-cu12 (53.7MiB)
Downloading nvidia-cusparse-cu12 (206.5MiB)
Downloading pyarrow (40.3MiB)
Downloading babel (9.7MiB)
Downloading nvidia-cudnn-cu12 (544.5MiB)
Downloading nvidia-cusolver-cu12 (150.9MiB)
Downloading sqlalchemy (3.1MiB)
Downloading scipy (35.9MiB)
Downloading nvidia-cusparselt-cu12 (149.5MiB)
Downloading h5py (4.3MiB)
Downloading array-record (2.1MiB)
Downloading tensorflow-datasets (5.1MiB)
Downloading triton (149.3MiB)
Downloading tensorboard (5.2MiB)
Downloading nvidia-cufft-cu12 (190.9MiB)
Downloading nvidia-nccl-cu12 (192.0MiB)
Downloading scikit-learn (12.9MiB)
Downloading tensorboard-data-server (6.3MiB)
Downloading mypy (12.0MiB)
Downloading fonttools (4.7MiB)
Downloading libcst (2.2MiB)
Downloading torch (825.1MiB)
Downloading tensorstore (18.0MiB)
Downloading tensorflow-text (5.0MiB)
Downloading sphinx (3.0MiB)
Downloading jaxlib (88.8MiB)
Downloading ale-py (4.4MiB)
      Built flax @ file:///app
 Downloading kiwisolver
Downloading accessible-pygments (1.3MiB)
 Downloading widgetsnbextension
Downloading keras (1.3MiB)
 Downloading sphinx-design
 Downloading array-record
Downloading sentencepiece (1.2MiB)
Downloading pygments (1.2MiB)
 Downloading networkx
Downloading nvidia-cufile-cu12 (1.1MiB)
 Downloading libcst
 Downloading accessible-pygments
 Downloading jax
 Downloading debugpy
 Downloading sphinx
 Downloading sqlalchemy
 Downloading sentencepiece
 Downloading keras
 Downloading nvidia-cufile-cu12
 Downloading pygments
 Downloading h5py
 Downloading pydata-sphinx-theme
 Downloading ml-dtypes
 Downloading pillow
 Downloading fonttools
 Downloading tensorflow-io-gcs-filesystem
 Downloading jedi
 Downloading tensorflow-text
 Downloading ale-py
 Downloading tensorboard
 Downloading grpcio
   Building promise==2.3
Downloading setuptools (1.1MiB)
 Downloading tensorboard-data-server
      Built promise==2.3
 Downloading sympy
 Downloading nvidia-cuda-cupti-cu12
 Downloading matplotlib
 Downloading babel
 Downloading tensorflow-datasets
 Downloading setuptools
 Downloading scikit-learn
 Downloading numpy
 Downloading tensorstore
 Downloading nvidia-nvjitlink-cu12
 Downloading nvidia-cuda-nvrtc-cu12
 Downloading libclang
 Downloading scipy
 Downloading mypy
 Downloading nvidia-curand-cu12
 Downloading opencv-python
 Downloading pyarrow
 Downloading jaxlib
 Downloading pytype
 Downloading nvidia-cusparselt-cu12
 Downloading nvidia-cusolver-cu12
 Downloading nvidia-cufft-cu12
 Downloading nvidia-nccl-cu12
 Downloading triton
 Downloading nvidia-cusparse-cu12
 Downloading nvidia-cublas-cu12
 Downloading nvidia-cudnn-cu12
 Downloading torch
 Downloading tensorflow
Prepared 203 packages in 1m 06s
warning: The module `nvidia` is provided by more than one package, which causes an install race condition and can result in a broken module. Consider removing your dependency on either `nvidia-cufile-cu12` (v1.11.1.6) or `nvidia-cuda-runtime-cu12` (v12.6.77).
warning: The module `nvidia` is provided by more than one package, which causes an install race condition and can result in a broken module. Consider removing your dependency on either `nvidia-nvtx-cu12` (v12.6.77) or `nvidia-cuda-runtime-cu12` (v12.6.77).
warning: The module `nvidia` is provided by more than one package, which causes an install race condition and can result in a broken module. Consider removing your dependency on either `nvidia-nvtx-cu12` (v12.6.77) or `nvidia-cuda-cupti-cu12` (v12.6.80).
warning: The module `nvidia` is provided by more than one package, which causes an install race condition and can result in a broken module. Consider removing your dependency on either `nvidia-cusolver-cu12` (v11.7.1.2) or `nvidia-cuda-cupti-cu12` (v12.6.80).
warning: The module `nvidia` is provided by more than one package, which causes an install race condition and can result in a broken module. Consider removing your dependency on either `nvidia-nvjitlink-cu12` (v12.6.85) or `nvidia-cusolver-cu12` (v11.7.1.2).
warning: The module `nvidia` is provided by more than one package, which causes an install race condition and can result in a broken module. Consider removing your dependency on either `nvidia-nvjitlink-cu12` (v12.6.85) or `nvidia-nccl-cu12` (v2.26.2).
warning: The module `nvidia` is provided by more than one package, which causes an install race condition and can result in a broken module. Consider removing your dependency on either `nvidia-nccl-cu12` (v2.26.2) or `nvidia-cusparse-cu12` (v12.5.4.2).
warning: The module `nvidia` is provided by more than one package, which causes an install race condition and can result in a broken module. Consider removing your dependency on either `nvidia-cusparse-cu12` (v12.5.4.2) or `nvidia-curand-cu12` (v10.3.7.77).
warning: The module `nvidia` is provided by more than one package, which causes an install race condition and can result in a broken module. Consider removing your dependency on either `nvidia-curand-cu12` (v10.3.7.77) or `nvidia-cudnn-cu12` (v9.5.1.17).
warning: The module `nvidia` is provided by more than one package, which causes an install race condition and can result in a broken module. Consider removing your dependency on either `nvidia-cudnn-cu12` (v9.5.1.17) or `nvidia-cublas-cu12` (v12.6.4.1).
warning: The module `nvidia` is provided by more than one package, which causes an install race condition and can result in a broken module. Consider removing your dependency on either `nvidia-cufft-cu12` (v11.3.0.4) or `nvidia-cublas-cu12` (v12.6.4.1).
warning: The module `nvidia` is provided by more than one package, which causes an install race condition and can result in a broken module. Consider removing your dependency on either `nvidia-cufft-cu12` (v11.3.0.4) or `nvidia-cuda-nvrtc-cu12` (v12.6.77).
Installed 203 packages in 848ms
 + absl-py==2.3.0
 + accessible-pygments==0.0.5
 + aiofiles==24.1.0
 + alabaster==0.7.16
 + ale-py==0.11.1
 + array-record==0.7.2
 + asttokens==3.0.0
 + astunparse==1.6.3
 + attrs==25.3.0
 + babel==2.17.0
 + beautifulsoup4==4.13.4
 + certifi==2025.4.26
 + charset-normalizer==3.4.2
 + chex==0.1.89
 + click==8.2.1
 + cloudpickle==3.1.1
 + clu==0.0.12
 + comm==0.2.2
 + commonmark==0.9.1
 + contourpy==1.3.2
 + coverage==7.8.2
 + cycler==0.12.1
 + debugpy==1.8.14
 + decorator==5.2.1
 + dm-haiku==0.0.14
 + dm-tree==0.1.9
 + docstring-parser==0.16
 + docutils==0.16
 + einops==0.8.1
 + etils==1.12.2
 + execnet==2.1.1
 + executing==2.2.0
 + farama-notifications==0.0.4
 + fastjsonschema==2.21.1
 + filelock==3.18.0
 + flatbuffers==25.2.10
 + flax==0.11.1 (from file:///app)
 + fonttools==4.58.1
 + fsspec==2025.5.1
 + gast==0.6.0
 + google-pasta==0.2.0
 + googleapis-common-protos==1.70.0
 + greenlet==3.2.2
 + grpcio==1.71.0
 + gymnasium==1.1.1
 + h5py==3.13.0
 + humanize==4.12.3
 + idna==3.10
 + imagesize==1.4.1
 + immutabledict==4.2.1
 + importlab==0.8.1
 + importlib-metadata==8.7.0
 + importlib-resources==6.5.2
 + iniconfig==2.1.0
 + ipykernel==6.29.5
 + ipython==8.36.0
 + ipython-genutils==0.2.0
 + ipywidgets==8.1.7
 + jax==0.7.0
 + jaxlib==0.7.0
 + jaxtyping==0.3.2
 + jedi==0.19.2
 + jinja2==3.1.6
 + jmp==0.0.4
 + joblib==1.5.1
 + jraph==0.0.6.dev0
 + jsonschema==4.24.0
 + jsonschema-specifications==2025.4.1
 + jupyter-cache==1.0.1
 + jupyter-client==8.6.3
 + jupyter-core==5.8.1
 + jupyterlab-widgets==3.0.15
 + jupytext==1.13.8
 + kagglehub==0.3.12
 + keras==3.10.0
 + kiwisolver==1.4.8
 + libclang==18.1.1
 + libcst==1.8.0
 + markdown==3.8
 + markdown-it-py==2.2.0
 + markupsafe==3.0.2
 + matplotlib==3.10.3
 + matplotlib-inline==0.1.7
 + mdit-py-plugins==0.3.5
 + mdurl==0.1.2
 + ml-collections==1.1.0
 + ml-dtypes==0.5.1
 + mpmath==1.3.0
 + msgpack==1.1.0
 + msgspec==0.19.0
 + mypy==1.16.0
 + mypy-extensions==1.1.0
 + myst-nb==1.2.0
 + myst-parser==1.0.0
 + namex==0.1.0
 + nbclient==0.10.2
 + nbformat==5.10.4
 + nbstripout==0.8.1
 + nest-asyncio==1.6.0
 + networkx==3.4.2
 + ninja==1.11.1.4
 + numpy==2.1.3
 + nvidia-cublas-cu12==12.6.4.1
 + nvidia-cuda-cupti-cu12==12.6.80
 + nvidia-cuda-nvrtc-cu12==12.6.77
 + nvidia-cuda-runtime-cu12==12.6.77
 + nvidia-cudnn-cu12==9.5.1.17
 + nvidia-cufft-cu12==11.3.0.4
 + nvidia-cufile-cu12==1.11.1.6
 + nvidia-curand-cu12==10.3.7.77
 + nvidia-cusolver-cu12==11.7.1.2
 + nvidia-cusparse-cu12==12.5.4.2
 + nvidia-cusparselt-cu12==0.6.3
 + nvidia-nccl-cu12==2.26.2
 + nvidia-nvjitlink-cu12==12.6.85
 + nvidia-nvtx-cu12==12.6.77
 + opencv-python==4.11.0.86
 + opt-einsum==3.4.0
 + optax==0.2.4
 + optree==0.16.0
 + orbax-checkpoint==0.11.21
 + packaging==25.0
 + parso==0.8.4
 + pathspec==0.12.1
 + pexpect==4.9.0
 + pillow==11.2.1
 + platformdirs==4.3.8
 + pluggy==1.6.0
 + promise==2.3
 + prompt-toolkit==3.0.51
 + protobuf==5.29.5
 + psutil==7.0.0
 + ptyprocess==0.7.0
 + pure-eval==0.2.3
 + pyarrow==20.0.0
 + pycnite==2024.7.31
 + pydata-sphinx-theme==0.15.4
 + pydot==4.0.0
 + pygments==2.19.1
 + pyparsing==3.2.3
 + pytest==8.3.5
 + pytest-cov==6.1.1
 + pytest-custom-exit-code==0.3.0
 + pytest-xdist==3.7.0
 + python-dateutil==2.9.0.post0
 + pytype==2024.10.11
 + pyyaml==6.0.2
 + pyzmq==26.4.0
 + recommonmark==0.7.1
 + referencing==0.36.2
 + requests==2.32.3
 + rich==14.0.0
 + rpds-py==0.25.1
 + scikit-learn==1.6.1
 + scipy==1.15.3
 + sentencepiece==0.2.0
 + setuptools==80.9.0
 + simple-parsing==0.1.7
 + simplejson==3.20.1
 + six==1.17.0
 + snowballstemmer==3.0.1
 + soupsieve==2.7
 + sphinx==5.3.0
 + sphinx-book-theme==1.1.3
 + sphinx-design==0.6.0
 + sphinxcontrib-applehelp==2.0.0
 + sphinxcontrib-devhelp==2.0.0
 + sphinxcontrib-htmlhelp==2.1.0
 + sphinxcontrib-jsmath==1.0.1
 + sphinxcontrib-qthelp==2.0.0
 + sphinxcontrib-serializinghtml==2.0.0
 + sqlalchemy==2.0.41
 + stack-data==0.6.3
 + sympy==1.14.0
 + tabulate==0.9.0
 + tensorboard==2.19.0
 + tensorboard-data-server==0.7.2
 + tensorflow==2.19.0
 + tensorflow-datasets==4.9.9
 + tensorflow-io-gcs-filesystem==0.37.1
 + tensorflow-metadata==0.5.0
 + tensorflow-text==2.19.0
 + tensorstore==0.1.75
 + termcolor==3.1.0
 + threadpoolctl==3.6.0
 + toml==0.10.2
 + tomli==2.2.1
 + toolz==1.0.0
 + torch==2.7.0
 + tornado==6.5.1
 + tqdm==4.67.1
 + traitlets==5.14.3
 + treescope==0.1.9
 + triton==3.3.0
 + typing-extensions==4.13.2
 + urllib3==2.4.0
 + wadler-lindig==0.1.6
 + wcwidth==0.2.13
 + werkzeug==3.1.3
 + wheel==0.45.1
 + widgetsnbextension==4.0.14
 + wrapt==1.17.2
 + zipp==3.22.0
Using Python 3.11.0rc1 environment at: venv
Resolved 6 packages in 102ms
Downloading numpy (16.2MiB)
Downloading scipy (33.7MiB)
Downloading jax (2.2MiB)
Downloading ml-dtypes (4.7MiB)
Downloading jaxlib (83.7MiB)
 Downloading ml-dtypes
 Downloading jax
 Downloading numpy
 Downloading jaxlib
 Downloading scipy
Prepared 5 packages in 1.93s
Installed 6 packages in 50ms
 + jax==0.6.0
 + jaxlib==0.6.0
 + ml-dtypes==0.5.3
 + numpy==2.3.2
 + opt-einsum==3.4.0
 + scipy==1.16.1
Using Python 3.11.0rc1 environment at: venv
Resolved 31 packages in 199ms
Downloading pyarrow (40.8MiB)
 Downloading pyarrow
Prepared 30 packages in 770ms
Installed 30 packages in 88ms
 + absl-py==2.3.1
 + array-record==0.7.2
 + attrs==25.3.0
 + certifi==2025.8.3
 + charset-normalizer==3.4.3
 + dm-tree==0.1.9
 + docstring-parser==0.17.0
 + einops==0.8.1
 + etils==1.13.0
 + fsspec==2025.7.0
 + googleapis-common-protos==1.70.0
 + idna==3.10
 + immutabledict==4.2.1
 + importlib-resources==6.5.2
 + promise==2.3
 + protobuf==6.31.1
 + psutil==7.0.0
 + pyarrow==21.0.0
 + requests==2.32.4
 + simple-parsing==0.1.7
 + six==1.17.0
 + tensorflow-datasets==4.9.9
 + tensorflow-metadata==1.17.2
 + termcolor==3.1.0
 + toml==0.10.2
 + tqdm==4.67.1
 + typing-extensions==4.14.1
 + urllib3==2.5.0
 + wrapt==1.17.2
 + zipp==3.23.0
warning: `VIRTUAL_ENV=venv` does not match the project environment path `.venv` and will be ignored; use `--active` to target the active environment instead
warning: The package `gymnasium==1.1.1` does not have an extra named `accept-rom-license`
====== test config =======
PYTEST_OPTS:
RUN_DOCTEST: false
RUN_PYTEST: true
RUN_MYPY: false
RUN_PYTYPE: false
GH_VENV: false
WHICH PYTHON: /app/.venv/bin/python
jax: 0.7.0
flax: 0.11.1
==========================

TFDS metadata does not exist. Downloading...
Cloning into 'datasets'...
Note: switching to '21f7b2086192080d3fb2e33d938ea99e4bc83a49'.

You are in 'detached HEAD' state. You can look around, make experimental
changes and commit them, and you can discard any commits you make in this
state without impacting any branches by switching back to a branch.

If you want to create a new branch to retain commits you create, you may
do so (now or later) by using -c with the switch command. Example:

  git switch -c <new-branch-name>

Or undo this operation with:

  git switch -

Turn off this advice by setting config variable advice.detachedHead to false

=== CHECKING FLAX IS EDITABLE ===
=== RUNNING PYTESTS ===
pytest -n auto tests/jax_utils_test.py
============================= test session starts ==============================
platform linux -- Python 3.11.0rc1, pytest-8.3.5, pluggy-1.6.0
rootdir: /app
configfile: pyproject.toml
plugins: custom-exit-code-0.3.0, jaxtyping-0.3.2, xdist-3.7.0, cov-6.1.1
created: 32/32 workers
32 workers [100 items]

........................................................................ [ 72%]
............................                                             [100%]
============================= 100 passed in 6.17s ==============================
pytest -n auto tests   --ignore=tests/jax_utils_test.py
============================= test session starts ==============================
platform linux -- Python 3.11.0rc1, pytest-8.3.5, pluggy-1.6.0
rootdir: /app
configfile: pyproject.toml
plugins: custom-exit-code-0.3.0, jaxtyping-0.3.2, xdist-3.7.0, cov-6.1.1
created: 32/32 workers
32 workers [2096 items]

........................................................................ [  3%]
........................................................................ [  6%]
........................................................................ [ 10%]
........................................................................ [ 13%]
........................................................................ [ 17%]
........................................................................ [ 20%]
........................................................................ [ 24%]
........................................................................ [ 27%]
........................................................................ [ 30%]
........................................................................ [ 34%]
........................................................................ [ 37%]
........................................................................ [ 41%]
........................................................................ [ 44%]
........................................................................ [ 48%]
........................................................................ [ 51%]
s....................................................................... [ 54%]
........................................................................ [ 58%]
........................................................................ [ 61%]
........................................................................ [ 65%]
........................................................................ [ 68%]
........................................................................ [ 72%]
........................................................................ [ 75%]
........................................................................ [ 79%]
...................................................s.................... [ 82%]
........................................................................ [ 85%]
........................................................................ [ 89%]
........................................................................ [ 92%]
........................................................................ [ 96%]
........................................................................ [ 99%]
........                                                                 [100%]
======================= 2094 passed, 2 skipped in 52.82s =======================
============================= test session starts ==============================
platform linux -- Python 3.11.0rc1, pytest-8.3.5, pluggy-1.6.0
rootdir: /app
configfile: pyproject.toml
plugins: custom-exit-code-0.3.0, jaxtyping-0.3.2, xdist-3.7.0, cov-6.1.1
created: 32/32 workers
32 workers [5 items]

.....                                                                    [100%]
============================== 5 passed in 3.98s ===============================
============================= test session starts ==============================
platform linux -- Python 3.11.0rc1, pytest-8.3.5, pluggy-1.6.0
rootdir: /app
configfile: pyproject.toml
plugins: custom-exit-code-0.3.0, jaxtyping-0.3.2, xdist-3.7.0, cov-6.1.1
created: 32/32 workers
32 workers [5 items]

.....                                                                    [100%]
============================== 5 passed in 4.02s ===============================
============================= test session starts ==============================
platform linux -- Python 3.11.0rc1, pytest-8.3.5, pluggy-1.6.0
rootdir: /app
configfile: pyproject.toml
plugins: custom-exit-code-0.3.0, jaxtyping-0.3.2, xdist-3.7.0, cov-6.1.1
collected 0 items / 2 errors

==================================== ERRORS ====================================
_____________ ERROR collecting examples/wmt/input_pipeline_test.py _____________
examples/wmt/input_pipeline_test.py:23: in <module>
    import input_pipeline
examples/wmt/input_pipeline.py:20: in <module>
    from clu import deterministic_data
.venv/lib/python3.11/site-packages/clu/deterministic_data.py:79: in <module>
    tfds.version.__version__)
E   AttributeError: module 'tensorflow_datasets' has no attribute 'version'
------------------------------- Captured stderr --------------------------------
2025-08-11 23:37:19.849751: E external/local_xla/xla/stream_executor/cuda/cuda_fft.cc:467] Unable to register cuFFT factory: Attempting to register factory for plugin cuFFT when one has already been registered
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1754955439.869823   32332 cuda_dnn.cc:8579] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1754955439.875896   32332 cuda_blas.cc:1407] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
W0000 00:00:1754955439.890471   32332 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1754955439.890494   32332 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1754955439.890497   32332 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1754955439.890500   32332 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
_________________ ERROR collecting examples/wmt/train_test.py __________________
examples/wmt/train_test.py:25: in <module>
    import train
examples/wmt/train.py:46: in <module>
    import input_pipeline
examples/wmt/input_pipeline.py:20: in <module>
    from clu import deterministic_data
.venv/lib/python3.11/site-packages/clu/deterministic_data.py:79: in <module>
    tfds.version.__version__)
E   AttributeError: module 'tensorflow_datasets' has no attribute 'version'
=========================== short test summary info ============================
ERROR examples/wmt/input_pipeline_test.py - AttributeError: module 'tensorflo...
ERROR examples/wmt/train_test.py - AttributeError: module 'tensorflow_dataset...
!!!!!!!!!!!!!!!!!!! Interrupted: 2 errors during collection !!!!!!!!!!!!!!!!!!!!
============================== 2 errors in 4.91s ===============================
error code 2
