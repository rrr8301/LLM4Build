Obtaining file:///app
  Installing build dependencies: started
  Installing build dependencies: finished with status 'done'
  Checking if build backend supports build_editable: started
  Checking if build backend supports build_editable: finished with status 'done'
  Getting requirements to build editable: started
  Getting requirements to build editable: finished with status 'done'
  Preparing editable metadata (pyproject.toml): started
  Preparing editable metadata (pyproject.toml): finished with status 'done'
Requirement already satisfied: arviz>=0.13.0 in /root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages (from pymc==0+unknown) (0.23.0)
Requirement already satisfied: cachetools>=4.2.1 in /root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages (from pymc==0+unknown) (6.2.4)
Requirement already satisfied: cloudpickle in /root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages (from pymc==0+unknown) (3.1.2)
Requirement already satisfied: numpy>=1.25.0 in /root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages (from pymc==0+unknown) (2.3.5)
Requirement already satisfied: pandas>=0.24.0 in /root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages (from pymc==0+unknown) (2.3.3)
Requirement already satisfied: pytensor<2.37,>=2.36.0 in /root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages (from pymc==0+unknown) (2.36.0)
Requirement already satisfied: rich>=13.7.1 in /root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages (from pymc==0+unknown) (14.2.0)
Requirement already satisfied: scipy>=1.4.1 in /root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages (from pymc==0+unknown) (1.16.3)
Requirement already satisfied: threadpoolctl<4.0.0,>=3.1.0 in /root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages (from pymc==0+unknown) (3.6.0)
Requirement already satisfied: typing-extensions>=3.7.4 in /root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages (from pymc==0+unknown) (4.15.0)
Requirement already satisfied: setuptools>=59.0.0 in /root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages (from pytensor<2.37,>=2.36.0->pymc==0+unknown) (80.9.0)
Requirement already satisfied: numba<1,>0.57 in /root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages (from pytensor<2.37,>=2.36.0->pymc==0+unknown) (0.63.1)
Requirement already satisfied: filelock>=3.15 in /root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages (from pytensor<2.37,>=2.36.0->pymc==0+unknown) (3.20.1)
Requirement already satisfied: etuples in /root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages (from pytensor<2.37,>=2.36.0->pymc==0+unknown) (0.3.10)
Requirement already satisfied: logical-unification in /root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages (from pytensor<2.37,>=2.36.0->pymc==0+unknown) (0.4.7)
Requirement already satisfied: miniKanren in /root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages (from pytensor<2.37,>=2.36.0->pymc==0+unknown) (1.0.5)
Requirement already satisfied: cons in /root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages (from pytensor<2.37,>=2.36.0->pymc==0+unknown) (0.4.7)
Requirement already satisfied: llvmlite<0.47,>=0.46.0dev0 in /root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages (from numba<1,>0.57->pytensor<2.37,>=2.36.0->pymc==0+unknown) (0.46.0)
Requirement already satisfied: matplotlib>=3.8 in /root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages (from arviz>=0.13.0->pymc==0+unknown) (3.10.8)
Requirement already satisfied: packaging in /root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages (from arviz>=0.13.0->pymc==0+unknown) (25.0)
Requirement already satisfied: xarray>=2023.7.0 in /root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages (from arviz>=0.13.0->pymc==0+unknown) (2025.12.0)
Requirement already satisfied: h5netcdf>=1.0.2 in /root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages (from arviz>=0.13.0->pymc==0+unknown) (1.7.3)
Requirement already satisfied: xarray-einstats>=0.3 in /root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages (from arviz>=0.13.0->pymc==0+unknown) (0.9.1)
Requirement already satisfied: h5py in /root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages (from h5netcdf>=1.0.2->arviz>=0.13.0->pymc==0+unknown) (3.15.1)
Requirement already satisfied: contourpy>=1.0.1 in /root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages (from matplotlib>=3.8->arviz>=0.13.0->pymc==0+unknown) (1.3.3)
Requirement already satisfied: cycler>=0.10 in /root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages (from matplotlib>=3.8->arviz>=0.13.0->pymc==0+unknown) (0.12.1)
Requirement already satisfied: fonttools>=4.22.0 in /root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages (from matplotlib>=3.8->arviz>=0.13.0->pymc==0+unknown) (4.61.1)
Requirement already satisfied: kiwisolver>=1.3.1 in /root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages (from matplotlib>=3.8->arviz>=0.13.0->pymc==0+unknown) (1.4.9)
Requirement already satisfied: pillow>=8 in /root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages (from matplotlib>=3.8->arviz>=0.13.0->pymc==0+unknown) (12.0.0)
Requirement already satisfied: pyparsing>=3 in /root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages (from matplotlib>=3.8->arviz>=0.13.0->pymc==0+unknown) (3.2.5)
Requirement already satisfied: python-dateutil>=2.7 in /root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages (from matplotlib>=3.8->arviz>=0.13.0->pymc==0+unknown) (2.9.0.post0)
Requirement already satisfied: pytz>=2020.1 in /root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages (from pandas>=0.24.0->pymc==0+unknown) (2025.2)
Requirement already satisfied: tzdata>=2022.7 in /root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages (from pandas>=0.24.0->pymc==0+unknown) (2025.3)
Requirement already satisfied: six>=1.5 in /root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages (from python-dateutil>=2.7->matplotlib>=3.8->arviz>=0.13.0->pymc==0+unknown) (1.17.0)
Requirement already satisfied: markdown-it-py>=2.2.0 in /root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages (from rich>=13.7.1->pymc==0+unknown) (4.0.0)
Requirement already satisfied: pygments<3.0.0,>=2.13.0 in /root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages (from rich>=13.7.1->pymc==0+unknown) (2.19.2)
Requirement already satisfied: mdurl~=0.1 in /root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages (from markdown-it-py>=2.2.0->rich>=13.7.1->pymc==0+unknown) (0.1.2)
Requirement already satisfied: toolz in /root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages (from logical-unification->pytensor<2.37,>=2.36.0->pymc==0+unknown) (1.1.0)
Requirement already satisfied: multipledispatch in /root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages (from logical-unification->pytensor<2.37,>=2.36.0->pymc==0+unknown) (0.6.0)
Building wheels for collected packages: pymc
  Building editable for pymc (pyproject.toml): started
  Building editable for pymc (pyproject.toml): finished with status 'done'
  Created wheel for pymc: filename=pymc-0+unknown-0.editable-py3-none-any.whl size=13777 sha256=166c532f51a0a33727b4d301e3e8f9156dc19fa02798f097b9010cf0c7d9ef84
  Stored in directory: /tmp/pip-ephem-wheel-cache-zjjpi1po/wheels/b8/36/9c/914153c626bda53913fc1c371da41560e7caf866363da7bf04
Successfully built pymc
Installing collected packages: pymc
  Attempting uninstall: pymc
    Found existing installation: pymc 0+unknown
    Uninstalling pymc-0+unknown:
      Successfully uninstalled pymc-0+unknown
Successfully installed pymc-0+unknown
WARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager, possibly rendering your system unusable. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv. Use the --root-user-action option if you know what you are doing and want to suppress this warning.
[1m============================= test session starts ==============================[0m
platform linux -- Python 3.14.2, pytest-9.0.2, pluggy-1.6.0 -- /root/.local/share/mamba/envs/pymc-test/bin/python
cachedir: .pytest_cache
rootdir: /app
configfile: pyproject.toml
testpaths: tests
plugins: cov-7.0.0
[1mcollecting ... [0mcollected 3683 items / 1 skipped

tests/backends/test_arviz.py::TestDataPyMC::test_to_idata [32mPASSED[0m[33m         [  0%][0m
tests/backends/test_arviz.py::TestDataPyMC::test_predictions_to_idata [32mPASSED[0m[33m [  0%][0m
tests/backends/test_arviz.py::TestDataPyMC::test_predictions_to_idata_new [32mPASSED[0m[33m [  0%][0m
tests/backends/test_arviz.py::TestDataPyMC::test_posterior_predictive_keep_size [32mPASSED[0m[33m [  0%][0m
tests/backends/test_arviz.py::TestDataPyMC::test_posterior_predictive_thinned [32mPASSED[0m[33m [  0%][0m
tests/backends/test_arviz.py::TestDataPyMC::test_autodetect_coords_from_model[True] [32mPASSED[0m[33m [  0%][0m
tests/backends/test_arviz.py::TestDataPyMC::test_autodetect_coords_from_model[False] [32mPASSED[0m[33m [  0%][0m
tests/backends/test_arviz.py::TestDataPyMC::test_overwrite_model_coords_dims [32mPASSED[0m[33m [  0%][0m
tests/backends/test_arviz.py::TestDataPyMC::test_missing_data_model [32mPASSED[0m[33m [  0%][0m
tests/backends/test_arviz.py::TestDataPyMC::test_mv_missing_data_model [32mPASSED[0m[33m [  0%][0m
tests/backends/test_arviz.py::TestDataPyMC::test_multiple_observed_rv[True] [32mPASSED[0m[33m [  0%][0m
tests/backends/test_arviz.py::TestDataPyMC::test_multiple_observed_rv[False] [32mPASSED[0m[33m [  0%][0m
tests/backends/test_arviz.py::TestDataPyMC::test_multiple_observed_rv[log_likelihood2] [32mPASSED[0m[33m [  0%][0m
tests/backends/test_arviz.py::TestDataPyMC::test_single_observation [32mPASSED[0m[33m [  0%][0m
tests/backends/test_arviz.py::TestDataPyMC::test_potential [32mPASSED[0m[33m        [  0%][0m
tests/backends/test_arviz.py::TestDataPyMC::test_constant_data[True] [32mPASSED[0m[33m [  0%][0m
tests/backends/test_arviz.py::TestDataPyMC::test_constant_data[False] [32mPASSED[0m[33m [  0%][0m
tests/backends/test_arviz.py::TestDataPyMC::test_observed_data_also_constant[True] [32mPASSED[0m[33m [  0%][0m
tests/backends/test_arviz.py::TestDataPyMC::test_observed_data_also_constant[False] [32mPASSED[0m[33m [  0%][0m
tests/backends/test_arviz.py::TestDataPyMC::test_predictions_constant_data [32mPASSED[0m[33m [  0%][0m
tests/backends/test_arviz.py::TestDataPyMC::test_no_trace [32mPASSED[0m[33m         [  0%][0m
tests/backends/test_arviz.py::TestDataPyMC::test_priors_separation[True] [32mPASSED[0m[33m [  0%][0m
tests/backends/test_arviz.py::TestDataPyMC::test_priors_separation[False] [32mPASSED[0m[33m [  0%][0m
tests/backends/test_arviz.py::TestDataPyMC::test_conversion_from_variables_subset [32mPASSED[0m[33m [  0%][0m
tests/backends/test_arviz.py::TestDataPyMC::test_multivariate_observations [31mFAILED[0m[31m [  0%][0m
tests/backends/test_arviz.py::TestDataPyMC::test_constant_data_coords_issue_5046 [32mPASSED[0m[31m [  0%][0m
tests/backends/test_arviz.py::TestDataPyMC::test_issue_5043_autoconvert_coord_values [32mPASSED[0m[31m [  0%][0m
tests/backends/test_arviz.py::TestDataPyMC::test_variable_dimension_name_collision [32mPASSED[0m[31m [  0%][0m
tests/backends/test_arviz.py::TestDataPyMC::test_include_transformed [32mPASSED[0m[31m [  0%][0m
tests/backends/test_arviz.py::TestDataPyMC::test_single_chain[1] [32mPASSED[0m[31m  [  0%][0m
tests/backends/test_arviz.py::TestDataPyMC::test_single_chain[2] [32mPASSED[0m[31m  [  0%][0m
tests/backends/test_arviz.py::TestPyMCWarmupHandling::test_save_warmup[0-50-1-False] [32mPASSED[0m[31m [  0%][0m
tests/backends/test_arviz.py::TestPyMCWarmupHandling::test_save_warmup[0-50-1-True] [32mPASSED[0m[31m [  0%][0m
tests/backends/test_arviz.py::TestPyMCWarmupHandling::test_save_warmup[0-50-2-False] [32mPASSED[0m[31m [  0%][0m
tests/backends/test_arviz.py::TestPyMCWarmupHandling::test_save_warmup[0-50-2-True] [32mPASSED[0m[31m [  0%][0m
tests/backends/test_arviz.py::TestPyMCWarmupHandling::test_save_warmup[10-40-1-False] [32mPASSED[0m[31m [  0%][0m
tests/backends/test_arviz.py::TestPyMCWarmupHandling::test_save_warmup[10-40-1-True] [32mPASSED[0m[31m [  1%][0m
tests/backends/test_arviz.py::TestPyMCWarmupHandling::test_save_warmup[10-40-2-False] [32mPASSED[0m[31m [  1%][0m
tests/backends/test_arviz.py::TestPyMCWarmupHandling::test_save_warmup[10-40-2-True] [32mPASSED[0m[31m [  1%][0m
tests/backends/test_arviz.py::TestPyMCWarmupHandling::test_save_warmup[30-0-1-False] [32mPASSED[0m[31m [  1%][0m
tests/backends/test_arviz.py::TestPyMCWarmupHandling::test_save_warmup[30-0-1-True] [32mPASSED[0m[31m [  1%][0m
tests/backends/test_arviz.py::TestPyMCWarmupHandling::test_save_warmup[30-0-2-False] [32mPASSED[0m[31m [  1%][0m
tests/backends/test_arviz.py::TestPyMCWarmupHandling::test_save_warmup[30-0-2-True] [32mPASSED[0m[31m [  1%][0m
tests/backends/test_arviz.py::TestPyMCWarmupHandling::test_save_warmup_issue_1208_after_3_9 [32mPASSED[0m[31m [  1%][0m
tests/backends/test_arviz.py::TestDatasetToPointList::test_dataset_to_point_list[dict] [32mPASSED[0m[31m [  1%][0m
tests/backends/test_arviz.py::TestDatasetToPointList::test_dataset_to_point_list[Dataset] [32mPASSED[0m[31m [  1%][0m
tests/backends/test_arviz.py::TestDatasetToPointList::test_transposed_dataset_to_point_list [32mPASSED[0m[31m [  1%][0m
tests/backends/test_arviz.py::TestDatasetToPointList::test_dataset_to_point_list_str_key [32mPASSED[0m[31m [  1%][0m
tests/backends/test_arviz.py::TestDatasetToPointList::test_zero_size [32mPASSED[0m[31m [  1%][0m
tests/backends/test_arviz.py::test_incompatible_coordinate_lengths [32mPASSED[0m[31m [  1%][0m
tests/backends/test_base.py::test_choose_chains[n_points0-0-2-3] [32mPASSED[0m[31m  [  1%][0m
tests/backends/test_base.py::test_choose_chains[n_points1-1-6-1] [32mPASSED[0m[31m  [  1%][0m
tests/backends/test_base.py::TestInitTrace::test_init_trace_continuation_unsupported [32mPASSED[0m[31m [  1%][0m
tests/backends/test_mcbackend.py::test_find_data [32mPASSED[0m[31m                  [  1%][0m
tests/backends/test_mcbackend.py::test_find_data_skips_deterministics [32mPASSED[0m[31m [  1%][0m
tests/backends/test_mcbackend.py::test_get_variables_and_point_fn [32mPASSED[0m[31m [  1%][0m
tests/backends/test_mcbackend.py::test_make_runmeta_and_point_fn [32mPASSED[0m[31m  [  1%][0m
tests/backends/test_mcbackend.py::test_init_traces [32mPASSED[0m[31m                [  1%][0m
tests/backends/test_mcbackend.py::TestChainRecordAdapter::test_get_sampler_stats [32mPASSED[0m[31m [  1%][0m
tests/backends/test_mcbackend.py::TestChainRecordAdapter::test_get_sampler_stats_compound [32mPASSED[0m[31m [  1%][0m
tests/backends/test_mcbackend.py::TestMcBackendSampling::test_return_multitrace[False] [32mPASSED[0m[31m [  1%][0m
tests/backends/test_mcbackend.py::TestMcBackendSampling::test_return_multitrace[True] [32mPASSED[0m[31m [  1%][0m
tests/backends/test_mcbackend.py::TestMcBackendSampling::test_return_inferencedata[1] [32mPASSED[0m[31m [  1%][0m
tests/backends/test_mcbackend.py::TestMcBackendSampling::test_return_inferencedata[3] [32mPASSED[0m[31m [  1%][0m
tests/backends/test_ndarray.py::TestNDArray0dSampling::test_append_invalid <- tests/backends/fixtures.py [32mPASSED[0m[31m [  1%][0m
tests/backends/test_ndarray.py::TestNDArray0dSampling::test_append <- tests/backends/fixtures.py [32mPASSED[0m[31m [  1%][0m
tests/backends/test_ndarray.py::TestNDArray0dSampling::test_double_close <- tests/backends/fixtures.py [32mPASSED[0m[31m [  1%][0m
tests/backends/test_ndarray.py::TestNDArray0dSampling::test_standard_close <- tests/backends/fixtures.py [32mPASSED[0m[31m [  1%][0m
tests/backends/test_ndarray.py::TestNDArray0dSampling::test_missing_stats <- tests/backends/fixtures.py [32mPASSED[0m[31m [  1%][0m
tests/backends/test_ndarray.py::TestNDArray0dSampling::test_clean_interrupt <- tests/backends/fixtures.py [32mPASSED[0m[31m [  1%][0m
tests/backends/test_ndarray.py::TestNDArray0dSamplingStats1::test_append_invalid <- tests/backends/fixtures.py [32mPASSED[0m[31m [  1%][0m
tests/backends/test_ndarray.py::TestNDArray0dSamplingStats1::test_append <- tests/backends/fixtures.py [32mPASSED[0m[31m [  1%][0m
tests/backends/test_ndarray.py::TestNDArray0dSamplingStats1::test_double_close <- tests/backends/fixtures.py [32mPASSED[0m[31m [  1%][0m
tests/backends/test_ndarray.py::TestNDArray0dSamplingStats1::test_standard_close <- tests/backends/fixtures.py [32mPASSED[0m[31m [  2%][0m
tests/backends/test_ndarray.py::TestNDArray0dSamplingStats1::test_missing_stats <- tests/backends/fixtures.py [32mPASSED[0m[31m [  2%][0m
tests/backends/test_ndarray.py::TestNDArray0dSamplingStats1::test_clean_interrupt <- tests/backends/fixtures.py [32mPASSED[0m[31m [  2%][0m
tests/backends/test_ndarray.py::TestNDArray0dSamplingStats2::test_append_invalid <- tests/backends/fixtures.py [32mPASSED[0m[31m [  2%][0m
tests/backends/test_ndarray.py::TestNDArray0dSamplingStats2::test_append <- tests/backends/fixtures.py [32mPASSED[0m[31m [  2%][0m
tests/backends/test_ndarray.py::TestNDArray0dSamplingStats2::test_double_close <- tests/backends/fixtures.py [32mPASSED[0m[31m [  2%][0m
tests/backends/test_ndarray.py::TestNDArray0dSamplingStats2::test_standard_close <- tests/backends/fixtures.py [32mPASSED[0m[31m [  2%][0m
tests/backends/test_ndarray.py::TestNDArray0dSamplingStats2::test_missing_stats <- tests/backends/fixtures.py [32mPASSED[0m[31m [  2%][0m
tests/backends/test_ndarray.py::TestNDArray0dSamplingStats2::test_clean_interrupt <- tests/backends/fixtures.py [32mPASSED[0m[31m [  2%][0m
tests/backends/test_ndarray.py::TestNDArray1dSampling::test_append_invalid <- tests/backends/fixtures.py [32mPASSED[0m[31m [  2%][0m
tests/backends/test_ndarray.py::TestNDArray1dSampling::test_append <- tests/backends/fixtures.py [32mPASSED[0m[31m [  2%][0m
tests/backends/test_ndarray.py::TestNDArray1dSampling::test_double_close <- tests/backends/fixtures.py [32mPASSED[0m[31m [  2%][0m
tests/backends/test_ndarray.py::TestNDArray1dSampling::test_standard_close <- tests/backends/fixtures.py [32mPASSED[0m[31m [  2%][0m
tests/backends/test_ndarray.py::TestNDArray1dSampling::test_missing_stats <- tests/backends/fixtures.py [32mPASSED[0m[31m [  2%][0m
tests/backends/test_ndarray.py::TestNDArray1dSampling::test_clean_interrupt <- tests/backends/fixtures.py [32mPASSED[0m[31m [  2%][0m
tests/backends/test_ndarray.py::TestNDArray2dSampling::test_append_invalid <- tests/backends/fixtures.py [32mPASSED[0m[31m [  2%][0m
tests/backends/test_ndarray.py::TestNDArray2dSampling::test_append <- tests/backends/fixtures.py [32mPASSED[0m[31m [  2%][0m
tests/backends/test_ndarray.py::TestNDArray2dSampling::test_double_close <- tests/backends/fixtures.py [32mPASSED[0m[31m [  2%][0m
tests/backends/test_ndarray.py::TestNDArray2dSampling::test_standard_close <- tests/backends/fixtures.py [32mPASSED[0m[31m [  2%][0m
tests/backends/test_ndarray.py::TestNDArray2dSampling::test_missing_stats <- tests/backends/fixtures.py [32mPASSED[0m[31m [  2%][0m
tests/backends/test_ndarray.py::TestNDArray2dSampling::test_clean_interrupt <- tests/backends/fixtures.py [32mPASSED[0m[31m [  2%][0m
tests/backends/test_ndarray.py::TestNDArrayStats::test_bad_dtype <- tests/backends/fixtures.py [32mPASSED[0m[31m [  2%][0m
tests/backends/test_ndarray.py::TestNDArray0dSelection::test_varnames_nonempty <- tests/backends/fixtures.py [32mPASSED[0m[31m [  2%][0m
tests/backends/test_ndarray.py::TestNDArray0dSelection::test_stat_names <- tests/backends/fixtures.py [32mPASSED[0m[31m [  2%][0m
tests/backends/test_ndarray.py::TestNDArray0dSelection::test_get_values_default <- tests/backends/fixtures.py [32mPASSED[0m[31m [  2%][0m
tests/backends/test_ndarray.py::TestNDArray0dSelection::test_get_values_nocombine_burn_keyword <- tests/backends/fixtures.py [32mPASSED[0m[31m [  2%][0m
tests/backends/test_ndarray.py::TestNDArray0dSelection::test_len <- tests/backends/fixtures.py [32mPASSED[0m[31m [  2%][0m
tests/backends/test_ndarray.py::TestNDArray0dSelection::test_dtypes <- tests/backends/fixtures.py [32mPASSED[0m[31m [  2%][0m
tests/backends/test_ndarray.py::TestNDArray0dSelection::test_get_values_nocombine_thin_keyword <- tests/backends/fixtures.py [32mPASSED[0m[31m [  2%][0m
tests/backends/test_ndarray.py::TestNDArray0dSelection::test_get_point <- tests/backends/fixtures.py [32mPASSED[0m[31m [  2%][0m
tests/backends/test_ndarray.py::TestNDArray0dSelection::test_get_slice <- tests/backends/fixtures.py [32mPASSED[0m[31m [  2%][0m
tests/backends/test_ndarray.py::TestNDArray0dSelection::test_get_slice_step <- tests/backends/fixtures.py [32mPASSED[0m[31m [  2%][0m
tests/backends/test_ndarray.py::TestNDArray0dSelection::test_get_slice_neg_step <- tests/backends/fixtures.py [32mPASSED[0m[31m [  2%][0m
tests/backends/test_ndarray.py::TestNDArray0dSelection::test_get_neg_slice <- tests/backends/fixtures.py [32mPASSED[0m[31m [  2%][0m
tests/backends/test_ndarray.py::TestNDArray0dSelection::test_get_values_one_chain <- tests/backends/fixtures.py [32mPASSED[0m[31m [  2%][0m
tests/backends/test_ndarray.py::TestNDArray0dSelection::test_get_values_nocombine_chains_reversed <- tests/backends/fixtures.py [32mPASSED[0m[31m [  2%][0m
tests/backends/test_ndarray.py::TestNDArray0dSelection::test_nchains <- tests/backends/fixtures.py [32mPASSED[0m[31m [  2%][0m
tests/backends/test_ndarray.py::TestNDArray0dSelection::test_get_values_one_chain_int_arg <- tests/backends/fixtures.py [32mPASSED[0m[31m [  3%][0m
tests/backends/test_ndarray.py::TestNDArray0dSelection::test_get_values_combine <- tests/backends/fixtures.py [32mPASSED[0m[31m [  3%][0m
tests/backends/test_ndarray.py::TestNDArray0dSelection::test_get_values_combine_burn_arg <- tests/backends/fixtures.py [32mPASSED[0m[31m [  3%][0m
tests/backends/test_ndarray.py::TestNDArray0dSelection::test_get_values_combine_thin_arg <- tests/backends/fixtures.py [32mPASSED[0m[31m [  3%][0m
tests/backends/test_ndarray.py::TestNDArray0dSelection::test_getitem_equivalence <- tests/backends/fixtures.py [32mPASSED[0m[31m [  3%][0m
tests/backends/test_ndarray.py::TestNDArray0dSelection::test_selection_method_equivalence <- tests/backends/fixtures.py [32mPASSED[0m[31m [  3%][0m
tests/backends/test_ndarray.py::TestNDArray0dSelection2::test_varnames_nonempty <- tests/backends/fixtures.py [32mPASSED[0m[31m [  3%][0m
tests/backends/test_ndarray.py::TestNDArray0dSelection2::test_stat_names <- tests/backends/fixtures.py [32mPASSED[0m[31m [  3%][0m
tests/backends/test_ndarray.py::TestNDArray0dSelection2::test_get_values_default <- tests/backends/fixtures.py [32mPASSED[0m[31m [  3%][0m
tests/backends/test_ndarray.py::TestNDArray0dSelection2::test_get_values_nocombine_burn_keyword <- tests/backends/fixtures.py [32mPASSED[0m[31m [  3%][0m
tests/backends/test_ndarray.py::TestNDArray0dSelection2::test_len <- tests/backends/fixtures.py [32mPASSED[0m[31m [  3%][0m
tests/backends/test_ndarray.py::TestNDArray0dSelection2::test_dtypes <- tests/backends/fixtures.py [32mPASSED[0m[31m [  3%][0m
tests/backends/test_ndarray.py::TestNDArray0dSelection2::test_get_values_nocombine_thin_keyword <- tests/backends/fixtures.py [32mPASSED[0m[31m [  3%][0m
tests/backends/test_ndarray.py::TestNDArray0dSelection2::test_get_point <- tests/backends/fixtures.py [32mPASSED[0m[31m [  3%][0m
tests/backends/test_ndarray.py::TestNDArray0dSelection2::test_get_slice <- tests/backends/fixtures.py [32mPASSED[0m[31m [  3%][0m
tests/backends/test_ndarray.py::TestNDArray0dSelection2::test_get_slice_step <- tests/backends/fixtures.py [32mPASSED[0m[31m [  3%][0m
tests/backends/test_ndarray.py::TestNDArray0dSelection2::test_get_slice_neg_step <- tests/backends/fixtures.py [32mPASSED[0m[31m [  3%][0m
tests/backends/test_ndarray.py::TestNDArray0dSelection2::test_get_neg_slice <- tests/backends/fixtures.py [32mPASSED[0m[31m [  3%][0m
tests/backends/test_ndarray.py::TestNDArray0dSelection2::test_get_values_one_chain <- tests/backends/fixtures.py [32mPASSED[0m[31m [  3%][0m
tests/backends/test_ndarray.py::TestNDArray0dSelection2::test_get_values_nocombine_chains_reversed <- tests/backends/fixtures.py [32mPASSED[0m[31m [  3%][0m
tests/backends/test_ndarray.py::TestNDArray0dSelection2::test_nchains <- tests/backends/fixtures.py [32mPASSED[0m[31m [  3%][0m
tests/backends/test_ndarray.py::TestNDArray0dSelection2::test_get_values_one_chain_int_arg <- tests/backends/fixtures.py [32mPASSED[0m[31m [  3%][0m
tests/backends/test_ndarray.py::TestNDArray0dSelection2::test_get_values_combine <- tests/backends/fixtures.py [32mPASSED[0m[31m [  3%][0m
tests/backends/test_ndarray.py::TestNDArray0dSelection2::test_get_values_combine_burn_arg <- tests/backends/fixtures.py [32mPASSED[0m[31m [  3%][0m
tests/backends/test_ndarray.py::TestNDArray0dSelection2::test_get_values_combine_thin_arg <- tests/backends/fixtures.py [32mPASSED[0m[31m [  3%][0m
tests/backends/test_ndarray.py::TestNDArray0dSelection2::test_getitem_equivalence <- tests/backends/fixtures.py [32mPASSED[0m[31m [  3%][0m
tests/backends/test_ndarray.py::TestNDArray0dSelection2::test_selection_method_equivalence <- tests/backends/fixtures.py [32mPASSED[0m[31m [  3%][0m
tests/backends/test_ndarray.py::TestNDArray0dSelectionStats1::test_varnames_nonempty <- tests/backends/fixtures.py [32mPASSED[0m[31m [  3%][0m
tests/backends/test_ndarray.py::TestNDArray0dSelectionStats1::test_stat_names <- tests/backends/fixtures.py [32mPASSED[0m[31m [  3%][0m
tests/backends/test_ndarray.py::TestNDArray0dSelectionStats1::test_get_values_default <- tests/backends/fixtures.py [32mPASSED[0m[31m [  3%][0m
tests/backends/test_ndarray.py::TestNDArray0dSelectionStats1::test_get_values_nocombine_burn_keyword <- tests/backends/fixtures.py [32mPASSED[0m[31m [  3%][0m
tests/backends/test_ndarray.py::TestNDArray0dSelectionStats1::test_len <- tests/backends/fixtures.py [32mPASSED[0m[31m [  3%][0m
tests/backends/test_ndarray.py::TestNDArray0dSelectionStats1::test_dtypes <- tests/backends/fixtures.py [32mPASSED[0m[31m [  3%][0m
tests/backends/test_ndarray.py::TestNDArray0dSelectionStats1::test_get_values_nocombine_thin_keyword <- tests/backends/fixtures.py [32mPASSED[0m[31m [  3%][0m
tests/backends/test_ndarray.py::TestNDArray0dSelectionStats1::test_get_point <- tests/backends/fixtures.py [32mPASSED[0m[31m [  3%][0m
tests/backends/test_ndarray.py::TestNDArray0dSelectionStats1::test_get_slice <- tests/backends/fixtures.py [32mPASSED[0m[31m [  3%][0m
tests/backends/test_ndarray.py::TestNDArray0dSelectionStats1::test_get_slice_step <- tests/backends/fixtures.py [32mPASSED[0m[31m [  3%][0m
tests/backends/test_ndarray.py::TestNDArray0dSelectionStats1::test_get_slice_neg_step <- tests/backends/fixtures.py [32mPASSED[0m[31m [  4%][0m
tests/backends/test_ndarray.py::TestNDArray0dSelectionStats1::test_get_neg_slice <- tests/backends/fixtures.py [32mPASSED[0m[31m [  4%][0m
tests/backends/test_ndarray.py::TestNDArray0dSelectionStats1::test_get_values_one_chain <- tests/backends/fixtures.py [32mPASSED[0m[31m [  4%][0m
tests/backends/test_ndarray.py::TestNDArray0dSelectionStats1::test_get_values_nocombine_chains_reversed <- tests/backends/fixtures.py [32mPASSED[0m[31m [  4%][0m
tests/backends/test_ndarray.py::TestNDArray0dSelectionStats1::test_nchains <- tests/backends/fixtures.py [32mPASSED[0m[31m [  4%][0m
tests/backends/test_ndarray.py::TestNDArray0dSelectionStats1::test_get_values_one_chain_int_arg <- tests/backends/fixtures.py [32mPASSED[0m[31m [  4%][0m
tests/backends/test_ndarray.py::TestNDArray0dSelectionStats1::test_get_values_combine <- tests/backends/fixtures.py [32mPASSED[0m[31m [  4%][0m
tests/backends/test_ndarray.py::TestNDArray0dSelectionStats1::test_get_values_combine_burn_arg <- tests/backends/fixtures.py [32mPASSED[0m[31m [  4%][0m
tests/backends/test_ndarray.py::TestNDArray0dSelectionStats1::test_get_values_combine_thin_arg <- tests/backends/fixtures.py [32mPASSED[0m[31m [  4%][0m
tests/backends/test_ndarray.py::TestNDArray0dSelectionStats1::test_getitem_equivalence <- tests/backends/fixtures.py [32mPASSED[0m[31m [  4%][0m
tests/backends/test_ndarray.py::TestNDArray0dSelectionStats1::test_selection_method_equivalence <- tests/backends/fixtures.py [32mPASSED[0m[31m [  4%][0m
tests/backends/test_ndarray.py::TestNDArray0dSelectionStats2::test_varnames_nonempty <- tests/backends/fixtures.py [32mPASSED[0m[31m [  4%][0m
tests/backends/test_ndarray.py::TestNDArray0dSelectionStats2::test_stat_names <- tests/backends/fixtures.py [32mPASSED[0m[31m [  4%][0m
tests/backends/test_ndarray.py::TestNDArray0dSelectionStats2::test_get_values_default <- tests/backends/fixtures.py [32mPASSED[0m[31m [  4%][0m
tests/backends/test_ndarray.py::TestNDArray0dSelectionStats2::test_get_values_nocombine_burn_keyword <- tests/backends/fixtures.py [32mPASSED[0m[31m [  4%][0m
tests/backends/test_ndarray.py::TestNDArray0dSelectionStats2::test_len <- tests/backends/fixtures.py [32mPASSED[0m[31m [  4%][0m
tests/backends/test_ndarray.py::TestNDArray0dSelectionStats2::test_dtypes <- tests/backends/fixtures.py [32mPASSED[0m[31m [  4%][0m
tests/backends/test_ndarray.py::TestNDArray0dSelectionStats2::test_get_values_nocombine_thin_keyword <- tests/backends/fixtures.py [32mPASSED[0m[31m [  4%][0m
tests/backends/test_ndarray.py::TestNDArray0dSelectionStats2::test_get_point <- tests/backends/fixtures.py [32mPASSED[0m[31m [  4%][0m
tests/backends/test_ndarray.py::TestNDArray0dSelectionStats2::test_get_slice <- tests/backends/fixtures.py [32mPASSED[0m[31m [  4%][0m
tests/backends/test_ndarray.py::TestNDArray0dSelectionStats2::test_get_slice_step <- tests/backends/fixtures.py [32mPASSED[0m[31m [  4%][0m
tests/backends/test_ndarray.py::TestNDArray0dSelectionStats2::test_get_slice_neg_step <- tests/backends/fixtures.py [32mPASSED[0m[31m [  4%][0m
tests/backends/test_ndarray.py::TestNDArray0dSelectionStats2::test_get_neg_slice <- tests/backends/fixtures.py [32mPASSED[0m[31m [  4%][0m
tests/backends/test_ndarray.py::TestNDArray0dSelectionStats2::test_get_values_one_chain <- tests/backends/fixtures.py [32mPASSED[0m[31m [  4%][0m
tests/backends/test_ndarray.py::TestNDArray0dSelectionStats2::test_get_values_nocombine_chains_reversed <- tests/backends/fixtures.py [32mPASSED[0m[31m [  4%][0m
tests/backends/test_ndarray.py::TestNDArray0dSelectionStats2::test_nchains <- tests/backends/fixtures.py [32mPASSED[0m[31m [  4%][0m
tests/backends/test_ndarray.py::TestNDArray0dSelectionStats2::test_get_values_one_chain_int_arg <- tests/backends/fixtures.py [32mPASSED[0m[31m [  4%][0m
tests/backends/test_ndarray.py::TestNDArray0dSelectionStats2::test_get_values_combine <- tests/backends/fixtures.py [32mPASSED[0m[31m [  4%][0m
tests/backends/test_ndarray.py::TestNDArray0dSelectionStats2::test_get_values_combine_burn_arg <- tests/backends/fixtures.py [32mPASSED[0m[31m [  4%][0m
tests/backends/test_ndarray.py::TestNDArray0dSelectionStats2::test_get_values_combine_thin_arg <- tests/backends/fixtures.py [32mPASSED[0m[31m [  4%][0m
tests/backends/test_ndarray.py::TestNDArray0dSelectionStats2::test_getitem_equivalence <- tests/backends/fixtures.py [32mPASSED[0m[31m [  4%][0m
tests/backends/test_ndarray.py::TestNDArray0dSelectionStats2::test_selection_method_equivalence <- tests/backends/fixtures.py [32mPASSED[0m[31m [  4%][0m
tests/backends/test_ndarray.py::TestNDArray1dSelection::test_varnames_nonempty <- tests/backends/fixtures.py [32mPASSED[0m[31m [  4%][0m
tests/backends/test_ndarray.py::TestNDArray1dSelection::test_stat_names <- tests/backends/fixtures.py [32mPASSED[0m[31m [  4%][0m
tests/backends/test_ndarray.py::TestNDArray1dSelection::test_get_values_default <- tests/backends/fixtures.py [32mPASSED[0m[31m [  4%][0m
tests/backends/test_ndarray.py::TestNDArray1dSelection::test_get_values_nocombine_burn_keyword <- tests/backends/fixtures.py [32mPASSED[0m[31m [  4%][0m
tests/backends/test_ndarray.py::TestNDArray1dSelection::test_len <- tests/backends/fixtures.py [32mPASSED[0m[31m [  4%][0m
tests/backends/test_ndarray.py::TestNDArray1dSelection::test_dtypes <- tests/backends/fixtures.py [32mPASSED[0m[31m [  5%][0m
tests/backends/test_ndarray.py::TestNDArray1dSelection::test_get_values_nocombine_thin_keyword <- tests/backends/fixtures.py [32mPASSED[0m[31m [  5%][0m
tests/backends/test_ndarray.py::TestNDArray1dSelection::test_get_point <- tests/backends/fixtures.py [32mPASSED[0m[31m [  5%][0m
tests/backends/test_ndarray.py::TestNDArray1dSelection::test_get_slice <- tests/backends/fixtures.py [32mPASSED[0m[31m [  5%][0m
tests/backends/test_ndarray.py::TestNDArray1dSelection::test_get_slice_step <- tests/backends/fixtures.py [32mPASSED[0m[31m [  5%][0m
tests/backends/test_ndarray.py::TestNDArray1dSelection::test_get_slice_neg_step <- tests/backends/fixtures.py [32mPASSED[0m[31m [  5%][0m
tests/backends/test_ndarray.py::TestNDArray1dSelection::test_get_neg_slice <- tests/backends/fixtures.py [32mPASSED[0m[31m [  5%][0m
tests/backends/test_ndarray.py::TestNDArray1dSelection::test_get_values_one_chain <- tests/backends/fixtures.py [32mPASSED[0m[31m [  5%][0m
tests/backends/test_ndarray.py::TestNDArray1dSelection::test_get_values_nocombine_chains_reversed <- tests/backends/fixtures.py [32mPASSED[0m[31m [  5%][0m
tests/backends/test_ndarray.py::TestNDArray1dSelection::test_nchains <- tests/backends/fixtures.py [32mPASSED[0m[31m [  5%][0m
tests/backends/test_ndarray.py::TestNDArray1dSelection::test_get_values_one_chain_int_arg <- tests/backends/fixtures.py [32mPASSED[0m[31m [  5%][0m
tests/backends/test_ndarray.py::TestNDArray1dSelection::test_get_values_combine <- tests/backends/fixtures.py [32mPASSED[0m[31m [  5%][0m
tests/backends/test_ndarray.py::TestNDArray1dSelection::test_get_values_combine_burn_arg <- tests/backends/fixtures.py [32mPASSED[0m[31m [  5%][0m
tests/backends/test_ndarray.py::TestNDArray1dSelection::test_get_values_combine_thin_arg <- tests/backends/fixtures.py [32mPASSED[0m[31m [  5%][0m
tests/backends/test_ndarray.py::TestNDArray1dSelection::test_getitem_equivalence <- tests/backends/fixtures.py [32mPASSED[0m[31m [  5%][0m
tests/backends/test_ndarray.py::TestNDArray1dSelection::test_selection_method_equivalence <- tests/backends/fixtures.py [32mPASSED[0m[31m [  5%][0m
tests/backends/test_ndarray.py::TestNDArray2dSelection::test_varnames_nonempty <- tests/backends/fixtures.py [32mPASSED[0m[31m [  5%][0m
tests/backends/test_ndarray.py::TestNDArray2dSelection::test_stat_names <- tests/backends/fixtures.py [32mPASSED[0m[31m [  5%][0m
tests/backends/test_ndarray.py::TestNDArray2dSelection::test_get_values_default <- tests/backends/fixtures.py [32mPASSED[0m[31m [  5%][0m
tests/backends/test_ndarray.py::TestNDArray2dSelection::test_get_values_nocombine_burn_keyword <- tests/backends/fixtures.py [32mPASSED[0m[31m [  5%][0m
tests/backends/test_ndarray.py::TestNDArray2dSelection::test_len <- tests/backends/fixtures.py [32mPASSED[0m[31m [  5%][0m
tests/backends/test_ndarray.py::TestNDArray2dSelection::test_dtypes <- tests/backends/fixtures.py [32mPASSED[0m[31m [  5%][0m
tests/backends/test_ndarray.py::TestNDArray2dSelection::test_get_values_nocombine_thin_keyword <- tests/backends/fixtures.py [32mPASSED[0m[31m [  5%][0m
tests/backends/test_ndarray.py::TestNDArray2dSelection::test_get_point <- tests/backends/fixtures.py [32mPASSED[0m[31m [  5%][0m
tests/backends/test_ndarray.py::TestNDArray2dSelection::test_get_slice <- tests/backends/fixtures.py [32mPASSED[0m[31m [  5%][0m
tests/backends/test_ndarray.py::TestNDArray2dSelection::test_get_slice_step <- tests/backends/fixtures.py [32mPASSED[0m[31m [  5%][0m
tests/backends/test_ndarray.py::TestNDArray2dSelection::test_get_slice_neg_step <- tests/backends/fixtures.py [32mPASSED[0m[31m [  5%][0m
tests/backends/test_ndarray.py::TestNDArray2dSelection::test_get_neg_slice <- tests/backends/fixtures.py [32mPASSED[0m[31m [  5%][0m
tests/backends/test_ndarray.py::TestNDArray2dSelection::test_get_values_one_chain <- tests/backends/fixtures.py [32mPASSED[0m[31m [  5%][0m
tests/backends/test_ndarray.py::TestNDArray2dSelection::test_get_values_nocombine_chains_reversed <- tests/backends/fixtures.py [32mPASSED[0m[31m [  5%][0m
tests/backends/test_ndarray.py::TestNDArray2dSelection::test_nchains <- tests/backends/fixtures.py [32mPASSED[0m[31m [  5%][0m
tests/backends/test_ndarray.py::TestNDArray2dSelection::test_get_values_one_chain_int_arg <- tests/backends/fixtures.py [32mPASSED[0m[31m [  5%][0m
tests/backends/test_ndarray.py::TestNDArray2dSelection::test_get_values_combine <- tests/backends/fixtures.py [32mPASSED[0m[31m [  5%][0m
tests/backends/test_ndarray.py::TestNDArray2dSelection::test_get_values_combine_burn_arg <- tests/backends/fixtures.py [32mPASSED[0m[31m [  5%][0m
tests/backends/test_ndarray.py::TestNDArray2dSelection::test_get_values_combine_thin_arg <- tests/backends/fixtures.py [32mPASSED[0m[31m [  5%][0m
tests/backends/test_ndarray.py::TestNDArray2dSelection::test_getitem_equivalence <- tests/backends/fixtures.py [32mPASSED[0m[31m [  5%][0m
tests/backends/test_ndarray.py::TestNDArray2dSelection::test_selection_method_equivalence <- tests/backends/fixtures.py [32mPASSED[0m[31m [  6%][0m
tests/backends/test_ndarray.py::TestMultiTrace::test_append_invalid <- tests/backends/fixtures.py [32mPASSED[0m[31m [  6%][0m
tests/backends/test_ndarray.py::TestMultiTrace::test_append <- tests/backends/fixtures.py [32mPASSED[0m[31m [  6%][0m
tests/backends/test_ndarray.py::TestMultiTrace::test_double_close <- tests/backends/fixtures.py [32mPASSED[0m[31m [  6%][0m
tests/backends/test_ndarray.py::TestMultiTrace::test_multitrace_nonunique [32mPASSED[0m[31m [  6%][0m
tests/backends/test_ndarray.py::TestMultiTrace::test_multitrace_iter_notimplemented [32mPASSED[0m[31m [  6%][0m
tests/backends/test_ndarray.py::TestSqueezeCat::test_combine_false_squeeze_false [32mPASSED[0m[31m [  6%][0m
tests/backends/test_ndarray.py::TestSqueezeCat::test_combine_true_squeeze_false [32mPASSED[0m[31m [  6%][0m
tests/backends/test_ndarray.py::TestSqueezeCat::test_combine_false_squeeze_true_more_than_one_item [32mPASSED[0m[31m [  6%][0m
tests/backends/test_ndarray.py::TestSqueezeCat::test_combine_false_squeeze_true_one_item [32mPASSED[0m[31m [  6%][0m
tests/backends/test_ndarray.py::TestSqueezeCat::test_combine_true_squeeze_true [32mPASSED[0m[31m [  6%][0m
tests/backends/test_zarr.py::test_record[single_step-include_transformed-frequent_writes] [32mPASSED[0m[31m [  6%][0m
tests/backends/test_zarr.py::test_record[single_step-include_transformed-sparse_writes] [32mPASSED[0m[31m [  6%][0m
tests/backends/test_zarr.py::test_record[single_step-discard_transformed-frequent_writes] [32mPASSED[0m[31m [  6%][0m
tests/backends/test_zarr.py::test_record[single_step-discard_transformed-sparse_writes] [32mPASSED[0m[31m [  6%][0m
tests/backends/test_zarr.py::test_record[compound_step-include_transformed-frequent_writes] [32mPASSED[0m[31m [  6%][0m
tests/backends/test_zarr.py::test_record[compound_step-include_transformed-sparse_writes] [32mPASSED[0m[31m [  6%][0m
tests/backends/test_zarr.py::test_record[compound_step-discard_transformed-frequent_writes] [32mPASSED[0m[31m [  6%][0m
tests/backends/test_zarr.py::test_record[compound_step-discard_transformed-sparse_writes] [32mPASSED[0m[31m [  6%][0m
tests/backends/test_zarr.py::test_split_warmup[single_step-include_transformed-0] [32mPASSED[0m[31m [  6%][0m
tests/backends/test_zarr.py::test_split_warmup[single_step-include_transformed-5] [32mPASSED[0m[31m [  6%][0m
tests/backends/test_zarr.py::test_split_warmup[single_step-include_transformed-10] [32mPASSED[0m[31m [  6%][0m
tests/backends/test_zarr.py::test_split_warmup[single_step-discard_transformed-0] [32mPASSED[0m[31m [  6%][0m
tests/backends/test_zarr.py::test_split_warmup[single_step-discard_transformed-5] [32mPASSED[0m[31m [  6%][0m
tests/backends/test_zarr.py::test_split_warmup[single_step-discard_transformed-10] [32mPASSED[0m[31m [  6%][0m
tests/backends/test_zarr.py::test_split_warmup[compound_step-include_transformed-0] [32mPASSED[0m[31m [  6%][0m
tests/backends/test_zarr.py::test_split_warmup[compound_step-include_transformed-5] [32mPASSED[0m[31m [  6%][0m
tests/backends/test_zarr.py::test_split_warmup[compound_step-include_transformed-10] [32mPASSED[0m[31m [  6%][0m
tests/backends/test_zarr.py::test_split_warmup[compound_step-discard_transformed-0] [32mPASSED[0m[31m [  6%][0m
tests/backends/test_zarr.py::test_split_warmup[compound_step-discard_transformed-5] [32mPASSED[0m[31m [  6%][0m
tests/backends/test_zarr.py::test_split_warmup[compound_step-discard_transformed-10] [32mPASSED[0m[31m [  6%][0m
tests/backends/test_zarr.py::test_sample[single_step-include_transformed-discard_tuning-return_idata-keep_warning_stat-parallel_sampling-compute_loglike-frequent_writes] [32mPASSED[0m[31m [  6%][0m
tests/backends/test_zarr.py::test_sample[single_step-include_transformed-discard_tuning-return_idata-keep_warning_stat-parallel_sampling-compute_loglike-sparse_writes] [32mPASSED[0m[31m [  6%][0m
tests/backends/test_zarr.py::test_sample[single_step-include_transformed-discard_tuning-return_idata-keep_warning_stat-parallel_sampling-no_loglike-frequent_writes] [32mPASSED[0m[31m [  6%][0m
tests/backends/test_zarr.py::test_sample[single_step-include_transformed-discard_tuning-return_idata-keep_warning_stat-parallel_sampling-no_loglike-sparse_writes] [32mPASSED[0m[31m [  6%][0m
tests/backends/test_zarr.py::test_sample[single_step-include_transformed-discard_tuning-return_idata-keep_warning_stat-sequential_sampling-compute_loglike-frequent_writes] [32mPASSED[0m[31m [  6%][0m
tests/backends/test_zarr.py::test_sample[single_step-include_transformed-discard_tuning-return_idata-keep_warning_stat-sequential_sampling-compute_loglike-sparse_writes] [32mPASSED[0m[31m [  6%][0m
tests/backends/test_zarr.py::test_sample[single_step-include_transformed-discard_tuning-return_idata-keep_warning_stat-sequential_sampling-no_loglike-frequent_writes] [32mPASSED[0m[31m [  7%][0m
tests/backends/test_zarr.py::test_sample[single_step-include_transformed-discard_tuning-return_idata-keep_warning_stat-sequential_sampling-no_loglike-sparse_writes] [32mPASSED[0m[31m [  7%][0m
tests/backends/test_zarr.py::test_sample[single_step-include_transformed-discard_tuning-return_idata-discard_warning_stat-parallel_sampling-compute_loglike-frequent_writes] [32mPASSED[0m[31m [  7%][0m
tests/backends/test_zarr.py::test_sample[single_step-include_transformed-discard_tuning-return_idata-discard_warning_stat-parallel_sampling-compute_loglike-sparse_writes] [32mPASSED[0m[31m [  7%][0m
tests/backends/test_zarr.py::test_sample[single_step-include_transformed-discard_tuning-return_idata-discard_warning_stat-parallel_sampling-no_loglike-frequent_writes] [32mPASSED[0m[31m [  7%][0m
tests/backends/test_zarr.py::test_sample[single_step-include_transformed-discard_tuning-return_idata-discard_warning_stat-parallel_sampling-no_loglike-sparse_writes] [32mPASSED[0m[31m [  7%][0m
tests/backends/test_zarr.py::test_sample[single_step-include_transformed-discard_tuning-return_idata-discard_warning_stat-sequential_sampling-compute_loglike-frequent_writes] [32mPASSED[0m[31m [  7%][0m
tests/backends/test_zarr.py::test_sample[single_step-include_transformed-discard_tuning-return_idata-discard_warning_stat-sequential_sampling-compute_loglike-sparse_writes] [32mPASSED[0m[31m [  7%][0m
tests/backends/test_zarr.py::test_sample[single_step-include_transformed-discard_tuning-return_idata-discard_warning_stat-sequential_sampling-no_loglike-frequent_writes] [32mPASSED[0m[31m [  7%][0m
tests/backends/test_zarr.py::test_sample[single_step-include_transformed-discard_tuning-return_idata-discard_warning_stat-sequential_sampling-no_loglike-sparse_writes] [32mPASSED[0m[31m [  7%][0m
tests/backends/test_zarr.py::test_sample[single_step-include_transformed-discard_tuning-return_zarr-keep_warning_stat-parallel_sampling-compute_loglike-frequent_writes] [32mPASSED[0m[31m [  7%][0m
tests/backends/test_zarr.py::test_sample[single_step-include_transformed-discard_tuning-return_zarr-keep_warning_stat-parallel_sampling-compute_loglike-sparse_writes] [32mPASSED[0m[31m [  7%][0m
tests/backends/test_zarr.py::test_sample[single_step-include_transformed-discard_tuning-return_zarr-keep_warning_stat-parallel_sampling-no_loglike-frequent_writes] [33mSKIPPED[0m[31m [  7%][0m
tests/backends/test_zarr.py::test_sample[single_step-include_transformed-discard_tuning-return_zarr-keep_warning_stat-parallel_sampling-no_loglike-sparse_writes] [33mSKIPPED[0m[31m [  7%][0m
tests/backends/test_zarr.py::test_sample[single_step-include_transformed-discard_tuning-return_zarr-keep_warning_stat-sequential_sampling-compute_loglike-frequent_writes] [32mPASSED[0m[31m [  7%][0m
tests/backends/test_zarr.py::test_sample[single_step-include_transformed-discard_tuning-return_zarr-keep_warning_stat-sequential_sampling-compute_loglike-sparse_writes] [32mPASSED[0m[31m [  7%][0m
tests/backends/test_zarr.py::test_sample[single_step-include_transformed-discard_tuning-return_zarr-keep_warning_stat-sequential_sampling-no_loglike-frequent_writes] [33mSKIPPED[0m[31m [  7%][0m
tests/backends/test_zarr.py::test_sample[single_step-include_transformed-discard_tuning-return_zarr-keep_warning_stat-sequential_sampling-no_loglike-sparse_writes] [33mSKIPPED[0m[31m [  7%][0m
tests/backends/test_zarr.py::test_sample[single_step-include_transformed-discard_tuning-return_zarr-discard_warning_stat-parallel_sampling-compute_loglike-frequent_writes] [32mPASSED[0m[31m [  7%][0m
tests/backends/test_zarr.py::test_sample[single_step-include_transformed-discard_tuning-return_zarr-discard_warning_stat-parallel_sampling-compute_loglike-sparse_writes] [32mPASSED[0m[31m [  7%][0m
tests/backends/test_zarr.py::test_sample[single_step-include_transformed-discard_tuning-return_zarr-discard_warning_stat-parallel_sampling-no_loglike-frequent_writes] [33mSKIPPED[0m[31m [  7%][0m
tests/backends/test_zarr.py::test_sample[single_step-include_transformed-discard_tuning-return_zarr-discard_warning_stat-parallel_sampling-no_loglike-sparse_writes] [33mSKIPPED[0m[31m [  7%][0m
tests/backends/test_zarr.py::test_sample[single_step-include_transformed-discard_tuning-return_zarr-discard_warning_stat-sequential_sampling-compute_loglike-frequent_writes] [32mPASSED[0m[31m [  7%][0m
tests/backends/test_zarr.py::test_sample[single_step-include_transformed-discard_tuning-return_zarr-discard_warning_stat-sequential_sampling-compute_loglike-sparse_writes] [32mPASSED[0m[31m [  7%][0m
tests/backends/test_zarr.py::test_sample[single_step-include_transformed-discard_tuning-return_zarr-discard_warning_stat-sequential_sampling-no_loglike-frequent_writes] [33mSKIPPED[0m[31m [  7%][0m
tests/backends/test_zarr.py::test_sample[single_step-include_transformed-discard_tuning-return_zarr-discard_warning_stat-sequential_sampling-no_loglike-sparse_writes] [33mSKIPPED[0m[31m [  7%][0m
tests/backends/test_zarr.py::test_sample[single_step-include_transformed-keep_tuning-return_idata-keep_warning_stat-parallel_sampling-compute_loglike-frequent_writes] [32mPASSED[0m[31m [  7%][0m
tests/backends/test_zarr.py::test_sample[single_step-include_transformed-keep_tuning-return_idata-keep_warning_stat-parallel_sampling-compute_loglike-sparse_writes] [32mPASSED[0m[31m [  7%][0m
tests/backends/test_zarr.py::test_sample[single_step-include_transformed-keep_tuning-return_idata-keep_warning_stat-parallel_sampling-no_loglike-frequent_writes] [32mPASSED[0m[31m [  7%][0m
tests/backends/test_zarr.py::test_sample[single_step-include_transformed-keep_tuning-return_idata-keep_warning_stat-parallel_sampling-no_loglike-sparse_writes] [32mPASSED[0m[31m [  7%][0m
tests/backends/test_zarr.py::test_sample[single_step-include_transformed-keep_tuning-return_idata-keep_warning_stat-sequential_sampling-compute_loglike-frequent_writes] [32mPASSED[0m[31m [  7%][0m
tests/backends/test_zarr.py::test_sample[single_step-include_transformed-keep_tuning-return_idata-keep_warning_stat-sequential_sampling-compute_loglike-sparse_writes] [32mPASSED[0m[31m [  7%][0m
tests/backends/test_zarr.py::test_sample[single_step-include_transformed-keep_tuning-return_idata-keep_warning_stat-sequential_sampling-no_loglike-frequent_writes] [32mPASSED[0m[31m [  7%][0m
tests/backends/test_zarr.py::test_sample[single_step-include_transformed-keep_tuning-return_idata-keep_warning_stat-sequential_sampling-no_loglike-sparse_writes] [32mPASSED[0m[31m [  7%][0m
tests/backends/test_zarr.py::test_sample[single_step-include_transformed-keep_tuning-return_idata-discard_warning_stat-parallel_sampling-compute_loglike-frequent_writes] [32mPASSED[0m[31m [  7%][0m
tests/backends/test_zarr.py::test_sample[single_step-include_transformed-keep_tuning-return_idata-discard_warning_stat-parallel_sampling-compute_loglike-sparse_writes] [32mPASSED[0m[31m [  7%][0m
tests/backends/test_zarr.py::test_sample[single_step-include_transformed-keep_tuning-return_idata-discard_warning_stat-parallel_sampling-no_loglike-frequent_writes] [32mPASSED[0m[31m [  7%][0m
tests/backends/test_zarr.py::test_sample[single_step-include_transformed-keep_tuning-return_idata-discard_warning_stat-parallel_sampling-no_loglike-sparse_writes] [32mPASSED[0m[31m [  8%][0m
tests/backends/test_zarr.py::test_sample[single_step-include_transformed-keep_tuning-return_idata-discard_warning_stat-sequential_sampling-compute_loglike-frequent_writes] [32mPASSED[0m[31m [  8%][0m
tests/backends/test_zarr.py::test_sample[single_step-include_transformed-keep_tuning-return_idata-discard_warning_stat-sequential_sampling-compute_loglike-sparse_writes] [32mPASSED[0m[31m [  8%][0m
tests/backends/test_zarr.py::test_sample[single_step-include_transformed-keep_tuning-return_idata-discard_warning_stat-sequential_sampling-no_loglike-frequent_writes] [32mPASSED[0m[31m [  8%][0m
tests/backends/test_zarr.py::test_sample[single_step-include_transformed-keep_tuning-return_idata-discard_warning_stat-sequential_sampling-no_loglike-sparse_writes] [32mPASSED[0m[31m [  8%][0m
tests/backends/test_zarr.py::test_sample[single_step-include_transformed-keep_tuning-return_zarr-keep_warning_stat-parallel_sampling-compute_loglike-frequent_writes] [32mPASSED[0m[31m [  8%][0m
tests/backends/test_zarr.py::test_sample[single_step-include_transformed-keep_tuning-return_zarr-keep_warning_stat-parallel_sampling-compute_loglike-sparse_writes] [32mPASSED[0m[31m [  8%][0m
tests/backends/test_zarr.py::test_sample[single_step-include_transformed-keep_tuning-return_zarr-keep_warning_stat-parallel_sampling-no_loglike-frequent_writes] [33mSKIPPED[0m[31m [  8%][0m
tests/backends/test_zarr.py::test_sample[single_step-include_transformed-keep_tuning-return_zarr-keep_warning_stat-parallel_sampling-no_loglike-sparse_writes] [33mSKIPPED[0m[31m [  8%][0m
tests/backends/test_zarr.py::test_sample[single_step-include_transformed-keep_tuning-return_zarr-keep_warning_stat-sequential_sampling-compute_loglike-frequent_writes] [32mPASSED[0m[31m [  8%][0m
tests/backends/test_zarr.py::test_sample[single_step-include_transformed-keep_tuning-return_zarr-keep_warning_stat-sequential_sampling-compute_loglike-sparse_writes] [32mPASSED[0m[31m [  8%][0m
tests/backends/test_zarr.py::test_sample[single_step-include_transformed-keep_tuning-return_zarr-keep_warning_stat-sequential_sampling-no_loglike-frequent_writes] [33mSKIPPED[0m[31m [  8%][0m
tests/backends/test_zarr.py::test_sample[single_step-include_transformed-keep_tuning-return_zarr-keep_warning_stat-sequential_sampling-no_loglike-sparse_writes] [33mSKIPPED[0m[31m [  8%][0m
tests/backends/test_zarr.py::test_sample[single_step-include_transformed-keep_tuning-return_zarr-discard_warning_stat-parallel_sampling-compute_loglike-frequent_writes] [32mPASSED[0m[31m [  8%][0m
tests/backends/test_zarr.py::test_sample[single_step-include_transformed-keep_tuning-return_zarr-discard_warning_stat-parallel_sampling-compute_loglike-sparse_writes] [32mPASSED[0m[31m [  8%][0m
tests/backends/test_zarr.py::test_sample[single_step-include_transformed-keep_tuning-return_zarr-discard_warning_stat-parallel_sampling-no_loglike-frequent_writes] [33mSKIPPED[0m[31m [  8%][0m
tests/backends/test_zarr.py::test_sample[single_step-include_transformed-keep_tuning-return_zarr-discard_warning_stat-parallel_sampling-no_loglike-sparse_writes] [33mSKIPPED[0m[31m [  8%][0m
tests/backends/test_zarr.py::test_sample[single_step-include_transformed-keep_tuning-return_zarr-discard_warning_stat-sequential_sampling-compute_loglike-frequent_writes] [32mPASSED[0m[31m [  8%][0m
tests/backends/test_zarr.py::test_sample[single_step-include_transformed-keep_tuning-return_zarr-discard_warning_stat-sequential_sampling-compute_loglike-sparse_writes] [32mPASSED[0m[31m [  8%][0m
tests/backends/test_zarr.py::test_sample[single_step-include_transformed-keep_tuning-return_zarr-discard_warning_stat-sequential_sampling-no_loglike-frequent_writes] [33mSKIPPED[0m[31m [  8%][0m
tests/backends/test_zarr.py::test_sample[single_step-include_transformed-keep_tuning-return_zarr-discard_warning_stat-sequential_sampling-no_loglike-sparse_writes] [33mSKIPPED[0m[31m [  8%][0m
tests/backends/test_zarr.py::test_sample[single_step-discard_transformed-discard_tuning-return_idata-keep_warning_stat-parallel_sampling-compute_loglike-frequent_writes] [32mPASSED[0m[31m [  8%][0m
tests/backends/test_zarr.py::test_sample[single_step-discard_transformed-discard_tuning-return_idata-keep_warning_stat-parallel_sampling-compute_loglike-sparse_writes] [32mPASSED[0m[31m [  8%][0m
tests/backends/test_zarr.py::test_sample[single_step-discard_transformed-discard_tuning-return_idata-keep_warning_stat-parallel_sampling-no_loglike-frequent_writes] [32mPASSED[0m[31m [  8%][0m
tests/backends/test_zarr.py::test_sample[single_step-discard_transformed-discard_tuning-return_idata-keep_warning_stat-parallel_sampling-no_loglike-sparse_writes] [32mPASSED[0m[31m [  8%][0m
tests/backends/test_zarr.py::test_sample[single_step-discard_transformed-discard_tuning-return_idata-keep_warning_stat-sequential_sampling-compute_loglike-frequent_writes] [32mPASSED[0m[31m [  8%][0m
tests/backends/test_zarr.py::test_sample[single_step-discard_transformed-discard_tuning-return_idata-keep_warning_stat-sequential_sampling-compute_loglike-sparse_writes] [32mPASSED[0m[31m [  8%][0m
tests/backends/test_zarr.py::test_sample[single_step-discard_transformed-discard_tuning-return_idata-keep_warning_stat-sequential_sampling-no_loglike-frequent_writes] [32mPASSED[0m[31m [  8%][0m
tests/backends/test_zarr.py::test_sample[single_step-discard_transformed-discard_tuning-return_idata-keep_warning_stat-sequential_sampling-no_loglike-sparse_writes] [32mPASSED[0m[31m [  8%][0m
tests/backends/test_zarr.py::test_sample[single_step-discard_transformed-discard_tuning-return_idata-discard_warning_stat-parallel_sampling-compute_loglike-frequent_writes] [32mPASSED[0m[31m [  8%][0m
tests/backends/test_zarr.py::test_sample[single_step-discard_transformed-discard_tuning-return_idata-discard_warning_stat-parallel_sampling-compute_loglike-sparse_writes] [32mPASSED[0m[31m [  8%][0m
tests/backends/test_zarr.py::test_sample[single_step-discard_transformed-discard_tuning-return_idata-discard_warning_stat-parallel_sampling-no_loglike-frequent_writes] [32mPASSED[0m[31m [  8%][0m
tests/backends/test_zarr.py::test_sample[single_step-discard_transformed-discard_tuning-return_idata-discard_warning_stat-parallel_sampling-no_loglike-sparse_writes] [32mPASSED[0m[31m [  8%][0m
tests/backends/test_zarr.py::test_sample[single_step-discard_transformed-discard_tuning-return_idata-discard_warning_stat-sequential_sampling-compute_loglike-frequent_writes] [32mPASSED[0m[31m [  8%][0m
tests/backends/test_zarr.py::test_sample[single_step-discard_transformed-discard_tuning-return_idata-discard_warning_stat-sequential_sampling-compute_loglike-sparse_writes] [32mPASSED[0m[31m [  8%][0m
tests/backends/test_zarr.py::test_sample[single_step-discard_transformed-discard_tuning-return_idata-discard_warning_stat-sequential_sampling-no_loglike-frequent_writes] [32mPASSED[0m[31m [  8%][0m
tests/backends/test_zarr.py::test_sample[single_step-discard_transformed-discard_tuning-return_idata-discard_warning_stat-sequential_sampling-no_loglike-sparse_writes] [32mPASSED[0m[31m [  8%][0m
tests/backends/test_zarr.py::test_sample[single_step-discard_transformed-discard_tuning-return_zarr-keep_warning_stat-parallel_sampling-compute_loglike-frequent_writes] [32mPASSED[0m[31m [  9%][0m
tests/backends/test_zarr.py::test_sample[single_step-discard_transformed-discard_tuning-return_zarr-keep_warning_stat-parallel_sampling-compute_loglike-sparse_writes] [32mPASSED[0m[31m [  9%][0m
tests/backends/test_zarr.py::test_sample[single_step-discard_transformed-discard_tuning-return_zarr-keep_warning_stat-parallel_sampling-no_loglike-frequent_writes] [33mSKIPPED[0m[31m [  9%][0m
tests/backends/test_zarr.py::test_sample[single_step-discard_transformed-discard_tuning-return_zarr-keep_warning_stat-parallel_sampling-no_loglike-sparse_writes] [33mSKIPPED[0m[31m [  9%][0m
tests/backends/test_zarr.py::test_sample[single_step-discard_transformed-discard_tuning-return_zarr-keep_warning_stat-sequential_sampling-compute_loglike-frequent_writes] [32mPASSED[0m[31m [  9%][0m
tests/backends/test_zarr.py::test_sample[single_step-discard_transformed-discard_tuning-return_zarr-keep_warning_stat-sequential_sampling-compute_loglike-sparse_writes] [32mPASSED[0m[31m [  9%][0m
tests/backends/test_zarr.py::test_sample[single_step-discard_transformed-discard_tuning-return_zarr-keep_warning_stat-sequential_sampling-no_loglike-frequent_writes] [33mSKIPPED[0m[31m [  9%][0m
tests/backends/test_zarr.py::test_sample[single_step-discard_transformed-discard_tuning-return_zarr-keep_warning_stat-sequential_sampling-no_loglike-sparse_writes] [33mSKIPPED[0m[31m [  9%][0m
tests/backends/test_zarr.py::test_sample[single_step-discard_transformed-discard_tuning-return_zarr-discard_warning_stat-parallel_sampling-compute_loglike-frequent_writes] [32mPASSED[0m[31m [  9%][0m
tests/backends/test_zarr.py::test_sample[single_step-discard_transformed-discard_tuning-return_zarr-discard_warning_stat-parallel_sampling-compute_loglike-sparse_writes] [32mPASSED[0m[31m [  9%][0m
tests/backends/test_zarr.py::test_sample[single_step-discard_transformed-discard_tuning-return_zarr-discard_warning_stat-parallel_sampling-no_loglike-frequent_writes] [33mSKIPPED[0m[31m [  9%][0m
tests/backends/test_zarr.py::test_sample[single_step-discard_transformed-discard_tuning-return_zarr-discard_warning_stat-parallel_sampling-no_loglike-sparse_writes] [33mSKIPPED[0m[31m [  9%][0m
tests/backends/test_zarr.py::test_sample[single_step-discard_transformed-discard_tuning-return_zarr-discard_warning_stat-sequential_sampling-compute_loglike-frequent_writes] [32mPASSED[0m[31m [  9%][0m
tests/backends/test_zarr.py::test_sample[single_step-discard_transformed-discard_tuning-return_zarr-discard_warning_stat-sequential_sampling-compute_loglike-sparse_writes] [32mPASSED[0m[31m [  9%][0m
tests/backends/test_zarr.py::test_sample[single_step-discard_transformed-discard_tuning-return_zarr-discard_warning_stat-sequential_sampling-no_loglike-frequent_writes] [33mSKIPPED[0m[31m [  9%][0m
tests/backends/test_zarr.py::test_sample[single_step-discard_transformed-discard_tuning-return_zarr-discard_warning_stat-sequential_sampling-no_loglike-sparse_writes] [33mSKIPPED[0m[31m [  9%][0m
tests/backends/test_zarr.py::test_sample[single_step-discard_transformed-keep_tuning-return_idata-keep_warning_stat-parallel_sampling-compute_loglike-frequent_writes] [32mPASSED[0m[31m [  9%][0m
tests/backends/test_zarr.py::test_sample[single_step-discard_transformed-keep_tuning-return_idata-keep_warning_stat-parallel_sampling-compute_loglike-sparse_writes] [32mPASSED[0m[31m [  9%][0m
tests/backends/test_zarr.py::test_sample[single_step-discard_transformed-keep_tuning-return_idata-keep_warning_stat-parallel_sampling-no_loglike-frequent_writes] [32mPASSED[0m[31m [  9%][0m
tests/backends/test_zarr.py::test_sample[single_step-discard_transformed-keep_tuning-return_idata-keep_warning_stat-parallel_sampling-no_loglike-sparse_writes] [32mPASSED[0m[31m [  9%][0m
tests/backends/test_zarr.py::test_sample[single_step-discard_transformed-keep_tuning-return_idata-keep_warning_stat-sequential_sampling-compute_loglike-frequent_writes] [32mPASSED[0m[31m [  9%][0m
tests/backends/test_zarr.py::test_sample[single_step-discard_transformed-keep_tuning-return_idata-keep_warning_stat-sequential_sampling-compute_loglike-sparse_writes] [32mPASSED[0m[31m [  9%][0m
tests/backends/test_zarr.py::test_sample[single_step-discard_transformed-keep_tuning-return_idata-keep_warning_stat-sequential_sampling-no_loglike-frequent_writes] [32mPASSED[0m[31m [  9%][0m
tests/backends/test_zarr.py::test_sample[single_step-discard_transformed-keep_tuning-return_idata-keep_warning_stat-sequential_sampling-no_loglike-sparse_writes] [32mPASSED[0m[31m [  9%][0m
tests/backends/test_zarr.py::test_sample[single_step-discard_transformed-keep_tuning-return_idata-discard_warning_stat-parallel_sampling-compute_loglike-frequent_writes] [32mPASSED[0m[31m [  9%][0m
tests/backends/test_zarr.py::test_sample[single_step-discard_transformed-keep_tuning-return_idata-discard_warning_stat-parallel_sampling-compute_loglike-sparse_writes] [32mPASSED[0m[31m [  9%][0m
tests/backends/test_zarr.py::test_sample[single_step-discard_transformed-keep_tuning-return_idata-discard_warning_stat-parallel_sampling-no_loglike-frequent_writes] [32mPASSED[0m[31m [  9%][0m
tests/backends/test_zarr.py::test_sample[single_step-discard_transformed-keep_tuning-return_idata-discard_warning_stat-parallel_sampling-no_loglike-sparse_writes] [32mPASSED[0m[31m [  9%][0m
tests/backends/test_zarr.py::test_sample[single_step-discard_transformed-keep_tuning-return_idata-discard_warning_stat-sequential_sampling-compute_loglike-frequent_writes] [32mPASSED[0m[31m [  9%][0m
tests/backends/test_zarr.py::test_sample[single_step-discard_transformed-keep_tuning-return_idata-discard_warning_stat-sequential_sampling-compute_loglike-sparse_writes] [32mPASSED[0m[31m [  9%][0m
tests/backends/test_zarr.py::test_sample[single_step-discard_transformed-keep_tuning-return_idata-discard_warning_stat-sequential_sampling-no_loglike-frequent_writes] [32mPASSED[0m[31m [  9%][0m
tests/backends/test_zarr.py::test_sample[single_step-discard_transformed-keep_tuning-return_idata-discard_warning_stat-sequential_sampling-no_loglike-sparse_writes] [32mPASSED[0m[31m [  9%][0m
tests/backends/test_zarr.py::test_sample[single_step-discard_transformed-keep_tuning-return_zarr-keep_warning_stat-parallel_sampling-compute_loglike-frequent_writes] [32mPASSED[0m[31m [  9%][0m
tests/backends/test_zarr.py::test_sample[single_step-discard_transformed-keep_tuning-return_zarr-keep_warning_stat-parallel_sampling-compute_loglike-sparse_writes] [32mPASSED[0m[31m [  9%][0m
tests/backends/test_zarr.py::test_sample[single_step-discard_transformed-keep_tuning-return_zarr-keep_warning_stat-parallel_sampling-no_loglike-frequent_writes] [33mSKIPPED[0m[31m [  9%][0m
tests/backends/test_zarr.py::test_sample[single_step-discard_transformed-keep_tuning-return_zarr-keep_warning_stat-parallel_sampling-no_loglike-sparse_writes] [33mSKIPPED[0m[31m [  9%][0m
tests/backends/test_zarr.py::test_sample[single_step-discard_transformed-keep_tuning-return_zarr-keep_warning_stat-sequential_sampling-compute_loglike-frequent_writes] [32mPASSED[0m[31m [  9%][0m
tests/backends/test_zarr.py::test_sample[single_step-discard_transformed-keep_tuning-return_zarr-keep_warning_stat-sequential_sampling-compute_loglike-sparse_writes] [32mPASSED[0m[31m [ 10%][0m
tests/backends/test_zarr.py::test_sample[single_step-discard_transformed-keep_tuning-return_zarr-keep_warning_stat-sequential_sampling-no_loglike-frequent_writes] [33mSKIPPED[0m[31m [ 10%][0m
tests/backends/test_zarr.py::test_sample[single_step-discard_transformed-keep_tuning-return_zarr-keep_warning_stat-sequential_sampling-no_loglike-sparse_writes] [33mSKIPPED[0m[31m [ 10%][0m
tests/backends/test_zarr.py::test_sample[single_step-discard_transformed-keep_tuning-return_zarr-discard_warning_stat-parallel_sampling-compute_loglike-frequent_writes] [32mPASSED[0m[31m [ 10%][0m
tests/backends/test_zarr.py::test_sample[single_step-discard_transformed-keep_tuning-return_zarr-discard_warning_stat-parallel_sampling-compute_loglike-sparse_writes] [32mPASSED[0m[31m [ 10%][0m
tests/backends/test_zarr.py::test_sample[single_step-discard_transformed-keep_tuning-return_zarr-discard_warning_stat-parallel_sampling-no_loglike-frequent_writes] [33mSKIPPED[0m[31m [ 10%][0m
tests/backends/test_zarr.py::test_sample[single_step-discard_transformed-keep_tuning-return_zarr-discard_warning_stat-parallel_sampling-no_loglike-sparse_writes] [33mSKIPPED[0m[31m [ 10%][0m
tests/backends/test_zarr.py::test_sample[single_step-discard_transformed-keep_tuning-return_zarr-discard_warning_stat-sequential_sampling-compute_loglike-frequent_writes] [32mPASSED[0m[31m [ 10%][0m
tests/backends/test_zarr.py::test_sample[single_step-discard_transformed-keep_tuning-return_zarr-discard_warning_stat-sequential_sampling-compute_loglike-sparse_writes] [32mPASSED[0m[31m [ 10%][0m
tests/backends/test_zarr.py::test_sample[single_step-discard_transformed-keep_tuning-return_zarr-discard_warning_stat-sequential_sampling-no_loglike-frequent_writes] [33mSKIPPED[0m[31m [ 10%][0m
tests/backends/test_zarr.py::test_sample[single_step-discard_transformed-keep_tuning-return_zarr-discard_warning_stat-sequential_sampling-no_loglike-sparse_writes] [33mSKIPPED[0m[31m [ 10%][0m
tests/backends/test_zarr.py::test_sample[compound_step-include_transformed-discard_tuning-return_idata-keep_warning_stat-parallel_sampling-compute_loglike-frequent_writes] [32mPASSED[0m[31m [ 10%][0m
tests/backends/test_zarr.py::test_sample[compound_step-include_transformed-discard_tuning-return_idata-keep_warning_stat-parallel_sampling-compute_loglike-sparse_writes] [32mPASSED[0m[31m [ 10%][0m
tests/backends/test_zarr.py::test_sample[compound_step-include_transformed-discard_tuning-return_idata-keep_warning_stat-parallel_sampling-no_loglike-frequent_writes] [32mPASSED[0m[31m [ 10%][0m
tests/backends/test_zarr.py::test_sample[compound_step-include_transformed-discard_tuning-return_idata-keep_warning_stat-parallel_sampling-no_loglike-sparse_writes] [32mPASSED[0m[31m [ 10%][0m
tests/backends/test_zarr.py::test_sample[compound_step-include_transformed-discard_tuning-return_idata-keep_warning_stat-sequential_sampling-compute_loglike-frequent_writes] [32mPASSED[0m[31m [ 10%][0m
tests/backends/test_zarr.py::test_sample[compound_step-include_transformed-discard_tuning-return_idata-keep_warning_stat-sequential_sampling-compute_loglike-sparse_writes] [32mPASSED[0m[31m [ 10%][0m
tests/backends/test_zarr.py::test_sample[compound_step-include_transformed-discard_tuning-return_idata-keep_warning_stat-sequential_sampling-no_loglike-frequent_writes] [32mPASSED[0m[31m [ 10%][0m
tests/backends/test_zarr.py::test_sample[compound_step-include_transformed-discard_tuning-return_idata-keep_warning_stat-sequential_sampling-no_loglike-sparse_writes] [32mPASSED[0m[31m [ 10%][0m
tests/backends/test_zarr.py::test_sample[compound_step-include_transformed-discard_tuning-return_idata-discard_warning_stat-parallel_sampling-compute_loglike-frequent_writes] [32mPASSED[0m[31m [ 10%][0m
tests/backends/test_zarr.py::test_sample[compound_step-include_transformed-discard_tuning-return_idata-discard_warning_stat-parallel_sampling-compute_loglike-sparse_writes] [32mPASSED[0m[31m [ 10%][0m
tests/backends/test_zarr.py::test_sample[compound_step-include_transformed-discard_tuning-return_idata-discard_warning_stat-parallel_sampling-no_loglike-frequent_writes] [32mPASSED[0m[31m [ 10%][0m
tests/backends/test_zarr.py::test_sample[compound_step-include_transformed-discard_tuning-return_idata-discard_warning_stat-parallel_sampling-no_loglike-sparse_writes] [32mPASSED[0m[31m [ 10%][0m
tests/backends/test_zarr.py::test_sample[compound_step-include_transformed-discard_tuning-return_idata-discard_warning_stat-sequential_sampling-compute_loglike-frequent_writes] [32mPASSED[0m[31m [ 10%][0m
tests/backends/test_zarr.py::test_sample[compound_step-include_transformed-discard_tuning-return_idata-discard_warning_stat-sequential_sampling-compute_loglike-sparse_writes] [32mPASSED[0m[31m [ 10%][0m
tests/backends/test_zarr.py::test_sample[compound_step-include_transformed-discard_tuning-return_idata-discard_warning_stat-sequential_sampling-no_loglike-frequent_writes] [32mPASSED[0m[31m [ 10%][0m
tests/backends/test_zarr.py::test_sample[compound_step-include_transformed-discard_tuning-return_idata-discard_warning_stat-sequential_sampling-no_loglike-sparse_writes] [32mPASSED[0m[31m [ 10%][0m
tests/backends/test_zarr.py::test_sample[compound_step-include_transformed-discard_tuning-return_zarr-keep_warning_stat-parallel_sampling-compute_loglike-frequent_writes] [32mPASSED[0m[31m [ 10%][0m
tests/backends/test_zarr.py::test_sample[compound_step-include_transformed-discard_tuning-return_zarr-keep_warning_stat-parallel_sampling-compute_loglike-sparse_writes] [32mPASSED[0m[31m [ 10%][0m
tests/backends/test_zarr.py::test_sample[compound_step-include_transformed-discard_tuning-return_zarr-keep_warning_stat-parallel_sampling-no_loglike-frequent_writes] [33mSKIPPED[0m[31m [ 10%][0m
tests/backends/test_zarr.py::test_sample[compound_step-include_transformed-discard_tuning-return_zarr-keep_warning_stat-parallel_sampling-no_loglike-sparse_writes] [33mSKIPPED[0m[31m [ 10%][0m
tests/backends/test_zarr.py::test_sample[compound_step-include_transformed-discard_tuning-return_zarr-keep_warning_stat-sequential_sampling-compute_loglike-frequent_writes] [32mPASSED[0m[31m [ 10%][0m
tests/backends/test_zarr.py::test_sample[compound_step-include_transformed-discard_tuning-return_zarr-keep_warning_stat-sequential_sampling-compute_loglike-sparse_writes] [32mPASSED[0m[31m [ 10%][0m
tests/backends/test_zarr.py::test_sample[compound_step-include_transformed-discard_tuning-return_zarr-keep_warning_stat-sequential_sampling-no_loglike-frequent_writes] [33mSKIPPED[0m[31m [ 10%][0m
tests/backends/test_zarr.py::test_sample[compound_step-include_transformed-discard_tuning-return_zarr-keep_warning_stat-sequential_sampling-no_loglike-sparse_writes] [33mSKIPPED[0m[31m [ 10%][0m
tests/backends/test_zarr.py::test_sample[compound_step-include_transformed-discard_tuning-return_zarr-discard_warning_stat-parallel_sampling-compute_loglike-frequent_writes] [32mPASSED[0m[31m [ 10%][0m
tests/backends/test_zarr.py::test_sample[compound_step-include_transformed-discard_tuning-return_zarr-discard_warning_stat-parallel_sampling-compute_loglike-sparse_writes] [32mPASSED[0m[31m [ 10%][0m
tests/backends/test_zarr.py::test_sample[compound_step-include_transformed-discard_tuning-return_zarr-discard_warning_stat-parallel_sampling-no_loglike-frequent_writes] [33mSKIPPED[0m[31m [ 11%][0m
tests/backends/test_zarr.py::test_sample[compound_step-include_transformed-discard_tuning-return_zarr-discard_warning_stat-parallel_sampling-no_loglike-sparse_writes] [33mSKIPPED[0m[31m [ 11%][0m
tests/backends/test_zarr.py::test_sample[compound_step-include_transformed-discard_tuning-return_zarr-discard_warning_stat-sequential_sampling-compute_loglike-frequent_writes] [32mPASSED[0m[31m [ 11%][0m
tests/backends/test_zarr.py::test_sample[compound_step-include_transformed-discard_tuning-return_zarr-discard_warning_stat-sequential_sampling-compute_loglike-sparse_writes] [32mPASSED[0m[31m [ 11%][0m
tests/backends/test_zarr.py::test_sample[compound_step-include_transformed-discard_tuning-return_zarr-discard_warning_stat-sequential_sampling-no_loglike-frequent_writes] [33mSKIPPED[0m[31m [ 11%][0m
tests/backends/test_zarr.py::test_sample[compound_step-include_transformed-discard_tuning-return_zarr-discard_warning_stat-sequential_sampling-no_loglike-sparse_writes] [33mSKIPPED[0m[31m [ 11%][0m
tests/backends/test_zarr.py::test_sample[compound_step-include_transformed-keep_tuning-return_idata-keep_warning_stat-parallel_sampling-compute_loglike-frequent_writes] [32mPASSED[0m[31m [ 11%][0m
tests/backends/test_zarr.py::test_sample[compound_step-include_transformed-keep_tuning-return_idata-keep_warning_stat-parallel_sampling-compute_loglike-sparse_writes] [32mPASSED[0m[31m [ 11%][0m
tests/backends/test_zarr.py::test_sample[compound_step-include_transformed-keep_tuning-return_idata-keep_warning_stat-parallel_sampling-no_loglike-frequent_writes] [32mPASSED[0m[31m [ 11%][0m
tests/backends/test_zarr.py::test_sample[compound_step-include_transformed-keep_tuning-return_idata-keep_warning_stat-parallel_sampling-no_loglike-sparse_writes] [32mPASSED[0m[31m [ 11%][0m
tests/backends/test_zarr.py::test_sample[compound_step-include_transformed-keep_tuning-return_idata-keep_warning_stat-sequential_sampling-compute_loglike-frequent_writes] [32mPASSED[0m[31m [ 11%][0m
tests/backends/test_zarr.py::test_sample[compound_step-include_transformed-keep_tuning-return_idata-keep_warning_stat-sequential_sampling-compute_loglike-sparse_writes] [32mPASSED[0m[31m [ 11%][0m
tests/backends/test_zarr.py::test_sample[compound_step-include_transformed-keep_tuning-return_idata-keep_warning_stat-sequential_sampling-no_loglike-frequent_writes] [32mPASSED[0m[31m [ 11%][0m
tests/backends/test_zarr.py::test_sample[compound_step-include_transformed-keep_tuning-return_idata-keep_warning_stat-sequential_sampling-no_loglike-sparse_writes] [32mPASSED[0m[31m [ 11%][0m
tests/backends/test_zarr.py::test_sample[compound_step-include_transformed-keep_tuning-return_idata-discard_warning_stat-parallel_sampling-compute_loglike-frequent_writes] [32mPASSED[0m[31m [ 11%][0m
tests/backends/test_zarr.py::test_sample[compound_step-include_transformed-keep_tuning-return_idata-discard_warning_stat-parallel_sampling-compute_loglike-sparse_writes] [32mPASSED[0m[31m [ 11%][0m
tests/backends/test_zarr.py::test_sample[compound_step-include_transformed-keep_tuning-return_idata-discard_warning_stat-parallel_sampling-no_loglike-frequent_writes] [32mPASSED[0m[31m [ 11%][0m
tests/backends/test_zarr.py::test_sample[compound_step-include_transformed-keep_tuning-return_idata-discard_warning_stat-parallel_sampling-no_loglike-sparse_writes] [32mPASSED[0m[31m [ 11%][0m
tests/backends/test_zarr.py::test_sample[compound_step-include_transformed-keep_tuning-return_idata-discard_warning_stat-sequential_sampling-compute_loglike-frequent_writes] [32mPASSED[0m[31m [ 11%][0m
tests/backends/test_zarr.py::test_sample[compound_step-include_transformed-keep_tuning-return_idata-discard_warning_stat-sequential_sampling-compute_loglike-sparse_writes] [32mPASSED[0m[31m [ 11%][0m
tests/backends/test_zarr.py::test_sample[compound_step-include_transformed-keep_tuning-return_idata-discard_warning_stat-sequential_sampling-no_loglike-frequent_writes] [32mPASSED[0m[31m [ 11%][0m
tests/backends/test_zarr.py::test_sample[compound_step-include_transformed-keep_tuning-return_idata-discard_warning_stat-sequential_sampling-no_loglike-sparse_writes] [32mPASSED[0m[31m [ 11%][0m
tests/backends/test_zarr.py::test_sample[compound_step-include_transformed-keep_tuning-return_zarr-keep_warning_stat-parallel_sampling-compute_loglike-frequent_writes] [32mPASSED[0m[31m [ 11%][0m
tests/backends/test_zarr.py::test_sample[compound_step-include_transformed-keep_tuning-return_zarr-keep_warning_stat-parallel_sampling-compute_loglike-sparse_writes] [32mPASSED[0m[31m [ 11%][0m
tests/backends/test_zarr.py::test_sample[compound_step-include_transformed-keep_tuning-return_zarr-keep_warning_stat-parallel_sampling-no_loglike-frequent_writes] [33mSKIPPED[0m[31m [ 11%][0m
tests/backends/test_zarr.py::test_sample[compound_step-include_transformed-keep_tuning-return_zarr-keep_warning_stat-parallel_sampling-no_loglike-sparse_writes] [33mSKIPPED[0m[31m [ 11%][0m
tests/backends/test_zarr.py::test_sample[compound_step-include_transformed-keep_tuning-return_zarr-keep_warning_stat-sequential_sampling-compute_loglike-frequent_writes] [32mPASSED[0m[31m [ 11%][0m
tests/backends/test_zarr.py::test_sample[compound_step-include_transformed-keep_tuning-return_zarr-keep_warning_stat-sequential_sampling-compute_loglike-sparse_writes] [32mPASSED[0m[31m [ 11%][0m
tests/backends/test_zarr.py::test_sample[compound_step-include_transformed-keep_tuning-return_zarr-keep_warning_stat-sequential_sampling-no_loglike-frequent_writes] [33mSKIPPED[0m[31m [ 11%][0m
tests/backends/test_zarr.py::test_sample[compound_step-include_transformed-keep_tuning-return_zarr-keep_warning_stat-sequential_sampling-no_loglike-sparse_writes] [33mSKIPPED[0m[31m [ 11%][0m
tests/backends/test_zarr.py::test_sample[compound_step-include_transformed-keep_tuning-return_zarr-discard_warning_stat-parallel_sampling-compute_loglike-frequent_writes] [32mPASSED[0m[31m [ 11%][0m
tests/backends/test_zarr.py::test_sample[compound_step-include_transformed-keep_tuning-return_zarr-discard_warning_stat-parallel_sampling-compute_loglike-sparse_writes] [32mPASSED[0m[31m [ 11%][0m
tests/backends/test_zarr.py::test_sample[compound_step-include_transformed-keep_tuning-return_zarr-discard_warning_stat-parallel_sampling-no_loglike-frequent_writes] [33mSKIPPED[0m[31m [ 11%][0m
tests/backends/test_zarr.py::test_sample[compound_step-include_transformed-keep_tuning-return_zarr-discard_warning_stat-parallel_sampling-no_loglike-sparse_writes] [33mSKIPPED[0m[31m [ 11%][0m
tests/backends/test_zarr.py::test_sample[compound_step-include_transformed-keep_tuning-return_zarr-discard_warning_stat-sequential_sampling-compute_loglike-frequent_writes] [32mPASSED[0m[31m [ 11%][0m
tests/backends/test_zarr.py::test_sample[compound_step-include_transformed-keep_tuning-return_zarr-discard_warning_stat-sequential_sampling-compute_loglike-sparse_writes] [32mPASSED[0m[31m [ 11%][0m
tests/backends/test_zarr.py::test_sample[compound_step-include_transformed-keep_tuning-return_zarr-discard_warning_stat-sequential_sampling-no_loglike-frequent_writes] [33mSKIPPED[0m[31m [ 12%][0m
tests/backends/test_zarr.py::test_sample[compound_step-include_transformed-keep_tuning-return_zarr-discard_warning_stat-sequential_sampling-no_loglike-sparse_writes] [33mSKIPPED[0m[31m [ 12%][0m
tests/backends/test_zarr.py::test_sample[compound_step-discard_transformed-discard_tuning-return_idata-keep_warning_stat-parallel_sampling-compute_loglike-frequent_writes] [32mPASSED[0m[31m [ 12%][0m
tests/backends/test_zarr.py::test_sample[compound_step-discard_transformed-discard_tuning-return_idata-keep_warning_stat-parallel_sampling-compute_loglike-sparse_writes] [32mPASSED[0m[31m [ 12%][0m
tests/backends/test_zarr.py::test_sample[compound_step-discard_transformed-discard_tuning-return_idata-keep_warning_stat-parallel_sampling-no_loglike-frequent_writes] [32mPASSED[0m[31m [ 12%][0m
tests/backends/test_zarr.py::test_sample[compound_step-discard_transformed-discard_tuning-return_idata-keep_warning_stat-parallel_sampling-no_loglike-sparse_writes] [32mPASSED[0m[31m [ 12%][0m
tests/backends/test_zarr.py::test_sample[compound_step-discard_transformed-discard_tuning-return_idata-keep_warning_stat-sequential_sampling-compute_loglike-frequent_writes] [32mPASSED[0m[31m [ 12%][0m
tests/backends/test_zarr.py::test_sample[compound_step-discard_transformed-discard_tuning-return_idata-keep_warning_stat-sequential_sampling-compute_loglike-sparse_writes] [32mPASSED[0m[31m [ 12%][0m
tests/backends/test_zarr.py::test_sample[compound_step-discard_transformed-discard_tuning-return_idata-keep_warning_stat-sequential_sampling-no_loglike-frequent_writes] [32mPASSED[0m[31m [ 12%][0m
tests/backends/test_zarr.py::test_sample[compound_step-discard_transformed-discard_tuning-return_idata-keep_warning_stat-sequential_sampling-no_loglike-sparse_writes] [32mPASSED[0m[31m [ 12%][0m
tests/backends/test_zarr.py::test_sample[compound_step-discard_transformed-discard_tuning-return_idata-discard_warning_stat-parallel_sampling-compute_loglike-frequent_writes] [32mPASSED[0m[31m [ 12%][0m
tests/backends/test_zarr.py::test_sample[compound_step-discard_transformed-discard_tuning-return_idata-discard_warning_stat-parallel_sampling-compute_loglike-sparse_writes] [32mPASSED[0m[31m [ 12%][0m
tests/backends/test_zarr.py::test_sample[compound_step-discard_transformed-discard_tuning-return_idata-discard_warning_stat-parallel_sampling-no_loglike-frequent_writes] [32mPASSED[0m[31m [ 12%][0m
tests/backends/test_zarr.py::test_sample[compound_step-discard_transformed-discard_tuning-return_idata-discard_warning_stat-parallel_sampling-no_loglike-sparse_writes] [32mPASSED[0m[31m [ 12%][0m
tests/backends/test_zarr.py::test_sample[compound_step-discard_transformed-discard_tuning-return_idata-discard_warning_stat-sequential_sampling-compute_loglike-frequent_writes] [32mPASSED[0m[31m [ 12%][0m
tests/backends/test_zarr.py::test_sample[compound_step-discard_transformed-discard_tuning-return_idata-discard_warning_stat-sequential_sampling-compute_loglike-sparse_writes] [32mPASSED[0m[31m [ 12%][0m
tests/backends/test_zarr.py::test_sample[compound_step-discard_transformed-discard_tuning-return_idata-discard_warning_stat-sequential_sampling-no_loglike-frequent_writes] [32mPASSED[0m[31m [ 12%][0m
tests/backends/test_zarr.py::test_sample[compound_step-discard_transformed-discard_tuning-return_idata-discard_warning_stat-sequential_sampling-no_loglike-sparse_writes] [32mPASSED[0m[31m [ 12%][0m
tests/backends/test_zarr.py::test_sample[compound_step-discard_transformed-discard_tuning-return_zarr-keep_warning_stat-parallel_sampling-compute_loglike-frequent_writes] [32mPASSED[0m[31m [ 12%][0m
tests/backends/test_zarr.py::test_sample[compound_step-discard_transformed-discard_tuning-return_zarr-keep_warning_stat-parallel_sampling-compute_loglike-sparse_writes] [32mPASSED[0m[31m [ 12%][0m
tests/backends/test_zarr.py::test_sample[compound_step-discard_transformed-discard_tuning-return_zarr-keep_warning_stat-parallel_sampling-no_loglike-frequent_writes] [33mSKIPPED[0m[31m [ 12%][0m
tests/backends/test_zarr.py::test_sample[compound_step-discard_transformed-discard_tuning-return_zarr-keep_warning_stat-parallel_sampling-no_loglike-sparse_writes] [33mSKIPPED[0m[31m [ 12%][0m
tests/backends/test_zarr.py::test_sample[compound_step-discard_transformed-discard_tuning-return_zarr-keep_warning_stat-sequential_sampling-compute_loglike-frequent_writes] [32mPASSED[0m[31m [ 12%][0m
tests/backends/test_zarr.py::test_sample[compound_step-discard_transformed-discard_tuning-return_zarr-keep_warning_stat-sequential_sampling-compute_loglike-sparse_writes] [32mPASSED[0m[31m [ 12%][0m
tests/backends/test_zarr.py::test_sample[compound_step-discard_transformed-discard_tuning-return_zarr-keep_warning_stat-sequential_sampling-no_loglike-frequent_writes] [33mSKIPPED[0m[31m [ 12%][0m
tests/backends/test_zarr.py::test_sample[compound_step-discard_transformed-discard_tuning-return_zarr-keep_warning_stat-sequential_sampling-no_loglike-sparse_writes] [33mSKIPPED[0m[31m [ 12%][0m
tests/backends/test_zarr.py::test_sample[compound_step-discard_transformed-discard_tuning-return_zarr-discard_warning_stat-parallel_sampling-compute_loglike-frequent_writes] [32mPASSED[0m[31m [ 12%][0m
tests/backends/test_zarr.py::test_sample[compound_step-discard_transformed-discard_tuning-return_zarr-discard_warning_stat-parallel_sampling-compute_loglike-sparse_writes] [32mPASSED[0m[31m [ 12%][0m
tests/backends/test_zarr.py::test_sample[compound_step-discard_transformed-discard_tuning-return_zarr-discard_warning_stat-parallel_sampling-no_loglike-frequent_writes] [33mSKIPPED[0m[31m [ 12%][0m
tests/backends/test_zarr.py::test_sample[compound_step-discard_transformed-discard_tuning-return_zarr-discard_warning_stat-parallel_sampling-no_loglike-sparse_writes] [33mSKIPPED[0m[31m [ 12%][0m
tests/backends/test_zarr.py::test_sample[compound_step-discard_transformed-discard_tuning-return_zarr-discard_warning_stat-sequential_sampling-compute_loglike-frequent_writes] [32mPASSED[0m[31m [ 12%][0m
tests/backends/test_zarr.py::test_sample[compound_step-discard_transformed-discard_tuning-return_zarr-discard_warning_stat-sequential_sampling-compute_loglike-sparse_writes] [32mPASSED[0m[31m [ 12%][0m
tests/backends/test_zarr.py::test_sample[compound_step-discard_transformed-discard_tuning-return_zarr-discard_warning_stat-sequential_sampling-no_loglike-frequent_writes] [33mSKIPPED[0m[31m [ 12%][0m
tests/backends/test_zarr.py::test_sample[compound_step-discard_transformed-discard_tuning-return_zarr-discard_warning_stat-sequential_sampling-no_loglike-sparse_writes] [33mSKIPPED[0m[31m [ 12%][0m
tests/backends/test_zarr.py::test_sample[compound_step-discard_transformed-keep_tuning-return_idata-keep_warning_stat-parallel_sampling-compute_loglike-frequent_writes] [32mPASSED[0m[31m [ 12%][0m
tests/backends/test_zarr.py::test_sample[compound_step-discard_transformed-keep_tuning-return_idata-keep_warning_stat-parallel_sampling-compute_loglike-sparse_writes] [32mPASSED[0m[31m [ 12%][0m
tests/backends/test_zarr.py::test_sample[compound_step-discard_transformed-keep_tuning-return_idata-keep_warning_stat-parallel_sampling-no_loglike-frequent_writes] [32mPASSED[0m[31m [ 12%][0m
tests/backends/test_zarr.py::test_sample[compound_step-discard_transformed-keep_tuning-return_idata-keep_warning_stat-parallel_sampling-no_loglike-sparse_writes] [32mPASSED[0m[31m [ 13%][0m
tests/backends/test_zarr.py::test_sample[compound_step-discard_transformed-keep_tuning-return_idata-keep_warning_stat-sequential_sampling-compute_loglike-frequent_writes] [32mPASSED[0m[31m [ 13%][0m
tests/backends/test_zarr.py::test_sample[compound_step-discard_transformed-keep_tuning-return_idata-keep_warning_stat-sequential_sampling-compute_loglike-sparse_writes] [32mPASSED[0m[31m [ 13%][0m
tests/backends/test_zarr.py::test_sample[compound_step-discard_transformed-keep_tuning-return_idata-keep_warning_stat-sequential_sampling-no_loglike-frequent_writes] [32mPASSED[0m[31m [ 13%][0m
tests/backends/test_zarr.py::test_sample[compound_step-discard_transformed-keep_tuning-return_idata-keep_warning_stat-sequential_sampling-no_loglike-sparse_writes] [32mPASSED[0m[31m [ 13%][0m
tests/backends/test_zarr.py::test_sample[compound_step-discard_transformed-keep_tuning-return_idata-discard_warning_stat-parallel_sampling-compute_loglike-frequent_writes] [32mPASSED[0m[31m [ 13%][0m
tests/backends/test_zarr.py::test_sample[compound_step-discard_transformed-keep_tuning-return_idata-discard_warning_stat-parallel_sampling-compute_loglike-sparse_writes] [32mPASSED[0m[31m [ 13%][0m
tests/backends/test_zarr.py::test_sample[compound_step-discard_transformed-keep_tuning-return_idata-discard_warning_stat-parallel_sampling-no_loglike-frequent_writes] [32mPASSED[0m[31m [ 13%][0m
tests/backends/test_zarr.py::test_sample[compound_step-discard_transformed-keep_tuning-return_idata-discard_warning_stat-parallel_sampling-no_loglike-sparse_writes] [32mPASSED[0m[31m [ 13%][0m
tests/backends/test_zarr.py::test_sample[compound_step-discard_transformed-keep_tuning-return_idata-discard_warning_stat-sequential_sampling-compute_loglike-frequent_writes] [32mPASSED[0m[31m [ 13%][0m
tests/backends/test_zarr.py::test_sample[compound_step-discard_transformed-keep_tuning-return_idata-discard_warning_stat-sequential_sampling-compute_loglike-sparse_writes] [32mPASSED[0m[31m [ 13%][0m
tests/backends/test_zarr.py::test_sample[compound_step-discard_transformed-keep_tuning-return_idata-discard_warning_stat-sequential_sampling-no_loglike-frequent_writes] [32mPASSED[0m[31m [ 13%][0m
tests/backends/test_zarr.py::test_sample[compound_step-discard_transformed-keep_tuning-return_idata-discard_warning_stat-sequential_sampling-no_loglike-sparse_writes] [32mPASSED[0m[31m [ 13%][0m
tests/backends/test_zarr.py::test_sample[compound_step-discard_transformed-keep_tuning-return_zarr-keep_warning_stat-parallel_sampling-compute_loglike-frequent_writes] [32mPASSED[0m[31m [ 13%][0m
tests/backends/test_zarr.py::test_sample[compound_step-discard_transformed-keep_tuning-return_zarr-keep_warning_stat-parallel_sampling-compute_loglike-sparse_writes] [32mPASSED[0m[31m [ 13%][0m
tests/backends/test_zarr.py::test_sample[compound_step-discard_transformed-keep_tuning-return_zarr-keep_warning_stat-parallel_sampling-no_loglike-frequent_writes] [33mSKIPPED[0m[31m [ 13%][0m
tests/backends/test_zarr.py::test_sample[compound_step-discard_transformed-keep_tuning-return_zarr-keep_warning_stat-parallel_sampling-no_loglike-sparse_writes] [33mSKIPPED[0m[31m [ 13%][0m
tests/backends/test_zarr.py::test_sample[compound_step-discard_transformed-keep_tuning-return_zarr-keep_warning_stat-sequential_sampling-compute_loglike-frequent_writes] [32mPASSED[0m[31m [ 13%][0m
tests/backends/test_zarr.py::test_sample[compound_step-discard_transformed-keep_tuning-return_zarr-keep_warning_stat-sequential_sampling-compute_loglike-sparse_writes] [32mPASSED[0m[31m [ 13%][0m
tests/backends/test_zarr.py::test_sample[compound_step-discard_transformed-keep_tuning-return_zarr-keep_warning_stat-sequential_sampling-no_loglike-frequent_writes] [33mSKIPPED[0m[31m [ 13%][0m
tests/backends/test_zarr.py::test_sample[compound_step-discard_transformed-keep_tuning-return_zarr-keep_warning_stat-sequential_sampling-no_loglike-sparse_writes] [33mSKIPPED[0m[31m [ 13%][0m
tests/backends/test_zarr.py::test_sample[compound_step-discard_transformed-keep_tuning-return_zarr-discard_warning_stat-parallel_sampling-compute_loglike-frequent_writes] [32mPASSED[0m[31m [ 13%][0m
tests/backends/test_zarr.py::test_sample[compound_step-discard_transformed-keep_tuning-return_zarr-discard_warning_stat-parallel_sampling-compute_loglike-sparse_writes] [32mPASSED[0m[31m [ 13%][0m
tests/backends/test_zarr.py::test_sample[compound_step-discard_transformed-keep_tuning-return_zarr-discard_warning_stat-parallel_sampling-no_loglike-frequent_writes] [33mSKIPPED[0m[31m [ 13%][0m
tests/backends/test_zarr.py::test_sample[compound_step-discard_transformed-keep_tuning-return_zarr-discard_warning_stat-parallel_sampling-no_loglike-sparse_writes] [33mSKIPPED[0m[31m [ 13%][0m
tests/backends/test_zarr.py::test_sample[compound_step-discard_transformed-keep_tuning-return_zarr-discard_warning_stat-sequential_sampling-compute_loglike-frequent_writes] [32mPASSED[0m[31m [ 13%][0m
tests/backends/test_zarr.py::test_sample[compound_step-discard_transformed-keep_tuning-return_zarr-discard_warning_stat-sequential_sampling-compute_loglike-sparse_writes] [32mPASSED[0m[31m [ 13%][0m
tests/backends/test_zarr.py::test_sample[compound_step-discard_transformed-keep_tuning-return_zarr-discard_warning_stat-sequential_sampling-no_loglike-frequent_writes] [33mSKIPPED[0m[31m [ 13%][0m
tests/backends/test_zarr.py::test_sample[compound_step-discard_transformed-keep_tuning-return_zarr-discard_warning_stat-sequential_sampling-no_loglike-sparse_writes] [33mSKIPPED[0m[31m [ 13%][0m
tests/backends/test_zarr.py::test_sampling_consistency[single_step-frequent_writes] [32mPASSED[0m[31m [ 13%][0m
tests/backends/test_zarr.py::test_sampling_consistency[single_step-sparse_writes] [32mPASSED[0m[31m [ 13%][0m
tests/backends/test_zarr.py::test_sampling_consistency[compound_step-frequent_writes] [32mPASSED[0m[31m [ 13%][0m
tests/backends/test_zarr.py::test_sampling_consistency[compound_step-sparse_writes] [32mPASSED[0m[31m [ 13%][0m
tests/dims/distributions/test_core.py::test_distribution_dims [32mPASSED[0m[31m     [ 13%][0m
tests/dims/distributions/test_core.py::test_multivariate_distribution_dims [32mPASSED[0m[31m [ 13%][0m
tests/dims/distributions/test_scalar.py::test_flat [32mPASSED[0m[31m                [ 13%][0m
tests/dims/distributions/test_scalar.py::test_halfflat [32mPASSED[0m[31m            [ 13%][0m
tests/dims/distributions/test_scalar.py::test_normal [32mPASSED[0m[31m              [ 14%][0m
tests/dims/distributions/test_scalar.py::test_halfnormal [32mPASSED[0m[31m          [ 14%][0m
tests/dims/distributions/test_scalar.py::test_lognormal [32mPASSED[0m[31m           [ 14%][0m
tests/dims/distributions/test_scalar.py::test_studentt [32mPASSED[0m[31m            [ 14%][0m
tests/dims/distributions/test_scalar.py::test_halfstudentt [32mPASSED[0m[31m        [ 14%][0m
tests/dims/distributions/test_scalar.py::test_cauchy [32mPASSED[0m[31m              [ 14%][0m
tests/dims/distributions/test_scalar.py::test_halfcauchy [32mPASSED[0m[31m          [ 14%][0m
tests/dims/distributions/test_scalar.py::test_beta [32mPASSED[0m[31m                [ 14%][0m
tests/dims/distributions/test_scalar.py::test_laplace [32mPASSED[0m[31m             [ 14%][0m
tests/dims/distributions/test_scalar.py::test_exponential [32mPASSED[0m[31m         [ 14%][0m
tests/dims/distributions/test_scalar.py::test_gamma [32mPASSED[0m[31m               [ 14%][0m
tests/dims/distributions/test_scalar.py::test_inverse_gamma [32mPASSED[0m[31m       [ 14%][0m
tests/dims/distributions/test_vector.py::test_categorical [32mPASSED[0m[31m         [ 14%][0m
tests/dims/distributions/test_vector.py::test_dirichlet [32mPASSED[0m[31m           [ 14%][0m
tests/dims/distributions/test_vector.py::test_mvnormal [32mPASSED[0m[31m            [ 14%][0m
tests/dims/distributions/test_vector.py::test_zerosumnormal [32mPASSED[0m[31m       [ 14%][0m
tests/dims/test_model.py::test_data [32mPASSED[0m[31m                               [ 14%][0m
tests/dims/test_model.py::test_simple_model [32mPASSED[0m[31m                       [ 14%][0m
tests/dims/test_model.py::test_complex_model [32mPASSED[0m[31m                      [ 14%][0m
tests/dims/test_model.py::test_zerosumnormal_model [32mPASSED[0m[31m                [ 14%][0m
tests/distributions/moments/test_means.py::test_mean_equal_to_scipy[AsymmetricLaplace-scipy_equiv0-dist_params0-scipy_params0] [32mPASSED[0m[31m [ 14%][0m
tests/distributions/moments/test_means.py::test_mean_equal_to_scipy[Bernoulli-scipy_equiv1-dist_params1-scipy_params1] [32mPASSED[0m[31m [ 14%][0m
tests/distributions/moments/test_means.py::test_mean_equal_to_scipy[Beta-scipy_equiv2-dist_params2-scipy_params2] [32mPASSED[0m[31m [ 14%][0m
tests/distributions/moments/test_means.py::test_mean_equal_to_scipy[BetaBinomial-scipy_equiv3-dist_params3-scipy_params3] [32mPASSED[0m[31m [ 14%][0m
tests/distributions/moments/test_means.py::test_mean_equal_to_scipy[Binomial-scipy_equiv4-dist_params4-scipy_params4] [32mPASSED[0m[31m [ 14%][0m
tests/distributions/moments/test_means.py::test_mean_equal_to_scipy[ChiSquared-scipy_equiv5-dist_params5-scipy_params5] [32mPASSED[0m[31m [ 14%][0m
tests/distributions/moments/test_means.py::test_mean_equal_to_scipy[Dirichlet-scipy_equiv6-dist_params6-scipy_params6] [32mPASSED[0m[31m [ 14%][0m
tests/distributions/moments/test_means.py::test_mean_equal_to_scipy[ExGaussian-scipy_equiv7-dist_params7-scipy_params7] [32mPASSED[0m[31m [ 14%][0m
tests/distributions/moments/test_means.py::test_mean_equal_to_scipy[Exponential-scipy_equiv8-dist_params8-scipy_params8] [32mPASSED[0m[31m [ 14%][0m
tests/distributions/moments/test_means.py::test_mean_equal_to_scipy[Gamma-scipy_equiv9-dist_params9-scipy_params9] [32mPASSED[0m[31m [ 14%][0m
tests/distributions/moments/test_means.py::test_mean_equal_to_scipy[Geometric-scipy_equiv10-dist_params10-scipy_params10] [32mPASSED[0m[31m [ 14%][0m
tests/distributions/moments/test_means.py::test_mean_equal_to_scipy[Gumbel-scipy_equiv11-dist_params11-scipy_params11] [32mPASSED[0m[31m [ 14%][0m
tests/distributions/moments/test_means.py::test_mean_equal_to_scipy[HalfNormal-scipy_equiv12-dist_params12-scipy_params12] [32mPASSED[0m[31m [ 14%][0m
tests/distributions/moments/test_means.py::test_mean_equal_to_scipy[HyperGeometric-scipy_equiv13-dist_params13-scipy_params13] [32mPASSED[0m[31m [ 14%][0m
tests/distributions/moments/test_means.py::test_mean_equal_to_scipy[InverseGamma-scipy_equiv14-dist_params14-scipy_params14] [32mPASSED[0m[31m [ 14%][0m
tests/distributions/moments/test_means.py::test_mean_equal_to_scipy[Laplace-scipy_equiv15-dist_params15-scipy_params15] [32mPASSED[0m[31m [ 14%][0m
tests/distributions/moments/test_means.py::test_mean_equal_to_scipy[Logistic-scipy_equiv16-dist_params16-scipy_params16] [32mPASSED[0m[31m [ 14%][0m
tests/distributions/moments/test_means.py::test_mean_equal_to_scipy[LogNormal-scipy_equiv17-dist_params17-scipy_params17] [32mPASSED[0m[31m [ 15%][0m
tests/distributions/moments/test_means.py::test_mean_equal_to_scipy[MatrixNormal-scipy_equiv18-dist_params18-scipy_params18] [32mPASSED[0m[31m [ 15%][0m
tests/distributions/moments/test_means.py::test_mean_equal_to_scipy[Moyal-scipy_equiv19-dist_params19-scipy_params19] [32mPASSED[0m[31m [ 15%][0m
tests/distributions/moments/test_means.py::test_mean_equal_to_scipy[Multinomial-scipy_equiv20-dist_params20-scipy_params20] [32mPASSED[0m[31m [ 15%][0m
tests/distributions/moments/test_means.py::test_mean_equal_to_scipy[MvNormal-scipy_equiv21-dist_params21-scipy_params21] [32mPASSED[0m[31m [ 15%][0m
tests/distributions/moments/test_means.py::test_mean_equal_to_scipy[MvStudentT-scipy_equiv22-dist_params22-scipy_params22] [32mPASSED[0m[31m [ 15%][0m
tests/distributions/moments/test_means.py::test_mean_equal_to_scipy[NegativeBinomial-scipy_equiv23-dist_params23-scipy_params23] [32mPASSED[0m[31m [ 15%][0m
tests/distributions/moments/test_means.py::test_mean_equal_to_scipy[Normal-scipy_equiv24-dist_params24-scipy_params24] [32mPASSED[0m[31m [ 15%][0m
tests/distributions/moments/test_means.py::test_mean_equal_to_scipy[Pareto-scipy_equiv25-dist_params25-scipy_params25] [32mPASSED[0m[31m [ 15%][0m
tests/distributions/moments/test_means.py::test_mean_equal_to_scipy[Poisson-scipy_equiv26-dist_params26-scipy_params26] [32mPASSED[0m[31m [ 15%][0m
tests/distributions/moments/test_means.py::test_mean_equal_to_scipy[Rice-scipy_equiv27-dist_params27-scipy_params27] [33mXFAIL[0m[31m [ 15%][0m
tests/distributions/moments/test_means.py::test_mean_equal_to_scipy[SkewNormal-scipy_equiv28-dist_params28-scipy_params28] [32mPASSED[0m[31m [ 15%][0m
tests/distributions/moments/test_means.py::test_mean_equal_to_scipy[SkewStudentT-scipy_equiv29-dist_params29-scipy_params29] [32mPASSED[0m[31m [ 15%][0m
tests/distributions/moments/test_means.py::test_mean_equal_to_scipy[StudentT-scipy_equiv30-dist_params30-scipy_params30] [32mPASSED[0m[31m [ 15%][0m
tests/distributions/moments/test_means.py::test_mean_equal_to_scipy[Triangular-scipy_equiv31-dist_params31-scipy_params31] [32mPASSED[0m[31m [ 15%][0m
tests/distributions/moments/test_means.py::test_mean_equal_to_scipy[Uniform-scipy_equiv32-dist_params32-scipy_params32] [32mPASSED[0m[31m [ 15%][0m
tests/distributions/moments/test_means.py::test_mean_equal_to_scipy[VonMises-scipy_equiv33-dist_params33-scipy_params33] [32mPASSED[0m[31m [ 15%][0m
tests/distributions/moments/test_means.py::test_mean_equal_to_scipy[Wald-scipy_equiv34-dist_params34-scipy_params34] [32mPASSED[0m[31m [ 15%][0m
tests/distributions/moments/test_means.py::test_mean_equal_to_scipy[Weibull-scipy_equiv35-dist_params35-scipy_params35] [32mPASSED[0m[31m [ 15%][0m
tests/distributions/moments/test_means.py::test_mean_equal_expected[CAR-dist_params0-expected0] [32mPASSED[0m[31m [ 15%][0m
tests/distributions/moments/test_means.py::test_mean_equal_expected[DiracDelta-dist_params1-4.0] [32mPASSED[0m[31m [ 15%][0m
tests/distributions/moments/test_means.py::test_mean_equal_expected[DirichletMultinomial-dist_params2-expected2] [32mPASSED[0m[31m [ 15%][0m
tests/distributions/moments/test_means.py::test_mean_equal_expected[DiscreteUniform-dist_params3-4.0] [32mPASSED[0m[31m [ 15%][0m
tests/distributions/moments/test_means.py::test_mean_equal_expected[HalfStudentT-dist_params4-2.0] [32mPASSED[0m[31m [ 15%][0m
tests/distributions/moments/test_means.py::test_mean_equal_expected[KroneckerNormal-dist_params5-expected5] [32mPASSED[0m[31m [ 15%][0m
tests/distributions/moments/test_means.py::test_mean_equal_expected[Kumaraswamy-dist_params6-0.5] [32mPASSED[0m[31m [ 15%][0m
tests/distributions/moments/test_means.py::test_mean_equal_expected[LKJCholeskyCov-dist_params7-expected7] [32mPASSED[0m[31m [ 15%][0m
tests/distributions/moments/test_means.py::test_mean_equal_expected[LKJCorr-dist_params8-expected8] [32mPASSED[0m[31m [ 15%][0m
tests/distributions/moments/test_means.py::test_mean_equal_expected[Mixture-dist_params9-0.7] [32mPASSED[0m[31m [ 15%][0m
tests/distributions/moments/test_means.py::test_mean_equal_expected[PolyaGamma-dist_params10-0.23105858] [32mPASSED[0m[31m [ 15%][0m
tests/distributions/moments/test_means.py::test_mean_equal_expected[StickBreakingWeights-dist_params11-expected11] [32mPASSED[0m[31m [ 15%][0m
tests/distributions/moments/test_means.py::test_mean_equal_expected[ZeroInflatedBinomial-dist_params12-4.0] [32mPASSED[0m[31m [ 15%][0m
tests/distributions/moments/test_means.py::test_mean_equal_expected[ZeroInflatedNegativeBinomial-dist_params13-8.0] [32mPASSED[0m[31m [ 15%][0m
tests/distributions/moments/test_means.py::test_mean_equal_expected[ZeroInflatedPoisson-dist_params14-4.0] [32mPASSED[0m[31m [ 15%][0m
tests/distributions/moments/test_means.py::test_no_mean[Cauchy-dist_params0] [32mPASSED[0m[31m [ 15%][0m
tests/distributions/moments/test_means.py::test_no_mean[HalfCauchy-dist_params1] [32mPASSED[0m[31m [ 15%][0m
tests/distributions/moments/test_means.py::test_no_mean[LogitNormal-dist_params2] [32mPASSED[0m[31m [ 15%][0m
tests/distributions/moments/test_means.py::test_no_mean[Flat-dist_params3] [32mPASSED[0m[31m [ 16%][0m
tests/distributions/moments/test_means.py::test_no_mean[HalfFlat-dist_params4] [32mPASSED[0m[31m [ 16%][0m
tests/distributions/moments/test_means.py::test_no_mean[Categorical-dist_params5] [32mPASSED[0m[31m [ 16%][0m
tests/distributions/test_censored.py::TestCensored::test_censored_workflow[False] [32mPASSED[0m[31m [ 16%][0m
tests/distributions/test_censored.py::TestCensored::test_censored_workflow[True] [32mPASSED[0m[31m [ 16%][0m
tests/distributions/test_censored.py::TestCensored::test_censored_invalid_dist [32mPASSED[0m[31m [ 16%][0m
tests/distributions/test_censored.py::TestCensored::test_change_dist_size [32mPASSED[0m[31m [ 16%][0m
tests/distributions/test_censored.py::TestCensored::test_dist_broadcasted_by_lower_upper [32mPASSED[0m[31m [ 16%][0m
tests/distributions/test_censored.py::TestCensored::test_censored_categorical [32mPASSED[0m[31m [ 16%][0m
tests/distributions/test_censored.py::TestCensored::test_censored_logcdf_continuous [32mPASSED[0m[31m [ 16%][0m
tests/distributions/test_censored.py::TestCensored::test_censored_logcdf_discrete [32mPASSED[0m[31m [ 16%][0m
tests/distributions/test_continuous.py::TestBoundedContinuous::test_upper_bounded [32mPASSED[0m[31m [ 16%][0m
tests/distributions/test_continuous.py::TestBoundedContinuous::test_lower_bounded [32mPASSED[0m[31m [ 16%][0m
tests/distributions/test_continuous.py::TestBoundedContinuous::test_lower_bounded_vector [32mPASSED[0m[31m [ 16%][0m
tests/distributions/test_continuous.py::TestBoundedContinuous::test_lower_bounded_broadcasted [32mPASSED[0m[31m [ 16%][0m
tests/distributions/test_continuous.py::TestMatchesScipy::test_uniform [32mPASSED[0m[31m [ 16%][0m
tests/distributions/test_continuous.py::TestMatchesScipy::test_triangular [32mPASSED[0m[31m [ 16%][0m
tests/distributions/test_continuous.py::TestMatchesScipy::test_polyagamma [32mPASSED[0m[31m [ 16%][0m
tests/distributions/test_continuous.py::TestMatchesScipy::test_flat [32mPASSED[0m[31m [ 16%][0m
tests/distributions/test_continuous.py::TestMatchesScipy::test_half_flat [32mPASSED[0m[31m [ 16%][0m
tests/distributions/test_continuous.py::TestMatchesScipy::test_normal [32mPASSED[0m[31m [ 16%][0m
tests/distributions/test_continuous.py::TestMatchesScipy::test_half_normal [32mPASSED[0m[31m [ 16%][0m
tests/distributions/test_continuous.py::TestMatchesScipy::test_chisquared_logp [32mPASSED[0m[31m [ 16%][0m
tests/distributions/test_continuous.py::TestMatchesScipy::test_chisquared_logcdf [32mPASSED[0m[31m [ 16%][0m
tests/distributions/test_continuous.py::TestMatchesScipy::test_wald_logp [32mPASSED[0m[31m [ 16%][0m
tests/distributions/test_continuous.py::TestMatchesScipy::test_wald_logcdf [32mPASSED[0m[31m [ 16%][0m
tests/distributions/test_continuous.py::TestMatchesScipy::test_wald_logp_custom_points[0.5-0.001-0.5-None-0.0--124500.7257914_0] [32mPASSED[0m[31m [ 16%][0m
tests/distributions/test_continuous.py::TestMatchesScipy::test_wald_logp_custom_points[1.0-0.5-0.001-None-0.0--4.3733162] [32mPASSED[0m[31m [ 16%][0m
tests/distributions/test_continuous.py::TestMatchesScipy::test_wald_logp_custom_points[2.0-1.0-None-None-0.0--2.2086593] [32mPASSED[0m[31m [ 16%][0m
tests/distributions/test_continuous.py::TestMatchesScipy::test_wald_logp_custom_points[5.0-2.0-2.5-None-0.0--3.43745] [32mPASSED[0m[31m [ 16%][0m
tests/distributions/test_continuous.py::TestMatchesScipy::test_wald_logp_custom_points[7.5-5.0-None-1.0-0.0--3.2199074] [32mPASSED[0m[31m [ 16%][0m
tests/distributions/test_continuous.py::TestMatchesScipy::test_wald_logp_custom_points[15.0-10.0-None-0.75-0.0--4.0360623] [32mPASSED[0m[31m [ 16%][0m
tests/distributions/test_continuous.py::TestMatchesScipy::test_wald_logp_custom_points[50.0-15.0-None-0.66666-0.0--6.1801249] [32mPASSED[0m[31m [ 16%][0m
tests/distributions/test_continuous.py::TestMatchesScipy::test_wald_logp_custom_points[0.5-0.001-0.5-None-0.0--124500.7257914_1] [32mPASSED[0m[31m [ 16%][0m
tests/distributions/test_continuous.py::TestMatchesScipy::test_wald_logp_custom_points[1.0-0.5-0.001-None-0.5--3.3330954] [32mPASSED[0m[31m [ 16%][0m
tests/distributions/test_continuous.py::TestMatchesScipy::test_wald_logp_custom_points[2.0-1.0-None-None-1.0--0.9189385] [32mPASSED[0m[31m [ 16%][0m
tests/distributions/test_continuous.py::TestMatchesScipy::test_wald_logp_custom_points[5.0-2.0-2.5-None-2.0--2.2128783] [32mPASSED[0m[31m [ 16%][0m
tests/distributions/test_continuous.py::TestMatchesScipy::test_wald_logp_custom_points[7.5-5.0-None-1.0-2.5--2.5283764] [32mPASSED[0m[31m [ 17%][0m
tests/distributions/test_continuous.py::TestMatchesScipy::test_wald_logp_custom_points[15.0-10.0-None-0.75-5.0--3.3653647] [32mPASSED[0m[31m [ 17%][0m
tests/distributions/test_continuous.py::TestMatchesScipy::test_wald_logp_custom_points[50.0-15.0-None-0.666666-10.0--5.6481874] [32mPASSED[0m[31m [ 17%][0m
tests/distributions/test_continuous.py::TestMatchesScipy::test_beta_logp [32mPASSED[0m[31m [ 17%][0m
tests/distributions/test_continuous.py::TestMatchesScipy::test_beta_logcdf [32mPASSED[0m[31m [ 17%][0m
tests/distributions/test_continuous.py::TestMatchesScipy::test_beta_icdf [32mPASSED[0m[31m [ 17%][0m
tests/distributions/test_continuous.py::TestMatchesScipy::test_kumaraswamy [32mPASSED[0m[31m [ 17%][0m
tests/distributions/test_continuous.py::TestMatchesScipy::test_exponential [32mPASSED[0m[31m [ 17%][0m
tests/distributions/test_continuous.py::TestMatchesScipy::test_laplace [32mPASSED[0m[31m [ 17%][0m
tests/distributions/test_continuous.py::TestMatchesScipy::test_laplace_asymmetric [32mPASSED[0m[31m [ 17%][0m
tests/distributions/test_continuous.py::TestMatchesScipy::test_lognormal [32mPASSED[0m[31m [ 17%][0m
tests/distributions/test_continuous.py::TestMatchesScipy::test_studentt_logp [32mPASSED[0m[31m [ 17%][0m
tests/distributions/test_continuous.py::TestMatchesScipy::test_skewstudentt_logp [32mPASSED[0m[31m [ 17%][0m
tests/distributions/test_continuous.py::TestMatchesScipy::test_studentt_logcdf [32mPASSED[0m[31m [ 17%][0m
tests/distributions/test_continuous.py::TestMatchesScipy::test_studentt_icdf [32mPASSED[0m[31m [ 17%][0m
tests/distributions/test_continuous.py::TestMatchesScipy::test_halfstudentt_icdf [32mPASSED[0m[31m [ 17%][0m
tests/distributions/test_continuous.py::TestMatchesScipy::test_skewstudentt_logcdf [32mPASSED[0m[31m [ 17%][0m
tests/distributions/test_continuous.py::TestMatchesScipy::test_skewstudentt_icdf [32mPASSED[0m[31m [ 17%][0m
tests/distributions/test_continuous.py::TestMatchesScipy::test_cauchy [32mPASSED[0m[31m [ 17%][0m
tests/distributions/test_continuous.py::TestMatchesScipy::test_half_cauchy [32mPASSED[0m[31m [ 17%][0m
tests/distributions/test_continuous.py::TestMatchesScipy::test_gamma_logp [32mPASSED[0m[31m [ 17%][0m
tests/distributions/test_continuous.py::TestMatchesScipy::test_gamma_logcdf [32mPASSED[0m[31m [ 17%][0m
tests/distributions/test_continuous.py::TestMatchesScipy::test_gamma_icdf [32mPASSED[0m[31m [ 17%][0m
tests/distributions/test_continuous.py::TestMatchesScipy::test_inverse_gamma_logp [32mPASSED[0m[31m [ 17%][0m
tests/distributions/test_continuous.py::TestMatchesScipy::test_inverse_gamma_logcdf [32mPASSED[0m[31m [ 17%][0m
tests/distributions/test_continuous.py::TestMatchesScipy::test_inverse_gamma_icdf [32mPASSED[0m[31m [ 17%][0m
tests/distributions/test_continuous.py::TestMatchesScipy::test_inverse_gamma_alt_params [32mPASSED[0m[31m [ 17%][0m
tests/distributions/test_continuous.py::TestMatchesScipy::test_pareto [32mPASSED[0m[31m [ 17%][0m
tests/distributions/test_continuous.py::TestMatchesScipy::test_weibull_logp [32mPASSED[0m[31m [ 17%][0m
tests/distributions/test_continuous.py::TestMatchesScipy::test_weibull_logcdf [32mPASSED[0m[31m [ 17%][0m
tests/distributions/test_continuous.py::TestMatchesScipy::test_weibull_icdf [32mPASSED[0m[31m [ 17%][0m
tests/distributions/test_continuous.py::TestMatchesScipy::test_half_studentt [32mPASSED[0m[31m [ 17%][0m
tests/distributions/test_continuous.py::TestMatchesScipy::test_skew_normal [32mPASSED[0m[31m [ 17%][0m
tests/distributions/test_continuous.py::TestMatchesScipy::test_ex_gaussian_cdf[0.5--50.0-0.5-0.5-0.0] [32mPASSED[0m[31m [ 17%][0m
tests/distributions/test_continuous.py::TestMatchesScipy::test_ex_gaussian_cdf[1.0--1.0-0.001-0.001-0.0] [32mPASSED[0m[31m [ 17%][0m
tests/distributions/test_continuous.py::TestMatchesScipy::test_ex_gaussian_cdf[2.0-0.001-1.0-1.0--0.2365674] [32mPASSED[0m[31m [ 17%][0m
tests/distributions/test_continuous.py::TestMatchesScipy::test_ex_gaussian_cdf[5.0-0.5-2.5-2.5--0.2886489] [32mPASSED[0m[31m [ 18%][0m
tests/distributions/test_continuous.py::TestMatchesScipy::test_ex_gaussian_cdf[7.5-2.0-5.0-5.0--0.5655104] [32mPASSED[0m[31m [ 18%][0m
tests/distributions/test_continuous.py::TestMatchesScipy::test_ex_gaussian_cdf[15.0-5.0-7.5-7.5--0.4545255] [32mPASSED[0m[31m [ 18%][0m
tests/distributions/test_continuous.py::TestMatchesScipy::test_ex_gaussian_cdf[50.0-50.0-10.0-10.0--1.433714] [32mPASSED[0m[31m [ 18%][0m
tests/distributions/test_continuous.py::TestMatchesScipy::test_ex_gaussian_cdf[1000.0-500.0-10.0-20.0--1.573708e-11] [32mPASSED[0m[31m [ 18%][0m
tests/distributions/test_continuous.py::TestMatchesScipy::test_ex_gaussian_cdf[0.01-0.01-100.0-0.01--0.69314718] [32mPASSED[0m[31m [ 18%][0m
tests/distributions/test_continuous.py::TestMatchesScipy::test_ex_gaussian_cdf[-0.43402407-0.0-0.1-0.1--13.59615423] [32mPASSED[0m[31m [ 18%][0m
tests/distributions/test_continuous.py::TestMatchesScipy::test_ex_gaussian_cdf[-0.72402009-0.0-0.1-0.1--31.26571842] [32mPASSED[0m[31m [ 18%][0m
tests/distributions/test_continuous.py::TestMatchesScipy::test_ex_gaussian_cdf_outside_edges [32mPASSED[0m[31m [ 18%][0m
tests/distributions/test_continuous.py::TestMatchesScipy::test_vonmises [32mPASSED[0m[31m [ 18%][0m
tests/distributions/test_continuous.py::TestMatchesScipy::test_gumbel [32mPASSED[0m[31m [ 18%][0m
tests/distributions/test_continuous.py::TestMatchesScipy::test_logistic [32mPASSED[0m[31m [ 18%][0m
tests/distributions/test_continuous.py::TestMatchesScipy::test_logitnormal [32mPASSED[0m[31m [ 18%][0m
tests/distributions/test_continuous.py::TestMatchesScipy::test_rice [32mPASSED[0m[31m [ 18%][0m
tests/distributions/test_continuous.py::TestMatchesScipy::test_rice_nu [32mPASSED[0m[31m [ 18%][0m
tests/distributions/test_continuous.py::TestMatchesScipy::test_moyal_logp [32mPASSED[0m[31m [ 18%][0m
tests/distributions/test_continuous.py::TestMatchesScipy::test_moyal_logcdf [32mPASSED[0m[31m [ 18%][0m
tests/distributions/test_continuous.py::TestMatchesScipy::test_moyal_icdf [32mPASSED[0m[31m [ 18%][0m
tests/distributions/test_continuous.py::TestMatchesScipy::test_interpolated [32mPASSED[0m[31m [ 18%][0m
tests/distributions/test_continuous.py::TestMatchesScipy::test_interpolated_transform[transform0] [32mPASSED[0m[31m [ 18%][0m
tests/distributions/test_continuous.py::TestMatchesScipy::test_interpolated_transform[None] [32mPASSED[0m[31m [ 18%][0m
tests/distributions/test_continuous.py::TestMatchesScipy::test_truncated_normal [32mPASSED[0m[31m [ 18%][0m
tests/distributions/test_continuous.py::TestMatchesScipy::test_get_tau_sigma [32mPASSED[0m[31m [ 18%][0m
tests/distributions/test_continuous.py::TestMatchesScipy::test_ex_gaussian[0.5--50.0-0.5-0.5--99.8068528] [32mPASSED[0m[31m [ 18%][0m
tests/distributions/test_continuous.py::TestMatchesScipy::test_ex_gaussian[1.0--1.0-0.001-0.001--1992.5922447] [32mPASSED[0m[31m [ 18%][0m
tests/distributions/test_continuous.py::TestMatchesScipy::test_ex_gaussian[2.0-0.001-1.0-1.0--1.6720416] [32mPASSED[0m[31m [ 18%][0m
tests/distributions/test_continuous.py::TestMatchesScipy::test_ex_gaussian[5.0-0.5-2.5-2.5--2.4543644] [32mPASSED[0m[31m [ 18%][0m
tests/distributions/test_continuous.py::TestMatchesScipy::test_ex_gaussian[7.5-2.0-5.0-5.0--2.8259429] [32mPASSED[0m[31m [ 18%][0m
tests/distributions/test_continuous.py::TestMatchesScipy::test_ex_gaussian[15.0-5.0-7.5-7.5--3.3093854] [32mPASSED[0m[31m [ 18%][0m
tests/distributions/test_continuous.py::TestMatchesScipy::test_ex_gaussian[50.0-50.0-10.0-10.0--3.6436067] [32mPASSED[0m[31m [ 18%][0m
tests/distributions/test_continuous.py::TestMatchesScipy::test_ex_gaussian[1000.0-500.0-10.0-20.0--27.8707323] [32mPASSED[0m[31m [ 18%][0m
tests/distributions/test_continuous.py::TestMatchesScipy::test_ex_gaussian[-1.0-1.0-20.0-0.9--3.91967108] [32mPASSED[0m[31m [ 18%][0m
tests/distributions/test_continuous.py::TestMatchesScipy::test_ex_gaussian[0.01-0.01-100.0-0.01--5.5241087] [32mPASSED[0m[31m [ 18%][0m
tests/distributions/test_continuous.py::TestMatchesScipy::test_ex_gaussian[-1.0-0.0-0.1-0.1--51.022349] [32mPASSED[0m[31m [ 18%][0m
tests/distributions/test_continuous.py::TestMoments::test_flat_support_point[None-0] [32mPASSED[0m[31m [ 18%][0m
tests/distributions/test_continuous.py::TestMoments::test_flat_support_point[5-expected1] [32mPASSED[0m[31m [ 18%][0m
tests/distributions/test_continuous.py::TestMoments::test_flat_support_point[size2-expected2] [32mPASSED[0m[31m [ 18%][0m
tests/distributions/test_continuous.py::TestMoments::test_halfflat_support_point[None-1] [32mPASSED[0m[31m [ 19%][0m
tests/distributions/test_continuous.py::TestMoments::test_halfflat_support_point[5-expected1] [32mPASSED[0m[31m [ 19%][0m
tests/distributions/test_continuous.py::TestMoments::test_halfflat_support_point[size2-expected2] [32mPASSED[0m[31m [ 19%][0m
tests/distributions/test_continuous.py::TestMoments::test_uniform_support_point[-1-1-None-0] [32mPASSED[0m[31m [ 19%][0m
tests/distributions/test_continuous.py::TestMoments::test_uniform_support_point[-1-1-5-expected1] [32mPASSED[0m[31m [ 19%][0m
tests/distributions/test_continuous.py::TestMoments::test_uniform_support_point[0-upper2-None-expected2] [32mPASSED[0m[31m [ 19%][0m
tests/distributions/test_continuous.py::TestMoments::test_uniform_support_point[0-upper3-size3-expected3] [32mPASSED[0m[31m [ 19%][0m
tests/distributions/test_continuous.py::TestMoments::test_normal_support_point[0-1-None-0] [32mPASSED[0m[31m [ 19%][0m
tests/distributions/test_continuous.py::TestMoments::test_normal_support_point[0-sigma1-None-expected1] [32mPASSED[0m[31m [ 19%][0m
tests/distributions/test_continuous.py::TestMoments::test_normal_support_point[mu2-1-None-expected2] [32mPASSED[0m[31m [ 19%][0m
tests/distributions/test_continuous.py::TestMoments::test_normal_support_point[mu3-sigma3-size3-expected3] [32mPASSED[0m[31m [ 19%][0m
tests/distributions/test_continuous.py::TestMoments::test_halfnormal_support_point[1-None-1] [32mPASSED[0m[31m [ 19%][0m
tests/distributions/test_continuous.py::TestMoments::test_halfnormal_support_point[1-5-expected1] [32mPASSED[0m[31m [ 19%][0m
tests/distributions/test_continuous.py::TestMoments::test_halfnormal_support_point[sigma2-None-expected2] [32mPASSED[0m[31m [ 19%][0m
tests/distributions/test_continuous.py::TestMoments::test_halfnormal_support_point[sigma3-size3-expected3] [32mPASSED[0m[31m [ 19%][0m
tests/distributions/test_continuous.py::TestMoments::test_halfstudentt_support_point[1-1-None-1] [32mPASSED[0m[31m [ 19%][0m
tests/distributions/test_continuous.py::TestMoments::test_halfstudentt_support_point[1-1-5-expected1] [32mPASSED[0m[31m [ 19%][0m
tests/distributions/test_continuous.py::TestMoments::test_halfstudentt_support_point[1-sigma2-size2-expected2] [32mPASSED[0m[31m [ 19%][0m
tests/distributions/test_continuous.py::TestMoments::test_halfstudentt_support_point[nu3-1-None-expected3] [32mPASSED[0m[31m [ 19%][0m
tests/distributions/test_continuous.py::TestMoments::test_truncatednormal_support_point[0.9-1--5-5-None-0] [32mPASSED[0m[31m [ 19%][0m
tests/distributions/test_continuous.py::TestMoments::test_truncatednormal_support_point[1-sigma1--10-inf-None-expected1] [32mPASSED[0m[31m [ 19%][0m
tests/distributions/test_continuous.py::TestMoments::test_truncatednormal_support_point[mu2-1-None-10-size2-expected2] [32mPASSED[0m[31m [ 19%][0m
tests/distributions/test_continuous.py::TestMoments::test_truncatednormal_support_point[1-1-lower3-10-None-expected3] [32mPASSED[0m[31m [ 19%][0m
tests/distributions/test_continuous.py::TestMoments::test_beta_support_point[1-1-None-0.5] [32mPASSED[0m[31m [ 19%][0m
tests/distributions/test_continuous.py::TestMoments::test_beta_support_point[1-1-5-expected1] [32mPASSED[0m[31m [ 19%][0m
tests/distributions/test_continuous.py::TestMoments::test_beta_support_point[1-beta2-None-expected2] [32mPASSED[0m[31m [ 19%][0m
tests/distributions/test_continuous.py::TestMoments::test_beta_support_point[1-beta3-size3-expected3] [32mPASSED[0m[31m [ 19%][0m
tests/distributions/test_continuous.py::TestMoments::test_exponential_support_point[2-None-0.5] [32mPASSED[0m[31m [ 19%][0m
tests/distributions/test_continuous.py::TestMoments::test_exponential_support_point[2-5-expected1] [32mPASSED[0m[31m [ 19%][0m
tests/distributions/test_continuous.py::TestMoments::test_exponential_support_point[lam2-None-expected2] [32mPASSED[0m[31m [ 19%][0m
tests/distributions/test_continuous.py::TestMoments::test_exponential_support_point[lam3-size3-expected3] [32mPASSED[0m[31m [ 19%][0m
tests/distributions/test_continuous.py::TestMoments::test_laplace_support_point[0-1-None-0] [32mPASSED[0m[31m [ 19%][0m
tests/distributions/test_continuous.py::TestMoments::test_laplace_support_point[0-b1-None-expected1] [32mPASSED[0m[31m [ 19%][0m
tests/distributions/test_continuous.py::TestMoments::test_laplace_support_point[mu2-1-None-expected2] [32mPASSED[0m[31m [ 19%][0m
tests/distributions/test_continuous.py::TestMoments::test_laplace_support_point[mu3-b3-size3-expected3] [32mPASSED[0m[31m [ 19%][0m
tests/distributions/test_continuous.py::TestMoments::test_studentt_support_point[0-1-1-None-0] [32mPASSED[0m[31m [ 19%][0m
tests/distributions/test_continuous.py::TestMoments::test_studentt_support_point[0-nu1-1-None-expected1] [32mPASSED[0m[31m [ 19%][0m
tests/distributions/test_continuous.py::TestMoments::test_studentt_support_point[mu2-10-sigma2-None-expected2] [32mPASSED[0m[31m [ 20%][0m
tests/distributions/test_continuous.py::TestMoments::test_studentt_support_point[mu3-10-sigma3-size3-expected3] [32mPASSED[0m[31m [ 20%][0m
tests/distributions/test_continuous.py::TestMoments::test_skewstudentt_support_point[1-1-0-1-None-0] [32mPASSED[0m[31m [ 20%][0m
tests/distributions/test_continuous.py::TestMoments::test_skewstudentt_support_point[a1-b1-0-1-None-expected1] [32mPASSED[0m[31m [ 20%][0m
tests/distributions/test_continuous.py::TestMoments::test_skewstudentt_support_point[10-10-mu2-sigma2-None-expected2] [32mPASSED[0m[31m [ 20%][0m
tests/distributions/test_continuous.py::TestMoments::test_skewstudentt_support_point[10-10-mu3-sigma3-size3-expected3] [32mPASSED[0m[31m [ 20%][0m
tests/distributions/test_continuous.py::TestMoments::test_cauchy_support_point[0-1-None-0] [32mPASSED[0m[31m [ 20%][0m
tests/distributions/test_continuous.py::TestMoments::test_cauchy_support_point[0-beta1-None-expected1] [32mPASSED[0m[31m [ 20%][0m
tests/distributions/test_continuous.py::TestMoments::test_cauchy_support_point[alpha2-1-None-expected2] [32mPASSED[0m[31m [ 20%][0m
tests/distributions/test_continuous.py::TestMoments::test_cauchy_support_point[alpha3-beta3-size3-expected3] [32mPASSED[0m[31m [ 20%][0m
tests/distributions/test_continuous.py::TestMoments::test_kumaraswamy_support_point[1-1-None-0.5] [32mPASSED[0m[31m [ 20%][0m
tests/distributions/test_continuous.py::TestMoments::test_kumaraswamy_support_point[1-1-5-expected1] [32mPASSED[0m[31m [ 20%][0m
tests/distributions/test_continuous.py::TestMoments::test_kumaraswamy_support_point[1-b2-None-expected2] [32mPASSED[0m[31m [ 20%][0m
tests/distributions/test_continuous.py::TestMoments::test_kumaraswamy_support_point[a3-1-None-expected3] [32mPASSED[0m[31m [ 20%][0m
tests/distributions/test_continuous.py::TestMoments::test_kumaraswamy_support_point[1-b4-size4-expected4] [32mPASSED[0m[31m [ 20%][0m
tests/distributions/test_continuous.py::TestMoments::test_lognormal_support_point[0-1-None-1.6487212707001282] [32mPASSED[0m[31m [ 20%][0m
tests/distributions/test_continuous.py::TestMoments::test_lognormal_support_point[0-1-5-expected1] [32mPASSED[0m[31m [ 20%][0m
tests/distributions/test_continuous.py::TestMoments::test_lognormal_support_point[mu2-1-None-expected2] [32mPASSED[0m[31m [ 20%][0m
tests/distributions/test_continuous.py::TestMoments::test_lognormal_support_point[mu3-sigma3-size3-expected3] [32mPASSED[0m[31m [ 20%][0m
tests/distributions/test_continuous.py::TestMoments::test_halfcauchy_support_point[1-None-1] [32mPASSED[0m[31m [ 20%][0m
tests/distributions/test_continuous.py::TestMoments::test_halfcauchy_support_point[1-5-expected1] [32mPASSED[0m[31m [ 20%][0m
tests/distributions/test_continuous.py::TestMoments::test_halfcauchy_support_point[beta2-None-expected2] [32mPASSED[0m[31m [ 20%][0m
tests/distributions/test_continuous.py::TestMoments::test_halfcauchy_support_point[beta3-size3-expected3] [32mPASSED[0m[31m [ 20%][0m
tests/distributions/test_continuous.py::TestMoments::test_gamma_support_point[1-1-None-1] [32mPASSED[0m[31m [ 20%][0m
tests/distributions/test_continuous.py::TestMoments::test_gamma_support_point[1-1-5-expected1] [32mPASSED[0m[31m [ 20%][0m
tests/distributions/test_continuous.py::TestMoments::test_gamma_support_point[alpha2-1-None-expected2] [32mPASSED[0m[31m [ 20%][0m
tests/distributions/test_continuous.py::TestMoments::test_gamma_support_point[alpha3-beta3-size3-expected3] [32mPASSED[0m[31m [ 20%][0m
tests/distributions/test_continuous.py::TestMoments::test_inverse_gamma_support_point[5-1-None-0.25] [32mPASSED[0m[31m [ 20%][0m
tests/distributions/test_continuous.py::TestMoments::test_inverse_gamma_support_point[0.5-1-None-0.6666666666666666] [32mPASSED[0m[31m [ 20%][0m
tests/distributions/test_continuous.py::TestMoments::test_inverse_gamma_support_point[5-1-5-expected2] [32mPASSED[0m[31m [ 20%][0m
tests/distributions/test_continuous.py::TestMoments::test_inverse_gamma_support_point[alpha3-1-None-expected3] [32mPASSED[0m[31m [ 20%][0m
tests/distributions/test_continuous.py::TestMoments::test_pareto_support_point[2-1-None-1.4142135623730951] [32mPASSED[0m[31m [ 20%][0m
tests/distributions/test_continuous.py::TestMoments::test_pareto_support_point[2-1-5-expected1] [32mPASSED[0m[31m [ 20%][0m
tests/distributions/test_continuous.py::TestMoments::test_pareto_support_point[alpha2-m2-None-expected2] [32mPASSED[0m[31m [ 20%][0m
tests/distributions/test_continuous.py::TestMoments::test_pareto_support_point[alpha3-m3-size3-expected3] [32mPASSED[0m[31m [ 20%][0m
tests/distributions/test_continuous.py::TestMoments::test_vonmises_support_point[0-1-None-0] [32mPASSED[0m[31m [ 20%][0m
tests/distributions/test_continuous.py::TestMoments::test_vonmises_support_point[0-kappa1-None-expected1] [32mPASSED[0m[31m [ 20%][0m
tests/distributions/test_continuous.py::TestMoments::test_vonmises_support_point[mu2-0.5-None-expected2] [32mPASSED[0m[31m [ 21%][0m
tests/distributions/test_continuous.py::TestMoments::test_vonmises_support_point[mu3-kappa3-size3-expected3] [32mPASSED[0m[31m [ 21%][0m
tests/distributions/test_continuous.py::TestMoments::test_wald_support_point[2-None-None-None-2] [32mPASSED[0m[31m [ 21%][0m
tests/distributions/test_continuous.py::TestMoments::test_wald_support_point[None-1-1-5-expected1] [32mPASSED[0m[31m [ 21%][0m
tests/distributions/test_continuous.py::TestMoments::test_wald_support_point[1-None-phi2-None-expected2] [32mPASSED[0m[31m [ 21%][0m
tests/distributions/test_continuous.py::TestMoments::test_wald_support_point[3-lam3-None-None-expected3] [32mPASSED[0m[31m [ 21%][0m
tests/distributions/test_continuous.py::TestMoments::test_wald_support_point[mu4-None-phi4-size4-expected4] [32mPASSED[0m[31m [ 21%][0m
tests/distributions/test_continuous.py::TestMoments::test_weibull_support_point[1-1-None-1] [32mPASSED[0m[31m [ 21%][0m
tests/distributions/test_continuous.py::TestMoments::test_weibull_support_point[1-1-5-expected1] [32mPASSED[0m[31m [ 21%][0m
tests/distributions/test_continuous.py::TestMoments::test_weibull_support_point[alpha2-1-None-expected2] [32mPASSED[0m[31m [ 21%][0m
tests/distributions/test_continuous.py::TestMoments::test_weibull_support_point[alpha3-beta3-size3-expected3] [32mPASSED[0m[31m [ 21%][0m
tests/distributions/test_continuous.py::TestMoments::test_logistic_support_point[1-1-None-1] [32mPASSED[0m[31m [ 21%][0m
tests/distributions/test_continuous.py::TestMoments::test_logistic_support_point[1-1-5-expected1] [32mPASSED[0m[31m [ 21%][0m
tests/distributions/test_continuous.py::TestMoments::test_logistic_support_point[2-s2-None-expected2] [32mPASSED[0m[31m [ 21%][0m
tests/distributions/test_continuous.py::TestMoments::test_logistic_support_point[mu3-s3-size3-expected3] [32mPASSED[0m[31m [ 21%][0m
tests/distributions/test_continuous.py::TestMoments::test_exgaussian_support_point[1-1-1-None-2] [32mPASSED[0m[31m [ 21%][0m
tests/distributions/test_continuous.py::TestMoments::test_exgaussian_support_point[1-1-sigma1-None-expected1] [32mPASSED[0m[31m [ 21%][0m
tests/distributions/test_continuous.py::TestMoments::test_exgaussian_support_point[1-1-3-5-expected2] [32mPASSED[0m[31m [ 21%][0m
tests/distributions/test_continuous.py::TestMoments::test_exgaussian_support_point[1-nu3-5-None-expected3] [32mPASSED[0m[31m [ 21%][0m
tests/distributions/test_continuous.py::TestMoments::test_exgaussian_support_point[1-nu4-1-size4-expected4] [32mPASSED[0m[31m [ 21%][0m
tests/distributions/test_continuous.py::TestMoments::test_gumbel_support_point[0-2-None-1.1544313298030657] [32mPASSED[0m[31m [ 21%][0m
tests/distributions/test_continuous.py::TestMoments::test_gumbel_support_point[1-beta1-None-expected1] [32mPASSED[0m[31m [ 21%][0m
tests/distributions/test_continuous.py::TestMoments::test_gumbel_support_point[mu2-2-None-expected2] [32mPASSED[0m[31m [ 21%][0m
tests/distributions/test_continuous.py::TestMoments::test_gumbel_support_point[1-2-5-expected3] [32mPASSED[0m[31m [ 21%][0m
tests/distributions/test_continuous.py::TestMoments::test_gumbel_support_point[mu4-beta4-size4-expected4] [32mPASSED[0m[31m [ 21%][0m
tests/distributions/test_continuous.py::TestMoments::test_triangular_support_point[1-0-5-None-2] [32mPASSED[0m[31m [ 21%][0m
tests/distributions/test_continuous.py::TestMoments::test_triangular_support_point[3-lower1-upper1-None-expected1] [32mPASSED[0m[31m [ 21%][0m
tests/distributions/test_continuous.py::TestMoments::test_triangular_support_point[c2--3-3-None-expected2] [32mPASSED[0m[31m [ 21%][0m
tests/distributions/test_continuous.py::TestMoments::test_triangular_support_point[3--3-6-5-expected3] [32mPASSED[0m[31m [ 21%][0m
tests/distributions/test_continuous.py::TestMoments::test_triangular_support_point[c4-lower4-upper4-size4-expected4] [32mPASSED[0m[31m [ 21%][0m
tests/distributions/test_continuous.py::TestMoments::test_logitnormal_support_point[1-2-None-0.7310585786300049] [32mPASSED[0m[31m [ 21%][0m
tests/distributions/test_continuous.py::TestMoments::test_logitnormal_support_point[0-sigma1-None-expected1] [32mPASSED[0m[31m [ 21%][0m
tests/distributions/test_continuous.py::TestMoments::test_logitnormal_support_point[mu2-1-None-expected2] [32mPASSED[0m[31m [ 21%][0m
tests/distributions/test_continuous.py::TestMoments::test_logitnormal_support_point[1-5-4-expected3] [32mPASSED[0m[31m [ 21%][0m
tests/distributions/test_continuous.py::TestMoments::test_logitnormal_support_point[mu4-sigma4-size4-expected4] [32mPASSED[0m[31m [ 21%][0m
tests/distributions/test_continuous.py::TestMoments::test_interpolated_support_point[x_points0-pdf_points0-None-0.2] [32mPASSED[0m[31m [ 21%][0m
tests/distributions/test_continuous.py::TestMoments::test_interpolated_support_point[x_points1-pdf_points1-None-9.34782609] [32mPASSED[0m[31m [ 21%][0m
tests/distributions/test_continuous.py::TestMoments::test_interpolated_support_point[x_points2-pdf_points2-size2-expected2] [32mPASSED[0m[31m [ 22%][0m
tests/distributions/test_continuous.py::TestMoments::test_interpolated_support_point[x_points3-pdf_points3-size3-expected3] [32mPASSED[0m[31m [ 22%][0m
tests/distributions/test_continuous.py::TestMoments::test_interpolated_support_point[x_points4-pdf_points4-None-2.5270134] [32mPASSED[0m[31m [ 22%][0m
tests/distributions/test_continuous.py::TestMoments::test_interpolated_support_point[x_points5-pdf_points5-None-2.51771721] [32mPASSED[0m[31m [ 22%][0m
tests/distributions/test_continuous.py::TestMoments::test_moyal_support_point[4.0-3.0-None-7.8110885363844345] [32mPASSED[0m[31m [ 22%][0m
tests/distributions/test_continuous.py::TestMoments::test_moyal_support_point[4.0-sigma1-None-expected1] [32mPASSED[0m[31m [ 22%][0m
tests/distributions/test_continuous.py::TestMoments::test_moyal_support_point[mu2-1-None-expected2] [32mPASSED[0m[31m [ 22%][0m
tests/distributions/test_continuous.py::TestMoments::test_moyal_support_point[mu3-sigma3-size3-expected3] [32mPASSED[0m[31m [ 22%][0m
tests/distributions/test_continuous.py::TestMoments::test_skewnormal_support_point[1.0-1.0-1.0-None-1.56418958] [32mPASSED[0m[31m [ 22%][0m
tests/distributions/test_continuous.py::TestMoments::test_skewnormal_support_point[1.0-mu1-1.0-None-expected1] [32mPASSED[0m[31m [ 22%][0m
tests/distributions/test_continuous.py::TestMoments::test_skewnormal_support_point[alpha2-1-sigma2-None-expected2] [32mPASSED[0m[31m [ 22%][0m
tests/distributions/test_continuous.py::TestMoments::test_skewnormal_support_point[alpha3-mu3-sigma3-None-expected3] [32mPASSED[0m[31m [ 22%][0m
tests/distributions/test_continuous.py::TestMoments::test_skewnormal_support_point[alpha4-mu4-sigma4-size4-expected4] [32mPASSED[0m[31m [ 22%][0m
tests/distributions/test_continuous.py::TestMoments::test_asymmetriclaplace_support_point[1.0-1.0-1.0-None-1.0] [32mPASSED[0m[31m [ 22%][0m
tests/distributions/test_continuous.py::TestMoments::test_asymmetriclaplace_support_point[1.0-kappa1-1.0-None-expected1] [32mPASSED[0m[31m [ 22%][0m
tests/distributions/test_continuous.py::TestMoments::test_asymmetriclaplace_support_point[b2-1.0-mu2-None-expected2] [32mPASSED[0m[31m [ 22%][0m
tests/distributions/test_continuous.py::TestMoments::test_asymmetriclaplace_support_point[b3-kappa3-mu3-None-expected3] [32mPASSED[0m[31m [ 22%][0m
tests/distributions/test_continuous.py::TestMoments::test_asymmetriclaplace_support_point[b4-kappa4-mu4-size4-expected4] [32mPASSED[0m[31m [ 22%][0m
tests/distributions/test_continuous.py::TestMoments::test_rice_support_point[1.0-1.0-None-1.5485724605511453] [32mPASSED[0m[31m [ 22%][0m
tests/distributions/test_continuous.py::TestMoments::test_rice_support_point[1.0-sigma1-None-expected1] [32mPASSED[0m[31m [ 22%][0m
tests/distributions/test_continuous.py::TestMoments::test_rice_support_point[nu2-1.0-None-expected2] [32mPASSED[0m[31m [ 22%][0m
tests/distributions/test_continuous.py::TestMoments::test_rice_support_point[nu3-sigma3-size3-expected3] [32mPASSED[0m[31m [ 22%][0m
tests/distributions/test_continuous.py::TestMoments::test_polyagamma_support_point[1.0-0.0-None-0.25] [32mPASSED[0m[31m [ 22%][0m
tests/distributions/test_continuous.py::TestMoments::test_polyagamma_support_point[1.0-z1-None-expected1] [32mPASSED[0m[31m [ 22%][0m
tests/distributions/test_continuous.py::TestMoments::test_polyagamma_support_point[h2-z2-None-expected2] [32mPASSED[0m[31m [ 22%][0m
tests/distributions/test_continuous.py::TestMoments::test_polyagamma_support_point[h3-z3-size3-expected3] [32mPASSED[0m[31m [ 22%][0m
tests/distributions/test_continuous.py::TestFlat::test_distribution <- pymc/testing.py [32mPASSED[0m[31m [ 22%][0m
tests/distributions/test_continuous.py::TestHalfFlat::test_distribution <- pymc/testing.py [32mPASSED[0m[31m [ 22%][0m
tests/distributions/test_continuous.py::TestPareto::test_distribution <- pymc/testing.py [32mPASSED[0m[31m [ 22%][0m
tests/distributions/test_continuous.py::TestLaplace::test_distribution <- pymc/testing.py [32mPASSED[0m[31m [ 22%][0m
tests/distributions/test_continuous.py::TestAsymmetricLaplace::test_distribution <- pymc/testing.py [32mPASSED[0m[31m [ 22%][0m
tests/distributions/test_continuous.py::TestAsymmetricLaplaceQ::test_distribution <- pymc/testing.py [32mPASSED[0m[31m [ 22%][0m
tests/distributions/test_continuous.py::TestExGaussian::test_distribution <- pymc/testing.py [32mPASSED[0m[31m [ 22%][0m
tests/distributions/test_continuous.py::TestGumbel::test_distribution <- pymc/testing.py [32mPASSED[0m[31m [ 22%][0m
tests/distributions/test_continuous.py::TestStudentT::test_distribution <- pymc/testing.py [32mPASSED[0m[31m [ 22%][0m
tests/distributions/test_continuous.py::TestHalfStudentT::test_distribution <- pymc/testing.py [32mPASSED[0m[31m [ 22%][0m
tests/distributions/test_continuous.py::TestSkewStudentT::test_distribution <- pymc/testing.py [32mPASSED[0m[31m [ 22%][0m
tests/distributions/test_continuous.py::TestMoyal::test_distribution <- pymc/testing.py [32mPASSED[0m[31m [ 23%][0m
tests/distributions/test_continuous.py::TestKumaraswamy::test_distribution <- pymc/testing.py [32mPASSED[0m[31m [ 23%][0m
tests/distributions/test_continuous.py::TestTruncatedNormal::test_distribution <- pymc/testing.py [32mPASSED[0m[31m [ 23%][0m
tests/distributions/test_continuous.py::TestTruncatedNormalTau::test_distribution <- pymc/testing.py [32mPASSED[0m[31m [ 23%][0m
tests/distributions/test_continuous.py::TestTruncatedNormalLowerTau::test_distribution <- pymc/testing.py [32mPASSED[0m[31m [ 23%][0m
tests/distributions/test_continuous.py::TestTruncatedNormalUpperTau::test_distribution <- pymc/testing.py [32mPASSED[0m[31m [ 23%][0m
tests/distributions/test_continuous.py::TestTruncatedNormalUpperArray::test_distribution <- pymc/testing.py [32mPASSED[0m[31m [ 23%][0m
tests/distributions/test_continuous.py::TestWald::test_distribution <- pymc/testing.py [32mPASSED[0m[31m [ 23%][0m
tests/distributions/test_continuous.py::TestWaldMuPhi::test_distribution <- pymc/testing.py [32mPASSED[0m[31m [ 23%][0m
tests/distributions/test_continuous.py::TestSkewNormal::test_distribution <- pymc/testing.py [32mPASSED[0m[31m [ 23%][0m
tests/distributions/test_continuous.py::TestSkewNormalTau::test_distribution <- pymc/testing.py [32mPASSED[0m[31m [ 23%][0m
tests/distributions/test_continuous.py::TestRice::test_distribution <- pymc/testing.py [32mPASSED[0m[31m [ 23%][0m
tests/distributions/test_continuous.py::TestRiceNu::test_distribution <- pymc/testing.py [32mPASSED[0m[31m [ 23%][0m
tests/distributions/test_continuous.py::TestStudentTLam::test_distribution <- pymc/testing.py [32mPASSED[0m[31m [ 23%][0m
tests/distributions/test_continuous.py::TestNormal::test_distribution <- pymc/testing.py [32mPASSED[0m[31m [ 23%][0m
tests/distributions/test_continuous.py::TestLogitNormal::test_distribution <- pymc/testing.py [32mPASSED[0m[31m [ 23%][0m
tests/distributions/test_continuous.py::TestLogitNormalTau::test_distribution <- pymc/testing.py [32mPASSED[0m[31m [ 23%][0m
tests/distributions/test_continuous.py::TestNormalTau::test_distribution <- pymc/testing.py [32mPASSED[0m[31m [ 23%][0m
tests/distributions/test_continuous.py::TestNormalSd::test_distribution <- pymc/testing.py [32mPASSED[0m[31m [ 23%][0m
tests/distributions/test_continuous.py::TestUniform::test_distribution <- pymc/testing.py [32mPASSED[0m[31m [ 23%][0m
tests/distributions/test_continuous.py::TestHalfNormal::test_distribution <- pymc/testing.py [32mPASSED[0m[31m [ 23%][0m
tests/distributions/test_continuous.py::TestHalfNormalTau::test_distribution <- pymc/testing.py [32mPASSED[0m[31m [ 23%][0m
tests/distributions/test_continuous.py::TestHalfNormalSd::test_distribution <- pymc/testing.py [32mPASSED[0m[31m [ 23%][0m
tests/distributions/test_continuous.py::TestBeta::test_distribution <- pymc/testing.py [32mPASSED[0m[31m [ 23%][0m
tests/distributions/test_continuous.py::TestBetaMuSigma::test_distribution <- pymc/testing.py [32mPASSED[0m[31m [ 23%][0m
tests/distributions/test_continuous.py::TestBetaMuNu::test_distribution <- pymc/testing.py [32mPASSED[0m[31m [ 23%][0m
tests/distributions/test_continuous.py::TestExponential::test_distribution <- pymc/testing.py [32mPASSED[0m[31m [ 23%][0m
tests/distributions/test_continuous.py::TestExponentialScale::test_distribution <- pymc/testing.py [32mPASSED[0m[31m [ 23%][0m
tests/distributions/test_continuous.py::TestCauchy::test_distribution <- pymc/testing.py [32mPASSED[0m[31m [ 23%][0m
tests/distributions/test_continuous.py::TestHalfCauchy::test_distribution <- pymc/testing.py [32mPASSED[0m[31m [ 23%][0m
tests/distributions/test_continuous.py::TestGamma::test_distribution <- pymc/testing.py [32mPASSED[0m[31m [ 23%][0m
tests/distributions/test_continuous.py::TestGammaMuSigma::test_distribution <- pymc/testing.py [32mPASSED[0m[31m [ 23%][0m
tests/distributions/test_continuous.py::TestInverseGamma::test_distribution <- pymc/testing.py [32mPASSED[0m[31m [ 23%][0m
tests/distributions/test_continuous.py::TestInverseGammaMuSigma::test_distribution <- pymc/testing.py [32mPASSED[0m[31m [ 23%][0m
tests/distributions/test_continuous.py::TestLogistic::test_distribution <- pymc/testing.py [32mPASSED[0m[31m [ 23%][0m
tests/distributions/test_continuous.py::TestLogNormal::test_distribution <- pymc/testing.py [32mPASSED[0m[31m [ 23%][0m
tests/distributions/test_continuous.py::TestLognormalTau::test_distribution <- pymc/testing.py [32mPASSED[0m[31m [ 24%][0m
tests/distributions/test_continuous.py::TestLognormalSd::test_distribution <- pymc/testing.py [32mPASSED[0m[31m [ 24%][0m
tests/distributions/test_continuous.py::TestTriangular::test_distribution <- pymc/testing.py [32mPASSED[0m[31m [ 24%][0m
tests/distributions/test_continuous.py::TestVonMises::test_distribution <- pymc/testing.py [32mPASSED[0m[31m [ 24%][0m
tests/distributions/test_continuous.py::TestWeibull::test_distribution <- pymc/testing.py [32mPASSED[0m[31m [ 24%][0m
tests/distributions/test_continuous.py::TestWeibull::test_rng_different_shapes [32mPASSED[0m[31m [ 24%][0m
tests/distributions/test_continuous.py::TestPolyaGamma::test_distribution <- pymc/testing.py [32mPASSED[0m[31m [ 24%][0m
tests/distributions/test_continuous.py::TestInterpolated::test_distribution <- pymc/testing.py [32mPASSED[0m[31m [ 24%][0m
tests/distributions/test_custom.py::TestCustomDist::test_custom_dist_with_random[()] [32mPASSED[0m[31m [ 24%][0m
tests/distributions/test_custom.py::TestCustomDist::test_custom_dist_with_random[(3,)] [32mPASSED[0m[31m [ 24%][0m
tests/distributions/test_custom.py::TestCustomDist::test_custom_dist_with_random[(3, 2)] [32mPASSED[0m[31m [ 24%][0m
tests/distributions/test_custom.py::TestCustomDist::test_custom_dist_with_random_invalid_observed [32mPASSED[0m[31m [ 24%][0m
tests/distributions/test_custom.py::TestCustomDist::test_custom_dist_without_random [32mPASSED[0m[31m [ 24%][0m
tests/distributions/test_custom.py::TestCustomDist::test_custom_dist_with_random_multivariate[()] [32mPASSED[0m[31m [ 24%][0m
tests/distributions/test_custom.py::TestCustomDist::test_custom_dist_with_random_multivariate[(3,)] [32mPASSED[0m[31m [ 24%][0m
tests/distributions/test_custom.py::TestCustomDist::test_custom_dist_with_random_multivariate[(3, 2)] [32mPASSED[0m[31m [ 24%][0m
tests/distributions/test_custom.py::TestCustomDist::test_serialize_custom_dist [32mPASSED[0m[31m [ 24%][0m
tests/distributions/test_custom.py::TestCustomDist::test_custom_dist_old_api_error [32mPASSED[0m[31m [ 24%][0m
tests/distributions/test_custom.py::TestCustomDist::test_custom_dist_multivariate_logp[None] [32mPASSED[0m[31m [ 24%][0m
tests/distributions/test_custom.py::TestCustomDist::test_custom_dist_multivariate_logp[()] [32mPASSED[0m[31m [ 24%][0m
tests/distributions/test_custom.py::TestCustomDist::test_custom_dist_multivariate_logp[(2,)] [32mPASSED[0m[31m [ 24%][0m
tests/distributions/test_custom.py::TestCustomDist::test_custom_dist_default_support_point_univariate[None-None-0.0] [32mPASSED[0m[31m [ 24%][0m
tests/distributions/test_custom.py::TestCustomDist::test_custom_dist_default_support_point_univariate[None-5-expected1] [32mPASSED[0m[31m [ 24%][0m
tests/distributions/test_custom.py::TestCustomDist::test_custom_dist_default_support_point_univariate[custom_support_point-size2-5] [32mPASSED[0m[31m [ 24%][0m
tests/distributions/test_custom.py::TestCustomDist::test_custom_dist_default_support_point_univariate[custom_support_point-size3-expected3] [32mPASSED[0m[31m [ 24%][0m
tests/distributions/test_custom.py::TestCustomDist::test_custom_dist_custom_support_point_univariate[()] [32mPASSED[0m[31m [ 24%][0m
tests/distributions/test_custom.py::TestCustomDist::test_custom_dist_custom_support_point_univariate[(2,)] [32mPASSED[0m[31m [ 24%][0m
tests/distributions/test_custom.py::TestCustomDist::test_custom_dist_custom_support_point_univariate[(3, 2)] [32mPASSED[0m[31m [ 24%][0m
tests/distributions/test_custom.py::TestCustomDist::test_custom_dist_custom_support_point_multivariate[()] [32mPASSED[0m[31m [ 24%][0m
tests/distributions/test_custom.py::TestCustomDist::test_custom_dist_custom_support_point_multivariate[(2,)] [32mPASSED[0m[31m [ 24%][0m
tests/distributions/test_custom.py::TestCustomDist::test_custom_dist_custom_support_point_multivariate[(3, 2)] [32mPASSED[0m[31m [ 24%][0m
tests/distributions/test_custom.py::TestCustomDist::test_custom_dist_default_support_point_multivariate[True-size0] [32mPASSED[0m[31m [ 24%][0m
tests/distributions/test_custom.py::TestCustomDist::test_custom_dist_default_support_point_multivariate[True-size1] [32mPASSED[0m[31m [ 24%][0m
tests/distributions/test_custom.py::TestCustomDist::test_custom_dist_default_support_point_multivariate[True-size2] [32mPASSED[0m[31m [ 24%][0m
tests/distributions/test_custom.py::TestCustomDist::test_custom_dist_default_support_point_multivariate[False-size3] [32mPASSED[0m[31m [ 24%][0m
tests/distributions/test_custom.py::TestCustomDist::test_custom_dist_default_support_point_multivariate[False-size4] [32mPASSED[0m[31m [ 24%][0m
tests/distributions/test_custom.py::TestCustomDist::test_dist [32mPASSED[0m[31m     [ 24%][0m
tests/distributions/test_custom.py::TestCustomDist::test_multivariate_insufficient_signature [32mPASSED[0m[31m [ 25%][0m
tests/distributions/test_custom.py::TestCustomSymbolicDist::test_basic [32mPASSED[0m[31m [ 25%][0m
tests/distributions/test_custom.py::TestCustomSymbolicDist::test_custom_dist_default_support_point[dist_params0-None-148.4131591025766-<lambda>] [32mPASSED[0m[31m [ 25%][0m
tests/distributions/test_custom.py::TestCustomSymbolicDist::test_custom_dist_default_support_point[dist_params1-None-expected1-<lambda>] [32mPASSED[0m[31m [ 25%][0m
tests/distributions/test_custom.py::TestCustomSymbolicDist::test_custom_dist_default_support_point[dist_params2-None-4.4816890703380645-<lambda>] [32mPASSED[0m[31m [ 25%][0m
tests/distributions/test_custom.py::TestCustomSymbolicDist::test_custom_dist_default_support_point[dist_params3-size3-expected3-<lambda>] [32mPASSED[0m[31m [ 25%][0m
tests/distributions/test_custom.py::TestCustomSymbolicDist::test_custom_dist_default_support_point[dist_params4-None-12-<lambda>] [32mPASSED[0m[31m [ 25%][0m
tests/distributions/test_custom.py::TestCustomSymbolicDist::test_custom_dist_default_support_point_scan [32mPASSED[0m[31m [ 25%][0m
tests/distributions/test_custom.py::TestCustomSymbolicDist::test_custom_dist_default_support_point_scan_recurring [32mPASSED[0m[31m [ 25%][0m
tests/distributions/test_custom.py::TestCustomSymbolicDist::test_custom_dist_default_support_point_nested[-1-1-None-5] [32mPASSED[0m[31m [ 25%][0m
tests/distributions/test_custom.py::TestCustomSymbolicDist::test_custom_dist_default_support_point_nested[-3--1-None-3] [32mPASSED[0m[31m [ 25%][0m
tests/distributions/test_custom.py::TestCustomSymbolicDist::test_custom_dist_default_support_point_nested[-3-1-size2-expected2] [32mPASSED[0m[31m [ 25%][0m
tests/distributions/test_custom.py::TestCustomSymbolicDist::test_logcdf_inference [32mPASSED[0m[31m [ 25%][0m
tests/distributions/test_custom.py::TestCustomSymbolicDist::test_random_multiple_rngs [32mPASSED[0m[31m [ 25%][0m
tests/distributions/test_custom.py::TestCustomSymbolicDist::test_custom_methods [32mPASSED[0m[31m [ 25%][0m
tests/distributions/test_custom.py::TestCustomSymbolicDist::test_change_size [32mPASSED[0m[31m [ 25%][0m
tests/distributions/test_custom.py::TestCustomSymbolicDist::test_error_model_access [32mPASSED[0m[31m [ 25%][0m
tests/distributions/test_custom.py::TestCustomSymbolicDist::test_api_change_error [32mPASSED[0m[31m [ 25%][0m
tests/distributions/test_custom.py::TestCustomSymbolicDist::test_scan [32mPASSED[0m[31m [ 25%][0m
tests/distributions/test_custom.py::TestCustomSymbolicDist::test_inferred_logp_mixture [32mPASSED[0m[31m [ 25%][0m
tests/distributions/test_custom.py::TestCustomSymbolicDist::test_symbolic_dist [32mPASSED[0m[31m [ 25%][0m
tests/distributions/test_custom.py::TestCustomSymbolicDist::test_nested_custom_dist [32mPASSED[0m[31m [ 25%][0m
tests/distributions/test_custom.py::TestCustomSymbolicDist::test_signature [32mPASSED[0m[31m [ 25%][0m
tests/distributions/test_custom.py::TestCustomSymbolicDist::test_inline_does_not_duplicate_graph [32mPASSED[0m[31m [ 25%][0m
tests/distributions/test_custom.py::TestCustomSymbolicDist::test_chained_custom_dist_bug [32mPASSED[0m[31m [ 25%][0m
tests/distributions/test_custom.py::TestCustomSymbolicDist::test_explicit_rng [32mPASSED[0m[31m [ 25%][0m
tests/distributions/test_discrete.py::TestMatchesScipy::test_discrete_unif [32mPASSED[0m[31m [ 25%][0m
tests/distributions/test_discrete.py::TestMatchesScipy::test_geometric [32mPASSED[0m[31m [ 25%][0m
tests/distributions/test_discrete.py::TestMatchesScipy::test_hypergeometric [32mPASSED[0m[31m [ 25%][0m
tests/distributions/test_discrete.py::TestMatchesScipy::test_negative_binomial [32mPASSED[0m[31m [ 25%][0m
tests/distributions/test_discrete.py::TestMatchesScipy::test_negative_binomial_init_fail[5-None-None-None-Must specify either alpha or n.] [32mPASSED[0m[31m [ 25%][0m
tests/distributions/test_discrete.py::TestMatchesScipy::test_negative_binomial_init_fail[None-0.5-None-None-Must specify either alpha or n.] [32mPASSED[0m[31m [ 25%][0m
tests/distributions/test_discrete.py::TestMatchesScipy::test_negative_binomial_init_fail[None-None-None-None-Must specify either alpha or n.] [32mPASSED[0m[31m [ 25%][0m
tests/distributions/test_discrete.py::TestMatchesScipy::test_negative_binomial_init_fail[5-None-2-2-Can't specify both alpha and n.] [32mPASSED[0m[31m [ 25%][0m
tests/distributions/test_discrete.py::TestMatchesScipy::test_negative_binomial_init_fail[None-0.5-2-2-Can't specify both alpha and n.] [32mPASSED[0m[31m [ 25%][0m
tests/distributions/test_discrete.py::TestMatchesScipy::test_negative_binomial_init_fail[None-None-2-2-Can't specify both alpha and n.] [32mPASSED[0m[31m [ 25%][0m
tests/distributions/test_discrete.py::TestMatchesScipy::test_negative_binomial_init_fail[None-None-2-None-Must specify either mu or p.] [32mPASSED[0m[31m [ 25%][0m
tests/distributions/test_discrete.py::TestMatchesScipy::test_negative_binomial_init_fail[None-None-None-2-Must specify either mu or p.] [32mPASSED[0m[31m [ 26%][0m
tests/distributions/test_discrete.py::TestMatchesScipy::test_negative_binomial_init_fail[5-0.5-2-None-Can't specify both mu and p.] [32mPASSED[0m[31m [ 26%][0m
tests/distributions/test_discrete.py::TestMatchesScipy::test_negative_binomial_init_fail[5-0.5-None-2-Can't specify both mu and p.] [32mPASSED[0m[31m [ 26%][0m
tests/distributions/test_discrete.py::TestMatchesScipy::test_binomial [32mPASSED[0m[31m [ 26%][0m
tests/distributions/test_discrete.py::TestMatchesScipy::test_beta_binomial [32mPASSED[0m[31m [ 26%][0m
tests/distributions/test_discrete.py::TestMatchesScipy::test_bernoulli [32mPASSED[0m[31m [ 26%][0m
tests/distributions/test_discrete.py::TestMatchesScipy::test_bernoulli_wrong_arguments [32mPASSED[0m[31m [ 26%][0m
tests/distributions/test_discrete.py::TestMatchesScipy::test_discrete_weibull [32mPASSED[0m[31m [ 26%][0m
tests/distributions/test_discrete.py::TestMatchesScipy::test_poisson [32mPASSED[0m[31m [ 26%][0m
tests/distributions/test_discrete.py::TestMatchesScipy::test_categorical[2] [32mPASSED[0m[31m [ 26%][0m
tests/distributions/test_discrete.py::TestMatchesScipy::test_categorical[3] [32mPASSED[0m[31m [ 26%][0m
tests/distributions/test_discrete.py::TestMatchesScipy::test_categorical[4] [32mPASSED[0m[31m [ 26%][0m
tests/distributions/test_discrete.py::TestMatchesScipy::test_categorical_logp_batch_dims[logp] [32mPASSED[0m[31m [ 26%][0m
tests/distributions/test_discrete.py::TestMatchesScipy::test_categorical_logp_batch_dims[logcdf] [32mPASSED[0m[31m [ 26%][0m
tests/distributions/test_discrete.py::TestMatchesScipy::test_categorical_bounds [32mPASSED[0m[31m [ 26%][0m
tests/distributions/test_discrete.py::TestMatchesScipy::test_categorical_negative_p[p0] [32mPASSED[0m[31m [ 26%][0m
tests/distributions/test_discrete.py::TestMatchesScipy::test_categorical_negative_p[p1] [32mPASSED[0m[31m [ 26%][0m
tests/distributions/test_discrete.py::TestMatchesScipy::test_categorical_negative_p[p2] [32mPASSED[0m[31m [ 26%][0m
tests/distributions/test_discrete.py::TestMatchesScipy::test_categorical_negative_p[p3] [32mPASSED[0m[31m [ 26%][0m
tests/distributions/test_discrete.py::TestMatchesScipy::test_categorical_p_not_normalized [32mPASSED[0m[31m [ 26%][0m
tests/distributions/test_discrete.py::TestMatchesScipy::test_categorical_negative_p_symbolic [32mPASSED[0m[31m [ 26%][0m
tests/distributions/test_discrete.py::TestMatchesScipy::test_categorical_p_not_normalized_symbolic [32mPASSED[0m[31m [ 26%][0m
tests/distributions/test_discrete.py::TestMatchesScipy::test_orderedlogistic[2] [32mPASSED[0m[31m [ 26%][0m
tests/distributions/test_discrete.py::TestMatchesScipy::test_orderedlogistic[3] [32mPASSED[0m[31m [ 26%][0m
tests/distributions/test_discrete.py::TestMatchesScipy::test_orderedlogistic[4] [32mPASSED[0m[31m [ 26%][0m
tests/distributions/test_discrete.py::TestMatchesScipy::test_orderedprobit[2] [32mPASSED[0m[31m [ 26%][0m
tests/distributions/test_discrete.py::TestMatchesScipy::test_orderedprobit[3] [32mPASSED[0m[31m [ 26%][0m
tests/distributions/test_discrete.py::TestMatchesScipy::test_orderedprobit[4] [32mPASSED[0m[31m [ 26%][0m
tests/distributions/test_discrete.py::test_orderedlogistic_dimensions[()] [32mPASSED[0m[31m [ 26%][0m
tests/distributions/test_discrete.py::test_orderedlogistic_dimensions[(1,)] [32mPASSED[0m[31m [ 26%][0m
tests/distributions/test_discrete.py::test_orderedlogistic_dimensions[(3, 1)] [32mPASSED[0m[31m [ 26%][0m
tests/distributions/test_discrete.py::test_orderedlogistic_dimensions[(3, 2)] [32mPASSED[0m[31m [ 26%][0m
tests/distributions/test_discrete.py::TestMoments::test_bernoulli_support_point[0.3-None-0] [32mPASSED[0m[31m [ 26%][0m
tests/distributions/test_discrete.py::TestMoments::test_bernoulli_support_point[0.9-5-expected1] [32mPASSED[0m[31m [ 26%][0m
tests/distributions/test_discrete.py::TestMoments::test_bernoulli_support_point[p2-None-expected2] [32mPASSED[0m[31m [ 26%][0m
tests/distributions/test_discrete.py::TestMoments::test_bernoulli_support_point[p3-size3-expected3] [32mPASSED[0m[31m [ 26%][0m
tests/distributions/test_discrete.py::TestMoments::test_beta_binomial_support_point[10-1-1-None-5] [32mPASSED[0m[31m [ 26%][0m
tests/distributions/test_discrete.py::TestMoments::test_beta_binomial_support_point[10-1-1-5-expected1] [32mPASSED[0m[31m [ 27%][0m
tests/distributions/test_discrete.py::TestMoments::test_beta_binomial_support_point[10-1-beta2-None-expected2] [32mPASSED[0m[31m [ 27%][0m
tests/distributions/test_discrete.py::TestMoments::test_beta_binomial_support_point[10-1-beta3-size3-expected3] [32mPASSED[0m[31m [ 27%][0m
tests/distributions/test_discrete.py::TestMoments::test_binomial_support_point[7-0.7-None-5] [32mPASSED[0m[31m [ 27%][0m
tests/distributions/test_discrete.py::TestMoments::test_binomial_support_point[7-0.3-5-expected1] [32mPASSED[0m[31m [ 27%][0m
tests/distributions/test_discrete.py::TestMoments::test_binomial_support_point[10-p2-None-expected2] [32mPASSED[0m[31m [ 27%][0m
tests/distributions/test_discrete.py::TestMoments::test_binomial_support_point[10-p3-size3-expected3] [32mPASSED[0m[31m [ 27%][0m
tests/distributions/test_discrete.py::TestMoments::test_poisson_support_point[2.7-None-2] [32mPASSED[0m[31m [ 27%][0m
tests/distributions/test_discrete.py::TestMoments::test_poisson_support_point[2.3-5-expected1] [32mPASSED[0m[31m [ 27%][0m
tests/distributions/test_discrete.py::TestMoments::test_poisson_support_point[mu2-None-expected2] [32mPASSED[0m[31m [ 27%][0m
tests/distributions/test_discrete.py::TestMoments::test_poisson_support_point[mu3-size3-expected3] [32mPASSED[0m[31m [ 27%][0m
tests/distributions/test_discrete.py::TestMoments::test_negative_binomial_support_point[10-0.7-None-4] [32mPASSED[0m[31m [ 27%][0m
tests/distributions/test_discrete.py::TestMoments::test_negative_binomial_support_point[10-0.7-5-expected1] [32mPASSED[0m[31m [ 27%][0m
tests/distributions/test_discrete.py::TestMoments::test_negative_binomial_support_point[n2-p2-None-expected2] [32mPASSED[0m[31m [ 27%][0m
tests/distributions/test_discrete.py::TestMoments::test_negative_binomial_support_point[10-p3-size3-expected3] [32mPASSED[0m[31m [ 27%][0m
tests/distributions/test_discrete.py::TestMoments::test_geometric_support_point[0.5-None-2] [32mPASSED[0m[31m [ 27%][0m
tests/distributions/test_discrete.py::TestMoments::test_geometric_support_point[0.2-5-expected1] [32mPASSED[0m[31m [ 27%][0m
tests/distributions/test_discrete.py::TestMoments::test_geometric_support_point[p2-None-expected2] [32mPASSED[0m[31m [ 27%][0m
tests/distributions/test_discrete.py::TestMoments::test_geometric_support_point[p3-size3-expected3] [32mPASSED[0m[31m [ 27%][0m
tests/distributions/test_discrete.py::TestMoments::test_hyper_geometric_support_point[50-10-20-None-4] [32mPASSED[0m[31m [ 27%][0m
tests/distributions/test_discrete.py::TestMoments::test_hyper_geometric_support_point[50-10-23-5-expected1] [32mPASSED[0m[31m [ 27%][0m
tests/distributions/test_discrete.py::TestMoments::test_hyper_geometric_support_point[50-10-n2-None-expected2] [32mPASSED[0m[31m [ 27%][0m
tests/distributions/test_discrete.py::TestMoments::test_hyper_geometric_support_point[50-10-n3-size3-expected3] [32mPASSED[0m[31m [ 27%][0m
tests/distributions/test_discrete.py::TestMoments::test_discrete_uniform_support_point[1-5-None-3] [32mPASSED[0m[31m [ 27%][0m
tests/distributions/test_discrete.py::TestMoments::test_discrete_uniform_support_point[1-5-5-expected1] [32mPASSED[0m[31m [ 27%][0m
tests/distributions/test_discrete.py::TestMoments::test_discrete_uniform_support_point[1-upper2-None-expected2] [32mPASSED[0m[31m [ 27%][0m
tests/distributions/test_discrete.py::TestMoments::test_discrete_uniform_support_point[1-upper3-size3-expected3] [32mPASSED[0m[31m [ 27%][0m
tests/distributions/test_discrete.py::TestMoments::test_discrete_weibull_support_point[0.5-0.5-None-0] [32mPASSED[0m[31m [ 27%][0m
tests/distributions/test_discrete.py::TestMoments::test_discrete_weibull_support_point[0.6-0.1-5-expected1] [32mPASSED[0m[31m [ 27%][0m
tests/distributions/test_discrete.py::TestMoments::test_discrete_weibull_support_point[q2-0.42-None-expected2] [32mPASSED[0m[31m [ 27%][0m
tests/distributions/test_discrete.py::TestMoments::test_discrete_weibull_support_point[q3-beta3-None-expected3] [32mPASSED[0m[31m [ 27%][0m
tests/distributions/test_discrete.py::TestMoments::test_categorical_support_point[p0-None-2] [32mPASSED[0m[31m [ 27%][0m
tests/distributions/test_discrete.py::TestMoments::test_categorical_support_point[p1-5-expected1] [32mPASSED[0m[31m [ 27%][0m
tests/distributions/test_discrete.py::TestMoments::test_categorical_support_point[p2-None-expected2] [32mPASSED[0m[31m [ 27%][0m
tests/distributions/test_discrete.py::TestMoments::test_categorical_support_point[p3-size3-expected3] [32mPASSED[0m[31m [ 27%][0m
tests/distributions/test_discrete.py::TestDiscreteWeibull::test_distribution <- pymc/testing.py [32mPASSED[0m[31m [ 27%][0m
tests/distributions/test_discrete.py::TestBinomial::test_distribution <- pymc/testing.py [32mPASSED[0m[31m [ 27%][0m
tests/distributions/test_discrete.py::TestLogitBinomial::test_distribution <- pymc/testing.py [32mPASSED[0m[31m [ 28%][0m
tests/distributions/test_discrete.py::TestLogitBinomial::test_binomial_init_fail[5-None-None-Must specify either p or logit_p.] [32mPASSED[0m[31m [ 28%][0m
tests/distributions/test_discrete.py::TestLogitBinomial::test_binomial_init_fail[5-0.5-0.5-Can't specify both p and logit_p.] [32mPASSED[0m[31m [ 28%][0m
tests/distributions/test_discrete.py::TestNegativeBinomial::test_distribution <- pymc/testing.py [32mPASSED[0m[31m [ 28%][0m
tests/distributions/test_discrete.py::TestNegativeBinomialMuSigma::test_distribution <- pymc/testing.py [32mPASSED[0m[31m [ 28%][0m
tests/distributions/test_discrete.py::TestBernoulli::test_distribution <- pymc/testing.py [32mPASSED[0m[31m [ 28%][0m
tests/distributions/test_discrete.py::TestBernoulliLogitP::test_distribution <- pymc/testing.py [32mPASSED[0m[31m [ 28%][0m
tests/distributions/test_discrete.py::TestPoisson::test_distribution <- pymc/testing.py [32mPASSED[0m[31m [ 28%][0m
tests/distributions/test_discrete.py::TestCategorical::test_distribution <- pymc/testing.py [32mPASSED[0m[31m [ 28%][0m
tests/distributions/test_discrete.py::TestLogitCategorical::test_distribution <- pymc/testing.py [32mPASSED[0m[31m [ 28%][0m
tests/distributions/test_discrete.py::TestLogitCategorical::test_categorical_init_fail[None-None-Must specify either p or logit_p.] [32mPASSED[0m[31m [ 28%][0m
tests/distributions/test_discrete.py::TestLogitCategorical::test_categorical_init_fail[0.5-0.5-Can't specify both p and logit_p.] [32mPASSED[0m[31m [ 28%][0m
tests/distributions/test_discrete.py::TestGeometric::test_distribution <- pymc/testing.py [32mPASSED[0m[31m [ 28%][0m
tests/distributions/test_discrete.py::TestHyperGeometric::test_distribution <- pymc/testing.py [32mPASSED[0m[31m [ 28%][0m
tests/distributions/test_discrete.py::TestBetaBinomial::test_distribution <- pymc/testing.py [32mPASSED[0m[31m [ 28%][0m
tests/distributions/test_discrete.py::TestDiscreteUniform::test_distribution <- pymc/testing.py [32mPASSED[0m[31m [ 28%][0m
tests/distributions/test_discrete.py::TestDiscreteUniform::test_implied_degenerate_shape [32mPASSED[0m[31m [ 28%][0m
tests/distributions/test_discrete.py::TestOrderedLogistic::test_expected_categorical [32mPASSED[0m[31m [ 28%][0m
tests/distributions/test_discrete.py::TestOrderedLogistic::test_shape_inputs[0-cutpoints0-expected0] [32mPASSED[0m[31m [ 28%][0m
tests/distributions/test_discrete.py::TestOrderedLogistic::test_shape_inputs[eta1-cutpoints1-expected1] [32mPASSED[0m[31m [ 28%][0m
tests/distributions/test_discrete.py::TestOrderedLogistic::test_shape_inputs[eta2-cutpoints2-expected2] [32mPASSED[0m[31m [ 28%][0m
tests/distributions/test_discrete.py::TestOrderedLogistic::test_shape_inputs[eta3-cutpoints3-expected3] [32mPASSED[0m[31m [ 28%][0m
tests/distributions/test_discrete.py::TestOrderedLogistic::test_shape_inputs[eta4-cutpoints4-expected4] [32mPASSED[0m[31m [ 28%][0m
tests/distributions/test_discrete.py::TestOrderedLogistic::test_shape_inputs[eta5-cutpoints5-expected5] [32mPASSED[0m[31m [ 28%][0m
tests/distributions/test_discrete.py::TestOrderedLogistic::test_compute_p [32mPASSED[0m[31m [ 28%][0m
tests/distributions/test_discrete.py::TestOrderedProbit::test_expected_categorical [32mPASSED[0m[31m [ 28%][0m
tests/distributions/test_discrete.py::TestOrderedProbit::test_shape_inputs[0-cutpoints0-1.0-expected0] [32mPASSED[0m[31m [ 28%][0m
tests/distributions/test_discrete.py::TestOrderedProbit::test_shape_inputs[eta1-cutpoints1-sigma1-expected1] [32mPASSED[0m[31m [ 28%][0m
tests/distributions/test_discrete.py::TestOrderedProbit::test_shape_inputs[eta2-cutpoints2-1.0-expected2] [32mPASSED[0m[31m [ 28%][0m
tests/distributions/test_discrete.py::TestOrderedProbit::test_shape_inputs[eta3-cutpoints3-sigma3-expected3] [32mPASSED[0m[31m [ 28%][0m
tests/distributions/test_discrete.py::TestOrderedProbit::test_shape_inputs[eta4-cutpoints4-sigma4-expected4] [32mPASSED[0m[31m [ 28%][0m
tests/distributions/test_discrete.py::TestOrderedProbit::test_shape_inputs[eta5-cutpoints5-sigma5-expected5] [32mPASSED[0m[31m [ 28%][0m
tests/distributions/test_discrete.py::TestOrderedProbit::test_shape_inputs[eta6-cutpoints6-sigma6-expected6] [32mPASSED[0m[31m [ 28%][0m
tests/distributions/test_discrete.py::TestOrderedProbit::test_compute_p [32mPASSED[0m[31m [ 28%][0m
tests/distributions/test_dist_math.py::test_check_parameters[conditions0-True] [32mPASSED[0m[31m [ 28%][0m
tests/distributions/test_dist_math.py::test_check_parameters[conditions1-True] [32mPASSED[0m[31m [ 28%][0m
tests/distributions/test_dist_math.py::test_check_parameters[conditions2-True] [32mPASSED[0m[31m [ 28%][0m
tests/distributions/test_dist_math.py::test_check_parameters[conditions3-True] [32mPASSED[0m[31m [ 29%][0m
tests/distributions/test_dist_math.py::test_check_parameters[conditions4-True] [32mPASSED[0m[31m [ 29%][0m
tests/distributions/test_dist_math.py::test_check_parameters[conditions5-True] [32mPASSED[0m[31m [ 29%][0m
tests/distributions/test_dist_math.py::test_check_parameters[conditions6-True] [32mPASSED[0m[31m [ 29%][0m
tests/distributions/test_dist_math.py::test_check_parameters[conditions7-False] [32mPASSED[0m[31m [ 29%][0m
tests/distributions/test_dist_math.py::test_check_parameters[conditions8-False] [32mPASSED[0m[31m [ 29%][0m
tests/distributions/test_dist_math.py::test_check_parameters[conditions9-False] [32mPASSED[0m[31m [ 29%][0m
tests/distributions/test_dist_math.py::test_check_parameters[conditions10-False] [32mPASSED[0m[31m [ 29%][0m
tests/distributions/test_dist_math.py::test_check_parameters[conditions11-False] [32mPASSED[0m[31m [ 29%][0m
tests/distributions/test_dist_math.py::test_check_parameters_shape [32mPASSED[0m[31m [ 29%][0m
tests/distributions/test_dist_math.py::test_multinomial_check_parameters [32mPASSED[0m[31m [ 29%][0m
tests/distributions/test_dist_math.py::TestSplineWrapper::test_grad [32mPASSED[0m[31m [ 29%][0m
tests/distributions/test_dist_math.py::TestSplineWrapper::test_hessian [32mPASSED[0m[31m [ 29%][0m
tests/distributions/test_dist_math.py::TestI0e::test_grad [32mPASSED[0m[31m         [ 29%][0m
tests/distributions/test_dist_math.py::test_clipped_beta_rvs[float16] [32mPASSED[0m[31m [ 29%][0m
tests/distributions/test_dist_math.py::test_clipped_beta_rvs[float32] [32mPASSED[0m[31m [ 29%][0m
tests/distributions/test_dist_math.py::test_clipped_beta_rvs[float64] [32mPASSED[0m[31m [ 29%][0m
tests/distributions/test_dist_math.py::test_multigamma [32mPASSED[0m[31m            [ 29%][0m
tests/distributions/test_distribution.py::TestBugfixes::test_issue_3051[1-MvNormal-kwargs0] [32mPASSED[0m[31m [ 29%][0m
tests/distributions/test_distribution.py::TestBugfixes::test_issue_3051[1-MvStudentT-kwargs1] [32mPASSED[0m[31m [ 29%][0m
tests/distributions/test_distribution.py::TestBugfixes::test_issue_3051[2-MvNormal-kwargs0] [32mPASSED[0m[31m [ 29%][0m
tests/distributions/test_distribution.py::TestBugfixes::test_issue_3051[2-MvStudentT-kwargs1] [32mPASSED[0m[31m [ 29%][0m
tests/distributions/test_distribution.py::TestBugfixes::test_issue_3051[4-MvNormal-kwargs0] [32mPASSED[0m[31m [ 29%][0m
tests/distributions/test_distribution.py::TestBugfixes::test_issue_3051[4-MvStudentT-kwargs1] [32mPASSED[0m[31m [ 29%][0m
tests/distributions/test_distribution.py::TestBugfixes::test_issue_4499 [32mPASSED[0m[31m [ 29%][0m
tests/distributions/test_distribution.py::test_all_distributions_have_support_points [32mPASSED[0m[31m [ 29%][0m
tests/distributions/test_distribution.py::TestSymbolicRandomVariable::test_inline [32mPASSED[0m[31m [ 29%][0m
tests/distributions/test_distribution.py::TestSymbolicRandomVariable::test_default_update [32mPASSED[0m[31m [ 29%][0m
tests/distributions/test_distribution.py::TestSymbolicRandomVariable::test_recreate_with_different_rng_inputs [32mPASSED[0m[31m [ 29%][0m
tests/distributions/test_distribution.py::TestSymbolicRandomVariable::test_change_dist_size_none [32mPASSED[0m[31m [ 29%][0m
tests/distributions/test_distribution.py::test_distribution_op_registered [32mPASSED[0m[31m [ 29%][0m
tests/distributions/test_distribution.py::TestDiracDelta::test_logp [32mPASSED[0m[31m [ 29%][0m
tests/distributions/test_distribution.py::TestDiracDelta::TestDiracDelta::test_distribution <- pymc/testing.py [32mPASSED[0m[31m [ 29%][0m
tests/distributions/test_distribution.py::TestDiracDelta::TestDiracDelta::test_dtype[float32] [32mPASSED[0m[31m [ 29%][0m
tests/distributions/test_distribution.py::TestDiracDelta::TestDiracDelta::test_dtype[float64] [32mPASSED[0m[31m [ 29%][0m
tests/distributions/test_distribution.py::TestPartialObservedRV::test_univariate[False] [32mPASSED[0m[31m [ 29%][0m
tests/distributions/test_distribution.py::TestPartialObservedRV::test_univariate[True] [32mPASSED[0m[31m [ 30%][0m
tests/distributions/test_distribution.py::TestPartialObservedRV::test_multivariate_constant_mask_separable[True-False] [32mPASSED[0m[31m [ 30%][0m
tests/distributions/test_distribution.py::TestPartialObservedRV::test_multivariate_constant_mask_separable[True-True] [32mPASSED[0m[31m [ 30%][0m
tests/distributions/test_distribution.py::TestPartialObservedRV::test_multivariate_constant_mask_separable[False-False] [32mPASSED[0m[31m [ 30%][0m
tests/distributions/test_distribution.py::TestPartialObservedRV::test_multivariate_constant_mask_separable[False-True] [32mPASSED[0m[31m [ 30%][0m
tests/distributions/test_distribution.py::TestPartialObservedRV::test_multivariate_constant_mask_unseparable [32mPASSED[0m[31m [ 30%][0m
tests/distributions/test_distribution.py::TestPartialObservedRV::test_multivariate_shared_mask_separable [32mPASSED[0m[31m [ 30%][0m
tests/distributions/test_distribution.py::TestPartialObservedRV::test_multivariate_shared_mask_unseparable[False] [32mPASSED[0m[31m [ 30%][0m
tests/distributions/test_distribution.py::TestPartialObservedRV::test_multivariate_shared_mask_unseparable[True] [32mPASSED[0m[31m [ 30%][0m
tests/distributions/test_distribution.py::TestPartialObservedRV::test_support_point [32mPASSED[0m[31m [ 30%][0m
tests/distributions/test_distribution.py::TestPartialObservedRV::test_wrong_mask [32mPASSED[0m[31m [ 30%][0m
tests/distributions/test_distribution.py::TestPartialObservedRV::test_default_updates [32mPASSED[0m[31m [ 30%][0m
tests/distributions/test_mixture.py::TestMixture::test_single_univariate_component_deterministic_weights[None-component0-weights0] [32mPASSED[0m[31m [ 30%][0m
tests/distributions/test_mixture.py::TestMixture::test_single_univariate_component_deterministic_weights[None-component0-weights1] [32mPASSED[0m[31m [ 30%][0m
tests/distributions/test_mixture.py::TestMixture::test_single_univariate_component_deterministic_weights[None-component1-weights0] [32mPASSED[0m[31m [ 30%][0m
tests/distributions/test_mixture.py::TestMixture::test_single_univariate_component_deterministic_weights[None-component1-weights1] [32mPASSED[0m[31m [ 30%][0m
tests/distributions/test_mixture.py::TestMixture::test_single_univariate_component_deterministic_weights[None-component2-weights0] [32mPASSED[0m[31m [ 30%][0m
tests/distributions/test_mixture.py::TestMixture::test_single_univariate_component_deterministic_weights[None-component2-weights1] [32mPASSED[0m[31m [ 30%][0m
tests/distributions/test_mixture.py::TestMixture::test_single_univariate_component_deterministic_weights[None-component3-weights0] [32mPASSED[0m[31m [ 30%][0m
tests/distributions/test_mixture.py::TestMixture::test_single_univariate_component_deterministic_weights[None-component3-weights1] [32mPASSED[0m[31m [ 30%][0m
tests/distributions/test_mixture.py::TestMixture::test_single_univariate_component_deterministic_weights[size1-component0-weights0] [32mPASSED[0m[31m [ 30%][0m
tests/distributions/test_mixture.py::TestMixture::test_single_univariate_component_deterministic_weights[size1-component0-weights1] [32mPASSED[0m[31m [ 30%][0m
tests/distributions/test_mixture.py::TestMixture::test_single_univariate_component_deterministic_weights[size1-component1-weights0] [32mPASSED[0m[31m [ 30%][0m
tests/distributions/test_mixture.py::TestMixture::test_single_univariate_component_deterministic_weights[size1-component1-weights1] [32mPASSED[0m[31m [ 30%][0m
tests/distributions/test_mixture.py::TestMixture::test_single_univariate_component_deterministic_weights[size1-component2-weights0] [32mPASSED[0m[31m [ 30%][0m
tests/distributions/test_mixture.py::TestMixture::test_single_univariate_component_deterministic_weights[size1-component2-weights1] [32mPASSED[0m[31m [ 30%][0m
tests/distributions/test_mixture.py::TestMixture::test_single_univariate_component_deterministic_weights[size1-component3-weights0] [32mPASSED[0m[31m [ 30%][0m
tests/distributions/test_mixture.py::TestMixture::test_single_univariate_component_deterministic_weights[size1-component3-weights1] [32mPASSED[0m[31m [ 30%][0m
tests/distributions/test_mixture.py::TestMixture::test_single_univariate_component_deterministic_weights[size2-component0-weights0] [32mPASSED[0m[31m [ 30%][0m
tests/distributions/test_mixture.py::TestMixture::test_single_univariate_component_deterministic_weights[size2-component0-weights1] [32mPASSED[0m[31m [ 30%][0m
tests/distributions/test_mixture.py::TestMixture::test_single_univariate_component_deterministic_weights[size2-component1-weights0] [32mPASSED[0m[31m [ 30%][0m
tests/distributions/test_mixture.py::TestMixture::test_single_univariate_component_deterministic_weights[size2-component1-weights1] [32mPASSED[0m[31m [ 30%][0m
tests/distributions/test_mixture.py::TestMixture::test_single_univariate_component_deterministic_weights[size2-component2-weights0] [32mPASSED[0m[31m [ 30%][0m
tests/distributions/test_mixture.py::TestMixture::test_single_univariate_component_deterministic_weights[size2-component2-weights1] [32mPASSED[0m[31m [ 30%][0m
tests/distributions/test_mixture.py::TestMixture::test_single_univariate_component_deterministic_weights[size2-component3-weights0] [32mPASSED[0m[31m [ 30%][0m
tests/distributions/test_mixture.py::TestMixture::test_single_univariate_component_deterministic_weights[size2-component3-weights1] [32mPASSED[0m[31m [ 30%][0m
tests/distributions/test_mixture.py::TestMixture::test_list_univariate_components_deterministic_weights[None-components0-weights0] [32mPASSED[0m[31m [ 30%][0m
tests/distributions/test_mixture.py::TestMixture::test_list_univariate_components_deterministic_weights[None-components0-weights1] [32mPASSED[0m[31m [ 31%][0m
tests/distributions/test_mixture.py::TestMixture::test_list_univariate_components_deterministic_weights[None-components1-weights0] [32mPASSED[0m[31m [ 31%][0m
tests/distributions/test_mixture.py::TestMixture::test_list_univariate_components_deterministic_weights[None-components1-weights1] [32mPASSED[0m[31m [ 31%][0m
tests/distributions/test_mixture.py::TestMixture::test_list_univariate_components_deterministic_weights[None-components2-weights0] [32mPASSED[0m[31m [ 31%][0m
tests/distributions/test_mixture.py::TestMixture::test_list_univariate_components_deterministic_weights[None-components2-weights1] [32mPASSED[0m[31m [ 31%][0m
tests/distributions/test_mixture.py::TestMixture::test_list_univariate_components_deterministic_weights[None-components3-weights0] [32mPASSED[0m[31m [ 31%][0m
tests/distributions/test_mixture.py::TestMixture::test_list_univariate_components_deterministic_weights[None-components3-weights1] [32mPASSED[0m[31m [ 31%][0m
tests/distributions/test_mixture.py::TestMixture::test_list_univariate_components_deterministic_weights[size1-components0-weights0] [32mPASSED[0m[31m [ 31%][0m
tests/distributions/test_mixture.py::TestMixture::test_list_univariate_components_deterministic_weights[size1-components0-weights1] [32mPASSED[0m[31m [ 31%][0m
tests/distributions/test_mixture.py::TestMixture::test_list_univariate_components_deterministic_weights[size1-components1-weights0] [32mPASSED[0m[31m [ 31%][0m
tests/distributions/test_mixture.py::TestMixture::test_list_univariate_components_deterministic_weights[size1-components1-weights1] [32mPASSED[0m[31m [ 31%][0m
tests/distributions/test_mixture.py::TestMixture::test_list_univariate_components_deterministic_weights[size1-components2-weights0] [32mPASSED[0m[31m [ 31%][0m
tests/distributions/test_mixture.py::TestMixture::test_list_univariate_components_deterministic_weights[size1-components2-weights1] [32mPASSED[0m[31m [ 31%][0m
tests/distributions/test_mixture.py::TestMixture::test_list_univariate_components_deterministic_weights[size1-components3-weights0] [32mPASSED[0m[31m [ 31%][0m
tests/distributions/test_mixture.py::TestMixture::test_list_univariate_components_deterministic_weights[size1-components3-weights1] [32mPASSED[0m[31m [ 31%][0m
tests/distributions/test_mixture.py::TestMixture::test_list_univariate_components_deterministic_weights[size2-components0-weights0] [32mPASSED[0m[31m [ 31%][0m
tests/distributions/test_mixture.py::TestMixture::test_list_univariate_components_deterministic_weights[size2-components0-weights1] [32mPASSED[0m[31m [ 31%][0m
tests/distributions/test_mixture.py::TestMixture::test_list_univariate_components_deterministic_weights[size2-components1-weights0] [32mPASSED[0m[31m [ 31%][0m
tests/distributions/test_mixture.py::TestMixture::test_list_univariate_components_deterministic_weights[size2-components1-weights1] [32mPASSED[0m[31m [ 31%][0m
tests/distributions/test_mixture.py::TestMixture::test_list_univariate_components_deterministic_weights[size2-components2-weights0] [32mPASSED[0m[31m [ 31%][0m
tests/distributions/test_mixture.py::TestMixture::test_list_univariate_components_deterministic_weights[size2-components2-weights1] [32mPASSED[0m[31m [ 31%][0m
tests/distributions/test_mixture.py::TestMixture::test_list_univariate_components_deterministic_weights[size2-components3-weights0] [32mPASSED[0m[31m [ 31%][0m
tests/distributions/test_mixture.py::TestMixture::test_list_univariate_components_deterministic_weights[size2-components3-weights1] [32mPASSED[0m[31m [ 31%][0m
tests/distributions/test_mixture.py::TestMixture::test_single_multivariate_component_deterministic_weights[None-component0-weights0] [32mPASSED[0m[31m [ 31%][0m
tests/distributions/test_mixture.py::TestMixture::test_single_multivariate_component_deterministic_weights[None-component0-weights1] [32mPASSED[0m[31m [ 31%][0m
tests/distributions/test_mixture.py::TestMixture::test_single_multivariate_component_deterministic_weights[None-component1-weights0] [32mPASSED[0m[31m [ 31%][0m
tests/distributions/test_mixture.py::TestMixture::test_single_multivariate_component_deterministic_weights[None-component1-weights1] [32mPASSED[0m[31m [ 31%][0m
tests/distributions/test_mixture.py::TestMixture::test_single_multivariate_component_deterministic_weights[size1-component0-weights0] [32mPASSED[0m[31m [ 31%][0m
tests/distributions/test_mixture.py::TestMixture::test_single_multivariate_component_deterministic_weights[size1-component0-weights1] [32mPASSED[0m[31m [ 31%][0m
tests/distributions/test_mixture.py::TestMixture::test_single_multivariate_component_deterministic_weights[size1-component1-weights0] [32mPASSED[0m[31m [ 31%][0m
tests/distributions/test_mixture.py::TestMixture::test_single_multivariate_component_deterministic_weights[size1-component1-weights1] [32mPASSED[0m[31m [ 31%][0m
tests/distributions/test_mixture.py::TestMixture::test_single_multivariate_component_deterministic_weights[size2-component0-weights0] [32mPASSED[0m[31m [ 31%][0m
tests/distributions/test_mixture.py::TestMixture::test_single_multivariate_component_deterministic_weights[size2-component0-weights1] [32mPASSED[0m[31m [ 31%][0m
tests/distributions/test_mixture.py::TestMixture::test_single_multivariate_component_deterministic_weights[size2-component1-weights0] [32mPASSED[0m[31m [ 31%][0m
tests/distributions/test_mixture.py::TestMixture::test_single_multivariate_component_deterministic_weights[size2-component1-weights1] [32mPASSED[0m[31m [ 31%][0m
tests/distributions/test_mixture.py::TestMixture::test_list_multivariate_components_deterministic_weights[None-components0-weights0] [32mPASSED[0m[31m [ 31%][0m
tests/distributions/test_mixture.py::TestMixture::test_list_multivariate_components_deterministic_weights[None-components0-weights1] [32mPASSED[0m[31m [ 31%][0m
tests/distributions/test_mixture.py::TestMixture::test_list_multivariate_components_deterministic_weights[None-components1-weights0] [32mPASSED[0m[31m [ 32%][0m
tests/distributions/test_mixture.py::TestMixture::test_list_multivariate_components_deterministic_weights[None-components1-weights1] [32mPASSED[0m[31m [ 32%][0m
tests/distributions/test_mixture.py::TestMixture::test_list_multivariate_components_deterministic_weights[size1-components0-weights0] [32mPASSED[0m[31m [ 32%][0m
tests/distributions/test_mixture.py::TestMixture::test_list_multivariate_components_deterministic_weights[size1-components0-weights1] [32mPASSED[0m[31m [ 32%][0m
tests/distributions/test_mixture.py::TestMixture::test_list_multivariate_components_deterministic_weights[size1-components1-weights0] [32mPASSED[0m[31m [ 32%][0m
tests/distributions/test_mixture.py::TestMixture::test_list_multivariate_components_deterministic_weights[size1-components1-weights1] [32mPASSED[0m[31m [ 32%][0m
tests/distributions/test_mixture.py::TestMixture::test_list_multivariate_components_deterministic_weights[size2-components0-weights0] [32mPASSED[0m[31m [ 32%][0m
tests/distributions/test_mixture.py::TestMixture::test_list_multivariate_components_deterministic_weights[size2-components0-weights1] [32mPASSED[0m[31m [ 32%][0m
tests/distributions/test_mixture.py::TestMixture::test_list_multivariate_components_deterministic_weights[size2-components1-weights0] [32mPASSED[0m[31m [ 32%][0m
tests/distributions/test_mixture.py::TestMixture::test_list_multivariate_components_deterministic_weights[size2-components1-weights1] [32mPASSED[0m[31m [ 32%][0m
tests/distributions/test_mixture.py::TestMixture::test_component_choice_random [32mPASSED[0m[31m [ 32%][0m
tests/distributions/test_mixture.py::TestMixture::test_components_expanded_by_weights[comp_dists0] [32mPASSED[0m[31m [ 32%][0m
tests/distributions/test_mixture.py::TestMixture::test_components_expanded_by_weights[comp_dists1] [32mPASSED[0m[31m [ 32%][0m
tests/distributions/test_mixture.py::TestMixture::test_components_expanded_by_weights[comp_dists2] [32mPASSED[0m[31m [ 32%][0m
tests/distributions/test_mixture.py::TestMixture::test_components_expanded_by_weights[comp_dists3] [32mPASSED[0m[31m [ 32%][0m
tests/distributions/test_mixture.py::TestMixture::test_change_dist_size[False-comp_dists0] [32mPASSED[0m[31m [ 32%][0m
tests/distributions/test_mixture.py::TestMixture::test_change_dist_size[False-comp_dists1] [32mPASSED[0m[31m [ 32%][0m
tests/distributions/test_mixture.py::TestMixture::test_change_dist_size[False-comp_dists2] [32mPASSED[0m[31m [ 32%][0m
tests/distributions/test_mixture.py::TestMixture::test_change_dist_size[False-comp_dists3] [32mPASSED[0m[31m [ 32%][0m
tests/distributions/test_mixture.py::TestMixture::test_change_dist_size[True-comp_dists0] [32mPASSED[0m[31m [ 32%][0m
tests/distributions/test_mixture.py::TestMixture::test_change_dist_size[True-comp_dists1] [32mPASSED[0m[31m [ 32%][0m
tests/distributions/test_mixture.py::TestMixture::test_change_dist_size[True-comp_dists2] [32mPASSED[0m[31m [ 32%][0m
tests/distributions/test_mixture.py::TestMixture::test_change_dist_size[True-comp_dists3] [32mPASSED[0m[31m [ 32%][0m
tests/distributions/test_mixture.py::TestMixture::test_list_mvnormals_logp [32mPASSED[0m[31m [ 32%][0m
tests/distributions/test_mixture.py::TestMixture::test_single_poisson_sampling [32mPASSED[0m[31m [ 32%][0m
tests/distributions/test_mixture.py::TestMixture::test_list_poissons_sampling [32mPASSED[0m[31m [ 32%][0m
tests/distributions/test_mixture.py::TestMixture::test_list_normals_sampling [32mPASSED[0m[31m [ 32%][0m
tests/distributions/test_mixture.py::TestMixture::test_single_poisson_predictive_sampling_shape [32mPASSED[0m[31m [ 32%][0m
tests/distributions/test_mixture.py::TestMixture::test_list_mvnormals_predictive_sampling_shape [32mPASSED[0m[31m [ 32%][0m
tests/distributions/test_mixture.py::TestMixture::test_nested_mixture [32mPASSED[0m[31m [ 32%][0m
tests/distributions/test_mixture.py::TestMixture::test_iterable_single_component_warning [32mPASSED[0m[31m [ 32%][0m
tests/distributions/test_mixture.py::TestMixture::test_mixture_dtype[float32] [32mPASSED[0m[31m [ 32%][0m
tests/distributions/test_mixture.py::TestMixture::test_mixture_dtype[float64] [32mPASSED[0m[31m [ 32%][0m
tests/distributions/test_mixture.py::TestMixture::test_broadcast_components[comp_dists0-expected_shape0] [32mPASSED[0m[31m [ 32%][0m
tests/distributions/test_mixture.py::TestMixture::test_broadcast_components[comp_dists1-expected_shape1] [32mPASSED[0m[31m [ 32%][0m
tests/distributions/test_mixture.py::TestMixture::test_preventing_mixing_cont_and_discrete [32mPASSED[0m[31m [ 32%][0m
tests/distributions/test_mixture.py::TestNormalMixture::test_normal_mixture_sampling [32mPASSED[0m[31m [ 32%][0m
tests/distributions/test_mixture.py::TestNormalMixture::test_normal_mixture_nd[()-5] [32mPASSED[0m[31m [ 33%][0m
tests/distributions/test_mixture.py::TestNormalMixture::test_normal_mixture_nd[1-5] [32mPASSED[0m[31m [ 33%][0m
tests/distributions/test_mixture.py::TestNormalMixture::test_normal_mixture_nd[3-5] [32mPASSED[0m[31m [ 33%][0m
tests/distributions/test_mixture.py::TestNormalMixture::test_normal_mixture_nd[(3, 3)-5] [32mPASSED[0m[31m [ 33%][0m
tests/distributions/test_mixture.py::TestNormalMixture::test_normal_mixture_nd[3-3] [32mPASSED[0m[31m [ 33%][0m
tests/distributions/test_mixture.py::TestNormalMixture::test_normal_mixture_nd[(3, 3)-3] [32mPASSED[0m[31m [ 33%][0m
tests/distributions/test_mixture.py::TestNormalMixture::test_random [32mPASSED[0m[31m [ 33%][0m
tests/distributions/test_mixture.py::TestMixtureVsLatent::test_scalar_components [32mPASSED[0m[31m [ 33%][0m
tests/distributions/test_mixture.py::TestMixtureVsLatent::test_vector_components [32mPASSED[0m[31m [ 33%][0m
tests/distributions/test_mixture.py::TestMixtureSameFamily::test_with_multinomial[(3, 4)] [31mFAILED[0m[31m [ 33%][0m
tests/distributions/test_mixture.py::TestMixtureSameFamily::test_with_multinomial[(20,)] [31mFAILED[0m[31m [ 33%][0m
tests/distributions/test_mixture.py::TestMixtureSameFamily::test_with_mvnormal [32mPASSED[0m[31m [ 33%][0m
tests/distributions/test_mixture.py::TestMixtureSameFamily::test_broadcasting_in_shape [32mPASSED[0m[31m [ 33%][0m
tests/distributions/test_mixture.py::TestMixtureMoments::test_single_univariate_component[weights0-comp_dists0-None-2.8] [32mPASSED[0m[31m [ 33%][0m
tests/distributions/test_mixture.py::TestMixtureMoments::test_single_univariate_component[weights1-comp_dists1-size1-expected1] [32mPASSED[0m[31m [ 33%][0m
tests/distributions/test_mixture.py::TestMixtureMoments::test_single_univariate_component[weights2-comp_dists2-size2-expected2] [32mPASSED[0m[31m [ 33%][0m
tests/distributions/test_mixture.py::TestMixtureMoments::test_single_univariate_component[weights3-comp_dists3-None-expected3] [32mPASSED[0m[31m [ 33%][0m
tests/distributions/test_mixture.py::TestMixtureMoments::test_single_univariate_component[weights4-comp_dists4-None-expected4] [32mPASSED[0m[31m [ 33%][0m
tests/distributions/test_mixture.py::TestMixtureMoments::test_single_univariate_component[weights5-comp_dists5-None-expected5] [32mPASSED[0m[31m [ 33%][0m
tests/distributions/test_mixture.py::TestMixtureMoments::test_single_univariate_component[weights6-comp_dists6-size6-expected6] [32mPASSED[0m[31m [ 33%][0m
tests/distributions/test_mixture.py::TestMixtureMoments::test_list_univariate_components[weights0-comp_dists0-None--2] [32mPASSED[0m[31m [ 33%][0m
tests/distributions/test_mixture.py::TestMixtureMoments::test_list_univariate_components[weights1-comp_dists1-None-expected1] [32mPASSED[0m[31m [ 33%][0m
tests/distributions/test_mixture.py::TestMixtureMoments::test_list_univariate_components[weights2-comp_dists2-size2-expected2] [32mPASSED[0m[31m [ 33%][0m
tests/distributions/test_mixture.py::TestMixtureMoments::test_list_univariate_components[weights3-comp_dists3-None-expected3] [32mPASSED[0m[31m [ 33%][0m
tests/distributions/test_mixture.py::TestMixtureMoments::test_list_univariate_components[weights4-comp_dists4-None-expected4] [32mPASSED[0m[31m [ 33%][0m
tests/distributions/test_mixture.py::TestMixtureMoments::test_list_univariate_components[weights5-comp_dists5-size5-expected5] [32mPASSED[0m[31m [ 33%][0m
tests/distributions/test_mixture.py::TestMixtureMoments::test_list_univariate_components[weights6-comp_dists6-size6-expected6] [32mPASSED[0m[31m [ 33%][0m
tests/distributions/test_mixture.py::TestMixtureMoments::test_single_multivariate_component[weights0-comp_dists0-None-expected0] [32mPASSED[0m[31m [ 33%][0m
tests/distributions/test_mixture.py::TestMixtureMoments::test_single_multivariate_component[weights1-comp_dists1-size1-expected1] [32mPASSED[0m[31m [ 33%][0m
tests/distributions/test_mixture.py::TestMixtureMoments::test_single_multivariate_component[weights2-comp_dists2-None-expected2] [32mPASSED[0m[31m [ 33%][0m
tests/distributions/test_mixture.py::TestMixtureMoments::test_single_multivariate_component[weights3-comp_dists3-size3-expected3] [32mPASSED[0m[31m [ 33%][0m
tests/distributions/test_mixture.py::TestMixtureMoments::test_list_multivariate_components[weights0-comp_dists0-None-expected0] [32mPASSED[0m[31m [ 33%][0m
tests/distributions/test_mixture.py::TestMixtureMoments::test_list_multivariate_components[weights1-comp_dists1-size1-expected1] [32mPASSED[0m[31m [ 33%][0m
tests/distributions/test_mixture.py::TestMixtureMoments::test_list_multivariate_components[weights2-comp_dists2-None-expected2] [32mPASSED[0m[31m [ 33%][0m
tests/distributions/test_mixture.py::TestMixtureMoments::test_list_multivariate_components[weights3-comp_dists3-size3-expected3] [32mPASSED[0m[31m [ 33%][0m
tests/distributions/test_mixture.py::TestMixtureDefaultTransforms::test_expected[comp_dists0-NoneType] [32mPASSED[0m[31m [ 33%][0m
tests/distributions/test_mixture.py::TestMixtureDefaultTransforms::test_expected[comp_dists1-NoneType] [32mPASSED[0m[31m [ 33%][0m
tests/distributions/test_mixture.py::TestMixtureDefaultTransforms::test_expected[comp_dists2-IntervalTransform] [32mPASSED[0m[31m [ 34%][0m
tests/distributions/test_mixture.py::TestMixtureDefaultTransforms::test_expected[comp_dists3-LogTransform] [32mPASSED[0m[31m [ 34%][0m
tests/distributions/test_mixture.py::TestMixtureDefaultTransforms::test_expected[comp_dists4-NoneType] [32mPASSED[0m[31m [ 34%][0m
tests/distributions/test_mixture.py::TestMixtureDefaultTransforms::test_expected[comp_dists5-LogTransform] [32mPASSED[0m[31m [ 34%][0m
tests/distributions/test_mixture.py::TestMixtureDefaultTransforms::test_expected[comp_dists6-SimplexTransform] [32mPASSED[0m[31m [ 34%][0m
tests/distributions/test_mixture.py::TestMixtureDefaultTransforms::test_expected[comp_dists7-IntervalTransform] [32mPASSED[0m[31m [ 34%][0m
tests/distributions/test_mixture.py::TestMixtureDefaultTransforms::test_expected[comp_dists8-NoneType] [32mPASSED[0m[31m [ 34%][0m
tests/distributions/test_mixture.py::TestMixtureDefaultTransforms::test_hierarchical_interval_transform [32mPASSED[0m[31m [ 34%][0m
tests/distributions/test_mixture.py::TestMixtureDefaultTransforms::test_logp [32mPASSED[0m[31m [ 34%][0m
tests/distributions/test_mixture.py::TestMixtureDefaultTransforms::test_warning [32mPASSED[0m[31m [ 34%][0m
tests/distributions/test_mixture.py::TestZeroInflatedMixture::test_zeroinflatedpoisson_logp [32mPASSED[0m[31m [ 34%][0m
tests/distributions/test_mixture.py::TestZeroInflatedMixture::test_zeroinflatednegativebinomial_logp [32mPASSED[0m[31m [ 34%][0m
tests/distributions/test_mixture.py::TestZeroInflatedMixture::test_zeroinflatedbinomial_logp [32mPASSED[0m[31m [ 34%][0m
tests/distributions/test_mixture.py::TestZeroInflatedMixture::test_zero_inflated_poisson_support_point[0.9-3.0-None-3] [32mPASSED[0m[31m [ 34%][0m
tests/distributions/test_mixture.py::TestZeroInflatedMixture::test_zero_inflated_poisson_support_point[0.8-2.9-5-expected1] [32mPASSED[0m[31m [ 34%][0m
tests/distributions/test_mixture.py::TestZeroInflatedMixture::test_zero_inflated_poisson_support_point[0.2-mu2-None-expected2] [32mPASSED[0m[31m [ 34%][0m
tests/distributions/test_mixture.py::TestZeroInflatedMixture::test_zero_inflated_poisson_support_point[0.2-mu3-size3-expected3] [32mPASSED[0m[31m [ 34%][0m
tests/distributions/test_mixture.py::TestZeroInflatedMixture::test_zero_inflated_binomial_support_point[0.8-7-0.7-None-4] [32mPASSED[0m[31m [ 34%][0m
tests/distributions/test_mixture.py::TestZeroInflatedMixture::test_zero_inflated_binomial_support_point[0.8-7-0.3-5-expected1] [32mPASSED[0m[31m [ 34%][0m
tests/distributions/test_mixture.py::TestZeroInflatedMixture::test_zero_inflated_binomial_support_point[0.4-25-p2-None-expected2] [32mPASSED[0m[31m [ 34%][0m
tests/distributions/test_mixture.py::TestZeroInflatedMixture::test_zero_inflated_binomial_support_point[0.4-25-p3-size3-expected3] [32mPASSED[0m[31m [ 34%][0m
tests/distributions/test_mixture.py::TestZeroInflatedMixture::test_zero_inflated_negative_binomial_support_point[0.2-10-3-None-2] [32mPASSED[0m[31m [ 34%][0m
tests/distributions/test_mixture.py::TestZeroInflatedMixture::test_zero_inflated_negative_binomial_support_point[0.2-10-4-5-expected1] [32mPASSED[0m[31m [ 34%][0m
tests/distributions/test_mixture.py::TestZeroInflatedMixture::test_zero_inflated_negative_binomial_support_point[0.4-mu2-alpha2-None-expected2] [32mPASSED[0m[31m [ 34%][0m
tests/distributions/test_mixture.py::TestZeroInflatedMixture::test_zero_inflated_negative_binomial_support_point[psi3-mu3-alpha3-size3-expected3] [32mPASSED[0m[31m [ 34%][0m
tests/distributions/test_mixture.py::TestZeroInflatedMixture::test_zero_inflated_dists_dtype_and_broadcast[dist-non_psi_args0] [32mPASSED[0m[31m [ 34%][0m
tests/distributions/test_mixture.py::TestZeroInflatedMixture::test_zero_inflated_dists_dtype_and_broadcast[dist-non_psi_args1] [32mPASSED[0m[31m [ 34%][0m
tests/distributions/test_mixture.py::TestZeroInflatedMixture::test_zero_inflated_dists_dtype_and_broadcast[dist-non_psi_args2] [32mPASSED[0m[31m [ 34%][0m
tests/distributions/test_mixture.py::TestHurdleDistributions::test_hurdle_poisson_graph [32mPASSED[0m[31m [ 34%][0m
tests/distributions/test_mixture.py::TestHurdleDistributions::test_hurdle_negativebinomial_graph [32mPASSED[0m[31m [ 34%][0m
tests/distributions/test_mixture.py::TestHurdleDistributions::test_hurdle_gamma_graph [32mPASSED[0m[31m [ 34%][0m
tests/distributions/test_mixture.py::TestHurdleDistributions::test_hurdle_lognormal_graph [32mPASSED[0m[31m [ 34%][0m
tests/distributions/test_mixture.py::TestHurdleDistributions::test_hurdle_logp_at_zero[dist-0.1-non_psi_args0] [32mPASSED[0m[31m [ 34%][0m
tests/distributions/test_mixture.py::TestHurdleDistributions::test_hurdle_logp_at_zero[dist-0.2-non_psi_args1] [32mPASSED[0m[31m [ 34%][0m
tests/distributions/test_mixture.py::TestHurdleDistributions::test_hurdle_logp_at_zero[dist-0.3-non_psi_args2] [32mPASSED[0m[31m [ 34%][0m
tests/distributions/test_mixture.py::TestHurdleDistributions::test_hurdle_logp_at_zero[dist-0.8-non_psi_args3] [32mPASSED[0m[31m [ 34%][0m
tests/distributions/test_mixture.py::TestHurdleDistributions::test_hurdle_logp_at_zero[dist-0.15-non_psi_args4] [32mPASSED[0m[31m [ 34%][0m
tests/distributions/test_mixture.py::TestHurdleDistributions::test_hurdle_logp_at_zero[dist-0.25-non_psi_args5] [32mPASSED[0m[31m [ 35%][0m
tests/distributions/test_mixture.py::TestHurdleDistributions::test_hurdle_logp_at_zero[dist-0.5-non_psi_args6] [32mPASSED[0m[31m [ 35%][0m
tests/distributions/test_mixture.py::TestHurdleDistributions::test_hurdle_logp_at_zero[dist-0.7-non_psi_args7] [32mPASSED[0m[31m [ 35%][0m
tests/distributions/test_mixture.py::TestHurdleDistributions::test_hurdle_logp_at_zero[dist-0.05-non_psi_args8] [32mPASSED[0m[31m [ 35%][0m
tests/distributions/test_mixture.py::TestHurdleDistributions::test_hurdle_logp_at_zero[dist-0.3-non_psi_args9] [32mPASSED[0m[31m [ 35%][0m
tests/distributions/test_mixture.py::TestHurdleDistributions::test_hurdle_logp_at_zero[dist-0.4-non_psi_args10] [32mPASSED[0m[31m [ 35%][0m
tests/distributions/test_mixture.py::TestHurdleDistributions::test_hurdle_logp_at_zero[dist-0.9-non_psi_args11] [32mPASSED[0m[31m [ 35%][0m
tests/distributions/test_mixture.py::TestHurdleDistributions::test_hurdle_logp_at_zero[dist-0.2-non_psi_args12] [32mPASSED[0m[31m [ 35%][0m
tests/distributions/test_mixture.py::TestHurdleDistributions::test_hurdle_logp_at_zero[dist-0.4-non_psi_args13] [32mPASSED[0m[31m [ 35%][0m
tests/distributions/test_mixture.py::TestHurdleDistributions::test_hurdle_logp_at_zero[dist-0.6-non_psi_args14] [32mPASSED[0m[31m [ 35%][0m
tests/distributions/test_mixture.py::TestHurdleDistributions::test_hurdle_logp_at_zero[dist-0.8-non_psi_args15] [32mPASSED[0m[31m [ 35%][0m
tests/distributions/test_mixture.py::TestHurdleDistributions::test_hurdle_zero_draws[dist-0.1-non_psi_args0] [32mPASSED[0m[31m [ 35%][0m
tests/distributions/test_mixture.py::TestHurdleDistributions::test_hurdle_zero_draws[dist-0.2-non_psi_args1] [32mPASSED[0m[31m [ 35%][0m
tests/distributions/test_mixture.py::TestHurdleDistributions::test_hurdle_zero_draws[dist-0.3-non_psi_args2] [32mPASSED[0m[31m [ 35%][0m
tests/distributions/test_mixture.py::TestHurdleDistributions::test_hurdle_zero_draws[dist-0.8-non_psi_args3] [32mPASSED[0m[31m [ 35%][0m
tests/distributions/test_mixture.py::TestHurdleDistributions::test_hurdle_zero_draws[dist-0.15-non_psi_args4] [32mPASSED[0m[31m [ 35%][0m
tests/distributions/test_mixture.py::TestHurdleDistributions::test_hurdle_zero_draws[dist-0.25-non_psi_args5] [32mPASSED[0m[31m [ 35%][0m
tests/distributions/test_mixture.py::TestHurdleDistributions::test_hurdle_zero_draws[dist-0.5-non_psi_args6] [32mPASSED[0m[31m [ 35%][0m
tests/distributions/test_mixture.py::TestHurdleDistributions::test_hurdle_zero_draws[dist-0.7-non_psi_args7] [32mPASSED[0m[31m [ 35%][0m
tests/distributions/test_mixture.py::TestHurdleDistributions::test_hurdle_zero_draws[dist-0.05-non_psi_args8] [32mPASSED[0m[31m [ 35%][0m
tests/distributions/test_mixture.py::TestHurdleDistributions::test_hurdle_zero_draws[dist-0.3-non_psi_args9] [32mPASSED[0m[31m [ 35%][0m
tests/distributions/test_mixture.py::TestHurdleDistributions::test_hurdle_zero_draws[dist-0.4-non_psi_args10] [32mPASSED[0m[31m [ 35%][0m
tests/distributions/test_mixture.py::TestHurdleDistributions::test_hurdle_zero_draws[dist-0.9-non_psi_args11] [32mPASSED[0m[31m [ 35%][0m
tests/distributions/test_mixture.py::TestHurdleDistributions::test_hurdle_zero_draws[dist-0.2-non_psi_args12] [32mPASSED[0m[31m [ 35%][0m
tests/distributions/test_mixture.py::TestHurdleDistributions::test_hurdle_zero_draws[dist-0.4-non_psi_args13] [32mPASSED[0m[31m [ 35%][0m
tests/distributions/test_mixture.py::TestHurdleDistributions::test_hurdle_zero_draws[dist-0.6-non_psi_args14] [32mPASSED[0m[31m [ 35%][0m
tests/distributions/test_mixture.py::TestHurdleDistributions::test_hurdle_zero_draws[dist-0.8-non_psi_args15] [32mPASSED[0m[31m [ 35%][0m
tests/distributions/test_mixture.py::TestHurdleDistributions::test_hurdle_poisson_logp [32mPASSED[0m[31m [ 35%][0m
tests/distributions/test_mixture.py::TestHurdleDistributions::test_hurdle_negativebinomial_logp [32mPASSED[0m[31m [ 35%][0m
tests/distributions/test_mixture.py::TestHurdleDistributions::test_hurdle_gamma_logp [32mPASSED[0m[31m [ 35%][0m
tests/distributions/test_mixture.py::TestHurdleDistributions::test_hurdle_lognormal_logp [32mPASSED[0m[31m [ 35%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_mvnormal[1] [32mPASSED[0m[31m [ 35%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_mvnormal[2] [32mPASSED[0m[31m [ 35%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_mvnormal[3] [32mPASSED[0m[31m [ 35%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_mvnormal_indef [32mPASSED[0m[31m [ 35%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_mvnormal_init_fail [32mPASSED[0m[31m [ 35%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_mvnormal_batched_dims[cov-False-False] [32mPASSED[0m[31m [ 36%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_mvnormal_batched_dims[cov-False-True] [32mPASSED[0m[31m [ 36%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_mvnormal_batched_dims[cov-True-False] [32mPASSED[0m[31m [ 36%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_mvnormal_batched_dims[cov-True-True] [32mPASSED[0m[31m [ 36%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_mvnormal_batched_dims[tau-False-False] [32mPASSED[0m[31m [ 36%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_mvnormal_batched_dims[tau-False-True] [32mPASSED[0m[31m [ 36%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_mvnormal_batched_dims[tau-True-False] [32mPASSED[0m[31m [ 36%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_mvnormal_batched_dims[tau-True-True] [32mPASSED[0m[31m [ 36%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_mvnormal_batched_dims[chol_lower-False-False] [32mPASSED[0m[31m [ 36%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_mvnormal_batched_dims[chol_lower-False-True] [32mPASSED[0m[31m [ 36%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_mvnormal_batched_dims[chol_lower-True-False] [32mPASSED[0m[31m [ 36%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_mvnormal_batched_dims[chol_lower-True-True] [32mPASSED[0m[31m [ 36%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_mvnormal_batched_dims[chol_upper-False-False] [32mPASSED[0m[31m [ 36%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_mvnormal_batched_dims[chol_upper-False-True] [32mPASSED[0m[31m [ 36%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_mvnormal_batched_dims[chol_upper-True-False] [32mPASSED[0m[31m [ 36%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_mvnormal_batched_dims[chol_upper-True-True] [32mPASSED[0m[31m [ 36%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_matrixnormal[1] [32mPASSED[0m[31m [ 36%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_matrixnormal[2] [32mPASSED[0m[31m [ 36%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_matrixnormal[3] [32mPASSED[0m[31m [ 36%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_kroneckernormal[0-3-2] [32mPASSED[0m[31m [ 36%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_kroneckernormal[0-3-3] [32mPASSED[0m[31m [ 36%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_kroneckernormal[1-3-2] [32mPASSED[0m[31m [ 36%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_kroneckernormal[1-3-3] [32mPASSED[0m[31m [ 36%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_mvt[1] [32mPASSED[0m[31m [ 36%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_mvt[2] [32mPASSED[0m[31m [ 36%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_mvt_batched_dims[cov-False-False-False] [32mPASSED[0m[31m [ 36%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_mvt_batched_dims[cov-False-False-True] [32mPASSED[0m[31m [ 36%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_mvt_batched_dims[cov-False-True-False] [32mPASSED[0m[31m [ 36%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_mvt_batched_dims[cov-False-True-True] [32mPASSED[0m[31m [ 36%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_mvt_batched_dims[cov-True-False-False] [32mPASSED[0m[31m [ 36%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_mvt_batched_dims[cov-True-False-True] [32mPASSED[0m[31m [ 36%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_mvt_batched_dims[cov-True-True-False] [32mPASSED[0m[31m [ 36%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_mvt_batched_dims[cov-True-True-True] [32mPASSED[0m[31m [ 36%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_mvt_batched_dims[tau-False-False-False] [32mPASSED[0m[31m [ 36%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_mvt_batched_dims[tau-False-False-True] [32mPASSED[0m[31m [ 36%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_mvt_batched_dims[tau-False-True-False] [32mPASSED[0m[31m [ 36%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_mvt_batched_dims[tau-False-True-True] [32mPASSED[0m[31m [ 36%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_mvt_batched_dims[tau-True-False-False] [32mPASSED[0m[31m [ 37%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_mvt_batched_dims[tau-True-False-True] [32mPASSED[0m[31m [ 37%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_mvt_batched_dims[tau-True-True-False] [32mPASSED[0m[31m [ 37%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_mvt_batched_dims[tau-True-True-True] [32mPASSED[0m[31m [ 37%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_mvt_batched_dims[chol-False-False-False] [32mPASSED[0m[31m [ 37%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_mvt_batched_dims[chol-False-False-True] [32mPASSED[0m[31m [ 37%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_mvt_batched_dims[chol-False-True-False] [32mPASSED[0m[31m [ 37%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_mvt_batched_dims[chol-False-True-True] [32mPASSED[0m[31m [ 37%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_mvt_batched_dims[chol-True-False-False] [32mPASSED[0m[31m [ 37%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_mvt_batched_dims[chol-True-False-True] [32mPASSED[0m[31m [ 37%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_mvt_batched_dims[chol-True-True-False] [32mPASSED[0m[31m [ 37%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_mvt_batched_dims[chol-True-True-True] [32mPASSED[0m[31m [ 37%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_wishart[2] [32mPASSED[0m[31m [ 37%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_wishart[3] [32mPASSED[0m[31m [ 37%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_lkjcorr[x0-1-3-1.596312591138855] [32mPASSED[0m[31m [ 37%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_lkjcorr[x1-3-3--7.796349337631274] [32mPASSED[0m[31m [ 37%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_lkjcorr[x2-0-3--inf] [32mPASSED[0m[31m [ 37%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_lkjcorr[x3-1-3--inf] [32mPASSED[0m[31m [ 37%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_lkjcorr[x4-1-3--inf] [32mPASSED[0m[31m [ 37%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_dirichlet[1] [32mPASSED[0m[31m [ 37%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_dirichlet[2] [32mPASSED[0m[31m [ 37%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_dirichlet[3] [32mPASSED[0m[31m [ 37%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_dirichlet_invalid [32mPASSED[0m[31m [ 37%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_dirichlet_vectorized[extra_size0-a0] [32mPASSED[0m[31m [ 37%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_dirichlet_vectorized[extra_size0-a1] [32mPASSED[0m[31m [ 37%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_dirichlet_vectorized[extra_size0-a2] [32mPASSED[0m[31m [ 37%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_dirichlet_vectorized[extra_size1-a0] [32mPASSED[0m[31m [ 37%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_dirichlet_vectorized[extra_size1-a1] [32mPASSED[0m[31m [ 37%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_dirichlet_vectorized[extra_size1-a2] [32mPASSED[0m[31m [ 37%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_dirichlet_vectorized[extra_size2-a0] [32mPASSED[0m[31m [ 37%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_dirichlet_vectorized[extra_size2-a1] [32mPASSED[0m[31m [ 37%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_dirichlet_vectorized[extra_size2-a2] [32mPASSED[0m[31m [ 37%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_multinomial[2] [31mFAILED[0m[31m [ 37%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_multinomial[3] [31mFAILED[0m[31m [ 37%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_multinomial_invalid_value [31mFAILED[0m[31m [ 37%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_multinomial_negative_p [32mPASSED[0m[31m [ 37%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_multinomial_p_not_normalized [32mPASSED[0m[31m [ 37%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_multinomial_negative_p_symbolic [32mPASSED[0m[31m [ 38%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_multinomial_p_not_normalized_symbolic [32mPASSED[0m[31m [ 38%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_multinomial_vectorized[extra_size0-p0-10] [32mPASSED[0m[31m [ 38%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_multinomial_vectorized[extra_size0-p0-n1] [31mFAILED[0m[31m [ 38%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_multinomial_vectorized[extra_size0-p0-n2] [31mFAILED[0m[31m [ 38%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_multinomial_vectorized[extra_size0-p1-10] [31mFAILED[0m[31m [ 38%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_multinomial_vectorized[extra_size0-p1-n1] [31mFAILED[0m[31m [ 38%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_multinomial_vectorized[extra_size0-p1-n2] [31mFAILED[0m[31m [ 38%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_multinomial_vectorized[extra_size0-p2-10] [31mFAILED[0m[31m [ 38%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_multinomial_vectorized[extra_size0-p2-n1] [31mFAILED[0m[31m [ 38%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_multinomial_vectorized[extra_size0-p2-n2] [31mFAILED[0m[31m [ 38%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_multinomial_vectorized[extra_size1-p0-10] [31mFAILED[0m[31m [ 38%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_multinomial_vectorized[extra_size1-p0-n1] [31mFAILED[0m[31m [ 38%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_multinomial_vectorized[extra_size1-p0-n2] [31mFAILED[0m[31m [ 38%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_multinomial_vectorized[extra_size1-p1-10] [31mFAILED[0m[31m [ 38%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_multinomial_vectorized[extra_size1-p1-n1] [31mFAILED[0m[31m [ 38%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_multinomial_vectorized[extra_size1-p1-n2] [31mFAILED[0m[31m [ 38%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_multinomial_vectorized[extra_size1-p2-10] [31mFAILED[0m[31m [ 38%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_multinomial_vectorized[extra_size1-p2-n1] [31mFAILED[0m[31m [ 38%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_multinomial_vectorized[extra_size1-p2-n2] [31mFAILED[0m[31m [ 38%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_multinomial_vectorized[extra_size2-p0-10] [31mFAILED[0m[31m [ 38%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_multinomial_vectorized[extra_size2-p0-n1] [31mFAILED[0m[31m [ 38%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_multinomial_vectorized[extra_size2-p0-n2] [31mFAILED[0m[31m [ 38%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_multinomial_vectorized[extra_size2-p1-10] [31mFAILED[0m[31m [ 38%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_multinomial_vectorized[extra_size2-p1-n1] [31mFAILED[0m[31m [ 38%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_multinomial_vectorized[extra_size2-p1-n2] [31mFAILED[0m[31m [ 38%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_multinomial_vectorized[extra_size2-p2-10] [31mFAILED[0m[31m [ 38%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_multinomial_vectorized[extra_size2-p2-n1] [31mFAILED[0m[31m [ 38%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_multinomial_vectorized[extra_size2-p2-n2] [31mFAILED[0m[31m [ 38%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_multinomial_zero_probs [31mFAILED[0m[31m [ 38%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_ordered_multinomial_probs [32mPASSED[0m[31m [ 38%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_dirichlet_multinomial[2] [32mPASSED[0m[31m [ 38%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_dirichlet_multinomial[3] [32mPASSED[0m[31m [ 38%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_dirichlet_multinomial_invalid [32mPASSED[0m[31m [ 38%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_dirichlet_multinomial_matches_beta_binomial [32mPASSED[0m[31m [ 38%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_dirichlet_multinomial_vectorized[extra_size0-a0-10] [32mPASSED[0m[31m [ 38%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_dirichlet_multinomial_vectorized[extra_size0-a0-n1] [32mPASSED[0m[31m [ 38%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_dirichlet_multinomial_vectorized[extra_size0-a0-n2] [32mPASSED[0m[31m [ 39%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_dirichlet_multinomial_vectorized[extra_size0-a1-10] [32mPASSED[0m[31m [ 39%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_dirichlet_multinomial_vectorized[extra_size0-a1-n1] [32mPASSED[0m[31m [ 39%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_dirichlet_multinomial_vectorized[extra_size0-a1-n2] [32mPASSED[0m[31m [ 39%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_dirichlet_multinomial_vectorized[extra_size0-a2-10] [32mPASSED[0m[31m [ 39%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_dirichlet_multinomial_vectorized[extra_size0-a2-n1] [32mPASSED[0m[31m [ 39%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_dirichlet_multinomial_vectorized[extra_size0-a2-n2] [32mPASSED[0m[31m [ 39%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_dirichlet_multinomial_vectorized[extra_size1-a0-10] [32mPASSED[0m[31m [ 39%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_dirichlet_multinomial_vectorized[extra_size1-a0-n1] [32mPASSED[0m[31m [ 39%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_dirichlet_multinomial_vectorized[extra_size1-a0-n2] [32mPASSED[0m[31m [ 39%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_dirichlet_multinomial_vectorized[extra_size1-a1-10] [32mPASSED[0m[31m [ 39%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_dirichlet_multinomial_vectorized[extra_size1-a1-n1] [32mPASSED[0m[31m [ 39%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_dirichlet_multinomial_vectorized[extra_size1-a1-n2] [32mPASSED[0m[31m [ 39%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_dirichlet_multinomial_vectorized[extra_size1-a2-10] [32mPASSED[0m[31m [ 39%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_dirichlet_multinomial_vectorized[extra_size1-a2-n1] [32mPASSED[0m[31m [ 39%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_dirichlet_multinomial_vectorized[extra_size1-a2-n2] [32mPASSED[0m[31m [ 39%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_dirichlet_multinomial_vectorized[extra_size2-a0-10] [32mPASSED[0m[31m [ 39%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_dirichlet_multinomial_vectorized[extra_size2-a0-n1] [32mPASSED[0m[31m [ 39%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_dirichlet_multinomial_vectorized[extra_size2-a0-n2] [32mPASSED[0m[31m [ 39%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_dirichlet_multinomial_vectorized[extra_size2-a1-10] [32mPASSED[0m[31m [ 39%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_dirichlet_multinomial_vectorized[extra_size2-a1-n1] [32mPASSED[0m[31m [ 39%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_dirichlet_multinomial_vectorized[extra_size2-a1-n2] [32mPASSED[0m[31m [ 39%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_dirichlet_multinomial_vectorized[extra_size2-a2-10] [32mPASSED[0m[31m [ 39%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_dirichlet_multinomial_vectorized[extra_size2-a2-n1] [32mPASSED[0m[31m [ 39%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_dirichlet_multinomial_vectorized[extra_size2-a2-n2] [32mPASSED[0m[31m [ 39%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_stickbreakingweights_logp[value0-0.5-4-1.5126301307277439] [32mPASSED[0m[31m [ 39%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_stickbreakingweights_logp[value1-2-12-13.980045245672827] [32mPASSED[0m[31m [ 39%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_stickbreakingweights_logp[value2-0.1-10--22.971662448814723] [32mPASSED[0m[31m [ 39%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_stickbreakingweights_logp[value3-5-19-94.20462772778092] [32mPASSED[0m[31m [ 39%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_stickbreakingweights_logp[value4-2.5-3-logp4] [32mPASSED[0m[31m [ 39%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_stickbreakingweights_invalid [32mPASSED[0m[31m [ 39%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_stickbreakingweights_vectorized[alpha0-3] [32mPASSED[0m[31m [ 39%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_stickbreakingweights_vectorized[alpha1-5] [32mPASSED[0m[31m [ 39%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_car_logp[False-()] [32mPASSED[0m[31m [ 39%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_car_logp[False-(1,)] [32mPASSED[0m[31m [ 39%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_car_logp[False-(4,)] [32mPASSED[0m[31m [ 39%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_car_logp[False-(4, 4, 4)] [32mPASSED[0m[31m [ 39%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_car_logp[True-()] [32mPASSED[0m[31m [ 40%][0m
tests/distributions/test_multivariate.py::TestMatchesScipy::test_car_logp[True-(4,)] [32mPASSED[0m[31m [ 40%][0m
tests/distributions/test_multivariate.py::test_car_matrix_check[False] [32mPASSED[0m[31m [ 40%][0m
tests/distributions/test_multivariate.py::test_car_matrix_check[True] [32mPASSED[0m[31m [ 40%][0m
tests/distributions/test_multivariate.py::test_car_alpha_bounds[1] [32mPASSED[0m[31m [ 40%][0m
tests/distributions/test_multivariate.py::test_car_alpha_bounds[-1] [32mPASSED[0m[31m [ 40%][0m
tests/distributions/test_multivariate.py::TestLKJCholeskCov::test_dist [32mPASSED[0m[31m [ 40%][0m
tests/distributions/test_multivariate.py::TestLKJCholeskCov::test_sd_dist_distribution [32mPASSED[0m[31m [ 40%][0m
tests/distributions/test_multivariate.py::TestLKJCholeskCov::test_sd_dist_registered [32mPASSED[0m[31m [ 40%][0m
tests/distributions/test_multivariate.py::TestLKJCholeskCov::test_no_warning_logp [32mPASSED[0m[31m [ 40%][0m
tests/distributions/test_multivariate.py::TestLKJCholeskCov::test_sd_dist_automatically_resized[size0-None-sd_dist0] [32mPASSED[0m[31m [ 40%][0m
tests/distributions/test_multivariate.py::TestLKJCholeskCov::test_sd_dist_automatically_resized[size0-None-sd_dist1] [32mPASSED[0m[31m [ 40%][0m
tests/distributions/test_multivariate.py::TestLKJCholeskCov::test_sd_dist_automatically_resized[None-shape1-sd_dist0] [32mPASSED[0m[31m [ 40%][0m
tests/distributions/test_multivariate.py::TestLKJCholeskCov::test_sd_dist_automatically_resized[None-shape1-sd_dist1] [32mPASSED[0m[31m [ 40%][0m
tests/distributions/test_multivariate.py::TestLKJCholeskCov::test_sd_dist_automatically_resized[None-shape2-sd_dist0] [32mPASSED[0m[31m [ 40%][0m
tests/distributions/test_multivariate.py::TestLKJCholeskCov::test_sd_dist_automatically_resized[None-shape2-sd_dist1] [32mPASSED[0m[31m [ 40%][0m
tests/distributions/test_multivariate.py::TestLKJCholeskCov::test_change_dist_size [32mPASSED[0m[31m [ 40%][0m
tests/distributions/test_multivariate.py::TestMoments::test_multinomial_support_point[p0-1-None-expected0] [32mPASSED[0m[31m [ 40%][0m
tests/distributions/test_multivariate.py::TestMoments::test_multinomial_support_point[p1-2-None-expected1] [32mPASSED[0m[31m [ 40%][0m
tests/distributions/test_multivariate.py::TestMoments::test_multinomial_support_point[p2-10-None-expected2] [32mPASSED[0m[31m [ 40%][0m
tests/distributions/test_multivariate.py::TestMoments::test_multinomial_support_point[p3-10-None-expected3] [31mFAILED[0m[31m [ 40%][0m
tests/distributions/test_multivariate.py::TestMoments::test_multinomial_support_point[p4-n4-size4-expected4] [32mPASSED[0m[31m [ 40%][0m
tests/distributions/test_multivariate.py::TestMoments::test_multinomial_support_point[p5-n5-None-expected5] [31mFAILED[0m[31m [ 40%][0m
tests/distributions/test_multivariate.py::TestMoments::test_multinomial_support_point[p6-n6-size6-expected6] [31mFAILED[0m[31m [ 40%][0m
tests/distributions/test_multivariate.py::TestMoments::test_multinomial_support_point[p7-1-None-expected7] [31mFAILED[0m[31m [ 40%][0m
tests/distributions/test_multivariate.py::TestMoments::test_multinomial_support_point[p8-4-None-expected8] [33mXFAIL[0m[31m [ 40%][0m
tests/distributions/test_multivariate.py::TestMoments::test_dirichlet_support_point[a0-None-expected0] [32mPASSED[0m[31m [ 40%][0m
tests/distributions/test_multivariate.py::TestMoments::test_dirichlet_support_point[a1-None-expected1] [32mPASSED[0m[31m [ 40%][0m
tests/distributions/test_multivariate.py::TestMoments::test_dirichlet_support_point[a2-size2-expected2] [32mPASSED[0m[31m [ 40%][0m
tests/distributions/test_multivariate.py::TestMoments::test_dirichlet_support_point[a3-size3-expected3] [32mPASSED[0m[31m [ 40%][0m
tests/distributions/test_multivariate.py::TestMoments::test_mv_normal_support_point[mu0-cov0-None-expected0] [32mPASSED[0m[31m [ 40%][0m
tests/distributions/test_multivariate.py::TestMoments::test_mv_normal_support_point[mu1-cov1-None-expected1] [32mPASSED[0m[31m [ 40%][0m
tests/distributions/test_multivariate.py::TestMoments::test_mv_normal_support_point[mu2-cov2-None-expected2] [32mPASSED[0m[31m [ 40%][0m
tests/distributions/test_multivariate.py::TestMoments::test_mv_normal_support_point[mu3-cov3-None-expected3] [32mPASSED[0m[31m [ 40%][0m
tests/distributions/test_multivariate.py::TestMoments::test_mv_normal_support_point[mu4-cov4-size4-expected4] [32mPASSED[0m[31m [ 40%][0m
tests/distributions/test_multivariate.py::TestMoments::test_mv_normal_support_point[mu5-cov5-5-expected5] [32mPASSED[0m[31m [ 40%][0m
tests/distributions/test_multivariate.py::TestMoments::test_mv_normal_support_point[mu6-cov6-size6-expected6] [32mPASSED[0m[31m [ 40%][0m
tests/distributions/test_multivariate.py::TestMoments::test_mv_normal_support_point[mu7-cov7-size7-expected7] [32mPASSED[0m[31m [ 41%][0m
tests/distributions/test_multivariate.py::TestMoments::test_zerosum_normal_support_point[shape0-None-expected0] [32mPASSED[0m[31m [ 41%][0m
tests/distributions/test_multivariate.py::TestMoments::test_zerosum_normal_support_point[shape1-2-expected1] [32mPASSED[0m[31m [ 41%][0m
tests/distributions/test_multivariate.py::TestMoments::test_zerosum_normal_support_point[shape2-3-expected2] [32mPASSED[0m[31m [ 41%][0m
tests/distributions/test_multivariate.py::TestMoments::test_car_support_point[mu0-None-expected0] [32mPASSED[0m[31m [ 41%][0m
tests/distributions/test_multivariate.py::TestMoments::test_car_support_point[mu1-6-expected1] [32mPASSED[0m[31m [ 41%][0m
tests/distributions/test_multivariate.py::TestMoments::test_car_support_point[mu2-size2-expected2] [32mPASSED[0m[31m [ 41%][0m
tests/distributions/test_multivariate.py::TestMoments::test_car_support_point[mu3-size3-expected3] [32mPASSED[0m[31m [ 41%][0m
tests/distributions/test_multivariate.py::TestMoments::test_icar_support_point[W0-expected0] [32mPASSED[0m[31m [ 41%][0m
tests/distributions/test_multivariate.py::TestMoments::test_icar_support_point[W1-expected1] [32mPASSED[0m[31m [ 41%][0m
tests/distributions/test_multivariate.py::TestMoments::test_mvstudentt_support_point[2-mu0-cov0-None-expected0] [32mPASSED[0m[31m [ 41%][0m
tests/distributions/test_multivariate.py::TestMoments::test_mvstudentt_support_point[2-mu1-cov1-None-expected1] [32mPASSED[0m[31m [ 41%][0m
tests/distributions/test_multivariate.py::TestMoments::test_mvstudentt_support_point[2-mu2-cov2-2-expected2] [32mPASSED[0m[31m [ 41%][0m
tests/distributions/test_multivariate.py::TestMoments::test_mvstudentt_support_point[2-mu3-cov3-size3-expected3] [32mPASSED[0m[31m [ 41%][0m
tests/distributions/test_multivariate.py::TestMoments::test_mvstudentt_support_point[2-mu4-cov4-None-expected4] [32mPASSED[0m[31m [ 41%][0m
tests/distributions/test_multivariate.py::TestMoments::test_mvstudentt_support_point[2-mu5-cov5-size5-expected5] [32mPASSED[0m[31m [ 41%][0m
tests/distributions/test_multivariate.py::TestMoments::test_mvstudentt_support_point[2-mu6-cov6-size6-expected6] [32mPASSED[0m[31m [ 41%][0m
tests/distributions/test_multivariate.py::TestMoments::test_mvstudentt_support_point[nu7-0-cov7-None-expected7] [32mPASSED[0m[31m [ 41%][0m
tests/distributions/test_multivariate.py::TestMoments::test_matrixnormal_support_point[mu0-rowchol0-colchol0-None-expected0] [32mPASSED[0m[31m [ 41%][0m
tests/distributions/test_multivariate.py::TestMoments::test_matrixnormal_support_point[mu1-rowchol1-colchol1-None-expected1] [32mPASSED[0m[31m [ 41%][0m
tests/distributions/test_multivariate.py::TestMoments::test_matrixnormal_support_point[mu2-rowchol2-colchol2-None-expected2] [32mPASSED[0m[31m [ 41%][0m
tests/distributions/test_multivariate.py::TestMoments::test_matrixnormal_support_point[mu3-rowchol3-colchol3-2-expected3] [32mPASSED[0m[31m [ 41%][0m
tests/distributions/test_multivariate.py::TestMoments::test_matrixnormal_support_point[mu4-rowchol4-colchol4-size4-expected4] [32mPASSED[0m[31m [ 41%][0m
tests/distributions/test_multivariate.py::TestMoments::test_stickbreakingweights_support_point[3-11-None-expected0] [32mPASSED[0m[31m [ 41%][0m
tests/distributions/test_multivariate.py::TestMoments::test_stickbreakingweights_support_point[5-19-None-expected1] [32mPASSED[0m[31m [ 41%][0m
tests/distributions/test_multivariate.py::TestMoments::test_stickbreakingweights_support_point[1-7-size2-expected2] [32mPASSED[0m[31m [ 41%][0m
tests/distributions/test_multivariate.py::TestMoments::test_stickbreakingweights_support_point[0.5-5-size3-expected3] [32mPASSED[0m[31m [ 41%][0m
tests/distributions/test_multivariate.py::TestMoments::test_stickbreakingweights_support_point[alpha4-11-None-expected4] [32mPASSED[0m[31m [ 41%][0m
tests/distributions/test_multivariate.py::TestMoments::test_stickbreakingweights_support_point[alpha5-9-size5-expected5] [32mPASSED[0m[31m [ 41%][0m
tests/distributions/test_multivariate.py::TestMoments::test_kronecker_normal_support_point[mu0-covs0-None-expected0] [32mPASSED[0m[31m [ 41%][0m
tests/distributions/test_multivariate.py::TestMoments::test_kronecker_normal_support_point[mu1-covs1-5-expected1] [32mPASSED[0m[31m [ 41%][0m
tests/distributions/test_multivariate.py::TestMoments::test_kronecker_normal_support_point[mu2-covs2-6-expected2] [32mPASSED[0m[31m [ 41%][0m
tests/distributions/test_multivariate.py::TestMoments::test_kronecker_normal_support_point[mu3-covs3-6-expected3] [32mPASSED[0m[31m [ 41%][0m
tests/distributions/test_multivariate.py::TestMoments::test_kronecker_normal_support_point[mu4-covs4-2-expected4] [32mPASSED[0m[31m [ 41%][0m
tests/distributions/test_multivariate.py::TestMoments::test_lkjcorr_support_point[3-1-None-expected0] [32mPASSED[0m[31m [ 41%][0m
tests/distributions/test_multivariate.py::TestMoments::test_lkjcorr_support_point[5-1-None-expected1] [32mPASSED[0m[31m [ 41%][0m
tests/distributions/test_multivariate.py::TestMoments::test_lkjcorr_support_point[3-1-1-expected2] [32mPASSED[0m[31m [ 42%][0m
tests/distributions/test_multivariate.py::TestMoments::test_lkjcorr_support_point[5-1-size3-expected3] [32mPASSED[0m[31m [ 42%][0m
tests/distributions/test_multivariate.py::TestMoments::test_lkjcholeskycov_support_point[3-1-None-expected0] [32mPASSED[0m[31m [ 42%][0m
tests/distributions/test_multivariate.py::TestMoments::test_lkjcholeskycov_support_point[4-1-None-expected1] [32mPASSED[0m[31m [ 42%][0m
tests/distributions/test_multivariate.py::TestMoments::test_lkjcholeskycov_support_point[3-1-1-expected2] [32mPASSED[0m[31m [ 42%][0m
tests/distributions/test_multivariate.py::TestMoments::test_lkjcholeskycov_support_point[4-1-size3-expected3] [32mPASSED[0m[31m [ 42%][0m
tests/distributions/test_multivariate.py::TestMoments::test_dirichlet_multinomial_support_point[a0-1-None-expected0] [32mPASSED[0m[31m [ 42%][0m
tests/distributions/test_multivariate.py::TestMoments::test_dirichlet_multinomial_support_point[a1-2-None-expected1] [32mPASSED[0m[31m [ 42%][0m
tests/distributions/test_multivariate.py::TestMoments::test_dirichlet_multinomial_support_point[a2-10-None-expected2] [32mPASSED[0m[31m [ 42%][0m
tests/distributions/test_multivariate.py::TestMoments::test_dirichlet_multinomial_support_point[a3-10-size3-expected3] [32mPASSED[0m[31m [ 42%][0m
tests/distributions/test_multivariate.py::TestMoments::test_dirichlet_multinomial_support_point[a4-n4-None-expected4] [32mPASSED[0m[31m [ 42%][0m
tests/distributions/test_multivariate.py::TestMoments::test_dirichlet_multinomial_support_point[a5-n5-size5-expected5] [32mPASSED[0m[31m [ 42%][0m
tests/distributions/test_multivariate.py::TestMvNormalCov::test_distribution <- pymc/testing.py [32mPASSED[0m[31m [ 42%][0m
tests/distributions/test_multivariate.py::TestMvNormalChol::test_distribution <- pymc/testing.py [32mPASSED[0m[31m [ 42%][0m
tests/distributions/test_multivariate.py::TestMvNormalTau::test_distribution <- pymc/testing.py [32mPASSED[0m[31m [ 42%][0m
tests/distributions/test_multivariate.py::TestMvNormalMisc::test_with_chol_rv [32mPASSED[0m[31m [ 42%][0m
tests/distributions/test_multivariate.py::TestMvNormalMisc::test_with_cov_rv [32mPASSED[0m[31m [ 42%][0m
tests/distributions/test_multivariate.py::TestMvNormalMisc::test_with_lkjcorr_matrix [32mPASSED[0m[31m [ 42%][0m
tests/distributions/test_multivariate.py::TestMvNormalMisc::test_issue_3758 [32mPASSED[0m[31m [ 42%][0m
tests/distributions/test_multivariate.py::TestMvNormalMisc::test_issue_3829 [32mPASSED[0m[31m [ 42%][0m
tests/distributions/test_multivariate.py::TestMvNormalMisc::test_issue_3706 [32mPASSED[0m[31m [ 42%][0m
tests/distributions/test_multivariate.py::TestZeroSumNormal::test_zsn_dims[dims0-None] [32mPASSED[0m[31m [ 42%][0m
tests/distributions/test_multivariate.py::TestZeroSumNormal::test_zsn_dims[dims1-1] [32mPASSED[0m[31m [ 42%][0m
tests/distributions/test_multivariate.py::TestZeroSumNormal::test_zsn_dims[dims2-2] [32mPASSED[0m[31m [ 42%][0m
tests/distributions/test_multivariate.py::TestZeroSumNormal::test_zsn_shape[None] [32mPASSED[0m[31m [ 42%][0m
tests/distributions/test_multivariate.py::TestZeroSumNormal::test_zsn_shape[1] [32mPASSED[0m[31m [ 42%][0m
tests/distributions/test_multivariate.py::TestZeroSumNormal::test_zsn_shape[2] [32mPASSED[0m[31m [ 42%][0m
tests/distributions/test_multivariate.py::TestZeroSumNormal::test_zsn_fail_axis[ValueError-Number of shape dimensions is too small for ndim_supp of 4-shape0-None-4] [32mPASSED[0m[31m [ 42%][0m
tests/distributions/test_multivariate.py::TestZeroSumNormal::test_zsn_fail_axis[AssertionError-does not match-shape1-support_shape1-None] [32mPASSED[0m[31m [ 42%][0m
tests/distributions/test_multivariate.py::TestZeroSumNormal::test_zsn_fail_axis[AssertionError-does not match-shape2-support_shape2-None] [32mPASSED[0m[31m [ 42%][0m
tests/distributions/test_multivariate.py::TestZeroSumNormal::test_zsn_support_shape[None-support_shape0] [32mPASSED[0m[31m [ 42%][0m
tests/distributions/test_multivariate.py::TestZeroSumNormal::test_zsn_support_shape[shape1-support_shape1] [32mPASSED[0m[31m [ 42%][0m
tests/distributions/test_multivariate.py::TestZeroSumNormal::test_zsn_change_dist_size[1] [32mPASSED[0m[31m [ 42%][0m
tests/distributions/test_multivariate.py::TestZeroSumNormal::test_zsn_change_dist_size[2] [32mPASSED[0m[31m [ 42%][0m
tests/distributions/test_multivariate.py::TestZeroSumNormal::test_zsn_variance[5-3] [32mPASSED[0m[31m [ 42%][0m
tests/distributions/test_multivariate.py::TestZeroSumNormal::test_zsn_variance[2-6] [32mPASSED[0m[31m [ 42%][0m
tests/distributions/test_multivariate.py::TestZeroSumNormal::test_zsn_logp[5-3-None-mvn_axes0] [32mPASSED[0m[31m [ 42%][0m
tests/distributions/test_multivariate.py::TestZeroSumNormal::test_zsn_logp[2-6-None-mvn_axes1] [32mPASSED[0m[31m [ 43%][0m
tests/distributions/test_multivariate.py::TestZeroSumNormal::test_zsn_logp[5-shape2-None-mvn_axes2] [32mPASSED[0m[31m [ 43%][0m
tests/distributions/test_multivariate.py::TestZeroSumNormal::test_zsn_logp[5-shape3-2-mvn_axes3] [32mPASSED[0m[31m [ 43%][0m
tests/distributions/test_multivariate.py::TestZeroSumNormal::test_does_not_upcast_to_float64 [32mPASSED[0m[31m [ 43%][0m
tests/distributions/test_multivariate.py::TestZeroSumNormal::test_batched_sigma [32mPASSED[0m[31m [ 43%][0m
tests/distributions/test_multivariate.py::TestMvStudentTCov::test_distribution <- pymc/testing.py [32mPASSED[0m[31m [ 43%][0m
tests/distributions/test_multivariate.py::TestMvStudentTChol::test_distribution <- pymc/testing.py [32mPASSED[0m[31m [ 43%][0m
tests/distributions/test_multivariate.py::TestMvStudentTTau::test_distribution <- pymc/testing.py [32mPASSED[0m[31m [ 43%][0m
tests/distributions/test_multivariate.py::TestDirichlet::test_distribution <- pymc/testing.py [32mPASSED[0m[31m [ 43%][0m
tests/distributions/test_multivariate.py::TestMultinomial::test_distribution <- pymc/testing.py [32mPASSED[0m[31m [ 43%][0m
tests/distributions/test_multivariate.py::TestDirichletMultinomial::test_distribution <- pymc/testing.py [32mPASSED[0m[31m [ 43%][0m
tests/distributions/test_multivariate.py::TestDirichletMultinomial_1D_n_2D_a::test_distribution <- pymc/testing.py [32mPASSED[0m[31m [ 43%][0m
tests/distributions/test_multivariate.py::TestStickBreakingWeights::test_distribution <- pymc/testing.py [32mPASSED[0m[31m [ 43%][0m
tests/distributions/test_multivariate.py::TestStickBreakingWeights_1D_alpha::test_distribution <- pymc/testing.py [32mPASSED[0m[31m [ 43%][0m
tests/distributions/test_multivariate.py::TestWishart::test_distribution <- pymc/testing.py [32mPASSED[0m[31m [ 43%][0m
tests/distributions/test_multivariate.py::TestMatrixNormal::test_distribution <- pymc/testing.py [32mPASSED[0m[31m [ 43%][0m
tests/distributions/test_multivariate.py::TestKroneckerNormal::test_distribution <- pymc/testing.py [32mPASSED[0m[31m [ 43%][0m
tests/distributions/test_multivariate.py::TestOrderedMultinomial::test_distribution <- pymc/testing.py [32mPASSED[0m[31m [ 43%][0m
tests/distributions/test_multivariate.py::TestLKJCorr::test_distribution <- pymc/testing.py [32mPASSED[0m[31m [ 43%][0m
tests/distributions/test_multivariate.py::test_LKJCorr_default_transform[shape0] [32mPASSED[0m[31m [ 43%][0m
tests/distributions/test_multivariate.py::test_LKJCorr_default_transform[shape1] [33mXFAIL[0m[31m [ 43%][0m
tests/distributions/test_multivariate.py::TestLKJCholeskyCov::test_distribution <- pymc/testing.py [32mPASSED[0m[31m [ 43%][0m
tests/distributions/test_multivariate.py::TestICAR::test_distribution <- pymc/testing.py [32mPASSED[0m[31m [ 43%][0m
tests/distributions/test_multivariate.py::TestICAR::test_icar_logp [32mPASSED[0m[31m [ 43%][0m
tests/distributions/test_multivariate.py::TestICAR::test_icar_rng_fn [32mPASSED[0m[31m [ 43%][0m
tests/distributions/test_multivariate.py::TestICAR::test_icar_matrix_checks[W0-W must be matrix with ndim=2] [32mPASSED[0m[31m [ 43%][0m
tests/distributions/test_multivariate.py::TestICAR::test_icar_matrix_checks[W1-W must be a square matrix] [32mPASSED[0m[31m [ 43%][0m
tests/distributions/test_multivariate.py::TestICAR::test_icar_matrix_checks[W2-W must be a symmetric matrix] [32mPASSED[0m[31m [ 43%][0m
tests/distributions/test_multivariate.py::TestICAR::test_icar_matrix_checks[W3-W must be composed of only 1s and 0s] [32mPASSED[0m[31m [ 43%][0m
tests/distributions/test_multivariate.py::test_car_rng_fn[True] [32mPASSED[0m[31m   [ 43%][0m
tests/distributions/test_multivariate.py::test_car_rng_fn[False] [32mPASSED[0m[31m  [ 43%][0m
tests/distributions/test_multivariate.py::test_posdef_symmetric[matrix0-True] [32mPASSED[0m[31m [ 43%][0m
tests/distributions/test_multivariate.py::test_posdef_symmetric[matrix1-False] [32mPASSED[0m[31m [ 43%][0m
tests/distributions/test_multivariate.py::test_posdef_symmetric[matrix2-False] [32mPASSED[0m[31m [ 43%][0m
tests/distributions/test_multivariate.py::test_posdef_symmetric[matrix3-False] [32mPASSED[0m[31m [ 43%][0m
tests/distributions/test_multivariate.py::test_mvnormal_no_cholesky_in_model_logp [32mPASSED[0m[31m [ 43%][0m
tests/distributions/test_multivariate.py::test_mvnormal_blockwise_solve_opt [32mPASSED[0m[31m [ 43%][0m
tests/distributions/test_multivariate.py::test_mvnormal_mu_convenience [32mPASSED[0m[31m [ 44%][0m
tests/distributions/test_multivariate.py::test_mvstudentt_mu_convenience [32mPASSED[0m[31m [ 44%][0m
tests/distributions/test_multivariate.py::test_mvstudentt_method [32mPASSED[0m[31m  [ 44%][0m
tests/distributions/test_multivariate.py::test_precision_mv_normal_optimization [32mPASSED[0m[31m [ 44%][0m
tests/distributions/test_random_alternative_backends.py::test_dirichlet_multinomial[FAST_RUN] [32mPASSED[0m[31m [ 44%][0m
tests/distributions/test_random_alternative_backends.py::test_dirichlet_multinomial[JAX] [32mPASSED[0m[31m [ 44%][0m
tests/distributions/test_random_alternative_backends.py::test_dirichlet_multinomial[NUMBA] [32mPASSED[0m[31m [ 44%][0m
tests/distributions/test_random_alternative_backends.py::test_dirichlet_multinomial_dims[FAST_RUN] [32mPASSED[0m[31m [ 44%][0m
tests/distributions/test_random_alternative_backends.py::test_dirichlet_multinomial_dims[JAX] [32mPASSED[0m[31m [ 44%][0m
tests/distributions/test_random_alternative_backends.py::test_dirichlet_multinomial_dims[NUMBA] [32mPASSED[0m[31m [ 44%][0m
tests/distributions/test_random_alternative_backends.py::test_mvstudentt[FAST_RUN] [32mPASSED[0m[31m [ 44%][0m
tests/distributions/test_random_alternative_backends.py::test_mvstudentt[JAX] [32mPASSED[0m[31m [ 44%][0m
tests/distributions/test_random_alternative_backends.py::test_mvstudentt[NUMBA] [32mPASSED[0m[31m [ 44%][0m
tests/distributions/test_random_alternative_backends.py::test_repeated_arguments[FAST_RUN] [32mPASSED[0m[31m [ 44%][0m
tests/distributions/test_random_alternative_backends.py::test_repeated_arguments[JAX] [32mPASSED[0m[31m [ 44%][0m
tests/distributions/test_random_alternative_backends.py::test_repeated_arguments[NUMBA] [32mPASSED[0m[31m [ 44%][0m
tests/distributions/test_shape_utils.py::TestShapesBroadcasting::test_broadcasting[((), (1,), (4,), (5, 4))] [32mPASSED[0m[31m [ 44%][0m
tests/distributions/test_shape_utils.py::TestShapesBroadcasting::test_broadcasting[((), (1,), (7,), (5, 4))] [32mPASSED[0m[31m [ 44%][0m
tests/distributions/test_shape_utils.py::TestShapesBroadcasting::test_broadcasting[((), (1,), (1, 4), (5, 4))] [32mPASSED[0m[31m [ 44%][0m
tests/distributions/test_shape_utils.py::TestShapesBroadcasting::test_broadcasting[((), (1,), (5, 1), (5, 4))] [32mPASSED[0m[31m [ 44%][0m
tests/distributions/test_shape_utils.py::TestShapesBroadcasting::test_broadcasting[((), (1,), (3, 4), (5, 4))] [32mPASSED[0m[31m [ 44%][0m
tests/distributions/test_shape_utils.py::TestShapesBroadcasting::test_broadcasting[((), (1,), (5, 3), (5, 4))] [32mPASSED[0m[31m [ 44%][0m
tests/distributions/test_shape_utils.py::TestShapesBroadcasting::test_broadcasting[((), (1,), (10, 4), (5, 4))] [32mPASSED[0m[31m [ 44%][0m
tests/distributions/test_shape_utils.py::TestShapesBroadcasting::test_broadcasting[((), (1,), (10,), (5, 4))] [32mPASSED[0m[31m [ 44%][0m
tests/distributions/test_shape_utils.py::TestShapesBroadcasting::test_broadcasting[((), (1,), (1, 1, 4), (5, 4))] [32mPASSED[0m[31m [ 44%][0m
tests/distributions/test_shape_utils.py::TestShapesBroadcasting::test_broadcasting[((), (1,), (10, 1, 4), (5, 4))] [32mPASSED[0m[31m [ 44%][0m
tests/distributions/test_shape_utils.py::TestShapesBroadcasting::test_broadcasting[((), (1,), (10, 5, 4), (5, 4))] [32mPASSED[0m[31m [ 44%][0m
tests/distributions/test_shape_utils.py::TestSizeShapeDimsObserved::test_param_and_batch_shape_combos[implicit-batch_shape0-param_shape0] [32mPASSED[0m[31m [ 44%][0m
tests/distributions/test_shape_utils.py::TestSizeShapeDimsObserved::test_param_and_batch_shape_combos[implicit-batch_shape0-param_shape1] [32mPASSED[0m[31m [ 44%][0m
tests/distributions/test_shape_utils.py::TestSizeShapeDimsObserved::test_param_and_batch_shape_combos[implicit-batch_shape1-param_shape0] [32mPASSED[0m[31m [ 44%][0m
tests/distributions/test_shape_utils.py::TestSizeShapeDimsObserved::test_param_and_batch_shape_combos[implicit-batch_shape1-param_shape1] [32mPASSED[0m[31m [ 44%][0m
tests/distributions/test_shape_utils.py::TestSizeShapeDimsObserved::test_param_and_batch_shape_combos[shape-batch_shape0-param_shape0] [32mPASSED[0m[31m [ 44%][0m
tests/distributions/test_shape_utils.py::TestSizeShapeDimsObserved::test_param_and_batch_shape_combos[shape-batch_shape0-param_shape1] [32mPASSED[0m[31m [ 44%][0m
tests/distributions/test_shape_utils.py::TestSizeShapeDimsObserved::test_param_and_batch_shape_combos[shape-batch_shape1-param_shape0] [32mPASSED[0m[31m [ 44%][0m
tests/distributions/test_shape_utils.py::TestSizeShapeDimsObserved::test_param_and_batch_shape_combos[shape-batch_shape1-param_shape1] [32mPASSED[0m[31m [ 44%][0m
tests/distributions/test_shape_utils.py::TestSizeShapeDimsObserved::test_param_and_batch_shape_combos[dims-batch_shape0-param_shape0] [32mPASSED[0m[31m [ 44%][0m
tests/distributions/test_shape_utils.py::TestSizeShapeDimsObserved::test_param_and_batch_shape_combos[dims-batch_shape0-param_shape1] [32mPASSED[0m[31m [ 44%][0m
tests/distributions/test_shape_utils.py::TestSizeShapeDimsObserved::test_param_and_batch_shape_combos[dims-batch_shape1-param_shape0] [32mPASSED[0m[31m [ 45%][0m
tests/distributions/test_shape_utils.py::TestSizeShapeDimsObserved::test_param_and_batch_shape_combos[dims-batch_shape1-param_shape1] [32mPASSED[0m[31m [ 45%][0m
tests/distributions/test_shape_utils.py::TestSizeShapeDimsObserved::test_param_and_batch_shape_combos[size-batch_shape0-param_shape0] [32mPASSED[0m[31m [ 45%][0m
tests/distributions/test_shape_utils.py::TestSizeShapeDimsObserved::test_param_and_batch_shape_combos[size-batch_shape0-param_shape1] [32mPASSED[0m[31m [ 45%][0m
tests/distributions/test_shape_utils.py::TestSizeShapeDimsObserved::test_param_and_batch_shape_combos[size-batch_shape1-param_shape0] [32mPASSED[0m[31m [ 45%][0m
tests/distributions/test_shape_utils.py::TestSizeShapeDimsObserved::test_param_and_batch_shape_combos[size-batch_shape1-param_shape1] [32mPASSED[0m[31m [ 45%][0m
tests/distributions/test_shape_utils.py::TestSizeShapeDimsObserved::test_broadcast_by_dims [32mPASSED[0m[31m [ 45%][0m
tests/distributions/test_shape_utils.py::TestSizeShapeDimsObserved::test_broadcast_by_observed [32mPASSED[0m[31m [ 45%][0m
tests/distributions/test_shape_utils.py::TestSizeShapeDimsObserved::test_simultaneous_shape_and_dims [32mPASSED[0m[31m [ 45%][0m
tests/distributions/test_shape_utils.py::TestSizeShapeDimsObserved::test_simultaneous_size_and_dims [32mPASSED[0m[31m [ 45%][0m
tests/distributions/test_shape_utils.py::TestSizeShapeDimsObserved::test_simultaneous_dims_and_observed [32mPASSED[0m[31m [ 45%][0m
tests/distributions/test_shape_utils.py::TestSizeShapeDimsObserved::test_define_dims_on_the_fly_raises [32mPASSED[0m[31m [ 45%][0m
tests/distributions/test_shape_utils.py::TestSizeShapeDimsObserved::test_can_resize_data_defined_size [32mPASSED[0m[31m [ 45%][0m
tests/distributions/test_shape_utils.py::TestSizeShapeDimsObserved::test_size32_doesnt_break_broadcasting [32mPASSED[0m[31m [ 45%][0m
tests/distributions/test_shape_utils.py::TestSizeShapeDimsObserved::test_observed_with_column_vector [32mPASSED[0m[31m [ 45%][0m
tests/distributions/test_shape_utils.py::TestSizeShapeDimsObserved::test_dist_api_works [32mPASSED[0m[31m [ 45%][0m
tests/distributions/test_shape_utils.py::TestSizeShapeDimsObserved::test_mvnormal_shape_size_difference [32mPASSED[0m[31m [ 45%][0m
tests/distributions/test_shape_utils.py::TestSizeShapeDimsObserved::test_convert_dims [32mPASSED[0m[31m [ 45%][0m
tests/distributions/test_shape_utils.py::TestSizeShapeDimsObserved::test_convert_dims_with_ellipsis [32mPASSED[0m[31m [ 45%][0m
tests/distributions/test_shape_utils.py::TestSizeShapeDimsObserved::test_convert_shape [32mPASSED[0m[31m [ 45%][0m
tests/distributions/test_shape_utils.py::TestSizeShapeDimsObserved::test_convert_size [32mPASSED[0m[31m [ 45%][0m
tests/distributions/test_shape_utils.py::TestSizeShapeDimsObserved::test_lazy_flavors [32mPASSED[0m[31m [ 45%][0m
tests/distributions/test_shape_utils.py::TestSizeShapeDimsObserved::test_invalid_flavors [32mPASSED[0m[31m [ 45%][0m
tests/distributions/test_shape_utils.py::TestSizeShapeDimsObserved::test_size_from_dims_rng_update [32mPASSED[0m[31m [ 45%][0m
tests/distributions/test_shape_utils.py::TestSizeShapeDimsObserved::test_size_from_observed_rng_update [32mPASSED[0m[31m [ 45%][0m
tests/distributions/test_shape_utils.py::TestSizeShapeDimsObserved::test_explicit_size_shape_none [32mPASSED[0m[31m [ 45%][0m
tests/distributions/test_shape_utils.py::test_rv_size_is_none [32mPASSED[0m[31m     [ 45%][0m
tests/distributions/test_shape_utils.py::test_change_rv_size [32mPASSED[0m[31m      [ 45%][0m
tests/distributions/test_shape_utils.py::test_change_rv_size_expand_none_size [32mPASSED[0m[31m [ 45%][0m
tests/distributions/test_shape_utils.py::test_change_rv_size_default_update [32mPASSED[0m[31m [ 45%][0m
tests/distributions/test_shape_utils.py::test_change_specify_shape_size_univariate [32mPASSED[0m[31m [ 45%][0m
tests/distributions/test_shape_utils.py::test_change_specify_shape_size_multivariate [32mPASSED[0m[31m [ 45%][0m
tests/distributions/test_shape_utils.py::test_get_support_shape_1d[shape-10-None-0-10-True] [32mPASSED[0m[31m [ 45%][0m
tests/distributions/test_shape_utils.py::test_get_support_shape_1d[shape-10-None-1-10-True] [32mPASSED[0m[31m [ 45%][0m
tests/distributions/test_shape_utils.py::test_get_support_shape_1d[shape-None-shape2-0-10-True] [32mPASSED[0m[31m [ 45%][0m
tests/distributions/test_shape_utils.py::test_get_support_shape_1d[shape-None-shape3-1-9-True] [32mPASSED[0m[31m [ 45%][0m
tests/distributions/test_shape_utils.py::test_get_support_shape_1d[shape-None-shape4-0-5-True] [32mPASSED[0m[31m [ 45%][0m
tests/distributions/test_shape_utils.py::test_get_support_shape_1d[shape-None-None-0-None-True] [32mPASSED[0m[31m [ 46%][0m
tests/distributions/test_shape_utils.py::test_get_support_shape_1d[shape-10-shape6-0-10-True] [32mPASSED[0m[31m [ 46%][0m
tests/distributions/test_shape_utils.py::test_get_support_shape_1d[shape-10-shape7-1-10-True] [32mPASSED[0m[31m [ 46%][0m
tests/distributions/test_shape_utils.py::test_get_support_shape_1d[shape-10-shape8-0-5-False] [32mPASSED[0m[31m [ 46%][0m
tests/distributions/test_shape_utils.py::test_get_support_shape_1d[shape-10-shape9-1-9-False] [32mPASSED[0m[31m [ 46%][0m
tests/distributions/test_shape_utils.py::test_get_support_shape_1d[dims-10-None-0-10-True] [32mPASSED[0m[31m [ 46%][0m
tests/distributions/test_shape_utils.py::test_get_support_shape_1d[dims-10-None-1-10-True] [32mPASSED[0m[31m [ 46%][0m
tests/distributions/test_shape_utils.py::test_get_support_shape_1d[dims-None-shape2-0-10-True] [32mPASSED[0m[31m [ 46%][0m
tests/distributions/test_shape_utils.py::test_get_support_shape_1d[dims-None-shape3-1-9-True] [32mPASSED[0m[31m [ 46%][0m
tests/distributions/test_shape_utils.py::test_get_support_shape_1d[dims-None-shape4-0-5-True] [32mPASSED[0m[31m [ 46%][0m
tests/distributions/test_shape_utils.py::test_get_support_shape_1d[dims-None-None-0-None-True] [32mPASSED[0m[31m [ 46%][0m
tests/distributions/test_shape_utils.py::test_get_support_shape_1d[dims-10-shape6-0-10-True] [32mPASSED[0m[31m [ 46%][0m
tests/distributions/test_shape_utils.py::test_get_support_shape_1d[dims-10-shape7-1-10-True] [32mPASSED[0m[31m [ 46%][0m
tests/distributions/test_shape_utils.py::test_get_support_shape_1d[dims-10-shape8-0-5-False] [32mPASSED[0m[31m [ 46%][0m
tests/distributions/test_shape_utils.py::test_get_support_shape_1d[dims-10-shape9-1-9-False] [32mPASSED[0m[31m [ 46%][0m
tests/distributions/test_shape_utils.py::test_get_support_shape_1d[observed-10-None-0-10-True] [32mPASSED[0m[31m [ 46%][0m
tests/distributions/test_shape_utils.py::test_get_support_shape_1d[observed-10-None-1-10-True] [32mPASSED[0m[31m [ 46%][0m
tests/distributions/test_shape_utils.py::test_get_support_shape_1d[observed-None-shape2-0-10-True] [32mPASSED[0m[31m [ 46%][0m
tests/distributions/test_shape_utils.py::test_get_support_shape_1d[observed-None-shape3-1-9-True] [32mPASSED[0m[31m [ 46%][0m
tests/distributions/test_shape_utils.py::test_get_support_shape_1d[observed-None-shape4-0-5-True] [32mPASSED[0m[31m [ 46%][0m
tests/distributions/test_shape_utils.py::test_get_support_shape_1d[observed-None-None-0-None-True] [32mPASSED[0m[31m [ 46%][0m
tests/distributions/test_shape_utils.py::test_get_support_shape_1d[observed-10-shape6-0-10-True] [32mPASSED[0m[31m [ 46%][0m
tests/distributions/test_shape_utils.py::test_get_support_shape_1d[observed-10-shape7-1-10-True] [32mPASSED[0m[31m [ 46%][0m
tests/distributions/test_shape_utils.py::test_get_support_shape_1d[observed-10-shape8-0-5-False] [32mPASSED[0m[31m [ 46%][0m
tests/distributions/test_shape_utils.py::test_get_support_shape_1d[observed-10-shape9-1-9-False] [32mPASSED[0m[31m [ 46%][0m
tests/distributions/test_shape_utils.py::test_get_support_shape[shape-support_shape0-None-support_shape_offset0-expected_support_shape0-1-True] [32mPASSED[0m[31m [ 46%][0m
tests/distributions/test_shape_utils.py::test_get_support_shape[shape-support_shape1-None-support_shape_offset1-expected_support_shape1-1-True] [32mPASSED[0m[31m [ 46%][0m
tests/distributions/test_shape_utils.py::test_get_support_shape[shape-None-shape2-support_shape_offset2-5-1-True] [32mPASSED[0m[31m [ 46%][0m
tests/distributions/test_shape_utils.py::test_get_support_shape[shape-None-shape3-support_shape_offset3-4-1-True] [32mPASSED[0m[31m [ 46%][0m
tests/distributions/test_shape_utils.py::test_get_support_shape[shape-None-shape4-support_shape_offset4-2-1-True] [32mPASSED[0m[31m [ 46%][0m
tests/distributions/test_shape_utils.py::test_get_support_shape[shape-None-None-None-None-1-True] [32mPASSED[0m[31m [ 46%][0m
tests/distributions/test_shape_utils.py::test_get_support_shape[shape-support_shape6-shape6-None-expected_support_shape6-2-True] [32mPASSED[0m[31m [ 46%][0m
tests/distributions/test_shape_utils.py::test_get_support_shape[shape-support_shape7-shape7-None-expected_support_shape7-2-True] [32mPASSED[0m[31m [ 46%][0m
tests/distributions/test_shape_utils.py::test_get_support_shape[shape-None-shape8-support_shape_offset8-expected_support_shape8-3-True] [32mPASSED[0m[31m [ 46%][0m
tests/distributions/test_shape_utils.py::test_get_support_shape[shape-support_shape9-shape9-support_shape_offset9-expected_support_shape9-1-False] [32mPASSED[0m[31m [ 46%][0m
tests/distributions/test_shape_utils.py::test_get_support_shape[shape-support_shape10-shape10-support_shape_offset10-expected_support_shape10-2-False] [32mPASSED[0m[31m [ 46%][0m
tests/distributions/test_shape_utils.py::test_get_support_shape[dims-support_shape0-None-support_shape_offset0-expected_support_shape0-1-True] [32mPASSED[0m[31m [ 46%][0m
tests/distributions/test_shape_utils.py::test_get_support_shape[dims-support_shape1-None-support_shape_offset1-expected_support_shape1-1-True] [32mPASSED[0m[31m [ 47%][0m
tests/distributions/test_shape_utils.py::test_get_support_shape[dims-None-shape2-support_shape_offset2-5-1-True] [32mPASSED[0m[31m [ 47%][0m
tests/distributions/test_shape_utils.py::test_get_support_shape[dims-None-shape3-support_shape_offset3-4-1-True] [32mPASSED[0m[31m [ 47%][0m
tests/distributions/test_shape_utils.py::test_get_support_shape[dims-None-shape4-support_shape_offset4-2-1-True] [32mPASSED[0m[31m [ 47%][0m
tests/distributions/test_shape_utils.py::test_get_support_shape[dims-None-None-None-None-1-True] [32mPASSED[0m[31m [ 47%][0m
tests/distributions/test_shape_utils.py::test_get_support_shape[dims-support_shape6-shape6-None-expected_support_shape6-2-True] [32mPASSED[0m[31m [ 47%][0m
tests/distributions/test_shape_utils.py::test_get_support_shape[dims-support_shape7-shape7-None-expected_support_shape7-2-True] [32mPASSED[0m[31m [ 47%][0m
tests/distributions/test_shape_utils.py::test_get_support_shape[dims-None-shape8-support_shape_offset8-expected_support_shape8-3-True] [32mPASSED[0m[31m [ 47%][0m
tests/distributions/test_shape_utils.py::test_get_support_shape[dims-support_shape9-shape9-support_shape_offset9-expected_support_shape9-1-False] [32mPASSED[0m[31m [ 47%][0m
tests/distributions/test_shape_utils.py::test_get_support_shape[dims-support_shape10-shape10-support_shape_offset10-expected_support_shape10-2-False] [32mPASSED[0m[31m [ 47%][0m
tests/distributions/test_shape_utils.py::test_get_support_shape[observed-support_shape0-None-support_shape_offset0-expected_support_shape0-1-True] [32mPASSED[0m[31m [ 47%][0m
tests/distributions/test_shape_utils.py::test_get_support_shape[observed-support_shape1-None-support_shape_offset1-expected_support_shape1-1-True] [32mPASSED[0m[31m [ 47%][0m
tests/distributions/test_shape_utils.py::test_get_support_shape[observed-None-shape2-support_shape_offset2-5-1-True] [32mPASSED[0m[31m [ 47%][0m
tests/distributions/test_shape_utils.py::test_get_support_shape[observed-None-shape3-support_shape_offset3-4-1-True] [32mPASSED[0m[31m [ 47%][0m
tests/distributions/test_shape_utils.py::test_get_support_shape[observed-None-shape4-support_shape_offset4-2-1-True] [32mPASSED[0m[31m [ 47%][0m
tests/distributions/test_shape_utils.py::test_get_support_shape[observed-None-None-None-None-1-True] [32mPASSED[0m[31m [ 47%][0m
tests/distributions/test_shape_utils.py::test_get_support_shape[observed-support_shape6-shape6-None-expected_support_shape6-2-True] [32mPASSED[0m[31m [ 47%][0m
tests/distributions/test_shape_utils.py::test_get_support_shape[observed-support_shape7-shape7-None-expected_support_shape7-2-True] [32mPASSED[0m[31m [ 47%][0m
tests/distributions/test_shape_utils.py::test_get_support_shape[observed-None-shape8-support_shape_offset8-expected_support_shape8-3-True] [32mPASSED[0m[31m [ 47%][0m
tests/distributions/test_shape_utils.py::test_get_support_shape[observed-support_shape9-shape9-support_shape_offset9-expected_support_shape9-1-False] [32mPASSED[0m[31m [ 47%][0m
tests/distributions/test_shape_utils.py::test_get_support_shape[observed-support_shape10-shape10-support_shape_offset10-expected_support_shape10-2-False] [32mPASSED[0m[31m [ 47%][0m
tests/distributions/test_shape_utils.py::test_implicit_size_from_params [32mPASSED[0m[31m [ 47%][0m
tests/distributions/test_simulator.py::TestSimulator::test_one_gaussian [32mPASSED[0m[31m [ 47%][0m
tests/distributions/test_simulator.py::TestSimulator::test_custom_dist_sum_stat[float32] [33mXFAIL[0m[31m [ 47%][0m
tests/distributions/test_simulator.py::TestSimulator::test_custom_dist_sum_stat[float64] [32mPASSED[0m[31m [ 47%][0m
tests/distributions/test_simulator.py::TestSimulator::test_custom_dist_sum_stat_scalar[float32] [32mPASSED[0m[31m [ 47%][0m
tests/distributions/test_simulator.py::TestSimulator::test_custom_dist_sum_stat_scalar[float64] [32mPASSED[0m[31m [ 47%][0m
tests/distributions/test_simulator.py::TestSimulator::test_model_with_potential [32mPASSED[0m[31m [ 47%][0m
tests/distributions/test_simulator.py::TestSimulator::test_simulator_metropolis_mcmc [32mPASSED[0m[31m [ 47%][0m
tests/distributions/test_simulator.py::TestSimulator::test_multiple_simulators [32mPASSED[0m[31m [ 47%][0m
tests/distributions/test_simulator.py::TestSimulator::test_nested_simulators [32mPASSED[0m[31m [ 47%][0m
tests/distributions/test_simulator.py::TestSimulator::test_upstream_rngs_not_in_compiled_logp [32mPASSED[0m[31m [ 47%][0m
tests/distributions/test_simulator.py::TestSimulator::test_simulator_error_msg [32mPASSED[0m[31m [ 47%][0m
tests/distributions/test_simulator.py::TestSimulator::test_automatic_use_of_sort [33mXFAIL[0m[31m [ 47%][0m
tests/distributions/test_simulator.py::TestSimulator::test_name_is_string_type [32mPASSED[0m[31m [ 47%][0m
tests/distributions/test_simulator.py::TestSimulator::test_named_model [32mPASSED[0m[31m [ 47%][0m
tests/distributions/test_simulator.py::TestSimulator::test_simulator_support_point[None-1-0] [32mPASSED[0m[31m [ 48%][0m
tests/distributions/test_simulator.py::TestSimulator::test_simulator_support_point[None-1-[0 1 2]] [32mPASSED[0m[31m [ 48%][0m
tests/distributions/test_simulator.py::TestSimulator::test_simulator_support_point[None-[1 2 5]-0] [32mPASSED[0m[31m [ 48%][0m
tests/distributions/test_simulator.py::TestSimulator::test_simulator_support_point[None-[1 2 5]-[0 1 2]] [32mPASSED[0m[31m [ 48%][0m
tests/distributions/test_simulator.py::TestSimulator::test_simulator_support_point[3-1-0] [32mPASSED[0m[31m [ 48%][0m
tests/distributions/test_simulator.py::TestSimulator::test_simulator_support_point[3-1-[0 1 2]] [32mPASSED[0m[31m [ 48%][0m
tests/distributions/test_simulator.py::TestSimulator::test_simulator_support_point[3-[1 2 5]-0] [32mPASSED[0m[31m [ 48%][0m
tests/distributions/test_simulator.py::TestSimulator::test_simulator_support_point[3-[1 2 5]-[0 1 2]] [32mPASSED[0m[31m [ 48%][0m
tests/distributions/test_simulator.py::TestSimulator::test_simulator_support_point[(5, 3)-1-0] [32mPASSED[0m[31m [ 48%][0m
tests/distributions/test_simulator.py::TestSimulator::test_simulator_support_point[(5, 3)-1-[0 1 2]] [32mPASSED[0m[31m [ 48%][0m
tests/distributions/test_simulator.py::TestSimulator::test_simulator_support_point[(5, 3)-[1 2 5]-0] [32mPASSED[0m[31m [ 48%][0m
tests/distributions/test_simulator.py::TestSimulator::test_simulator_support_point[(5, 3)-[1 2 5]-[0 1 2]] [32mPASSED[0m[31m [ 48%][0m
tests/distributions/test_simulator.py::TestSimulator::test_dist [32mPASSED[0m[31m   [ 48%][0m
tests/distributions/test_timeseries.py::TestRandomWalk::test_dists_types [32mPASSED[0m[31m [ 48%][0m
tests/distributions/test_timeseries.py::TestRandomWalk::test_dists_not_registered_check [32mPASSED[0m[31m [ 48%][0m
tests/distributions/test_timeseries.py::TestRandomWalk::test_dists_independent_check [32mPASSED[0m[31m [ 48%][0m
tests/distributions/test_timeseries.py::TestRandomWalk::test_dist_sizes[init_dist0-innovation_dist0-1-None-None-1-1-rw_shape0] [32mPASSED[0m[31m [ 48%][0m
tests/distributions/test_timeseries.py::TestRandomWalk::test_dist_sizes[init_dist1-innovation_dist1-1-None-shape1-1-1-rw_shape1] [32mPASSED[0m[31m [ 48%][0m
tests/distributions/test_timeseries.py::TestRandomWalk::test_dist_sizes[init_dist2-innovation_dist2-3-size2-None-5-15-rw_shape2] [32mPASSED[0m[31m [ 48%][0m
tests/distributions/test_timeseries.py::TestRandomWalk::test_dist_sizes[init_dist3-innovation_dist3-3-None-shape3-5-15-rw_shape3] [32mPASSED[0m[31m [ 48%][0m
tests/distributions/test_timeseries.py::TestRandomWalk::test_dist_sizes[init_dist4-innovation_dist4-1-None-None-3-3-rw_shape4] [32mPASSED[0m[31m [ 48%][0m
tests/distributions/test_timeseries.py::TestRandomWalk::test_dist_sizes[init_dist5-innovation_dist5-4-None-None-6-24-rw_shape5] [32mPASSED[0m[31m [ 48%][0m
tests/distributions/test_timeseries.py::TestRandomWalk::test_dist_sizes[init_dist6-innovation_dist6-4-None-None-6-24-rw_shape6] [32mPASSED[0m[31m [ 48%][0m
tests/distributions/test_timeseries.py::TestRandomWalk::test_dist_sizes[init_dist7-innovation_dist7-1-None-None-3-3-rw_shape7] [32mPASSED[0m[31m [ 48%][0m
tests/distributions/test_timeseries.py::TestRandomWalk::test_dist_sizes[init_dist8-innovation_dist8-1-None-shape8-3-3-rw_shape8] [32mPASSED[0m[31m [ 48%][0m
tests/distributions/test_timeseries.py::TestRandomWalk::test_dist_sizes[init_dist9-innovation_dist9-4-size9-None-18-72-rw_shape9] [32mPASSED[0m[31m [ 48%][0m
tests/distributions/test_timeseries.py::TestRandomWalk::test_dist_sizes[init_dist10-innovation_dist10-4-None-shape10-18-72-rw_shape10] [32mPASSED[0m[31m [ 48%][0m
tests/distributions/test_timeseries.py::TestRandomWalk::test_dist_sizes[init_dist11-innovation_dist11-1-None-None-12-12-rw_shape11] [32mPASSED[0m[31m [ 48%][0m
tests/distributions/test_timeseries.py::TestRandomWalk::test_dist_sizes[init_dist12-innovation_dist12-4-None-None-6-24-rw_shape12] [32mPASSED[0m[31m [ 48%][0m
tests/distributions/test_timeseries.py::TestRandomWalk::test_change_size_univariate [32mPASSED[0m[31m [ 48%][0m
tests/distributions/test_timeseries.py::TestRandomWalk::test_change_size_multivariate [32mPASSED[0m[31m [ 48%][0m
tests/distributions/test_timeseries.py::TestRandomWalk::test_infer_steps[shape-init_dist0-innovation_dist0-shape0-2] [32mPASSED[0m[31m [ 48%][0m
tests/distributions/test_timeseries.py::TestRandomWalk::test_infer_steps[shape-init_dist1-innovation_dist1-shape1-4] [32mPASSED[0m[31m [ 48%][0m
tests/distributions/test_timeseries.py::TestRandomWalk::test_infer_steps[dims-init_dist0-innovation_dist0-shape0-2] [32mPASSED[0m[31m [ 48%][0m
tests/distributions/test_timeseries.py::TestRandomWalk::test_infer_steps[dims-init_dist1-innovation_dist1-shape1-4] [32mPASSED[0m[31m [ 48%][0m
tests/distributions/test_timeseries.py::TestRandomWalk::test_infer_steps[observed-init_dist0-innovation_dist0-shape0-2] [32mPASSED[0m[31m [ 48%][0m
tests/distributions/test_timeseries.py::TestRandomWalk::test_infer_steps[observed-init_dist1-innovation_dist1-shape1-4] [32mPASSED[0m[31m [ 48%][0m
tests/distributions/test_timeseries.py::TestRandomWalk::test_infer_steps_error [32mPASSED[0m[31m [ 49%][0m
tests/distributions/test_timeseries.py::TestRandomWalk::test_inconsistent_steps_and_shape[init_dist0-innovation_dist0-12-shape0] [32mPASSED[0m[31m [ 49%][0m
tests/distributions/test_timeseries.py::TestRandomWalk::test_inconsistent_steps_and_shape[init_dist1-innovation_dist1-12-shape1] [32mPASSED[0m[31m [ 49%][0m
tests/distributions/test_timeseries.py::TestRandomWalk::test_init_logp_univariate[init_dist0] [32mPASSED[0m[31m [ 49%][0m
tests/distributions/test_timeseries.py::TestRandomWalk::test_init_logp_univariate[init_dist1] [32mPASSED[0m[31m [ 49%][0m
tests/distributions/test_timeseries.py::TestRandomWalk::test_init_logp_multivariate[init_dist0] [32mPASSED[0m[31m [ 49%][0m
tests/distributions/test_timeseries.py::TestRandomWalk::test_init_logp_multivariate[init_dist1] [32mPASSED[0m[31m [ 49%][0m
tests/distributions/test_timeseries.py::TestRandomWalk::test_innovation_logp_univariate [32mPASSED[0m[31m [ 49%][0m
tests/distributions/test_timeseries.py::TestRandomWalk::test_innovation_logp_multivariate [32mPASSED[0m[31m [ 49%][0m
tests/distributions/test_timeseries.py::TestRandomWalk::test_support_point[init_dist0-innovation_dist0-9-None-expected0-True] [32mPASSED[0m[31m [ 49%][0m
tests/distributions/test_timeseries.py::TestRandomWalk::test_support_point[init_dist1-innovation_dist1-9-size1-expected1-True] [32mPASSED[0m[31m [ 49%][0m
tests/distributions/test_timeseries.py::TestRandomWalk::test_support_point[init_dist2-innovation_dist2-9-None-expected2-True] [32mPASSED[0m[31m [ 49%][0m
tests/distributions/test_timeseries.py::TestRandomWalk::test_support_point[init_dist3-innovation_dist3-9-None-expected3-True] [32mPASSED[0m[31m [ 49%][0m
tests/distributions/test_timeseries.py::TestRandomWalk::test_support_point[init_dist4-innovation_dist4-9-size4-expected4-False] [32mPASSED[0m[31m [ 49%][0m
tests/distributions/test_timeseries.py::TestPredefinedRandomWalk::test_gaussian [32mPASSED[0m[31m [ 49%][0m
tests/distributions/test_timeseries.py::TestPredefinedRandomWalk::test_gaussian_inference [32mPASSED[0m[31m [ 49%][0m
tests/distributions/test_timeseries.py::TestPredefinedRandomWalk::test_mvgaussian[cov] [32mPASSED[0m[31m [ 49%][0m
tests/distributions/test_timeseries.py::TestPredefinedRandomWalk::test_mvgaussian[chol] [32mPASSED[0m[31m [ 49%][0m
tests/distributions/test_timeseries.py::TestPredefinedRandomWalk::test_mvgaussian[tau] [32mPASSED[0m[31m [ 49%][0m
tests/distributions/test_timeseries.py::TestPredefinedRandomWalk::test_mvgaussian_with_chol_cov_rv[chol] [32mPASSED[0m[31m [ 49%][0m
tests/distributions/test_timeseries.py::TestPredefinedRandomWalk::test_mvgaussian_with_chol_cov_rv[cov] [32mPASSED[0m[31m [ 49%][0m
tests/distributions/test_timeseries.py::TestPredefinedRandomWalk::test_mvstudentt[scale] [32mPASSED[0m[31m [ 49%][0m
tests/distributions/test_timeseries.py::TestPredefinedRandomWalk::test_mvstudentt[chol] [32mPASSED[0m[31m [ 49%][0m
tests/distributions/test_timeseries.py::TestPredefinedRandomWalk::test_mvstudentt[tau] [32mPASSED[0m[31m [ 49%][0m
tests/distributions/test_timeseries.py::TestAR::test_order1_logp [32mPASSED[0m[31m  [ 49%][0m
tests/distributions/test_timeseries.py::TestAR::test_order2_logp [32mPASSED[0m[31m  [ 49%][0m
tests/distributions/test_timeseries.py::TestAR::test_batched_size[False] [32mPASSED[0m[31m [ 49%][0m
tests/distributions/test_timeseries.py::TestAR::test_batched_size[True] [32mPASSED[0m[31m [ 49%][0m
tests/distributions/test_timeseries.py::TestAR::test_batched_rhos [32mPASSED[0m[31m [ 49%][0m
tests/distributions/test_timeseries.py::TestAR::test_batched_sigma [32mPASSED[0m[31m [ 49%][0m
tests/distributions/test_timeseries.py::TestAR::test_batched_init_dist [32mPASSED[0m[31m [ 49%][0m
tests/distributions/test_timeseries.py::TestAR::test_constant_random [32mPASSED[0m[31m [ 49%][0m
tests/distributions/test_timeseries.py::TestAR::test_multivariate_init_dist [32mPASSED[0m[31m [ 49%][0m
tests/distributions/test_timeseries.py::TestAR::test_support_point[None-expected0] [32mPASSED[0m[31m [ 49%][0m
tests/distributions/test_timeseries.py::TestAR::test_support_point[size1-expected1] [32mPASSED[0m[31m [ 49%][0m
tests/distributions/test_timeseries.py::TestAR::test_change_dist_size [32mPASSED[0m[31m [ 49%][0m
tests/distributions/test_timeseries.py::TestGARCH11::test_logp [32mPASSED[0m[31m    [ 49%][0m
tests/distributions/test_timeseries.py::TestGARCH11::test_batched_size[True-omega] [32mPASSED[0m[31m [ 50%][0m
tests/distributions/test_timeseries.py::TestGARCH11::test_batched_size[True-alpha_1] [32mPASSED[0m[31m [ 50%][0m
tests/distributions/test_timeseries.py::TestGARCH11::test_batched_size[True-beta_1] [32mPASSED[0m[31m [ 50%][0m
tests/distributions/test_timeseries.py::TestGARCH11::test_batched_size[True-initial_vol] [32mPASSED[0m[31m [ 50%][0m
tests/distributions/test_timeseries.py::TestGARCH11::test_batched_size[False-omega] [32mPASSED[0m[31m [ 50%][0m
tests/distributions/test_timeseries.py::TestGARCH11::test_batched_size[False-alpha_1] [32mPASSED[0m[31m [ 50%][0m
tests/distributions/test_timeseries.py::TestGARCH11::test_batched_size[False-beta_1] [32mPASSED[0m[31m [ 50%][0m
tests/distributions/test_timeseries.py::TestGARCH11::test_batched_size[False-initial_vol] [32mPASSED[0m[31m [ 50%][0m
tests/distributions/test_timeseries.py::TestGARCH11::test_support_point[None-expected0] [32mPASSED[0m[31m [ 50%][0m
tests/distributions/test_timeseries.py::TestGARCH11::test_support_point[size1-expected1] [32mPASSED[0m[31m [ 50%][0m
tests/distributions/test_timeseries.py::TestGARCH11::test_change_dist_size [32mPASSED[0m[31m [ 50%][0m
tests/distributions/test_timeseries.py::TestEulerMaruyama::test_batched_size[True-1] [32mPASSED[0m[31m [ 50%][0m
tests/distributions/test_timeseries.py::TestEulerMaruyama::test_batched_size[True-2] [32mPASSED[0m[31m [ 50%][0m
tests/distributions/test_timeseries.py::TestEulerMaruyama::test_batched_size[False-1] [32mPASSED[0m[31m [ 50%][0m
tests/distributions/test_timeseries.py::TestEulerMaruyama::test_batched_size[False-2] [32mPASSED[0m[31m [ 50%][0m
tests/distributions/test_timeseries.py::TestEulerMaruyama::test_change_dist_size1 [32mPASSED[0m[31m [ 50%][0m
tests/distributions/test_timeseries.py::TestEulerMaruyama::test_change_dist_size2 [32mPASSED[0m[31m [ 50%][0m
tests/distributions/test_timeseries.py::TestEulerMaruyama::test_linear_model [32mPASSED[0m[31m [ 50%][0m
tests/distributions/test_transform.py::test_simplex [32mPASSED[0m[31m               [ 50%][0m
tests/distributions/test_transform.py::test_simplex_bounds [32mPASSED[0m[31m        [ 50%][0m
tests/distributions/test_transform.py::test_simplex_accuracy [32mPASSED[0m[31m      [ 50%][0m
tests/distributions/test_transform.py::test_sum_to_1 [32mPASSED[0m[31m              [ 50%][0m
tests/distributions/test_transform.py::test_log [32mPASSED[0m[31m                   [ 50%][0m
tests/distributions/test_transform.py::test_log_exp_m1 [32mPASSED[0m[31m            [ 50%][0m
tests/distributions/test_transform.py::test_logodds [32mPASSED[0m[31m               [ 50%][0m
tests/distributions/test_transform.py::test_lowerbound [32mPASSED[0m[31m            [ 50%][0m
tests/distributions/test_transform.py::test_upperbound [32mPASSED[0m[31m            [ 50%][0m
tests/distributions/test_transform.py::test_interval [32mPASSED[0m[31m              [ 50%][0m
tests/distributions/test_transform.py::test_interval_near_boundary [32mPASSED[0m[31m [ 50%][0m
tests/distributions/test_transform.py::test_circular [32mPASSED[0m[31m              [ 50%][0m
tests/distributions/test_transform.py::test_ordered [32mPASSED[0m[31m               [ 50%][0m
tests/distributions/test_transform.py::test_chain_values [32mPASSED[0m[31m          [ 50%][0m
tests/distributions/test_transform.py::test_chain_vector_transform [32mPASSED[0m[31m [ 50%][0m
tests/distributions/test_transform.py::test_chain_jacob_det [33mXFAIL[0m (Fails
due to precision issue. Values just close to expected.)[31m                  [ 50%][0m
tests/distributions/test_transform.py::TestElementWiseLogp::test_half_normal[2.5-2] [32mPASSED[0m[31m [ 50%][0m
tests/distributions/test_transform.py::TestElementWiseLogp::test_half_normal[5.0-size1] [32mPASSED[0m[31m [ 50%][0m
tests/distributions/test_transform.py::TestElementWiseLogp::test_half_normal[sigma2-size2] [32mPASSED[0m[31m [ 50%][0m
tests/distributions/test_transform.py::TestElementWiseLogp::test_exponential[2.5-2] [32mPASSED[0m[31m [ 51%][0m
tests/distributions/test_transform.py::TestElementWiseLogp::test_exponential[5.0-size1] [32mPASSED[0m[31m [ 51%][0m
tests/distributions/test_transform.py::TestElementWiseLogp::test_exponential[lam2-size2] [32mPASSED[0m[31m [ 51%][0m
tests/distributions/test_transform.py::TestElementWiseLogp::test_beta[1.0-1.0-2] [32mPASSED[0m[31m [ 51%][0m
tests/distributions/test_transform.py::TestElementWiseLogp::test_beta[0.5-0.5-size1] [32mPASSED[0m[31m [ 51%][0m
tests/distributions/test_transform.py::TestElementWiseLogp::test_beta[a2-b2-size2] [32mPASSED[0m[31m [ 51%][0m
tests/distributions/test_transform.py::TestElementWiseLogp::test_uniform[0.0-1.0-2] [32mPASSED[0m[31m [ 51%][0m
tests/distributions/test_transform.py::TestElementWiseLogp::test_uniform[0.5-5.5-size1] [32mPASSED[0m[31m [ 51%][0m
tests/distributions/test_transform.py::TestElementWiseLogp::test_uniform[lower2-upper2-size2] [32mPASSED[0m[31m [ 51%][0m
tests/distributions/test_transform.py::TestElementWiseLogp::test_triangular[0.0-1.0-2.0-2] [32mPASSED[0m[31m [ 51%][0m
tests/distributions/test_transform.py::TestElementWiseLogp::test_triangular[-10-0-200-size1] [32mPASSED[0m[31m [ 51%][0m
tests/distributions/test_transform.py::TestElementWiseLogp::test_triangular[lower2-c2-upper2-size2] [32mPASSED[0m[31m [ 51%][0m
tests/distributions/test_transform.py::TestElementWiseLogp::test_vonmises[0.0-1.0-2] [32mPASSED[0m[31m [ 51%][0m
tests/distributions/test_transform.py::TestElementWiseLogp::test_vonmises[-0.5-5.5-size1] [32mPASSED[0m[31m [ 51%][0m
tests/distributions/test_transform.py::TestElementWiseLogp::test_vonmises[mu2-kappa2-size2] [32mPASSED[0m[31m [ 51%][0m
tests/distributions/test_transform.py::TestElementWiseLogp::test_dirichlet[a0-None] [32mPASSED[0m[31m [ 51%][0m
tests/distributions/test_transform.py::TestElementWiseLogp::test_dirichlet[a1-None] [32mPASSED[0m[31m [ 51%][0m
tests/distributions/test_transform.py::TestElementWiseLogp::test_dirichlet[a2-size2] [32mPASSED[0m[31m [ 51%][0m
tests/distributions/test_transform.py::TestElementWiseLogp::test_normal_ordered [32mPASSED[0m[31m [ 51%][0m
tests/distributions/test_transform.py::TestElementWiseLogp::test_half_normal_ordered[2.5-size0] [32mPASSED[0m[31m [ 51%][0m
tests/distributions/test_transform.py::TestElementWiseLogp::test_half_normal_ordered[sigma1-size1] [32mPASSED[0m[31m [ 51%][0m
tests/distributions/test_transform.py::TestElementWiseLogp::test_exponential_ordered[2.5-size0] [32mPASSED[0m[31m [ 51%][0m
tests/distributions/test_transform.py::TestElementWiseLogp::test_exponential_ordered[lam1-size1] [32mPASSED[0m[31m [ 51%][0m
tests/distributions/test_transform.py::TestElementWiseLogp::test_beta_ordered[1.0-1.0-size0] [32mPASSED[0m[31m [ 51%][0m
tests/distributions/test_transform.py::TestElementWiseLogp::test_beta_ordered[a1-b1-size1] [32mPASSED[0m[31m [ 51%][0m
tests/distributions/test_transform.py::TestElementWiseLogp::test_uniform_ordered[0.0-1.0-size0] [32mPASSED[0m[31m [ 51%][0m
tests/distributions/test_transform.py::TestElementWiseLogp::test_uniform_ordered[lower1-upper1-size1] [32mPASSED[0m[31m [ 51%][0m
tests/distributions/test_transform.py::TestElementWiseLogp::test_vonmises_ordered[0.0-1.0-size0] [32mPASSED[0m[31m [ 51%][0m
tests/distributions/test_transform.py::TestElementWiseLogp::test_vonmises_ordered[mu1-kappa1-size1] [32mPASSED[0m[31m [ 51%][0m
tests/distributions/test_transform.py::TestElementWiseLogp::test_uniform_other[0.0-1.0-size0-transform0] [32mPASSED[0m[31m [ 51%][0m
tests/distributions/test_transform.py::TestElementWiseLogp::test_uniform_other[0.5-5.5-size1-transform1] [32mPASSED[0m[31m [ 51%][0m
tests/distributions/test_transform.py::TestElementWiseLogp::test_uniform_other[lower2-upper2-size2-transform2] [32mPASSED[0m[31m [ 51%][0m
tests/distributions/test_transform.py::TestElementWiseLogp::test_mvnormal_transform[transform0-mu0-cov0-None-shape0] [32mPASSED[0m[31m [ 51%][0m
tests/distributions/test_transform.py::TestElementWiseLogp::test_mvnormal_transform[transform0-mu1-cov1-size1-shape1] [32mPASSED[0m[31m [ 51%][0m
tests/distributions/test_transform.py::TestElementWiseLogp::test_mvnormal_transform[transform1-mu0-cov0-None-shape0] [32mPASSED[0m[31m [ 51%][0m
tests/distributions/test_transform.py::TestElementWiseLogp::test_mvnormal_transform[transform1-mu1-cov1-size1-shape1] [32mPASSED[0m[31m [ 51%][0m
tests/distributions/test_transform.py::test_triangular_transform [32mPASSED[0m[31m  [ 51%][0m
tests/distributions/test_transform.py::test_interval_transform_raises [32mPASSED[0m[31m [ 52%][0m
tests/distributions/test_transform.py::test_discrete_trafo [32mPASSED[0m[31m        [ 52%][0m
tests/distributions/test_transform.py::test_transform_univariate_dist_logp_shape [32mPASSED[0m[31m [ 52%][0m
tests/distributions/test_transform.py::test_univariate_transform_multivariate_dist_raises [32mPASSED[0m[31m [ 52%][0m
tests/distributions/test_transform.py::test_invalid_jacobian_broadcast_raises [32mPASSED[0m[31m [ 52%][0m
tests/distributions/test_truncated.py::test_truncation_specialized_op[shape] [32mPASSED[0m[31m [ 52%][0m
tests/distributions/test_truncated.py::test_truncation_specialized_op[dims] [32mPASSED[0m[31m [ 52%][0m
tests/distributions/test_truncated.py::test_truncation_specialized_op[observed] [32mPASSED[0m[31m [ 52%][0m
tests/distributions/test_truncated.py::test_truncation_continuous_random[False-True-icdf--1-inf] [32mPASSED[0m[31m [ 52%][0m
tests/distributions/test_truncated.py::test_truncation_continuous_random[False-True-icdf--1-1.5] [32mPASSED[0m[31m [ 52%][0m
tests/distributions/test_truncated.py::test_truncation_continuous_random[False-True-icdf--inf-1.5] [32mPASSED[0m[31m [ 52%][0m
tests/distributions/test_truncated.py::test_truncation_continuous_random[False-True-rejection--1-inf] [32mPASSED[0m[31m [ 52%][0m
tests/distributions/test_truncated.py::test_truncation_continuous_random[False-True-rejection--1-1.5] [32mPASSED[0m[31m [ 52%][0m
tests/distributions/test_truncated.py::test_truncation_continuous_random[False-True-rejection--inf-1.5] [32mPASSED[0m[31m [ 52%][0m
tests/distributions/test_truncated.py::test_truncation_continuous_random[False-False-icdf--1-inf] [32mPASSED[0m[31m [ 52%][0m
tests/distributions/test_truncated.py::test_truncation_continuous_random[False-False-icdf--1-1.5] [32mPASSED[0m[31m [ 52%][0m
tests/distributions/test_truncated.py::test_truncation_continuous_random[False-False-icdf--inf-1.5] [32mPASSED[0m[31m [ 52%][0m
tests/distributions/test_truncated.py::test_truncation_continuous_random[False-False-rejection--1-inf] [32mPASSED[0m[31m [ 52%][0m
tests/distributions/test_truncated.py::test_truncation_continuous_random[False-False-rejection--1-1.5] [32mPASSED[0m[31m [ 52%][0m
tests/distributions/test_truncated.py::test_truncation_continuous_random[False-False-rejection--inf-1.5] [32mPASSED[0m[31m [ 52%][0m
tests/distributions/test_truncated.py::test_truncation_continuous_random[True-True-icdf--1-inf] [32mPASSED[0m[31m [ 52%][0m
tests/distributions/test_truncated.py::test_truncation_continuous_random[True-True-icdf--1-1.5] [32mPASSED[0m[31m [ 52%][0m
tests/distributions/test_truncated.py::test_truncation_continuous_random[True-True-icdf--inf-1.5] [32mPASSED[0m[31m [ 52%][0m
tests/distributions/test_truncated.py::test_truncation_continuous_random[True-True-rejection--1-inf] [32mPASSED[0m[31m [ 52%][0m
tests/distributions/test_truncated.py::test_truncation_continuous_random[True-True-rejection--1-1.5] [32mPASSED[0m[31m [ 52%][0m
tests/distributions/test_truncated.py::test_truncation_continuous_random[True-True-rejection--inf-1.5] [32mPASSED[0m[31m [ 52%][0m
tests/distributions/test_truncated.py::test_truncation_continuous_random[True-False-icdf--1-inf] [32mPASSED[0m[31m [ 52%][0m
tests/distributions/test_truncated.py::test_truncation_continuous_random[True-False-icdf--1-1.5] [32mPASSED[0m[31m [ 52%][0m
tests/distributions/test_truncated.py::test_truncation_continuous_random[True-False-icdf--inf-1.5] [32mPASSED[0m[31m [ 52%][0m
tests/distributions/test_truncated.py::test_truncation_continuous_random[True-False-rejection--1-inf] [32mPASSED[0m[31m [ 52%][0m
tests/distributions/test_truncated.py::test_truncation_continuous_random[True-False-rejection--1-1.5] [32mPASSED[0m[31m [ 52%][0m
tests/distributions/test_truncated.py::test_truncation_continuous_random[True-False-rejection--inf-1.5] [32mPASSED[0m[31m [ 52%][0m
tests/distributions/test_truncated.py::test_truncation_continuous_logp[False-icdf--1-inf] [32mPASSED[0m[31m [ 52%][0m
tests/distributions/test_truncated.py::test_truncation_continuous_logp[False-icdf--1-1.5] [32mPASSED[0m[31m [ 52%][0m
tests/distributions/test_truncated.py::test_truncation_continuous_logp[False-icdf--inf-1.5] [32mPASSED[0m[31m [ 52%][0m
tests/distributions/test_truncated.py::test_truncation_continuous_logp[False-rejection--1-inf] [32mPASSED[0m[31m [ 52%][0m
tests/distributions/test_truncated.py::test_truncation_continuous_logp[False-rejection--1-1.5] [32mPASSED[0m[31m [ 53%][0m
tests/distributions/test_truncated.py::test_truncation_continuous_logp[False-rejection--inf-1.5] [32mPASSED[0m[31m [ 53%][0m
tests/distributions/test_truncated.py::test_truncation_continuous_logp[True-icdf--1-inf] [32mPASSED[0m[31m [ 53%][0m
tests/distributions/test_truncated.py::test_truncation_continuous_logp[True-icdf--1-1.5] [32mPASSED[0m[31m [ 53%][0m
tests/distributions/test_truncated.py::test_truncation_continuous_logp[True-icdf--inf-1.5] [32mPASSED[0m[31m [ 53%][0m
tests/distributions/test_truncated.py::test_truncation_continuous_logp[True-rejection--1-inf] [32mPASSED[0m[31m [ 53%][0m
tests/distributions/test_truncated.py::test_truncation_continuous_logp[True-rejection--1-1.5] [32mPASSED[0m[31m [ 53%][0m
tests/distributions/test_truncated.py::test_truncation_continuous_logp[True-rejection--inf-1.5] [32mPASSED[0m[31m [ 53%][0m
tests/distributions/test_truncated.py::test_truncation_continuous_logcdf[False-icdf--1-inf] [32mPASSED[0m[31m [ 53%][0m
tests/distributions/test_truncated.py::test_truncation_continuous_logcdf[False-icdf--1-1.5] [32mPASSED[0m[31m [ 53%][0m
tests/distributions/test_truncated.py::test_truncation_continuous_logcdf[False-icdf--inf-1.5] [32mPASSED[0m[31m [ 53%][0m
tests/distributions/test_truncated.py::test_truncation_continuous_logcdf[False-rejection--1-inf] [32mPASSED[0m[31m [ 53%][0m
tests/distributions/test_truncated.py::test_truncation_continuous_logcdf[False-rejection--1-1.5] [32mPASSED[0m[31m [ 53%][0m
tests/distributions/test_truncated.py::test_truncation_continuous_logcdf[False-rejection--inf-1.5] [32mPASSED[0m[31m [ 53%][0m
tests/distributions/test_truncated.py::test_truncation_continuous_logcdf[True-icdf--1-inf] [32mPASSED[0m[31m [ 53%][0m
tests/distributions/test_truncated.py::test_truncation_continuous_logcdf[True-icdf--1-1.5] [32mPASSED[0m[31m [ 53%][0m
tests/distributions/test_truncated.py::test_truncation_continuous_logcdf[True-icdf--inf-1.5] [32mPASSED[0m[31m [ 53%][0m
tests/distributions/test_truncated.py::test_truncation_continuous_logcdf[True-rejection--1-inf] [32mPASSED[0m[31m [ 53%][0m
tests/distributions/test_truncated.py::test_truncation_continuous_logcdf[True-rejection--1-1.5] [32mPASSED[0m[31m [ 53%][0m
tests/distributions/test_truncated.py::test_truncation_continuous_logcdf[True-rejection--inf-1.5] [32mPASSED[0m[31m [ 53%][0m
tests/distributions/test_truncated.py::test_truncation_discrete_random[icdf-2-inf] [32mPASSED[0m[31m [ 53%][0m
tests/distributions/test_truncated.py::test_truncation_discrete_random[icdf-2-5] [32mPASSED[0m[31m [ 53%][0m
tests/distributions/test_truncated.py::test_truncation_discrete_random[icdf--inf-5] [32mPASSED[0m[31m [ 53%][0m
tests/distributions/test_truncated.py::test_truncation_discrete_random[rejection-2-inf] [32mPASSED[0m[31m [ 53%][0m
tests/distributions/test_truncated.py::test_truncation_discrete_random[rejection-2-5] [32mPASSED[0m[31m [ 53%][0m
tests/distributions/test_truncated.py::test_truncation_discrete_random[rejection--inf-5] [32mPASSED[0m[31m [ 53%][0m
tests/distributions/test_truncated.py::test_truncation_discrete_logp[icdf-2-inf] [32mPASSED[0m[31m [ 53%][0m
tests/distributions/test_truncated.py::test_truncation_discrete_logp[icdf-2-5] [32mPASSED[0m[31m [ 53%][0m
tests/distributions/test_truncated.py::test_truncation_discrete_logp[icdf--inf-5] [32mPASSED[0m[31m [ 53%][0m
tests/distributions/test_truncated.py::test_truncation_discrete_logp[rejection-2-inf] [32mPASSED[0m[31m [ 53%][0m
tests/distributions/test_truncated.py::test_truncation_discrete_logp[rejection-2-5] [32mPASSED[0m[31m [ 53%][0m
tests/distributions/test_truncated.py::test_truncation_discrete_logp[rejection--inf-5] [32mPASSED[0m[31m [ 53%][0m
tests/distributions/test_truncated.py::test_truncation_discrete_logcdf[icdf-2-inf] [32mPASSED[0m[31m [ 53%][0m
tests/distributions/test_truncated.py::test_truncation_discrete_logcdf[icdf-2-5] [32mPASSED[0m[31m [ 53%][0m
tests/distributions/test_truncated.py::test_truncation_discrete_logcdf[icdf--inf-5] [32mPASSED[0m[31m [ 53%][0m
tests/distributions/test_truncated.py::test_truncation_discrete_logcdf[rejection-2-inf] [32mPASSED[0m[31m [ 53%][0m
tests/distributions/test_truncated.py::test_truncation_discrete_logcdf[rejection-2-5] [32mPASSED[0m[31m [ 53%][0m
tests/distributions/test_truncated.py::test_truncation_discrete_logcdf[rejection--inf-5] [32mPASSED[0m[31m [ 54%][0m
tests/distributions/test_truncated.py::test_truncation_exceptions [32mPASSED[0m[31m [ 54%][0m
tests/distributions/test_truncated.py::test_truncation_logprob_bound_check [32mPASSED[0m[31m [ 54%][0m
tests/distributions/test_truncated.py::test_change_truncated_size [32mPASSED[0m[31m [ 54%][0m
tests/distributions/test_truncated.py::test_truncated_default_transform [32mPASSED[0m[31m [ 54%][0m
tests/distributions/test_truncated.py::test_truncated_transform_logp [32mPASSED[0m[31m [ 54%][0m
tests/distributions/test_truncated.py::test_truncated_support_point[truncated_dist0--1-2-None-0] [32mPASSED[0m[31m [ 54%][0m
tests/distributions/test_truncated.py::test_truncated_support_point[truncated_dist1--1-2-shape1-expected1] [32mPASSED[0m[31m [ 54%][0m
tests/distributions/test_truncated.py::test_truncated_support_point[truncated_dist2--1-None-shape2-expected2] [32mPASSED[0m[31m [ 54%][0m
tests/distributions/test_truncated.py::test_truncated_support_point[truncated_dist3-None-upper3-shape3-expected3] [32mPASSED[0m[31m [ 54%][0m
tests/distributions/test_truncated.py::test_truncated_inference [32mPASSED[0m[31m   [ 54%][0m
tests/distributions/test_truncated.py::test_truncated_gamma [32mPASSED[0m[31m       [ 54%][0m
tests/distributions/test_truncated.py::test_vectorized_bounds [32mPASSED[0m[31m     [ 54%][0m
tests/distributions/test_truncated.py::test_truncated_multiple_rngs [32mPASSED[0m[31m [ 54%][0m
tests/distributions/test_truncated.py::test_truncated_maxwell_dist [32mPASSED[0m[31m [ 54%][0m
tests/distributions/test_truncated.py::test_truncated_identity_input[dist_op0] [32mPASSED[0m[31m [ 54%][0m
tests/distributions/test_truncated.py::test_truncated_identity_input[dist_op1] [32mPASSED[0m[31m [ 54%][0m
tests/distributions/test_truncated.py::test_truncated_custom_dist_indexed_argument[rv_op0] [32mPASSED[0m[31m [ 54%][0m
tests/distributions/test_truncated.py::test_truncated_custom_dist_indexed_argument[rv_op1] [32mPASSED[0m[31m [ 54%][0m
tests/distributions/test_truncated.py::test_truncated_symbolic_rv[<lambda>0] [32mPASSED[0m[31m [ 54%][0m
tests/distributions/test_truncated.py::test_truncated_symbolic_rv[<lambda>1] [33mXFAIL[0m[31m [ 54%][0m
tests/gp/test_cov.py::TestCovAdd::test_symadd_cov [32mPASSED[0m[31m                 [ 54%][0m
tests/gp/test_cov.py::TestCovAdd::test_rightadd_scalar [32mPASSED[0m[31m            [ 54%][0m
tests/gp/test_cov.py::TestCovAdd::test_leftadd_scalar [32mPASSED[0m[31m             [ 54%][0m
tests/gp/test_cov.py::TestCovAdd::test_rightadd_matrix [32mPASSED[0m[31m            [ 54%][0m
tests/gp/test_cov.py::TestCovAdd::test_leftadd_matrixt [32mPASSED[0m[31m            [ 54%][0m
tests/gp/test_cov.py::TestCovAdd::test_leftprod_matrix [32mPASSED[0m[31m            [ 54%][0m
tests/gp/test_cov.py::TestCovAdd::test_inv_rightadd [32mPASSED[0m[31m               [ 54%][0m
tests/gp/test_cov.py::TestCovAdd::test_rightadd_whitenoise [32mPASSED[0m[31m        [ 54%][0m
tests/gp/test_cov.py::TestCovProd::test_symprod_cov [32mPASSED[0m[31m               [ 54%][0m
tests/gp/test_cov.py::TestCovProd::test_rightprod_scalar [32mPASSED[0m[31m          [ 54%][0m
tests/gp/test_cov.py::TestCovProd::test_leftprod_scalar [32mPASSED[0m[31m           [ 54%][0m
tests/gp/test_cov.py::TestCovProd::test_rightprod_matrix [32mPASSED[0m[31m          [ 54%][0m
tests/gp/test_cov.py::TestCovProd::test_leftprod_matrix [32mPASSED[0m[31m           [ 54%][0m
tests/gp/test_cov.py::TestCovProd::test_multiops [32mPASSED[0m[31m                  [ 54%][0m
tests/gp/test_cov.py::TestCovProd::test_inv_rightprod [32mPASSED[0m[31m             [ 54%][0m
tests/gp/test_cov.py::TestCovPSD::test_covpsd_add [32mPASSED[0m[31m                 [ 54%][0m
tests/gp/test_cov.py::TestCovPSD::test_copsd_multiply [32mPASSED[0m[31m             [ 55%][0m
tests/gp/test_cov.py::TestCovPSD::test_covpsd_nonstationary1 [32mPASSED[0m[31m      [ 55%][0m
tests/gp/test_cov.py::TestCovPSD::test_covpsd_nonstationary2 [32mPASSED[0m[31m      [ 55%][0m
tests/gp/test_cov.py::TestCovPSD::test_covpsd_notimplemented [32mPASSED[0m[31m      [ 55%][0m
tests/gp/test_cov.py::TestCovExponentiation::test_symexp_cov [32mPASSED[0m[31m      [ 55%][0m
tests/gp/test_cov.py::TestCovExponentiation::test_covexp_numpy [32mPASSED[0m[31m    [ 55%][0m
tests/gp/test_cov.py::TestCovExponentiation::test_covexp_pytensor [32mPASSED[0m[31m [ 55%][0m
tests/gp/test_cov.py::TestCovExponentiation::test_covexp_shared [32mPASSED[0m[31m   [ 55%][0m
tests/gp/test_cov.py::TestCovExponentiation::test_invalid_covexp [32mPASSED[0m[31m  [ 55%][0m
tests/gp/test_cov.py::TestCovExponentiation::test_invalid_covexp_noncov [32mPASSED[0m[31m [ 55%][0m
tests/gp/test_cov.py::TestCovKron::test_symprod_cov [32mPASSED[0m[31m               [ 55%][0m
tests/gp/test_cov.py::TestCovKron::test_multiops [32mPASSED[0m[31m                  [ 55%][0m
tests/gp/test_cov.py::TestCovSliceDim::test_slice1 [32mPASSED[0m[31m                [ 55%][0m
tests/gp/test_cov.py::TestCovSliceDim::test_slice2 [32mPASSED[0m[31m                [ 55%][0m
tests/gp/test_cov.py::TestCovSliceDim::test_slice3 [32mPASSED[0m[31m                [ 55%][0m
tests/gp/test_cov.py::TestCovSliceDim::test_diffslice [32mPASSED[0m[31m             [ 55%][0m
tests/gp/test_cov.py::TestCovSliceDim::test_raises [32mPASSED[0m[31m                [ 55%][0m
tests/gp/test_cov.py::TestStability::test_stable [32mPASSED[0m[31m                  [ 55%][0m
tests/gp/test_cov.py::TestExpQuad::test_1d [32mPASSED[0m[31m                        [ 55%][0m
tests/gp/test_cov.py::TestExpQuad::test_2d [32mPASSED[0m[31m                        [ 55%][0m
tests/gp/test_cov.py::TestExpQuad::test_2dard [32mPASSED[0m[31m                     [ 55%][0m
tests/gp/test_cov.py::TestExpQuad::test_inv_lengthscale [32mPASSED[0m[31m           [ 55%][0m
tests/gp/test_cov.py::TestExpQuad::test_psd [32mPASSED[0m[31m                       [ 55%][0m
tests/gp/test_cov.py::TestExpQuad::test_euclidean_dist [32mPASSED[0m[31m            [ 55%][0m
tests/gp/test_cov.py::TestWhiteNoise::test_1d [32mPASSED[0m[31m                     [ 55%][0m
tests/gp/test_cov.py::TestConstant::test_1d [32mPASSED[0m[31m                       [ 55%][0m
tests/gp/test_cov.py::TestRatQuad::test_1d [32mPASSED[0m[31m                        [ 55%][0m
tests/gp/test_cov.py::TestRatQuad::test_psd_eigenvalues [32mPASSED[0m[31m           [ 55%][0m
tests/gp/test_cov.py::TestExponential::test_1d [32mPASSED[0m[31m                    [ 55%][0m
tests/gp/test_cov.py::TestMatern52::test_1d [32mPASSED[0m[31m                       [ 55%][0m
tests/gp/test_cov.py::TestMatern52::test_psd [32mPASSED[0m[31m                      [ 55%][0m
tests/gp/test_cov.py::TestMatern32::test_1d [32mPASSED[0m[31m                       [ 55%][0m
tests/gp/test_cov.py::TestMatern32::test_psd [32mPASSED[0m[31m                      [ 55%][0m
tests/gp/test_cov.py::TestMatern12::test_1d [32mPASSED[0m[31m                       [ 55%][0m
tests/gp/test_cov.py::TestCosine::test_1d [32mPASSED[0m[31m                         [ 55%][0m
tests/gp/test_cov.py::TestPeriodic::test_1d [32mPASSED[0m[31m                       [ 55%][0m
tests/gp/test_cov.py::TestPeriodic::test_psd [32mPASSED[0m[31m                      [ 55%][0m
tests/gp/test_cov.py::TestLinear::test_1d [32mPASSED[0m[31m                         [ 56%][0m
tests/gp/test_cov.py::TestPolynomial::test_1d [32mPASSED[0m[31m                     [ 56%][0m
tests/gp/test_cov.py::TestWarpedInput::test_1d [32mPASSED[0m[31m                    [ 56%][0m
tests/gp/test_cov.py::TestWarpedInput::test_raises [32mPASSED[0m[31m                [ 56%][0m
tests/gp/test_cov.py::TestWrappedPeriodic::test_1d [32mPASSED[0m[31m                [ 56%][0m
tests/gp/test_cov.py::TestWrappedPeriodic::test_raises [32mPASSED[0m[31m            [ 56%][0m
tests/gp/test_cov.py::TestGibbs::test_1d [32mPASSED[0m[31m                          [ 56%][0m
tests/gp/test_cov.py::TestGibbs::test_raises [32mPASSED[0m[31m                      [ 56%][0m
tests/gp/test_cov.py::TestScaledCov::test_1d [32mPASSED[0m[31m                      [ 56%][0m
tests/gp/test_cov.py::TestScaledCov::test_raises [32mPASSED[0m[31m                  [ 56%][0m
tests/gp/test_cov.py::TestCircular::test_1d_tau1 [32mPASSED[0m[31m                  [ 56%][0m
tests/gp/test_cov.py::TestCircular::test_1d_tau2 [32mPASSED[0m[31m                  [ 56%][0m
tests/gp/test_cov.py::TestHandleArgs::test_handleargs [32mPASSED[0m[31m             [ 56%][0m
tests/gp/test_cov.py::TestCoregion::test_full [32mPASSED[0m[31m                     [ 56%][0m
tests/gp/test_cov.py::TestCoregion::test_fullB [32mPASSED[0m[31m                    [ 56%][0m
tests/gp/test_cov.py::TestCoregion::test_Xs [32mPASSED[0m[31m                       [ 56%][0m
tests/gp/test_cov.py::TestCoregion::test_diag [32mPASSED[0m[31m                     [ 56%][0m
tests/gp/test_cov.py::TestCoregion::test_raises [32mPASSED[0m[31m                   [ 56%][0m
tests/gp/test_cov.py::TestCoregion::test_raises2 [32mPASSED[0m[31m                  [ 56%][0m
tests/gp/test_cov.py::TestCoregion::test_raises3 [32mPASSED[0m[31m                  [ 56%][0m
tests/gp/test_cov.py::test_full_shape[Constant-args0] [32mPASSED[0m[31m             [ 56%][0m
tests/gp/test_cov.py::test_full_shape[WhiteNoise-args1] [32mPASSED[0m[31m           [ 56%][0m
tests/gp/test_cov.py::test_full_shape[ExpQuad-args2] [32mPASSED[0m[31m              [ 56%][0m
tests/gp/test_cov.py::test_full_shape[RatQuad-args3] [32mPASSED[0m[31m              [ 56%][0m
tests/gp/test_cov.py::test_full_shape[Exponential-args4] [32mPASSED[0m[31m          [ 56%][0m
tests/gp/test_cov.py::test_full_shape[Matern12-args5] [32mPASSED[0m[31m             [ 56%][0m
tests/gp/test_cov.py::test_full_shape[Matern32-args6] [32mPASSED[0m[31m             [ 56%][0m
tests/gp/test_cov.py::test_full_shape[Matern52-args7] [32mPASSED[0m[31m             [ 56%][0m
tests/gp/test_cov.py::test_full_shape[Periodic-args8] [32mPASSED[0m[31m             [ 56%][0m
tests/gp/test_cov.py::test_full_shape[Circular-args9] [32mPASSED[0m[31m             [ 56%][0m
tests/gp/test_cov.py::test_full_shape[Linear-args10] [32mPASSED[0m[31m              [ 56%][0m
tests/gp/test_cov.py::test_full_shape[Cosine-args11] [32mPASSED[0m[31m              [ 56%][0m
tests/gp/test_cov.py::test_full_shape[Polynomial-args12] [32mPASSED[0m[31m          [ 56%][0m
tests/gp/test_cov.py::test_full_shape[WrappedPeriodic-args13] [32mPASSED[0m[31m     [ 56%][0m
tests/gp/test_cov.py::test_full_shape[Gibbs-args14] [32mPASSED[0m[31m               [ 56%][0m
tests/gp/test_gp.py::TestMarginalVsMarginalApprox::test_fits_and_preds[FITC] [32mPASSED[0m[31m [ 56%][0m
tests/gp/test_gp.py::TestMarginalVsMarginalApprox::test_fits_and_preds[VFE] [32mPASSED[0m[31m [ 56%][0m
tests/gp/test_gp.py::TestMarginalVsMarginalApprox::test_fits_and_preds[DTC] [32mPASSED[0m[31m [ 57%][0m
tests/gp/test_gp.py::TestGPAdditive::testAdditiveMarginal [32mPASSED[0m[31m         [ 57%][0m
tests/gp/test_gp.py::TestGPAdditive::testAdditiveMarginalApprox[FITC] [32mPASSED[0m[31m [ 57%][0m
tests/gp/test_gp.py::TestGPAdditive::testAdditiveMarginalApprox[VFE] [32mPASSED[0m[31m [ 57%][0m
tests/gp/test_gp.py::TestGPAdditive::testAdditiveMarginalApprox[DTC] [32mPASSED[0m[31m [ 57%][0m
tests/gp/test_gp.py::TestGPAdditive::testAdditiveLatent [32mPASSED[0m[31m           [ 57%][0m
tests/gp/test_gp.py::TestGPAdditive::testAdditiveSparseRaises [32mPASSED[0m[31m     [ 57%][0m
tests/gp/test_gp.py::TestGPAdditive::testAdditiveTypeRaises1 [32mPASSED[0m[31m      [ 57%][0m
tests/gp/test_gp.py::TestGPAdditive::testAdditiveTypeRaises2 [32mPASSED[0m[31m      [ 57%][0m
tests/gp/test_gp.py::TestMarginalVsLatent::testLatent1 [32mPASSED[0m[31m            [ 57%][0m
tests/gp/test_gp.py::TestMarginalVsLatent::testLatent2 [32mPASSED[0m[31m            [ 57%][0m
tests/gp/test_gp.py::TestMarginalVsLatent::testLatentMultioutput [32mPASSED[0m[31m  [ 57%][0m
tests/gp/test_gp.py::TestTP::testTPvsLatent [32mPASSED[0m[31m                       [ 57%][0m
tests/gp/test_gp.py::TestTP::testTPvsLatentReparameterized [32mPASSED[0m[31m        [ 57%][0m
tests/gp/test_gp.py::TestTP::testAdditiveTPRaises [32mPASSED[0m[31m                 [ 57%][0m
tests/gp/test_gp.py::TestLatentKron::testLatentKronvsLatent [32mPASSED[0m[31m       [ 57%][0m
tests/gp/test_gp.py::TestLatentKron::testLatentKronRaisesAdditive [32mPASSED[0m[31m [ 57%][0m
tests/gp/test_gp.py::TestLatentKron::testLatentKronRaisesSizes [32mPASSED[0m[31m    [ 57%][0m
tests/gp/test_gp.py::TestMarginalKron::testMarginalKronvsMarginalpredict [32mPASSED[0m[31m [ 57%][0m
tests/gp/test_gp.py::TestMarginalKron::testMarginalKronvsMarginal [32mPASSED[0m[31m [ 57%][0m
tests/gp/test_gp.py::TestMarginalKron::testMarginalKronRaises [32mPASSED[0m[31m     [ 57%][0m
tests/gp/test_hsgp_approx.py::TestHSGP::test_set_boundaries_1d[-5-5] [32mPASSED[0m[31m [ 57%][0m
tests/gp/test_hsgp_approx.py::TestHSGP::test_set_boundaries_1d[-10--1] [32mPASSED[0m[31m [ 57%][0m
tests/gp/test_hsgp_approx.py::TestHSGP::test_set_boundaries_3d [32mPASSED[0m[31m    [ 57%][0m
tests/gp/test_hsgp_approx.py::TestHSGP::test_mean_invariance [32mPASSED[0m[31m      [ 57%][0m
tests/gp/test_hsgp_approx.py::TestHSGP::test_parametrization [32mPASSED[0m[31m      [ 57%][0m
tests/gp/test_hsgp_approx.py::TestHSGP::test_parametrization_drop_first[True-cov_func0] [32mPASSED[0m[31m [ 57%][0m
tests/gp/test_hsgp_approx.py::TestHSGP::test_parametrization_drop_first[False-cov_func0] [32mPASSED[0m[31m [ 57%][0m
tests/gp/test_hsgp_approx.py::TestHSGP::test_prior[cov_func0-centered] [32mPASSED[0m[31m [ 57%][0m
tests/gp/test_hsgp_approx.py::TestHSGP::test_prior[cov_func1-noncentered] [32mPASSED[0m[31m [ 57%][0m
tests/gp/test_hsgp_approx.py::TestHSGP::test_conditional[cov_func0-centered] [32mPASSED[0m[31m [ 57%][0m
tests/gp/test_hsgp_approx.py::TestHSGP::test_conditional[cov_func1-noncentered] [32mPASSED[0m[31m [ 57%][0m
tests/gp/test_hsgp_approx.py::TestHSGPPeriodic::test_parametrization [32mPASSED[0m[31m [ 57%][0m
tests/gp/test_hsgp_approx.py::TestHSGPPeriodic::test_prior[100.0-cov_func0] [33mXFAIL[0mround `0.0468`.        The test passes more often when
subtracting the mean from the mean from the samples.        It might be
that the period is slightly off for the approximate power spectral
density.        See https://github.com/pymc-devs/pymc/pull/6877/ for the
full discussion.)[31m                                                        [ 57%][0m
tests/gp/test_hsgp_approx.py::TestHSGPPeriodic::test_conditional_periodic[cov_func0] [32mPASSED[0m[31m [ 57%][0m
tests/gp/test_mean.py::TestZeroMean::test_value [32mPASSED[0m[31m                   [ 57%][0m
tests/gp/test_mean.py::TestConstantMean::test_value [32mPASSED[0m[31m               [ 57%][0m
tests/gp/test_mean.py::TestLinearMean::test_value [32mPASSED[0m[31m                 [ 58%][0m
tests/gp/test_mean.py::TestAddProdMean::test_add [32mPASSED[0m[31m                  [ 58%][0m
tests/gp/test_mean.py::TestAddProdMean::test_prod [32mPASSED[0m[31m                 [ 58%][0m
tests/gp/test_mean.py::TestAddProdMean::test_add_multid [32mPASSED[0m[31m           [ 58%][0m
tests/gp/test_mean.py::TestAddProdMean::test_prod_multid [32mPASSED[0m[31m          [ 58%][0m
tests/gp/test_util.py::TestPlotGP::test_plot_gp_dist [32mPASSED[0m[31m              [ 58%][0m
tests/gp/test_util.py::TestPlotGP::test_plot_gp_dist_warn_nan [32mPASSED[0m[31m     [ 58%][0m
tests/gp/test_util.py::TestKmeansInducing::test_kmeans [32mPASSED[0m[31m            [ 58%][0m
tests/gp/test_util.py::TestKmeansInducing::test_kmeans_raises [32mPASSED[0m[31m     [ 58%][0m
tests/gp/test_util.py::TestReplaceWithValues::test_basic_replace [32mPASSED[0m[31m  [ 58%][0m
tests/gp/test_util.py::TestReplaceWithValues::test_replace_no_inputs_needed [32mPASSED[0m[31m [ 58%][0m
tests/gp/test_util.py::TestReplaceWithValues::test_missing_input [32mPASSED[0m[31m  [ 58%][0m
tests/logprob/test_abstract.py::test_measurable_elemwise [32mPASSED[0m[31m          [ 58%][0m
tests/logprob/test_abstract.py::test_logcdf_helper [32mPASSED[0m[31m                [ 58%][0m
tests/logprob/test_abstract.py::test_logcdf_transformed_argument [32mPASSED[0m[31m  [ 58%][0m
tests/logprob/test_basic.py::test_factorized_joint_logprob_basic [32mPASSED[0m[31m  [ 58%][0m
tests/logprob/test_basic.py::test_factorized_joint_logprob_multi_obs [32mPASSED[0m[31m [ 58%][0m
tests/logprob/test_basic.py::test_factorized_joint_logprob_diff_dims [32mPASSED[0m[31m [ 58%][0m
tests/logprob/test_basic.py::test_persist_inputs [32mPASSED[0m[31m                  [ 58%][0m
tests/logprob/test_basic.py::test_warn_rvs_conditional_logp [32mPASSED[0m[31m       [ 58%][0m
tests/logprob/test_basic.py::test_multiple_rvs_to_same_value_raises [32mPASSED[0m[31m [ 58%][0m
tests/logprob/test_basic.py::test_joint_logp_basic [32mPASSED[0m[31m                [ 58%][0m
tests/logprob/test_basic.py::test_model_unchanged_logprob_access [32mPASSED[0m[31m  [ 58%][0m
tests/logprob/test_basic.py::test_unexpected_rvs [32mPASSED[0m[31m                  [ 58%][0m
tests/logprob/test_basic.py::test_hierarchical_logp [32mPASSED[0m[31m               [ 58%][0m
tests/logprob/test_basic.py::test_hierarchical_obs_logp [32mPASSED[0m[31m           [ 58%][0m
tests/logprob/test_basic.py::test_probability_direct_dispatch[logp-logpdf] [32mPASSED[0m[31m [ 58%][0m
tests/logprob/test_basic.py::test_probability_direct_dispatch[logcdf-logcdf] [32mPASSED[0m[31m [ 58%][0m
tests/logprob/test_basic.py::test_probability_direct_dispatch[icdf-ppf] [32mPASSED[0m[31m [ 58%][0m
tests/logprob/test_basic.py::test_probability_inference[logp-logpdf-5.0] [32mPASSED[0m[31m [ 58%][0m
tests/logprob/test_basic.py::test_probability_inference[logcdf-logcdf-5.0] [32mPASSED[0m[31m [ 58%][0m
tests/logprob/test_basic.py::test_probability_inference[icdf-ppf-0.7] [32mPASSED[0m[31m [ 58%][0m
tests/logprob/test_basic.py::test_probability_inference_fails[logp-Logprob] [32mPASSED[0m[31m [ 58%][0m
tests/logprob/test_basic.py::test_probability_inference_fails[logcdf-LogCDF] [32mPASSED[0m[31m [ 58%][0m
tests/logprob/test_basic.py::test_probability_inference_fails[icdf-Inverse CDF] [32mPASSED[0m[31m [ 58%][0m
tests/logprob/test_basic.py::test_warn_rvs_probability_derivation[logp-logpdf-5.0] [32mPASSED[0m[31m [ 58%][0m
tests/logprob/test_basic.py::test_warn_rvs_probability_derivation[logcdf-logcdf-5.0] [32mPASSED[0m[31m [ 59%][0m
tests/logprob/test_basic.py::test_warn_rvs_probability_derivation[icdf-ppf-0.7] [32mPASSED[0m[31m [ 59%][0m
tests/logprob/test_basic.py::test_icdf_discrete [32mPASSED[0m[31m                   [ 59%][0m
tests/logprob/test_basic.py::test_ir_rewrite_does_not_disconnect_valued_rvs [32mPASSED[0m[31m [ 59%][0m
tests/logprob/test_basic.py::test_ir_ops_can_be_evaluated_with_warning [32mPASSED[0m[31m [ 59%][0m
tests/logprob/test_binary.py::test_continuous_rv_comparison_bitwise[comparison_op0-logcdf-logsf-inputs0] [32mPASSED[0m[31m [ 59%][0m
tests/logprob/test_binary.py::test_continuous_rv_comparison_bitwise[comparison_op1-logsf-logcdf-inputs1] [32mPASSED[0m[31m [ 59%][0m
tests/logprob/test_binary.py::test_continuous_rv_comparison_bitwise[comparison_op2-logsf-logcdf-inputs2] [32mPASSED[0m[31m [ 59%][0m
tests/logprob/test_binary.py::test_continuous_rv_comparison_bitwise[comparison_op3-logcdf-logsf-inputs3] [32mPASSED[0m[31m [ 59%][0m
tests/logprob/test_binary.py::test_discrete_rv_comparison_bitwise[comparison_op0-<lambda>-<lambda>-inputs0] [32mPASSED[0m[31m [ 59%][0m
tests/logprob/test_binary.py::test_discrete_rv_comparison_bitwise[comparison_op1-<lambda>-<lambda>-inputs1] [32mPASSED[0m[31m [ 59%][0m
tests/logprob/test_binary.py::test_discrete_rv_comparison_bitwise[comparison_op2-logsf-logcdf-inputs2] [32mPASSED[0m[31m [ 59%][0m
tests/logprob/test_binary.py::test_discrete_rv_comparison_bitwise[comparison_op3-logcdf-logsf-inputs3] [32mPASSED[0m[31m [ 59%][0m
tests/logprob/test_binary.py::test_discrete_rv_comparison_bitwise[comparison_op4-logsf-logcdf-inputs4] [32mPASSED[0m[31m [ 59%][0m
tests/logprob/test_binary.py::test_discrete_rv_comparison_bitwise[comparison_op5-logcdf-logsf-inputs5] [32mPASSED[0m[31m [ 59%][0m
tests/logprob/test_binary.py::test_discrete_rv_comparison_bitwise[comparison_op6-<lambda>-<lambda>-inputs6] [32mPASSED[0m[31m [ 59%][0m
tests/logprob/test_binary.py::test_discrete_rv_comparison_bitwise[comparison_op7-<lambda>-<lambda>-inputs7] [32mPASSED[0m[31m [ 59%][0m
tests/logprob/test_binary.py::test_potentially_measurable_operand [32mPASSED[0m[31m [ 59%][0m
tests/logprob/test_binary.py::test_comparison_invalid_broadcast [32mPASSED[0m[31m   [ 59%][0m
tests/logprob/test_censoring.py::test_continuous_rv_clip [32mPASSED[0m[31m          [ 59%][0m
tests/logprob/test_censoring.py::test_discrete_rv_clip [32mPASSED[0m[31m            [ 59%][0m
tests/logprob/test_censoring.py::test_one_sided_clip [32mPASSED[0m[31m              [ 59%][0m
tests/logprob/test_censoring.py::test_useless_clip [32mPASSED[0m[31m                [ 59%][0m
tests/logprob/test_censoring.py::test_random_clip [32mPASSED[0m[31m                 [ 59%][0m
tests/logprob/test_censoring.py::test_broadcasted_clip_constant [32mPASSED[0m[31m   [ 59%][0m
tests/logprob/test_censoring.py::test_broadcasted_clip_random [32mPASSED[0m[31m     [ 59%][0m
tests/logprob/test_censoring.py::test_fail_base_and_clip_have_values [32mPASSED[0m[31m [ 59%][0m
tests/logprob/test_censoring.py::test_fail_multiple_clip_single_base [32mPASSED[0m[31m [ 59%][0m
tests/logprob/test_censoring.py::test_deterministic_clipping [32mPASSED[0m[31m      [ 59%][0m
tests/logprob/test_censoring.py::test_clip_transform [32mPASSED[0m[31m              [ 59%][0m
tests/logprob/test_censoring.py::test_rounding[round] [32mPASSED[0m[31m             [ 59%][0m
tests/logprob/test_censoring.py::test_rounding[rounding_op1] [32mPASSED[0m[31m      [ 59%][0m
tests/logprob/test_censoring.py::test_rounding[rounding_op2] [32mPASSED[0m[31m      [ 59%][0m
tests/logprob/test_checks.py::test_specify_shape_logprob [32mPASSED[0m[31m          [ 59%][0m
tests/logprob/test_checks.py::test_assert_logprob [32mPASSED[0m[31m                 [ 59%][0m
tests/logprob/test_composite_logprob.py::test_scalar_clipped_mixture [32mPASSED[0m[31m [ 59%][0m
tests/logprob/test_composite_logprob.py::test_nested_scalar_mixtures [32mPASSED[0m[31m [ 59%][0m
tests/logprob/test_composite_logprob.py::test_unvalued_ir_reversion[False] [33mXFAIL[0m[31m [ 60%][0m
tests/logprob/test_composite_logprob.py::test_unvalued_ir_reversion[True] [33mXFAIL[0m[31m [ 60%][0m
tests/logprob/test_composite_logprob.py::test_shifted_cumsum [32mPASSED[0m[31m      [ 60%][0m
tests/logprob/test_composite_logprob.py::test_double_log_transform_rv [32mPASSED[0m[31m [ 60%][0m
tests/logprob/test_composite_logprob.py::test_affine_transform_rv [32mPASSED[0m[31m [ 60%][0m
tests/logprob/test_composite_logprob.py::test_affine_log_transform_rv [32mPASSED[0m[31m [ 60%][0m
tests/logprob/test_composite_logprob.py::test_affine_join_interdependent[False] [32mPASSED[0m[31m [ 60%][0m
tests/logprob/test_composite_logprob.py::test_affine_join_interdependent[True] [32mPASSED[0m[31m [ 60%][0m
tests/logprob/test_cumsum.py::test_normal_cumsum[10-None] [32mPASSED[0m[31m         [ 60%][0m
tests/logprob/test_cumsum.py::test_normal_cumsum[10-0] [32mPASSED[0m[31m            [ 60%][0m
tests/logprob/test_cumsum.py::test_normal_cumsum[size2-0] [32mPASSED[0m[31m         [ 60%][0m
tests/logprob/test_cumsum.py::test_normal_cumsum[size3-1] [32mPASSED[0m[31m         [ 60%][0m
tests/logprob/test_cumsum.py::test_normal_cumsum[size4-0] [32mPASSED[0m[31m         [ 60%][0m
tests/logprob/test_cumsum.py::test_normal_cumsum[size5-1] [32mPASSED[0m[31m         [ 60%][0m
tests/logprob/test_cumsum.py::test_normal_cumsum[size6-2] [32mPASSED[0m[31m         [ 60%][0m
tests/logprob/test_cumsum.py::test_bernoulli_cumsum[10-None] [32mPASSED[0m[31m      [ 60%][0m
tests/logprob/test_cumsum.py::test_bernoulli_cumsum[10-0] [32mPASSED[0m[31m         [ 60%][0m
tests/logprob/test_cumsum.py::test_bernoulli_cumsum[size2-0] [32mPASSED[0m[31m      [ 60%][0m
tests/logprob/test_cumsum.py::test_bernoulli_cumsum[size3-1] [32mPASSED[0m[31m      [ 60%][0m
tests/logprob/test_cumsum.py::test_bernoulli_cumsum[size4-0] [32mPASSED[0m[31m      [ 60%][0m
tests/logprob/test_cumsum.py::test_bernoulli_cumsum[size5-1] [32mPASSED[0m[31m      [ 60%][0m
tests/logprob/test_cumsum.py::test_bernoulli_cumsum[size6-2] [32mPASSED[0m[31m      [ 60%][0m
tests/logprob/test_cumsum.py::test_destructive_cumsum_fails [32mPASSED[0m[31m       [ 60%][0m
tests/logprob/test_cumsum.py::test_deterministic_cumsum [32mPASSED[0m[31m           [ 60%][0m
tests/logprob/test_linalg.py::test_matrix_vector_transform[batch_shape0-True] [32mPASSED[0m[31m [ 60%][0m
tests/logprob/test_linalg.py::test_matrix_vector_transform[batch_shape0-False] [32mPASSED[0m[31m [ 60%][0m
tests/logprob/test_linalg.py::test_matrix_vector_transform[batch_shape1-True] [32mPASSED[0m[31m [ 60%][0m
tests/logprob/test_linalg.py::test_matrix_vector_transform[batch_shape1-False] [32mPASSED[0m[31m [ 60%][0m
tests/logprob/test_linalg.py::test_matrix_matrix_transform [32mPASSED[0m[31m        [ 60%][0m
tests/logprob/test_linalg.py::test_broadcasted_matmul_fails [32mPASSED[0m[31m       [ 60%][0m
tests/logprob/test_mixture.py::test_mixture_basics [32mPASSED[0m[31m                [ 60%][0m
tests/logprob/test_mixture.py::test_hetero_mixture_binomial[p_val0-size0-True] [32mPASSED[0m[31m [ 60%][0m
tests/logprob/test_mixture.py::test_hetero_mixture_binomial[p_val1-size1-True] [32mPASSED[0m[31m [ 60%][0m
tests/logprob/test_mixture.py::test_hetero_mixture_binomial[p_val2-size2-True] [32mPASSED[0m[31m [ 60%][0m
tests/logprob/test_mixture.py::test_hetero_mixture_binomial[p_val3-size3-False] [32mPASSED[0m[31m [ 60%][0m
tests/logprob/test_mixture.py::test_hetero_mixture_binomial[p_val4-size4-False] [32mPASSED[0m[31m [ 60%][0m
tests/logprob/test_mixture.py::test_hetero_mixture_binomial[p_val5-size5-False] [32mPASSED[0m[31m [ 60%][0m
tests/logprob/test_mixture.py::test_hetero_mixture_binomial[p_val6-size6-False] [32mPASSED[0m[31m [ 61%][0m
tests/logprob/test_mixture.py::test_hetero_mixture_categorical[X_args0-Y_args0-Z_args0-p_val0-comp_size0-idx_size0-extra_indices0-0-True] [32mPASSED[0m[31m [ 61%][0m
tests/logprob/test_mixture.py::test_hetero_mixture_categorical[X_args1-Y_args1-Z_args1-p_val1-None-idx_size1-extra_indices1-0-True] [32mPASSED[0m[31m [ 61%][0m
tests/logprob/test_mixture.py::test_hetero_mixture_categorical[X_args2-Y_args2-Z_args2-p_val2-None-idx_size2-extra_indices2-1-True] [32mPASSED[0m[31m [ 61%][0m
tests/logprob/test_mixture.py::test_hetero_mixture_categorical[X_args3-Y_args3-Z_args3-p_val3-comp_size3-idx_size3-extra_indices3-0-True] [32mPASSED[0m[31m [ 61%][0m
tests/logprob/test_mixture.py::test_hetero_mixture_categorical[X_args4-Y_args4-Z_args4-p_val4-comp_size4-idx_size4-extra_indices4-1-True] [32mPASSED[0m[31m [ 61%][0m
tests/logprob/test_mixture.py::test_hetero_mixture_categorical[X_args5-Y_args5-Z_args5-p_val5-comp_size5-idx_size5-extra_indices5-1-True] [33mXFAIL[0m[31m [ 61%][0m
tests/logprob/test_mixture.py::test_hetero_mixture_categorical[X_args6-Y_args6-Z_args6-p_val6-comp_size6-idx_size6-extra_indices6-0-True] [32mPASSED[0m[31m [ 61%][0m
tests/logprob/test_mixture.py::test_hetero_mixture_categorical[X_args7-Y_args7-Z_args7-p_val7-comp_size7-idx_size7-extra_indices7-0-False] [32mPASSED[0m[31m [ 61%][0m
tests/logprob/test_mixture.py::test_hetero_mixture_categorical[X_args8-Y_args8-Z_args8-p_val8-comp_size8-idx_size8-extra_indices8-0-False] [32mPASSED[0m[31m [ 61%][0m
tests/logprob/test_mixture.py::test_hetero_mixture_categorical[X_args9-Y_args9-Z_args9-p_val9-comp_size9-idx_size9-extra_indices9-1-False] [32mPASSED[0m[31m [ 61%][0m
tests/logprob/test_mixture.py::test_hetero_mixture_categorical[X_args10-Y_args10-Z_args10-p_val10-comp_size10-idx_size10-extra_indices10-0-False] [32mPASSED[0m[31m [ 61%][0m
tests/logprob/test_mixture.py::test_hetero_mixture_categorical[X_args11-Y_args11-Z_args11-p_val11-comp_size11-idx_size11-extra_indices11-0-False] [32mPASSED[0m[31m [ 61%][0m
tests/logprob/test_mixture.py::test_hetero_mixture_categorical[X_args12-Y_args12-Z_args12-p_val12-None-None-extra_indices12-0-False] [32mPASSED[0m[31m [ 61%][0m
tests/logprob/test_mixture.py::test_hetero_mixture_categorical[X_args13-Y_args13-Z_args13-p_val13-comp_size13-idx_size13-extra_indices13-0-False] [32mPASSED[0m[31m [ 61%][0m
tests/logprob/test_mixture.py::test_hetero_mixture_categorical[X_args14-Y_args14-Z_args14-p_val14-comp_size14-idx_size14-extra_indices14-0-False] [32mPASSED[0m[31m [ 61%][0m
tests/logprob/test_mixture.py::test_hetero_mixture_categorical[X_args15-Y_args15-Z_args15-p_val15-comp_size15-idx_size15-extra_indices15-0-False] [32mPASSED[0m[31m [ 61%][0m
tests/logprob/test_mixture.py::test_expand_indices_basic[A_parts0-indices0] [32mPASSED[0m[31m [ 61%][0m
tests/logprob/test_mixture.py::test_expand_indices_basic[A_parts1-indices1] [32mPASSED[0m[31m [ 61%][0m
tests/logprob/test_mixture.py::test_expand_indices_basic[A_parts2-indices2] [32mPASSED[0m[31m [ 61%][0m
tests/logprob/test_mixture.py::test_expand_indices_basic[A_parts3-indices3] [32mPASSED[0m[31m [ 61%][0m
tests/logprob/test_mixture.py::test_expand_indices_basic[A_parts4-indices4] [32mPASSED[0m[31m [ 61%][0m
tests/logprob/test_mixture.py::test_expand_indices_basic[A_parts5-indices5] [32mPASSED[0m[31m [ 61%][0m
tests/logprob/test_mixture.py::test_expand_indices_basic[A_parts6-indices6] [32mPASSED[0m[31m [ 61%][0m
tests/logprob/test_mixture.py::test_expand_indices_basic[A_parts7-indices7] [32mPASSED[0m[31m [ 61%][0m
tests/logprob/test_mixture.py::test_expand_indices_basic[A_parts8-indices8] [32mPASSED[0m[31m [ 61%][0m
tests/logprob/test_mixture.py::test_expand_indices_moved_subspaces[A_parts0-indices0] [32mPASSED[0m[31m [ 61%][0m
tests/logprob/test_mixture.py::test_expand_indices_moved_subspaces[A_parts1-indices1] [32mPASSED[0m[31m [ 61%][0m
tests/logprob/test_mixture.py::test_expand_indices_single_indices[A_parts0-indices0] [32mPASSED[0m[31m [ 61%][0m
tests/logprob/test_mixture.py::test_expand_indices_single_indices[A_parts1-indices1] [32mPASSED[0m[31m [ 61%][0m
tests/logprob/test_mixture.py::test_expand_indices_single_indices[A_parts2-indices2] [32mPASSED[0m[31m [ 61%][0m
tests/logprob/test_mixture.py::test_expand_indices_single_indices[A_parts3-indices3] [32mPASSED[0m[31m [ 61%][0m
tests/logprob/test_mixture.py::test_expand_indices_newaxis[A_parts0-indices0] [32mPASSED[0m[31m [ 61%][0m
tests/logprob/test_mixture.py::test_expand_indices_newaxis[A_parts1-indices1] [32mPASSED[0m[31m [ 61%][0m
tests/logprob/test_mixture.py::test_expand_indices_newaxis[A_parts2-indices2] [32mPASSED[0m[31m [ 61%][0m
tests/logprob/test_mixture.py::test_expand_indices_newaxis[A_parts3-indices3] [32mPASSED[0m[31m [ 61%][0m
tests/logprob/test_mixture.py::test_expand_indices_newaxis[A_parts4-indices4] [32mPASSED[0m[31m [ 61%][0m
tests/logprob/test_mixture.py::test_mixture_with_DiracDelta [32mPASSED[0m[31m       [ 62%][0m
tests/logprob/test_mixture.py::test_scalar_switch_mixture [32mPASSED[0m[31m         [ 62%][0m
tests/logprob/test_mixture.py::test_switch_mixture_vector[True] [32mPASSED[0m[31m   [ 62%][0m
tests/logprob/test_mixture.py::test_switch_mixture_vector[False] [32mPASSED[0m[31m  [ 62%][0m
tests/logprob/test_mixture.py::test_switch_mixture_measurable_cond_fails [32mPASSED[0m[31m [ 62%][0m
tests/logprob/test_mixture.py::test_switch_mixture_invalid_bcast [32mPASSED[0m[31m  [ 62%][0m
tests/logprob/test_mixture.py::test_ifelse_mixture_one_component [32mPASSED[0m[31m  [ 62%][0m
tests/logprob/test_mixture.py::test_ifelse_mixture_multiple_components [32mPASSED[0m[31m [ 62%][0m
tests/logprob/test_mixture.py::test_ifelse_mixture_shared_component [32mPASSED[0m[31m [ 62%][0m
tests/logprob/test_mixture.py::test_joint_logprob_subtensor [33mXFAIL[0m[31m        [ 62%][0m
tests/logprob/test_mixture.py::test_nested_ifelse [32mPASSED[0m[31m                 [ 62%][0m
tests/logprob/test_mixture.py::test_advanced_subtensor_none_and_integer [32mPASSED[0m[31m [ 62%][0m
tests/logprob/test_order.py::test_argmax [32mPASSED[0m[31m                          [ 62%][0m
tests/logprob/test_order.py::test_non_iid_fails[max] [32mPASSED[0m[31m              [ 62%][0m
tests/logprob/test_order.py::test_non_iid_fails[min] [32mPASSED[0m[31m              [ 62%][0m
tests/logprob/test_order.py::test_multivariate_rv_fails[max] [32mPASSED[0m[31m      [ 62%][0m
tests/logprob/test_order.py::test_multivariate_rv_fails[min] [32mPASSED[0m[31m      [ 62%][0m
tests/logprob/test_order.py::test_categorical[max] [32mPASSED[0m[31m                [ 62%][0m
tests/logprob/test_order.py::test_categorical[min] [32mPASSED[0m[31m                [ 62%][0m
tests/logprob/test_order.py::test_non_supp_axis[max] [32mPASSED[0m[31m              [ 62%][0m
tests/logprob/test_order.py::test_non_supp_axis[min] [32mPASSED[0m[31m              [ 62%][0m
tests/logprob/test_order.py::test_max_logprob[3-0.85--1] [32mPASSED[0m[31m          [ 62%][0m
tests/logprob/test_order.py::test_max_logprob[3-0.01-0] [32mPASSED[0m[31m           [ 62%][0m
tests/logprob/test_order.py::test_max_logprob[2-0.2-None] [32mPASSED[0m[31m         [ 62%][0m
tests/logprob/test_order.py::test_max_logprob[4-0.5-0] [32mPASSED[0m[31m            [ 62%][0m
tests/logprob/test_order.py::test_max_logprob[shape4-0.9-None] [32mPASSED[0m[31m    [ 62%][0m
tests/logprob/test_order.py::test_max_logprob[shape5-0.75-axis5] [32mPASSED[0m[31m  [ 62%][0m
tests/logprob/test_order.py::test_min_logprob[3-0.85--1] [32mPASSED[0m[31m          [ 62%][0m
tests/logprob/test_order.py::test_min_logprob[3-0.01-0] [32mPASSED[0m[31m           [ 62%][0m
tests/logprob/test_order.py::test_min_logprob[2-0.2-None] [32mPASSED[0m[31m         [ 62%][0m
tests/logprob/test_order.py::test_min_logprob[4-0.5-0] [32mPASSED[0m[31m            [ 62%][0m
tests/logprob/test_order.py::test_min_logprob[shape4-0.9-None] [32mPASSED[0m[31m    [ 62%][0m
tests/logprob/test_order.py::test_min_logprob[shape5-0.75-axis5] [32mPASSED[0m[31m  [ 62%][0m
tests/logprob/test_order.py::test_min_non_mul_elemwise_fails [32mPASSED[0m[31m      [ 62%][0m
tests/logprob/test_order.py::test_max_discrete[2-3-1--1] [32mPASSED[0m[31m          [ 62%][0m
tests/logprob/test_order.py::test_max_discrete[2-3-1-0] [32mPASSED[0m[31m           [ 62%][0m
tests/logprob/test_order.py::test_max_discrete[1-2-2-None] [32mPASSED[0m[31m        [ 62%][0m
tests/logprob/test_order.py::test_max_discrete[0-4-0-0] [32mPASSED[0m[31m           [ 63%][0m
tests/logprob/test_order.py::test_min_discrete[2-3-1--1] [32mPASSED[0m[31m          [ 63%][0m
tests/logprob/test_order.py::test_min_discrete[2-3-1-0] [32mPASSED[0m[31m           [ 63%][0m
tests/logprob/test_order.py::test_min_discrete[1-2-2-None] [32mPASSED[0m[31m        [ 63%][0m
tests/logprob/test_order.py::test_min_discrete[0-4-0-0] [32mPASSED[0m[31m           [ 63%][0m
tests/logprob/test_order.py::test_min_max_bernoulli [32mPASSED[0m[31m               [ 63%][0m
tests/logprob/test_order.py::test_non_measurable_max_grad [32mPASSED[0m[31m         [ 63%][0m
tests/logprob/test_rewriting.py::test_local_lift_DiracDelta [32mPASSED[0m[31m       [ 63%][0m
tests/logprob/test_rewriting.py::test_local_remove_DiracDelta [32mPASSED[0m[31m     [ 63%][0m
tests/logprob/test_rewriting.py::test_local_remove_TransformedVariable [32mPASSED[0m[31m [ 63%][0m
tests/logprob/test_scan.py::test_convert_outer_out_to_in_sit_sot [32mPASSED[0m[31m  [ 63%][0m
tests/logprob/test_scan.py::test_convert_outer_out_to_in_mit_sot [32mPASSED[0m[31m  [ 63%][0m
tests/logprob/test_scan.py::test_scan_joint_logprob[False] [32mPASSED[0m[31m        [ 63%][0m
tests/logprob/test_scan.py::test_scan_joint_logprob[True] [32mPASSED[0m[31m         [ 63%][0m
tests/logprob/test_scan.py::test_mode_is_kept[True] [32mPASSED[0m[31m               [ 63%][0m
tests/logprob/test_scan.py::test_mode_is_kept[False] [32mPASSED[0m[31m              [ 63%][0m
tests/logprob/test_scan.py::test_scan_non_pure_rv_output [32mPASSED[0m[31m          [ 63%][0m
tests/logprob/test_scan.py::test_scan_over_seqs [32mPASSED[0m[31m                   [ 63%][0m
tests/logprob/test_scan.py::test_scan_carried_deterministic_state [32mPASSED[0m[31m [ 63%][0m
tests/logprob/test_scan.py::test_scan_multiple_output_types [32mPASSED[0m[31m       [ 63%][0m
tests/logprob/test_scan.py::test_generative_graph_unchanged [32mPASSED[0m[31m       [ 63%][0m
tests/logprob/test_tensor.py::test_bcast_rv_logp [33mXFAIL[0m (logprob for
broadcasted RVs not implemented)[31m                                         [ 63%][0m
tests/logprob/test_tensor.py::test_measurable_make_vector [32mPASSED[0m[31m         [ 63%][0m
tests/logprob/test_tensor.py::test_measurable_make_vector_interdependent[False] [32mPASSED[0m[31m [ 63%][0m
tests/logprob/test_tensor.py::test_measurable_make_vector_interdependent[True] [32mPASSED[0m[31m [ 63%][0m
tests/logprob/test_tensor.py::test_measurable_join_interdependent[False] [32mPASSED[0m[31m [ 63%][0m
tests/logprob/test_tensor.py::test_measurable_join_interdependent[True] [32mPASSED[0m[31m [ 63%][0m
tests/logprob/test_tensor.py::test_measurable_join_univariate[size10-size20-0-True] [32mPASSED[0m[31m [ 63%][0m
tests/logprob/test_tensor.py::test_measurable_join_univariate[size11-size21--1-True] [32mPASSED[0m[31m [ 63%][0m
tests/logprob/test_tensor.py::test_measurable_join_univariate[size12-size22-0-True] [32mPASSED[0m[31m [ 63%][0m
tests/logprob/test_tensor.py::test_measurable_join_univariate[size13-size23-1-True] [32mPASSED[0m[31m [ 63%][0m
tests/logprob/test_tensor.py::test_measurable_join_univariate[size14-size24-0-False] [32mPASSED[0m[31m [ 63%][0m
tests/logprob/test_tensor.py::test_measurable_join_univariate[size15-size25-1-False] [32mPASSED[0m[31m [ 63%][0m
tests/logprob/test_tensor.py::test_measurable_join_univariate[size16-size26-2-False] [32mPASSED[0m[31m [ 63%][0m
tests/logprob/test_tensor.py::test_measurable_join_multivariate[None-2-None-2-0-True-0] [32mPASSED[0m[31m [ 63%][0m
tests/logprob/test_tensor.py::test_measurable_join_multivariate[None-2-None-2--1-True-0] [32mPASSED[0m[31m [ 63%][0m
tests/logprob/test_tensor.py::test_measurable_join_multivariate[size12-2-size22-2-0-True-0] [32mPASSED[0m[31m [ 63%][0m
tests/logprob/test_tensor.py::test_measurable_join_multivariate[size13-2-size23-2--2-True-0] [32mPASSED[0m[31m [ 64%][0m
tests/logprob/test_tensor.py::test_measurable_join_multivariate[size14-5-size24-3-1-True-0] [32mPASSED[0m[31m [ 64%][0m
tests/logprob/test_tensor.py::test_measurable_join_multivariate[size15-10-size25-10-1-True-1] [32mPASSED[0m[31m [ 64%][0m
tests/logprob/test_tensor.py::test_measurable_join_multivariate[size16-10-size26-10--2-True-1] [32mPASSED[0m[31m [ 64%][0m
tests/logprob/test_tensor.py::test_measurable_join_multivariate[size17-5-size27-5-0-False-0] [32mPASSED[0m[31m [ 64%][0m
tests/logprob/test_tensor.py::test_measurable_join_multivariate[size18-5-size28-5-1-False-1] [32mPASSED[0m[31m [ 64%][0m
tests/logprob/test_tensor.py::test_measurable_join_multivariate[size19-10-size29-10-2-False-2] [32mPASSED[0m[31m [ 64%][0m
tests/logprob/test_tensor.py::test_join_mixed_ndim_supp [32mPASSED[0m[31m           [ 64%][0m
tests/logprob/test_tensor.py::test_measurable_dimshuffle[False-ds_order0] [32mPASSED[0m[31m [ 64%][0m
tests/logprob/test_tensor.py::test_measurable_dimshuffle[False-ds_order1] [32mPASSED[0m[31m [ 64%][0m
tests/logprob/test_tensor.py::test_measurable_dimshuffle[False-ds_order2] [32mPASSED[0m[31m [ 64%][0m
tests/logprob/test_tensor.py::test_measurable_dimshuffle[False-ds_order3] [32mPASSED[0m[31m [ 64%][0m
tests/logprob/test_tensor.py::test_measurable_dimshuffle[False-ds_order4] [32mPASSED[0m[31m [ 64%][0m
tests/logprob/test_tensor.py::test_measurable_dimshuffle[False-ds_order5] [32mPASSED[0m[31m [ 64%][0m
tests/logprob/test_tensor.py::test_measurable_dimshuffle[False-ds_order6] [32mPASSED[0m[31m [ 64%][0m
tests/logprob/test_tensor.py::test_measurable_dimshuffle[False-ds_order7] [32mPASSED[0m[31m [ 64%][0m
tests/logprob/test_tensor.py::test_measurable_dimshuffle[False-ds_order8] [32mPASSED[0m[31m [ 64%][0m
tests/logprob/test_tensor.py::test_measurable_dimshuffle[False-ds_order9] [32mPASSED[0m[31m [ 64%][0m
tests/logprob/test_tensor.py::test_measurable_dimshuffle[True-ds_order0] [32mPASSED[0m[31m [ 64%][0m
tests/logprob/test_tensor.py::test_measurable_dimshuffle[True-ds_order1] [32mPASSED[0m[31m [ 64%][0m
tests/logprob/test_tensor.py::test_measurable_dimshuffle[True-ds_order2] [32mPASSED[0m[31m [ 64%][0m
tests/logprob/test_tensor.py::test_measurable_dimshuffle[True-ds_order3] [32mPASSED[0m[31m [ 64%][0m
tests/logprob/test_tensor.py::test_measurable_dimshuffle[True-ds_order4] [32mPASSED[0m[31m [ 64%][0m
tests/logprob/test_tensor.py::test_measurable_dimshuffle[True-ds_order5] [32mPASSED[0m[31m [ 64%][0m
tests/logprob/test_tensor.py::test_measurable_dimshuffle[True-ds_order6] [32mPASSED[0m[31m [ 64%][0m
tests/logprob/test_tensor.py::test_measurable_dimshuffle[True-ds_order7] [32mPASSED[0m[31m [ 64%][0m
tests/logprob/test_tensor.py::test_measurable_dimshuffle[True-ds_order8] [32mPASSED[0m[31m [ 64%][0m
tests/logprob/test_tensor.py::test_measurable_dimshuffle[True-ds_order9] [32mPASSED[0m[31m [ 64%][0m
tests/logprob/test_tensor.py::test_unmeasurable_dimshuffles [32mPASSED[0m[31m       [ 64%][0m
tests/logprob/test_tensor.py::TestMeasurableSplit::test_univariate [32mPASSED[0m[31m [ 64%][0m
tests/logprob/test_tensor.py::TestMeasurableSplit::test_multivariate [32mPASSED[0m[31m [ 64%][0m
tests/logprob/test_tensor.py::TestMeasurableSplit::test_not_all_splits_used [33mXFAIL[0m[31m [ 64%][0m
tests/logprob/test_tensor.py::TestMeasurableSplit::test_not_all_splits_used_core_dim [32mPASSED[0m[31m [ 64%][0m
tests/logprob/test_tensor.py::TestMeasurableSplit::test_subtensor_converted_to_splits [33mXFAIL[0m[31m [ 64%][0m
tests/logprob/test_transform_value.py::test_TransformValuesMapping [32mPASSED[0m[31m [ 64%][0m
tests/logprob/test_transform_value.py::test_original_values_output_dict [32mPASSED[0m[31m [ 64%][0m
tests/logprob/test_transform_value.py::test_default_value_transform_logprob[pt_dist0-dist_params0-sp_dist0-size0] [32mPASSED[0m[31m [ 65%][0m
tests/logprob/test_transform_value.py::test_default_value_transform_logprob[pt_dist1-dist_params1-<lambda>-size1] [32mPASSED[0m[31m [ 65%][0m
tests/logprob/test_transform_value.py::test_default_value_transform_logprob[pt_dist2-dist_params2-<lambda>-size2] [32mPASSED[0m[31m [ 65%][0m
tests/logprob/test_transform_value.py::test_default_value_transform_logprob[pt_dist3-dist_params3-sp_dist3-size3] [32mPASSED[0m[31m [ 65%][0m
tests/logprob/test_transform_value.py::test_default_value_transform_logprob[pt_dist4-dist_params4-<lambda>-size4] [33mXFAIL[0m[31m [ 65%][0m
tests/logprob/test_transform_value.py::test_default_value_transform_logprob[pt_dist5-dist_params5-<lambda>-size5] [32mPASSED[0m[31m [ 65%][0m
tests/logprob/test_transform_value.py::test_default_value_transform_logprob[pt_dist6-dist_params6-<lambda>-size6] [32mPASSED[0m[31m [ 65%][0m
tests/logprob/test_transform_value.py::test_default_value_transform_logprob[pt_dist7-dist_params7-<lambda>-size7] [32mPASSED[0m[31m [ 65%][0m
tests/logprob/test_transform_value.py::test_default_value_transform_logprob[pt_dist8-dist_params8-<lambda>-size8] [32mPASSED[0m[31m [ 65%][0m
tests/logprob/test_transform_value.py::test_default_value_transform_logprob[gamma-dist_params9-<lambda>-size9] [32mPASSED[0m[31m [ 65%][0m
tests/logprob/test_transform_value.py::test_default_value_transform_logprob[pt_dist10-dist_params10-<lambda>-size10] [32mPASSED[0m[31m [ 65%][0m
tests/logprob/test_transform_value.py::test_default_value_transform_logprob[dist-dist_params11-<lambda>-size11] [32mPASSED[0m[31m [ 65%][0m
tests/logprob/test_transform_value.py::test_default_value_transform_logprob[pt_dist12-dist_params12-<lambda>-size12] [33mXFAIL[0m[31m [ 65%][0m
tests/logprob/test_transform_value.py::test_default_value_transform_logprob[pt_dist13-dist_params13-<lambda>-size13] [32mPASSED[0m[31m [ 65%][0m
tests/logprob/test_transform_value.py::test_default_value_transform_logprob[pt_dist14-dist_params14-<lambda>-size14] [32mPASSED[0m[31m [ 65%][0m
tests/logprob/test_transform_value.py::test_default_value_transform_logprob[pt_dist15-dist_params15-<lambda>-size15] [32mPASSED[0m[31m [ 65%][0m
tests/logprob/test_transform_value.py::test_default_value_transform_logprob[pt_dist16-dist_params16-<lambda>-None] [32mPASSED[0m[31m [ 65%][0m
tests/logprob/test_transform_value.py::test_default_value_transform_logprob[pt_dist17-dist_params17-<lambda>-size17] [32mPASSED[0m[31m [ 65%][0m
tests/logprob/test_transform_value.py::test_value_transform_logprob_nojac[True] [32mPASSED[0m[31m [ 65%][0m
tests/logprob/test_transform_value.py::test_value_transform_logprob_nojac[False] [32mPASSED[0m[31m [ 65%][0m
tests/logprob/test_transform_value.py::test_hierarchical_value_transform [32mPASSED[0m[31m [ 65%][0m
tests/logprob/test_transform_value.py::test_nondefault_value_transform [32mPASSED[0m[31m [ 65%][0m
tests/logprob/test_transform_value.py::test_no_value_transform_multiout_input [32mPASSED[0m[31m [ 65%][0m
tests/logprob/test_transform_value.py::test_value_transform_multiout_op[True-True] [32mPASSED[0m[31m [ 65%][0m
tests/logprob/test_transform_value.py::test_value_transform_multiout_op[True-False] [32mPASSED[0m[31m [ 65%][0m
tests/logprob/test_transform_value.py::test_value_transform_multiout_op[False-True] [32mPASSED[0m[31m [ 65%][0m
tests/logprob/test_transform_value.py::test_value_transform_multiout_op[False-False] [32mPASSED[0m[31m [ 65%][0m
tests/logprob/test_transform_value.py::test_transformed_rv_and_value [32mPASSED[0m[31m [ 65%][0m
tests/logprob/test_transform_value.py::test_mixture_transform [32mPASSED[0m[31m     [ 65%][0m
tests/logprob/test_transform_value.py::test_scan_transform [32mPASSED[0m[31m        [ 65%][0m
tests/logprob/test_transform_value.py::test_weakref_leak [32mPASSED[0m[31m          [ 65%][0m
tests/logprob/test_transforms.py::TestTransform::test_fallback_log_jac_det[0] [32mPASSED[0m[31m [ 65%][0m
tests/logprob/test_transforms.py::TestTransform::test_fallback_log_jac_det[1] [32mPASSED[0m[31m [ 65%][0m
tests/logprob/test_transforms.py::TestTransform::test_fallback_log_jac_det_undefined_ndim[None] [32mPASSED[0m[31m [ 65%][0m
tests/logprob/test_transforms.py::TestTransform::test_fallback_log_jac_det_undefined_ndim[2] [32mPASSED[0m[31m [ 65%][0m
tests/logprob/test_transforms.py::TestTransform::test_chained_transform [32mPASSED[0m[31m [ 65%][0m
tests/logprob/test_transforms.py::TestTransform::test_check_jac_det[transform0] [32mPASSED[0m[31m [ 65%][0m
tests/logprob/test_transforms.py::TestTransform::test_check_jac_det[transform1] [32mPASSED[0m[31m [ 66%][0m
tests/logprob/test_transforms.py::TestTransform::test_check_jac_det[transform2] [32mPASSED[0m[31m [ 66%][0m
tests/logprob/test_transforms.py::TestTransform::test_check_jac_det[transform3] [32mPASSED[0m[31m [ 66%][0m
tests/logprob/test_transforms.py::TestTransform::test_check_jac_det[transform4] [32mPASSED[0m[31m [ 66%][0m
tests/logprob/test_transforms.py::TestTransform::test_check_jac_det[transform5] [32mPASSED[0m[31m [ 66%][0m
tests/logprob/test_transforms.py::TestTransform::test_check_jac_det[transform6] [32mPASSED[0m[31m [ 66%][0m
tests/logprob/test_transforms.py::TestTransform::test_check_jac_det[transform7] [32mPASSED[0m[31m [ 66%][0m
tests/logprob/test_transforms.py::TestTransform::test_check_jac_det[transform8] [32mPASSED[0m[31m [ 66%][0m
tests/logprob/test_transforms.py::TestTransform::test_check_jac_det[transform9] [32mPASSED[0m[31m [ 66%][0m
tests/logprob/test_transforms.py::TestTransform::test_check_jac_det[transform10] [32mPASSED[0m[31m [ 66%][0m
tests/logprob/test_transforms.py::test_exp_transform_rv [32mPASSED[0m[31m           [ 66%][0m
tests/logprob/test_transforms.py::test_log_transform_rv [32mPASSED[0m[31m           [ 66%][0m
tests/logprob/test_transforms.py::TestLocScaleRVTransform::test_loc_transform_rv[rv_size0-scalar-True] [32mPASSED[0m[31m [ 66%][0m
tests/logprob/test_transforms.py::TestLocScaleRVTransform::test_loc_transform_rv[2-vector-False] [32mPASSED[0m[31m [ 66%][0m
tests/logprob/test_transforms.py::TestLocScaleRVTransform::test_loc_transform_rv[rv_size2-col-True] [32mPASSED[0m[31m [ 66%][0m
tests/logprob/test_transforms.py::TestLocScaleRVTransform::test_scale_transform_rv[rv_size0-scalar-True] [32mPASSED[0m[31m [ 66%][0m
tests/logprob/test_transforms.py::TestLocScaleRVTransform::test_scale_transform_rv[1-scale_type1-True] [32mPASSED[0m[31m [ 66%][0m
tests/logprob/test_transforms.py::TestLocScaleRVTransform::test_scale_transform_rv[rv_size2-matrix-False] [32mPASSED[0m[31m [ 66%][0m
tests/logprob/test_transforms.py::TestLocScaleRVTransform::test_negated_rv_transform [32mPASSED[0m[31m [ 66%][0m
tests/logprob/test_transforms.py::TestLocScaleRVTransform::test_subtracted_rv_transform [32mPASSED[0m[31m [ 66%][0m
tests/logprob/test_transforms.py::TestLocScaleRVTransform::test_loc_transform_multiple_rvs_fails1 [32mPASSED[0m[31m [ 66%][0m
tests/logprob/test_transforms.py::TestLocScaleRVTransform::test_nested_loc_transform_multiple_rvs_fails2 [32mPASSED[0m[31m [ 66%][0m
tests/logprob/test_transforms.py::TestPowerRVTransform::test_reciprocal_rv_transform[1.0] [32mPASSED[0m[31m [ 66%][0m
tests/logprob/test_transforms.py::TestPowerRVTransform::test_reciprocal_rv_transform[2.0] [32mPASSED[0m[31m [ 66%][0m
tests/logprob/test_transforms.py::TestPowerRVTransform::test_reciprocal_real_rv_transform [32mPASSED[0m[31m [ 66%][0m
tests/logprob/test_transforms.py::TestPowerRVTransform::test_sqr_transform [32mPASSED[0m[31m [ 66%][0m
tests/logprob/test_transforms.py::TestPowerRVTransform::test_sqrt_transform [32mPASSED[0m[31m [ 66%][0m
tests/logprob/test_transforms.py::TestPowerRVTransform::test_negative_value_odd_power_transform[-3] [32mPASSED[0m[31m [ 66%][0m
tests/logprob/test_transforms.py::TestPowerRVTransform::test_negative_value_odd_power_transform[-1] [32mPASSED[0m[31m [ 66%][0m
tests/logprob/test_transforms.py::TestPowerRVTransform::test_negative_value_odd_power_transform[1] [32mPASSED[0m[31m [ 66%][0m
tests/logprob/test_transforms.py::TestPowerRVTransform::test_negative_value_odd_power_transform[5] [32mPASSED[0m[31m [ 66%][0m
tests/logprob/test_transforms.py::TestPowerRVTransform::test_negative_value_odd_power_transform[7] [32mPASSED[0m[31m [ 66%][0m
tests/logprob/test_transforms.py::TestPowerRVTransform::test_negative_value_even_power_transform_logp[-2] [32mPASSED[0m[31m [ 66%][0m
tests/logprob/test_transforms.py::TestPowerRVTransform::test_negative_value_even_power_transform_logp[2] [32mPASSED[0m[31m [ 66%][0m
tests/logprob/test_transforms.py::TestPowerRVTransform::test_negative_value_even_power_transform_logp[4] [32mPASSED[0m[31m [ 66%][0m
tests/logprob/test_transforms.py::TestPowerRVTransform::test_negative_value_even_power_transform_logp[6] [32mPASSED[0m[31m [ 66%][0m
tests/logprob/test_transforms.py::TestPowerRVTransform::test_negative_value_even_power_transform_logp[8] [32mPASSED[0m[31m [ 66%][0m
tests/logprob/test_transforms.py::TestPowerRVTransform::test_negative_value_frac_power_transform_logp[-0.3333333333333333] [32mPASSED[0m[31m [ 67%][0m
tests/logprob/test_transforms.py::TestPowerRVTransform::test_negative_value_frac_power_transform_logp[-0.5] [32mPASSED[0m[31m [ 67%][0m
tests/logprob/test_transforms.py::TestPowerRVTransform::test_negative_value_frac_power_transform_logp[0.5] [32mPASSED[0m[31m [ 67%][0m
tests/logprob/test_transforms.py::TestPowerRVTransform::test_negative_value_frac_power_transform_logp[0.3333333333333333] [32mPASSED[0m[31m [ 67%][0m
tests/logprob/test_transforms.py::test_absolute_rv_transform[2.5] [32mPASSED[0m[31m [ 67%][0m
tests/logprob/test_transforms.py::test_absolute_rv_transform[-2.5] [32mPASSED[0m[31m [ 67%][0m
tests/logprob/test_transforms.py::test_extra_bijective_rv_transforms[pt_transform0-transform0] [32mPASSED[0m[31m [ 67%][0m
tests/logprob/test_transforms.py::test_extra_bijective_rv_transforms[pt_transform1-transform1] [32mPASSED[0m[31m [ 67%][0m
tests/logprob/test_transforms.py::test_extra_bijective_rv_transforms[pt_transform2-transform2] [32mPASSED[0m[31m [ 67%][0m
tests/logprob/test_transforms.py::test_extra_bijective_rv_transforms[pt_transform3-transform3] [32mPASSED[0m[31m [ 67%][0m
tests/logprob/test_transforms.py::test_extra_bijective_rv_transforms[pt_transform4-transform4] [32mPASSED[0m[31m [ 67%][0m
tests/logprob/test_transforms.py::test_extra_bijective_rv_transforms[pt_transform5-transform5] [32mPASSED[0m[31m [ 67%][0m
tests/logprob/test_transforms.py::test_extra_bijective_rv_transforms[pt_transform6-transform6] [32mPASSED[0m[31m [ 67%][0m
tests/logprob/test_transforms.py::test_extra_bijective_rv_transforms[pt_transform7-transform7] [32mPASSED[0m[31m [ 67%][0m
tests/logprob/test_transforms.py::test_cosh_rv_transform [32mPASSED[0m[31m          [ 67%][0m
tests/logprob/test_transforms.py::test_special_log_exp_transforms[canonical_func0-<lambda>] [32mPASSED[0m[31m [ 67%][0m
tests/logprob/test_transforms.py::test_special_log_exp_transforms[canonical_func1-<lambda>] [32mPASSED[0m[31m [ 67%][0m
tests/logprob/test_transforms.py::test_special_log_exp_transforms[canonical_func2-<lambda>] [32mPASSED[0m[31m [ 67%][0m
tests/logprob/test_transforms.py::test_special_log_exp_transforms[canonical_func3-<lambda>] [32mPASSED[0m[31m [ 67%][0m
tests/logprob/test_transforms.py::test_special_log_exp_transforms[canonical_func4-<lambda>] [32mPASSED[0m[31m [ 67%][0m
tests/logprob/test_transforms.py::test_special_log_exp_transforms[canonical_func5-<lambda>] [32mPASSED[0m[31m [ 67%][0m
tests/logprob/test_transforms.py::test_special_log_exp_transforms[canonical_func6-<lambda>] [32mPASSED[0m[31m [ 67%][0m
tests/logprob/test_transforms.py::test_special_log_exp_transforms[canonical_func7-<lambda>] [32mPASSED[0m[31m [ 67%][0m
tests/logprob/test_transforms.py::test_special_log_exp_transforms[canonical_func8-<lambda>] [32mPASSED[0m[31m [ 67%][0m
tests/logprob/test_transforms.py::test_measurable_power_exponent_with_constant_base [32mPASSED[0m[31m [ 67%][0m
tests/logprob/test_transforms.py::test_measurable_power_exponent_with_variable_base [32mPASSED[0m[31m [ 67%][0m
tests/logprob/test_transforms.py::test_base_exponent_non_measurable [32mPASSED[0m[31m [ 67%][0m
tests/logprob/test_transforms.py::test_multivariate_rv_transform[2.0-1.5] [32mPASSED[0m[31m [ 67%][0m
tests/logprob/test_transforms.py::test_multivariate_rv_transform[2.0-shift1] [32mPASSED[0m[31m [ 67%][0m
tests/logprob/test_transforms.py::test_multivariate_rv_transform[scale1-1.5] [32mPASSED[0m[31m [ 67%][0m
tests/logprob/test_transforms.py::test_multivariate_rv_transform[scale1-shift1] [32mPASSED[0m[31m [ 67%][0m
tests/logprob/test_transforms.py::test_not_implemented_discrete_rv_transform [32mPASSED[0m[31m [ 67%][0m
tests/logprob/test_transforms.py::test_negated_discrete_rv_transform [32mPASSED[0m[31m [ 67%][0m
tests/logprob/test_transforms.py::test_shifted_discrete_rv_transform [32mPASSED[0m[31m [ 67%][0m
tests/logprob/test_transforms.py::test_invalid_broadcasted_transform_rv_fails [33mXFAIL[0m[31m [ 67%][0m
tests/logprob/test_utils.py::TestReplaceRVsByValues::test_basic[True-False] [32mPASSED[0m[31m [ 67%][0m
tests/logprob/test_utils.py::TestReplaceRVsByValues::test_basic[True-True] [32mPASSED[0m[31m [ 67%][0m
tests/logprob/test_utils.py::TestReplaceRVsByValues::test_basic[False-False] [32mPASSED[0m[31m [ 68%][0m
tests/logprob/test_utils.py::TestReplaceRVsByValues::test_basic[False-True] [32mPASSED[0m[31m [ 68%][0m
tests/logprob/test_utils.py::TestReplaceRVsByValues::test_intermediate_rv [32mPASSED[0m[31m [ 68%][0m
tests/logprob/test_utils.py::TestReplaceRVsByValues::test_unvalued_rv_model [32mPASSED[0m[31m [ 68%][0m
tests/logprob/test_utils.py::TestReplaceRVsByValues::test_no_change_inplace [32mPASSED[0m[31m [ 68%][0m
tests/logprob/test_utils.py::TestReplaceRVsByValues::test_interdependent_transformed_rvs[False] [32mPASSED[0m[31m [ 68%][0m
tests/logprob/test_utils.py::TestReplaceRVsByValues::test_interdependent_transformed_rvs[True] [32mPASSED[0m[31m [ 68%][0m
tests/logprob/test_utils.py::test_CheckParameter [32mPASSED[0m[31m                  [ 68%][0m
tests/logprob/test_utils.py::test_dirac_delta [32mPASSED[0m[31m                     [ 68%][0m
tests/logprob/test_utils.py::test_dirac_delta_logprob[dist_params0-obs0] [32mPASSED[0m[31m [ 68%][0m
tests/logprob/test_utils.py::test_dirac_delta_logprob[dist_params1-obs1] [32mPASSED[0m[31m [ 68%][0m
tests/logprob/test_utils.py::test_check_potential_measurability [32mPASSED[0m[31m   [ 68%][0m
tests/model/test_core.py::TestBaseModel::test_setattr_properly_works [32mPASSED[0m[31m [ 68%][0m
tests/model/test_core.py::TestBaseModel::test_context_passes_vars_to_parent_model [32mPASSED[0m[31m [ 68%][0m
tests/model/test_core.py::TestBaseModel::test_docstring_example [32mPASSED[0m[31m   [ 68%][0m
tests/model/test_core.py::TestNested::test_nest_context_works [32mPASSED[0m[31m     [ 68%][0m
tests/model/test_core.py::TestNested::test_named_context [32mPASSED[0m[31m          [ 68%][0m
tests/model/test_core.py::TestNested::test_docstring_example1 [32mPASSED[0m[31m     [ 68%][0m
tests/model/test_core.py::TestNested::test_docstring_example2 [32mPASSED[0m[31m     [ 68%][0m
tests/model/test_core.py::TestNested::test_duplicates_detection [32mPASSED[0m[31m   [ 68%][0m
tests/model/test_core.py::TestNested::test_model_root [32mPASSED[0m[31m             [ 68%][0m
tests/model/test_core.py::TestNested::test_prefix_add_uses_separator [32mPASSED[0m[31m [ 68%][0m
tests/model/test_core.py::TestNested::test_nested_named_model_repeated [32mPASSED[0m[31m [ 68%][0m
tests/model/test_core.py::TestNested::test_nested_named_model [32mPASSED[0m[31m     [ 68%][0m
tests/model/test_core.py::TestNested::test_nested_model_to_netcdf [32mPASSED[0m[31m [ 68%][0m
tests/model/test_core.py::TestNested::test_bad_name [32mPASSED[0m[31m               [ 68%][0m
tests/model/test_core.py::TestObserved::test_observed_rv_fail [32mPASSED[0m[31m     [ 68%][0m
tests/model/test_core.py::TestObserved::test_observed_type [32mPASSED[0m[31m        [ 68%][0m
tests/model/test_core.py::TestObserved::test_observed_compute_test_value [32mPASSED[0m[31m [ 68%][0m
tests/model/test_core.py::test_duplicate_vars [32mPASSED[0m[31m                     [ 68%][0m
tests/model/test_core.py::test_empty_observed [32mPASSED[0m[31m                     [ 68%][0m
tests/model/test_core.py::TestValueGradFunction::test_no_extra [32mPASSED[0m[31m    [ 68%][0m
tests/model/test_core.py::TestValueGradFunction::test_invalid_type [32mPASSED[0m[31m [ 68%][0m
tests/model/test_core.py::TestValueGradFunction::test_extra_not_set[False] [32mPASSED[0m[31m [ 68%][0m
tests/model/test_core.py::TestValueGradFunction::test_extra_not_set[True] [32mPASSED[0m[31m [ 68%][0m
tests/model/test_core.py::TestValueGradFunction::test_grad[False] [32mPASSED[0m[31m [ 68%][0m
tests/model/test_core.py::TestValueGradFunction::test_grad[True] [32mPASSED[0m[31m  [ 68%][0m
tests/model/test_core.py::TestValueGradFunction::test_edge_case [32mPASSED[0m[31m   [ 69%][0m
tests/model/test_core.py::TestValueGradFunction::test_missing_data [32mPASSED[0m[31m [ 69%][0m
tests/model/test_core.py::TestPytensorRelatedLogpBugs::test_pytensor_switch_broadcast_edge_cases_1 [32mPASSED[0m[31m [ 69%][0m
tests/model/test_core.py::TestPytensorRelatedLogpBugs::test_pytensor_switch_broadcast_edge_cases_2 [32mPASSED[0m[31m [ 69%][0m
tests/model/test_core.py::test_multiple_observed_rv [32mPASSED[0m[31m               [ 69%][0m
tests/model/test_core.py::test_tempered_logp_dlogp[False] [32mPASSED[0m[31m         [ 69%][0m
tests/model/test_core.py::test_tempered_logp_dlogp[True] [32mPASSED[0m[31m          [ 69%][0m
tests/model/test_core.py::TestPickling::test_model_pickle [32mPASSED[0m[31m         [ 69%][0m
tests/model/test_core.py::TestPickling::test_model_pickle_deterministic [32mPASSED[0m[31m [ 69%][0m
tests/model/test_core.py::TestPickling::test_model_roundtrip [32mPASSED[0m[31m      [ 69%][0m
tests/model/test_core.py::test_model_value_vars [32mPASSED[0m[31m                   [ 69%][0m
tests/model/test_core.py::test_model_var_maps [32mPASSED[0m[31m                     [ 69%][0m
tests/model/test_core.py::TestTransformArgs::test_transform_warning [32mPASSED[0m[31m [ 69%][0m
tests/model/test_core.py::TestTransformArgs::test_transform_order [32mPASSED[0m[31m [ 69%][0m
tests/model/test_core.py::TestTransformArgs::test_default_transform_is_applied [32mPASSED[0m[31m [ 69%][0m
tests/model/test_core.py::test_make_obs_var [32mPASSED[0m[31m                       [ 69%][0m
tests/model/test_core.py::test_initial_point [32mPASSED[0m[31m                      [ 69%][0m
tests/model/test_core.py::test_point_logps [32mPASSED[0m[31m                        [ 69%][0m
tests/model/test_core.py::test_point_logps_potential [32mPASSED[0m[31m              [ 69%][0m
tests/model/test_core.py::TestShapeEvaluation::test_eval_rv_shapes [32mPASSED[0m[31m [ 69%][0m
tests/model/test_core.py::TestCheckStartVals::test_valid_start_point [32mPASSED[0m[31m [ 69%][0m
tests/model/test_core.py::TestCheckStartVals::test_invalid_start_point [32mPASSED[0m[31m [ 69%][0m
tests/model/test_core.py::TestCheckStartVals::test_invalid_variable_name [32mPASSED[0m[31m [ 69%][0m
tests/model/test_core.py::TestCheckStartVals::test_mode[None] [32mPASSED[0m[31m     [ 69%][0m
tests/model/test_core.py::TestCheckStartVals::test_mode[JAX] [32mPASSED[0m[31m      [ 69%][0m
tests/model/test_core.py::TestCheckStartVals::test_mode[NUMBA] [32mPASSED[0m[31m    [ 69%][0m
tests/model/test_core.py::test_set_initval [32mPASSED[0m[31m                        [ 69%][0m
tests/model/test_core.py::test_datalogp_multiple_shapes [32mPASSED[0m[31m           [ 69%][0m
tests/model/test_core.py::test_nested_model_coords [32mPASSED[0m[31m                [ 69%][0m
tests/model/test_core.py::test_multiple_add_coords_with_same_name [32mPASSED[0m[31m [ 69%][0m
tests/model/test_core.py::TestSetUpdateCoords::test_shapeerror_from_set_data_dimensionality [32mPASSED[0m[31m [ 69%][0m
tests/model/test_core.py::TestSetUpdateCoords::test_resize_from_set_data_dim_with_coords [32mPASSED[0m[31m [ 69%][0m
tests/model/test_core.py::TestSetUpdateCoords::test_resize_from_set_data_dim_without_coords [32mPASSED[0m[31m [ 69%][0m
tests/model/test_core.py::TestSetUpdateCoords::test_resize_from_set_dim [32mPASSED[0m[31m [ 69%][0m
tests/model/test_core.py::TestSetUpdateCoords::test_resize_from_set_data_and_set_dim [32mPASSED[0m[31m [ 69%][0m
tests/model/test_core.py::TestSetUpdateCoords::test_add_named_variable_checks_dim_name [32mPASSED[0m[31m [ 69%][0m
tests/model/test_core.py::TestSetUpdateCoords::test_add_named_variable_checks_number_of_dims [32mPASSED[0m[31m [ 69%][0m
tests/model/test_core.py::TestSetUpdateCoords::test_rv_dims_type_check [32mPASSED[0m[31m [ 70%][0m
tests/model/test_core.py::TestSetUpdateCoords::test_none_coords_autonumbering [32mPASSED[0m[31m [ 70%][0m
tests/model/test_core.py::TestSetUpdateCoords::test_set_data_indirect_resize_without_coords [32mPASSED[0m[31m [ 70%][0m
tests/model/test_core.py::TestSetUpdateCoords::test_set_data_indirect_resize_with_coords [32mPASSED[0m[31m [ 70%][0m
tests/model/test_core.py::TestSetUpdateCoords::test_set_data_warns_on_resize_of_dims_defined_by_other_data [32mPASSED[0m[31m [ 70%][0m
tests/model/test_core.py::TestSetUpdateCoords::test_set_data_constant_shape_error [32mPASSED[0m[31m [ 70%][0m
tests/model/test_core.py::test_model_logp[True] [32mPASSED[0m[31m                   [ 70%][0m
tests/model/test_core.py::test_model_logp[False] [32mPASSED[0m[31m                  [ 70%][0m
tests/model/test_core.py::test_model_dlogp[True] [32mPASSED[0m[31m                  [ 70%][0m
tests/model/test_core.py::test_model_dlogp[False] [32mPASSED[0m[31m                 [ 70%][0m
tests/model/test_core.py::test_model_d2logp[True] [32mPASSED[0m[31m                 [ 70%][0m
tests/model/test_core.py::test_model_d2logp[False] [32mPASSED[0m[31m                [ 70%][0m
tests/model/test_core.py::test_deterministic [32mPASSED[0m[31m                      [ 70%][0m
tests/model/test_core.py::test_determinsitic_with_dims [32mPASSED[0m[31m            [ 70%][0m
tests/model/test_core.py::test_potential_with_dims [32mPASSED[0m[31m                [ 70%][0m
tests/model/test_core.py::test_empty_model_representation [32mPASSED[0m[31m         [ 70%][0m
tests/model/test_core.py::test_compile_fn [32mPASSED[0m[31m                         [ 70%][0m
tests/model/test_core.py::test_model_parent_set_programmatically [32mPASSED[0m[31m  [ 70%][0m
tests/model/test_core.py::TestModelContext::test_thread_safety [32mPASSED[0m[31m    [ 70%][0m
tests/model/test_core.py::test_mixed_contexts [32mPASSED[0m[31m                     [ 70%][0m
tests/model/test_core.py::TestProfile::test_profile_model [32mPASSED[0m[31m         [ 70%][0m
tests/model/test_core.py::TestProfile::test_profile_variable [32mPASSED[0m[31m      [ 70%][0m
tests/model/test_core.py::TestProfile::test_profile_count [32mPASSED[0m[31m         [ 70%][0m
tests/model/test_core.py::TestImputationMissingData::test_missing_basic[masked] [32mPASSED[0m[31m [ 70%][0m
tests/model/test_core.py::TestImputationMissingData::test_missing_basic[pandas] [32mPASSED[0m[31m [ 70%][0m
tests/model/test_core.py::TestImputationMissingData::test_missing_with_predictors [32mPASSED[0m[31m [ 70%][0m
tests/model/test_core.py::TestImputationMissingData::test_missing_dual_observations [32mPASSED[0m[31m [ 70%][0m
tests/model/test_core.py::TestImputationMissingData::test_interval_missing_observations [32mPASSED[0m[31m [ 70%][0m
tests/model/test_core.py::TestImputationMissingData::test_missing_logp1 [32mPASSED[0m[31m [ 70%][0m
tests/model/test_core.py::TestImputationMissingData::test_missing_logp2 [32mPASSED[0m[31m [ 70%][0m
tests/model/test_core.py::TestImputationMissingData::test_missing_multivariate_separable [32mPASSED[0m[31m [ 70%][0m
tests/model/test_core.py::TestImputationMissingData::test_missing_multivariate_unseparable [32mPASSED[0m[31m [ 70%][0m
tests/model/test_core.py::TestImputationMissingData::test_missing_vector_parameter [32mPASSED[0m[31m [ 70%][0m
tests/model/test_core.py::TestImputationMissingData::test_missing_symmetric [32mPASSED[0m[31m [ 70%][0m
tests/model/test_core.py::TestImputationMissingData::test_dims [32mPASSED[0m[31m    [ 70%][0m
tests/model/test_core.py::TestImputationMissingData::test_symbolic_random_variable [32mPASSED[0m[31m [ 70%][0m
tests/model/test_core.py::TestImputationMissingData::test_truncated_normal [32mPASSED[0m[31m [ 71%][0m
tests/model/test_core.py::TestImputationMissingData::test_coordinates [32mPASSED[0m[31m [ 71%][0m
tests/model/test_core.py::TestShared::test_deterministic [32mPASSED[0m[31m          [ 71%][0m
tests/model/test_core.py::TestModelDebug::test_no_problems[logp] [32mPASSED[0m[31m  [ 71%][0m
tests/model/test_core.py::TestModelDebug::test_no_problems[dlogp] [32mPASSED[0m[31m [ 71%][0m
tests/model/test_core.py::TestModelDebug::test_no_problems[random] [32mPASSED[0m[31m [ 71%][0m
tests/model/test_core.py::TestModelDebug::test_invalid_parameter[logp] [32mPASSED[0m[31m [ 71%][0m
tests/model/test_core.py::TestModelDebug::test_invalid_parameter[dlogp] [32mPASSED[0m[31m [ 71%][0m
tests/model/test_core.py::TestModelDebug::test_invalid_parameter[random] [32mPASSED[0m[31m [ 71%][0m
tests/model/test_core.py::TestModelDebug::test_invalid_parameter_cant_be_evaluated[logp-True] [32mPASSED[0m[31m [ 71%][0m
tests/model/test_core.py::TestModelDebug::test_invalid_parameter_cant_be_evaluated[logp-False] [32mPASSED[0m[31m [ 71%][0m
tests/model/test_core.py::TestModelDebug::test_invalid_parameter_cant_be_evaluated[dlogp-True] [32mPASSED[0m[31m [ 71%][0m
tests/model/test_core.py::TestModelDebug::test_invalid_parameter_cant_be_evaluated[dlogp-False] [32mPASSED[0m[31m [ 71%][0m
tests/model/test_core.py::TestModelDebug::test_invalid_parameter_cant_be_evaluated[random-True] [32mPASSED[0m[31m [ 71%][0m
tests/model/test_core.py::TestModelDebug::test_invalid_parameter_cant_be_evaluated[random-False] [32mPASSED[0m[31m [ 71%][0m
tests/model/test_core.py::TestModelDebug::test_invalid_value [32mPASSED[0m[31m      [ 71%][0m
tests/model/test_core.py::TestModelDebug::test_invalid_observed_value [32mPASSED[0m[31m [ 71%][0m
tests/model/test_core.py::test_model_logp_fast_compile [32mPASSED[0m[31m            [ 71%][0m
tests/model/test_core.py::TestModelGraphs::test_graphviz_call_function[ext-all] [32mPASSED[0m[31m [ 71%][0m
tests/model/test_core.py::TestModelGraphs::test_graphviz_call_function[ext-subset] [32mPASSED[0m[31m [ 71%][0m
tests/model/test_core.py::TestModelGraphs::test_graphviz_call_function[no_ext-all] [32mPASSED[0m[31m [ 71%][0m
tests/model/test_core.py::TestModelGraphs::test_graphviz_call_function[no_ext-subset] [32mPASSED[0m[31m [ 71%][0m
tests/model/test_core.py::TestModelCopy::test_copy_model[copy] [32mPASSED[0m[31m    [ 71%][0m
tests/model/test_core.py::TestModelCopy::test_copy_model[deepcopy] [32mPASSED[0m[31m [ 71%][0m
tests/model/test_core.py::TestModelCopy::test_guassian_process_copy_failure[copy] [32mPASSED[0m[31m [ 71%][0m
tests/model/test_core.py::TestModelCopy::test_guassian_process_copy_failure[deepcopy] [32mPASSED[0m[31m [ 71%][0m
tests/model/test_fgraph.py::test_basic [32mPASSED[0m[31m                            [ 71%][0m
tests/model/test_fgraph.py::test_data[False] [32mPASSED[0m[31m                      [ 71%][0m
tests/model/test_fgraph.py::test_data[True] [32mPASSED[0m[31m                       [ 71%][0m
tests/model/test_fgraph.py::test_shared_variable [32mPASSED[0m[31m                  [ 71%][0m
tests/model/test_fgraph.py::test_deterministics[False] [32mPASSED[0m[31m            [ 71%][0m
tests/model/test_fgraph.py::test_deterministics[True] [32mPASSED[0m[31m             [ 71%][0m
tests/model/test_fgraph.py::test_context_error [32mPASSED[0m[31m                    [ 71%][0m
tests/model/test_fgraph.py::test_sub_model_error [32mPASSED[0m[31m                  [ 71%][0m
tests/model/test_fgraph.py::test_fgraph_rewrite [32mPASSED[0m[31m                   [ 71%][0m
tests/model/test_fgraph.py::test_multivariate_transform [32mPASSED[0m[31m           [ 71%][0m
tests/model/transform/test_basic.py::test_prune_vars_detached_from_observed [32mPASSED[0m[31m [ 71%][0m
tests/model/transform/test_basic.py::test_remove_minibatches [32mPASSED[0m[31m      [ 72%][0m
tests/model/transform/test_conditioning.py::test_observe [32mPASSED[0m[31m          [ 72%][0m
tests/model/transform/test_conditioning.py::test_observe_minibatch [32mPASSED[0m[31m [ 72%][0m
tests/model/transform/test_conditioning.py::test_observe_deterministic [32mPASSED[0m[31m [ 72%][0m
tests/model/transform/test_conditioning.py::test_observe_dims [32mPASSED[0m[31m     [ 72%][0m
tests/model/transform/test_conditioning.py::test_do [32mPASSED[0m[31m               [ 72%][0m
tests/model/transform/test_conditioning.py::test_do_posterior_predictive [32mPASSED[0m[31m [ 72%][0m
tests/model/transform/test_conditioning.py::test_do_constant[False] [32mPASSED[0m[31m [ 72%][0m
tests/model/transform/test_conditioning.py::test_do_constant[True] [32mPASSED[0m[31m [ 72%][0m
tests/model/transform/test_conditioning.py::test_do_deterministic [32mPASSED[0m[31m [ 72%][0m
tests/model/transform/test_conditioning.py::test_do_dims [32mPASSED[0m[31m          [ 72%][0m
tests/model/transform/test_conditioning.py::test_do_prune[False] [32mPASSED[0m[31m  [ 72%][0m
tests/model/transform/test_conditioning.py::test_do_prune[True] [32mPASSED[0m[31m   [ 72%][0m
tests/model/transform/test_conditioning.py::test_do_self_reference [32mPASSED[0m[31m [ 72%][0m
tests/model/transform/test_conditioning.py::test_do_make_intervenstions_shared [32mPASSED[0m[31m [ 72%][0m
tests/model/transform/test_conditioning.py::test_do_sample_posterior_predictive[True] [32mPASSED[0m[31m [ 72%][0m
tests/model/transform/test_conditioning.py::test_do_sample_posterior_predictive[False] [33mXFAIL[0m[31m [ 72%][0m
tests/model/transform/test_conditioning.py::test_change_value_transforms [32mPASSED[0m[31m [ 72%][0m
tests/model/transform/test_conditioning.py::test_change_value_transforms_error [32mPASSED[0m[31m [ 72%][0m
tests/model/transform/test_conditioning.py::test_remove_value_transforms [32mPASSED[0m[31m [ 72%][0m
tests/model/transform/test_optimization.py::test_freeze_dims_and_data [32mPASSED[0m[31m [ 72%][0m
tests/model/transform/test_optimization.py::test_freeze_dims_nothing_to_change [32mPASSED[0m[31m [ 72%][0m
tests/model/transform/test_optimization.py::test_freeze_dims_and_data_subset [32mPASSED[0m[31m [ 72%][0m
tests/model/transform/test_optimization.py::test_freeze_dim_after_do_intervention [32mPASSED[0m[31m [ 72%][0m
tests/model/transform/test_optimization.py::test_freeze_dims_and_data_partially_observed_rv [32mPASSED[0m[31m [ 72%][0m
tests/ode/test_ode.py::test_simulate [32mPASSED[0m[31m                              [ 72%][0m
tests/ode/test_ode.py::TestSensitivityInitialCondition::test_sens_ic_scalar_1_param [32mPASSED[0m[31m [ 72%][0m
tests/ode/test_ode.py::TestSensitivityInitialCondition::test_sens_ic_scalar_2_param [32mPASSED[0m[31m [ 72%][0m
tests/ode/test_ode.py::TestSensitivityInitialCondition::test_sens_ic_vector_1_param [32mPASSED[0m[31m [ 72%][0m
tests/ode/test_ode.py::TestSensitivityInitialCondition::test_sens_ic_vector_2_param [32mPASSED[0m[31m [ 72%][0m
tests/ode/test_ode.py::TestSensitivityInitialCondition::test_sens_ic_vector_2_param_tensor [32mPASSED[0m[31m [ 72%][0m
tests/ode/test_ode.py::TestSensitivityInitialCondition::test_sens_ic_vector_3_params [32mPASSED[0m[31m [ 72%][0m
tests/ode/test_ode.py::test_logp_scalar_ode [32mPASSED[0m[31m                       [ 72%][0m
tests/ode/test_ode.py::TestErrors::test_too_many_params [32mPASSED[0m[31m           [ 72%][0m
tests/ode/test_ode.py::TestErrors::test_too_many_y0 [32mPASSED[0m[31m               [ 72%][0m
tests/ode/test_ode.py::TestErrors::test_too_few_params [32mPASSED[0m[31m            [ 72%][0m
tests/ode/test_ode.py::TestErrors::test_too_few_y0 [32mPASSED[0m[31m                [ 72%][0m
tests/ode/test_ode.py::TestErrors::test_func_callable [32mPASSED[0m[31m             [ 73%][0m
tests/ode/test_ode.py::TestErrors::test_number_of_states [32mPASSED[0m[31m          [ 73%][0m
tests/ode/test_ode.py::TestErrors::test_number_of_params [32mPASSED[0m[31m          [ 73%][0m
tests/ode/test_ode.py::TestErrors::test_tensor_shape [32mPASSED[0m[31m              [ 73%][0m
tests/ode/test_ode.py::TestErrors::test_list_shape [32mPASSED[0m[31m                [ 73%][0m
tests/ode/test_ode.py::TestErrors::test_unexpected_return_type_set [32mPASSED[0m[31m [ 73%][0m
tests/ode/test_ode.py::TestErrors::test_unexpected_return_type_dict [32mPASSED[0m[31m [ 73%][0m
tests/ode/test_ode.py::TestDiffEqModel::test_op_equality [32mPASSED[0m[31m          [ 73%][0m
tests/ode/test_ode.py::TestDiffEqModel::test_scalar_ode_1_param [32mPASSED[0m[31m   [ 73%][0m
tests/ode/test_ode.py::TestDiffEqModel::test_scalar_ode_2_param [32mPASSED[0m[31m   [ 73%][0m
tests/ode/test_ode.py::TestDiffEqModel::test_vector_ode_1_param [32mPASSED[0m[31m   [ 73%][0m
tests/ode/test_ode.py::TestDiffEqModel::test_vector_ode_2_param [32mPASSED[0m[31m   [ 73%][0m
tests/ode/test_utils.py::test_gradients [32mPASSED[0m[31m                           [ 73%][0m
tests/sampling/test_deterministic.py::test_compute_deterministics [32mPASSED[0m[31m [ 73%][0m
tests/sampling/test_deterministic.py::test_docstring_example [32mPASSED[0m[31m      [ 73%][0m
tests/sampling/test_forward.py::TestDraw::test_univariate [32mPASSED[0m[31m         [ 73%][0m
tests/sampling/test_forward.py::TestDraw::test_multivariate [32mPASSED[0m[31m       [ 73%][0m
tests/sampling/test_forward.py::TestDraw::test_multiple_variables [32mPASSED[0m[31m [ 73%][0m
tests/sampling/test_forward.py::TestDraw::test_draw_different_samples [32mPASSED[0m[31m [ 73%][0m
tests/sampling/test_forward.py::TestDraw::test_draw_pytensor_function_kwargs [32mPASSED[0m[31m [ 73%][0m
tests/sampling/test_forward.py::TestCompileForwardSampler::test_linear_model [32mPASSED[0m[31m [ 73%][0m
tests/sampling/test_forward.py::TestCompileForwardSampler::test_nested_observed_model [32mPASSED[0m[31m [ 73%][0m
tests/sampling/test_forward.py::TestCompileForwardSampler::test_volatile_parameters [32mPASSED[0m[31m [ 73%][0m
tests/sampling/test_forward.py::TestCompileForwardSampler::test_mixture [32mPASSED[0m[31m [ 73%][0m
tests/sampling/test_forward.py::TestCompileForwardSampler::test_censored [32mPASSED[0m[31m [ 73%][0m
tests/sampling/test_forward.py::TestCompileForwardSampler::test_lkj_cholesky_cov [32mPASSED[0m[31m [ 73%][0m
tests/sampling/test_forward.py::TestCompileForwardSampler::test_non_random_model_variable [32mPASSED[0m[31m [ 73%][0m
tests/sampling/test_forward.py::TestCompileForwardSampler::test_mutable_coords_volatile [32mPASSED[0m[31m [ 73%][0m
tests/sampling/test_forward.py::TestCompileForwardSampler::test_length_coords_volatile [32mPASSED[0m[31m [ 73%][0m
tests/sampling/test_forward.py::TestSamplePPC::test_normal_scalar [32mPASSED[0m[31m [ 73%][0m
tests/sampling/test_forward.py::TestSamplePPC::test_normal_scalar_idata [32mPASSED[0m[31m [ 73%][0m
tests/sampling/test_forward.py::TestSamplePPC::test_external_trace_det [32mPASSED[0m[31m [ 73%][0m
tests/sampling/test_forward.py::TestSamplePPC::test_normal_vector [32mPASSED[0m[31m [ 73%][0m
tests/sampling/test_forward.py::TestSamplePPC::test_normal_vector_idata [32mPASSED[0m[31m [ 73%][0m
tests/sampling/test_forward.py::TestSamplePPC::test_exceptions [32mPASSED[0m[31m    [ 73%][0m
tests/sampling/test_forward.py::TestSamplePPC::test_sum_normal [32mPASSED[0m[31m    [ 73%][0m
tests/sampling/test_forward.py::TestSamplePPC::test_model_not_drawable_prior [32mPASSED[0m[31m [ 73%][0m
tests/sampling/test_forward.py::TestSamplePPC::test_model_shared_variable [32mPASSED[0m[31m [ 74%][0m
tests/sampling/test_forward.py::TestSamplePPC::test_deterministic_of_observed [32mPASSED[0m[31m [ 74%][0m
tests/sampling/test_forward.py::TestSamplePPC::test_deterministic_of_observed_modified_interface [32mPASSED[0m[31m [ 74%][0m
tests/sampling/test_forward.py::TestSamplePPC::test_variable_type [32mPASSED[0m[31m [ 74%][0m
tests/sampling/test_forward.py::TestSamplePPC::test_potentials_warning [32mPASSED[0m[31m [ 74%][0m
tests/sampling/test_forward.py::TestSamplePPC::test_idata_extension [32mPASSED[0m[31m [ 74%][0m
tests/sampling/test_forward.py::TestSamplePPC::test_deterministics_out_of_idata[False] [32mPASSED[0m[31m [ 74%][0m
tests/sampling/test_forward.py::TestSamplePPC::test_deterministics_out_of_idata[True] [32mPASSED[0m[31m [ 74%][0m
tests/sampling/test_forward.py::TestSamplePPC::test_logging_sampled_basic_rvs_prior [32mPASSED[0m[31m [ 74%][0m
tests/sampling/test_forward.py::TestSamplePPC::test_logging_sampled_basic_rvs_posterior [32mPASSED[0m[31m [ 74%][0m
tests/sampling/test_forward.py::TestSamplePPC::test_logging_sampled_basic_rvs_posterior_deterministic [32mPASSED[0m[31m [ 74%][0m
tests/sampling/test_forward.py::TestSamplePPC::test_logging_sampled_basic_rvs_posterior_mutable[MultiTrace] [32mPASSED[0m[31m [ 74%][0m
tests/sampling/test_forward.py::TestSamplePPC::test_logging_sampled_basic_rvs_posterior_mutable[InferenceData] [32mPASSED[0m[31m [ 74%][0m
tests/sampling/test_forward.py::TestSamplePPC::test_logging_sampled_basic_rvs_posterior_mutable[Dataset] [32mPASSED[0m[31m [ 74%][0m
tests/sampling/test_forward.py::TestSamplePPC::test_observed_data_needed_in_pp [32mPASSED[0m[31m [ 74%][0m
tests/sampling/test_forward.py::TestSamplePriorPredictive::test_ignores_observed [32mPASSED[0m[31m [ 74%][0m
tests/sampling/test_forward.py::TestSamplePriorPredictive::test_respects_shape [32mPASSED[0m[31m [ 74%][0m
tests/sampling/test_forward.py::TestSamplePriorPredictive::test_multivariate [32mPASSED[0m[31m [ 74%][0m
tests/sampling/test_forward.py::TestSamplePriorPredictive::test_multivariate2 [32mPASSED[0m[31m [ 74%][0m
tests/sampling/test_forward.py::TestSamplePriorPredictive::test_layers [32mPASSED[0m[31m [ 74%][0m
tests/sampling/test_forward.py::TestSamplePriorPredictive::test_transformed [32mPASSED[0m[31m [ 74%][0m
tests/sampling/test_forward.py::TestSamplePriorPredictive::test_shared [32mPASSED[0m[31m [ 74%][0m
tests/sampling/test_forward.py::TestSamplePriorPredictive::test_density_dist [32mPASSED[0m[31m [ 74%][0m
tests/sampling/test_forward.py::TestSamplePriorPredictive::test_shape_edgecase [32mPASSED[0m[31m [ 74%][0m
tests/sampling/test_forward.py::TestSamplePriorPredictive::test_zeroinflatedpoisson [32mPASSED[0m[31m [ 74%][0m
tests/sampling/test_forward.py::TestSamplePriorPredictive::test_potentials_warning [32mPASSED[0m[31m [ 74%][0m
tests/sampling/test_forward.py::TestSamplePriorPredictive::test_transformed_vars_not_supported [32mPASSED[0m[31m [ 74%][0m
tests/sampling/test_forward.py::TestSamplePriorPredictive::test_issue_4490 [32mPASSED[0m[31m [ 74%][0m
tests/sampling/test_forward.py::TestSamplePriorPredictive::test_pytensor_function_kwargs [32mPASSED[0m[31m [ 74%][0m
tests/sampling/test_forward.py::TestSamplePosteriorPredictive::test_point_list_arg_bug_spp [32mPASSED[0m[31m [ 74%][0m
tests/sampling/test_forward.py::TestSamplePosteriorPredictive::test_sample_from_xarray_prior [32mPASSED[0m[31m [ 74%][0m
tests/sampling/test_forward.py::TestSamplePosteriorPredictive::test_sample_from_xarray_posterior [32mPASSED[0m[31m [ 74%][0m
tests/sampling/test_forward.py::TestSamplePosteriorPredictive::test_pytensor_function_kwargs [32mPASSED[0m[31m [ 74%][0m
tests/sampling/test_forward.py::TestSamplePosteriorPredictive::test_sample_dims [32mPASSED[0m[31m [ 74%][0m
tests/sampling/test_forward.py::test_distinct_rvs [32mPASSED[0m[31m                 [ 74%][0m
tests/sampling/test_forward.py::TestNestedRandom::test_NegativeBinomial[10-(3,)-(None, ())-(None, (3,))] [32mPASSED[0m[31m [ 74%][0m
tests/sampling/test_forward.py::TestNestedRandom::test_NegativeBinomial[10-(3,)-(None, (3,))-(None, ())] [32mPASSED[0m[31m [ 74%][0m
tests/sampling/test_forward.py::TestNestedRandom::test_NegativeBinomial[10-(4, 3)-(None, (3,))-(None, (3,))] [32mPASSED[0m[31m [ 75%][0m
tests/sampling/test_forward.py::TestNestedRandom::test_NegativeBinomial[10-(4, 3)-(None, (3,))-(None, (4, 3))] [32mPASSED[0m[31m [ 75%][0m
tests/sampling/test_forward.py::TestNestedRandom::test_ZeroInflatedNegativeBinomial[10-(3,)-(0.5, ())-(None, ())-(None, (3,))] [32mPASSED[0m[31m [ 75%][0m
tests/sampling/test_forward.py::TestNestedRandom::test_ZeroInflatedNegativeBinomial[10-(3,)-(0.5, (3,))-(None, ())-(None, (3,))] [32mPASSED[0m[31m [ 75%][0m
tests/sampling/test_forward.py::TestNestedRandom::test_ZeroInflatedNegativeBinomial[10-(3,)-(0.5, ())-(None, (3,))-(None, ())] [32mPASSED[0m[31m [ 75%][0m
tests/sampling/test_forward.py::TestNestedRandom::test_ZeroInflatedNegativeBinomial[10-(3,)-(0.5, (3,))-(None, (3,))-(None, ())] [32mPASSED[0m[31m [ 75%][0m
tests/sampling/test_forward.py::TestNestedRandom::test_ZeroInflatedNegativeBinomial[10-(4, 3)-(0.5, (3,))-(None, (3,))-(None, (3,))] [32mPASSED[0m[31m [ 75%][0m
tests/sampling/test_forward.py::TestNestedRandom::test_ZeroInflatedNegativeBinomial[10-(4, 3)-(0.5, (3,))-(None, (3,))-(None, (4, 3))] [32mPASSED[0m[31m [ 75%][0m
tests/sampling/test_forward.py::TestNestedRandom::test_Rice[10-(3,)-(None, ())-(None, (3,))0] [32mPASSED[0m[31m [ 75%][0m
tests/sampling/test_forward.py::TestNestedRandom::test_Rice[10-(3,)-(None, ())-(None, (3,))1] [32mPASSED[0m[31m [ 75%][0m
tests/sampling/test_forward.py::TestNestedRandom::test_Rice[10-(3,)-(None, (3,))-(None, ())0] [32mPASSED[0m[31m [ 75%][0m
tests/sampling/test_forward.py::TestNestedRandom::test_Rice[10-(3,)-(None, (3,))-(None, ())1] [32mPASSED[0m[31m [ 75%][0m
tests/sampling/test_forward.py::TestNestedRandom::test_Rice[10-(4, 3)-(None, (3,))-(None, (3,))] [32mPASSED[0m[31m [ 75%][0m
tests/sampling/test_forward.py::TestNestedRandom::test_Rice[10-(4, 3)-(None, (3,))-(None, (4, 3))] [32mPASSED[0m[31m [ 75%][0m
tests/sampling/test_forward.py::TestNestedRandom::test_TruncatedNormal[10-(3,)-(None, ())-(1.0, ())-(None, (), -1)-(None, (3,))0] [32mPASSED[0m[31m [ 75%][0m
tests/sampling/test_forward.py::TestNestedRandom::test_TruncatedNormal[10-(3,)-(None, ())-(1.0, ())-(None, (), -1)-(None, (3,))1] [32mPASSED[0m[31m [ 75%][0m
tests/sampling/test_forward.py::TestNestedRandom::test_TruncatedNormal[10-(3,)-(None, ())-(1.0, ())-(None, (3,), -1)-(None, ())0] [32mPASSED[0m[31m [ 75%][0m
tests/sampling/test_forward.py::TestNestedRandom::test_TruncatedNormal[10-(3,)-(None, ())-(1.0, ())-(None, (3,), -1)-(None, ())1] [32mPASSED[0m[31m [ 75%][0m
tests/sampling/test_forward.py::TestNestedRandom::test_TruncatedNormal[10-(4, 3)-(None, (3,))-(1.0, ())-(None, (3,), -1)-(None, (3,))] [32mPASSED[0m[31m [ 75%][0m
tests/sampling/test_forward.py::TestNestedRandom::test_TruncatedNormal[10-(4, 3)-(None, (3,))-(1.0, ())-(None, (3,), -1)-(None, (4, 3))] [32mPASSED[0m[31m [ 75%][0m
tests/sampling/test_forward.py::TestNestedRandom::test_TruncatedNormal[10-(3,)-(0.0, ())-(None, ())-(None, (), -1)-(None, (3,))0] [32mPASSED[0m[31m [ 75%][0m
tests/sampling/test_forward.py::TestNestedRandom::test_TruncatedNormal[10-(3,)-(0.0, ())-(None, ())-(None, (), -1)-(None, (3,))1] [32mPASSED[0m[31m [ 75%][0m
tests/sampling/test_forward.py::TestNestedRandom::test_TruncatedNormal[10-(3,)-(0.0, ())-(None, ())-(None, (3,), -1)-(None, ())0] [32mPASSED[0m[31m [ 75%][0m
tests/sampling/test_forward.py::TestNestedRandom::test_TruncatedNormal[10-(3,)-(0.0, ())-(None, ())-(None, (3,), -1)-(None, ())1] [32mPASSED[0m[31m [ 75%][0m
tests/sampling/test_forward.py::TestNestedRandom::test_TruncatedNormal[10-(4, 3)-(0.0, ())-(None, (3,))-(None, (3,), -1)-(None, (3,))] [32mPASSED[0m[31m [ 75%][0m
tests/sampling/test_forward.py::TestNestedRandom::test_TruncatedNormal[10-(4, 3)-(0.0, ())-(None, (3,))-(None, (3,), -1)-(None, (4, 3))] [32mPASSED[0m[31m [ 75%][0m
tests/sampling/test_forward.py::TestNestedRandom::test_Triangular[10-(3,)-(None, ())-(-1.0, (3,))-(2, ())] [32mPASSED[0m[31m [ 75%][0m
tests/sampling/test_forward.py::TestNestedRandom::test_Triangular[10-(3,)-(None, ())-(-1.0, ())-(None, (), 1)] [32mPASSED[0m[31m [ 75%][0m
tests/sampling/test_forward.py::TestNestedRandom::test_Triangular[10-(3,)-(None, (3,))-(-1.0, ())-(None, (), 1)] [32mPASSED[0m[31m [ 75%][0m
tests/sampling/test_forward.py::TestNestedRandom::test_Triangular[10-(4, 3)-(None, (3,))-(-1.0, ())-(None, (3,), 1)] [32mPASSED[0m[31m [ 75%][0m
tests/sampling/test_forward.py::TestNestedRandom::test_Triangular[10-(4, 3)-(None, (3,))-(None, (), -1)-(None, (3,), 1)] [32mPASSED[0m[31m [ 75%][0m
tests/sampling/test_forward.py::test_get_constant_coords [32mPASSED[0m[31m          [ 75%][0m
tests/sampling/test_forward.py::test_get_vars_in_point_list [32mPASSED[0m[31m       [ 75%][0m
tests/sampling/test_forward.py::test_observed_dependent_deterministics [32mPASSED[0m[31m [ 75%][0m
tests/sampling/test_forward.py::test_sample_prior_predictive_samples_deprecated_warns [32mPASSED[0m[31m [ 75%][0m
tests/sampling/test_forward.py::test_vectorize_over_posterior[nested_random_variables-deterministic-rv_from_posterior-allow_rvs_in_graph] [32mPASSED[0m[31m [ 75%][0m
tests/sampling/test_forward.py::test_vectorize_over_posterior[nested_random_variables-deterministic-rv_from_posterior-disallow_rvs_in_graph] [32mPASSED[0m[31m [ 75%][0m
tests/sampling/test_forward.py::test_vectorize_over_posterior[nested_random_variables-deterministic-resample_rv-allow_rvs_in_graph] [32mPASSED[0m[31m [ 76%][0m
tests/sampling/test_forward.py::test_vectorize_over_posterior[nested_random_variables-deterministic-resample_rv-disallow_rvs_in_graph] [32mPASSED[0m[31m [ 76%][0m
tests/sampling/test_forward.py::test_vectorize_over_posterior[nested_random_variables-observed-rv_from_posterior-allow_rvs_in_graph] [32mPASSED[0m[31m [ 76%][0m
tests/sampling/test_forward.py::test_vectorize_over_posterior[nested_random_variables-observed-rv_from_posterior-disallow_rvs_in_graph] [32mPASSED[0m[31m [ 76%][0m
tests/sampling/test_forward.py::test_vectorize_over_posterior[nested_random_variables-observed-resample_rv-allow_rvs_in_graph] [32mPASSED[0m[31m [ 76%][0m
tests/sampling/test_forward.py::test_vectorize_over_posterior[nested_random_variables-observed-resample_rv-disallow_rvs_in_graph] [32mPASSED[0m[31m [ 76%][0m
tests/sampling/test_forward.py::test_vectorize_over_posterior[nested_random_variables-conditioned_on_observed-rv_from_posterior-allow_rvs_in_graph] [32mPASSED[0m[31m [ 76%][0m
tests/sampling/test_forward.py::test_vectorize_over_posterior[nested_random_variables-conditioned_on_observed-rv_from_posterior-disallow_rvs_in_graph] [32mPASSED[0m[31m [ 76%][0m
tests/sampling/test_forward.py::test_vectorize_over_posterior[nested_random_variables-conditioned_on_observed-resample_rv-allow_rvs_in_graph] [32mPASSED[0m[31m [ 76%][0m
tests/sampling/test_forward.py::test_vectorize_over_posterior[nested_random_variables-conditioned_on_observed-resample_rv-disallow_rvs_in_graph] [32mPASSED[0m[31m [ 76%][0m
tests/sampling/test_forward.py::test_vectorize_over_posterior[no_nested_random_variables-deterministic-rv_from_posterior-allow_rvs_in_graph] [32mPASSED[0m[31m [ 76%][0m
tests/sampling/test_forward.py::test_vectorize_over_posterior[no_nested_random_variables-deterministic-rv_from_posterior-disallow_rvs_in_graph] [32mPASSED[0m[31m [ 76%][0m
tests/sampling/test_forward.py::test_vectorize_over_posterior[no_nested_random_variables-deterministic-resample_rv-allow_rvs_in_graph] [32mPASSED[0m[31m [ 76%][0m
tests/sampling/test_forward.py::test_vectorize_over_posterior[no_nested_random_variables-deterministic-resample_rv-disallow_rvs_in_graph] [32mPASSED[0m[31m [ 76%][0m
tests/sampling/test_forward.py::test_vectorize_over_posterior[no_nested_random_variables-observed-rv_from_posterior-allow_rvs_in_graph] [32mPASSED[0m[31m [ 76%][0m
tests/sampling/test_forward.py::test_vectorize_over_posterior[no_nested_random_variables-observed-rv_from_posterior-disallow_rvs_in_graph] [32mPASSED[0m[31m [ 76%][0m
tests/sampling/test_forward.py::test_vectorize_over_posterior[no_nested_random_variables-observed-resample_rv-allow_rvs_in_graph] [32mPASSED[0m[31m [ 76%][0m
tests/sampling/test_forward.py::test_vectorize_over_posterior[no_nested_random_variables-observed-resample_rv-disallow_rvs_in_graph] [32mPASSED[0m[31m [ 76%][0m
tests/sampling/test_forward.py::test_vectorize_over_posterior[no_nested_random_variables-conditioned_on_observed-rv_from_posterior-allow_rvs_in_graph] [32mPASSED[0m[31m [ 76%][0m
tests/sampling/test_forward.py::test_vectorize_over_posterior[no_nested_random_variables-conditioned_on_observed-rv_from_posterior-disallow_rvs_in_graph] [32mPASSED[0m[31m [ 76%][0m
tests/sampling/test_forward.py::test_vectorize_over_posterior[no_nested_random_variables-conditioned_on_observed-resample_rv-allow_rvs_in_graph] [32mPASSED[0m[31m [ 76%][0m
tests/sampling/test_forward.py::test_vectorize_over_posterior[no_nested_random_variables-conditioned_on_observed-resample_rv-disallow_rvs_in_graph] [32mPASSED[0m[31m [ 76%][0m
tests/sampling/test_forward.py::test_vectorize_over_posterior_matches_sample [32mPASSED[0m[31m [ 76%][0m
tests/sampling/test_forward.py::test_vectorize_over_posterior_with_intermediate_rvs [32mPASSED[0m[31m [ 76%][0m
tests/sampling/test_mcmc.py::TestInitNuts::test_checks_seeds_kwarg [32mPASSED[0m[31m [ 76%][0m
tests/sampling/test_mcmc.py::TestSample::test_random_seed[1-None-1-jitter+adapt_diag] [32mPASSED[0m[31m [ 76%][0m
tests/sampling/test_mcmc.py::TestSample::test_random_seed[1-None-1-advi] [32mPASSED[0m[31m [ 76%][0m
tests/sampling/test_mcmc.py::TestSample::test_random_seed[1-None-1-map] [32mPASSED[0m[31m [ 76%][0m
tests/sampling/test_mcmc.py::TestSample::test_random_seed[1-None-2-jitter+adapt_diag] [32mPASSED[0m[31m [ 76%][0m
tests/sampling/test_mcmc.py::TestSample::test_random_seed[1-None-2-advi] [32mPASSED[0m[31m [ 76%][0m
tests/sampling/test_mcmc.py::TestSample::test_random_seed[1-None-2-map] [32mPASSED[0m[31m [ 76%][0m
tests/sampling/test_mcmc.py::TestSample::test_random_seed[1-1-1-jitter+adapt_diag] [32mPASSED[0m[31m [ 76%][0m
tests/sampling/test_mcmc.py::TestSample::test_random_seed[1-1-1-advi] [32mPASSED[0m[31m [ 76%][0m
tests/sampling/test_mcmc.py::TestSample::test_random_seed[1-1-1-map] [32mPASSED[0m[31m [ 76%][0m
tests/sampling/test_mcmc.py::TestSample::test_random_seed[1-1-2-jitter+adapt_diag] [32mPASSED[0m[31m [ 76%][0m
tests/sampling/test_mcmc.py::TestSample::test_random_seed[1-1-2-advi] [32mPASSED[0m[31m [ 76%][0m
tests/sampling/test_mcmc.py::TestSample::test_random_seed[1-1-2-map] [32mPASSED[0m[31m [ 77%][0m
tests/sampling/test_mcmc.py::TestSample::test_random_seed[1-seeds2-1-jitter+adapt_diag] [32mPASSED[0m[31m [ 77%][0m
tests/sampling/test_mcmc.py::TestSample::test_random_seed[1-seeds2-1-advi] [32mPASSED[0m[31m [ 77%][0m
tests/sampling/test_mcmc.py::TestSample::test_random_seed[1-seeds2-1-map] [32mPASSED[0m[31m [ 77%][0m
tests/sampling/test_mcmc.py::TestSample::test_random_seed[1-seeds2-2-jitter+adapt_diag] [32mPASSED[0m[31m [ 77%][0m
tests/sampling/test_mcmc.py::TestSample::test_random_seed[1-seeds2-2-advi] [32mPASSED[0m[31m [ 77%][0m
tests/sampling/test_mcmc.py::TestSample::test_random_seed[1-seeds2-2-map] [32mPASSED[0m[31m [ 77%][0m
tests/sampling/test_mcmc.py::TestSample::test_random_seed[2-None-1-jitter+adapt_diag] [32mPASSED[0m[31m [ 77%][0m
tests/sampling/test_mcmc.py::TestSample::test_random_seed[2-None-1-advi] [32mPASSED[0m[31m [ 77%][0m
tests/sampling/test_mcmc.py::TestSample::test_random_seed[2-None-1-map] [32mPASSED[0m[31m [ 77%][0m
tests/sampling/test_mcmc.py::TestSample::test_random_seed[2-None-2-jitter+adapt_diag] [32mPASSED[0m[31m [ 77%][0m
tests/sampling/test_mcmc.py::TestSample::test_random_seed[2-None-2-advi] [32mPASSED[0m[31m [ 77%][0m
tests/sampling/test_mcmc.py::TestSample::test_random_seed[2-None-2-map] [32mPASSED[0m[31m [ 77%][0m
tests/sampling/test_mcmc.py::TestSample::test_random_seed[2-1-1-jitter+adapt_diag] [32mPASSED[0m[31m [ 77%][0m
tests/sampling/test_mcmc.py::TestSample::test_random_seed[2-1-1-advi] [32mPASSED[0m[31m [ 77%][0m
tests/sampling/test_mcmc.py::TestSample::test_random_seed[2-1-1-map] [32mPASSED[0m[31m [ 77%][0m
tests/sampling/test_mcmc.py::TestSample::test_random_seed[2-1-2-jitter+adapt_diag] [32mPASSED[0m[31m [ 77%][0m
tests/sampling/test_mcmc.py::TestSample::test_random_seed[2-1-2-advi] [32mPASSED[0m[31m [ 77%][0m
tests/sampling/test_mcmc.py::TestSample::test_random_seed[2-1-2-map] [32mPASSED[0m[31m [ 77%][0m
tests/sampling/test_mcmc.py::TestSample::test_random_seed[2-seeds5-1-jitter+adapt_diag] [32mPASSED[0m[31m [ 77%][0m
tests/sampling/test_mcmc.py::TestSample::test_random_seed[2-seeds5-1-advi] [32mPASSED[0m[31m [ 77%][0m
tests/sampling/test_mcmc.py::TestSample::test_random_seed[2-seeds5-1-map] [32mPASSED[0m[31m [ 77%][0m
tests/sampling/test_mcmc.py::TestSample::test_random_seed[2-seeds5-2-jitter+adapt_diag] [32mPASSED[0m[31m [ 77%][0m
tests/sampling/test_mcmc.py::TestSample::test_random_seed[2-seeds5-2-advi] [32mPASSED[0m[31m [ 77%][0m
tests/sampling/test_mcmc.py::TestSample::test_random_seed[2-seeds5-2-map] [32mPASSED[0m[31m [ 77%][0m
tests/sampling/test_mcmc.py::TestSample::test_default_sample_does_not_set_global_seed [32mPASSED[0m[31m [ 77%][0m
tests/sampling/test_mcmc.py::TestSample::test_sample_does_not_rely_on_external_global_seeding [32mPASSED[0m[31m [ 77%][0m
tests/sampling/test_mcmc.py::TestSample::test_sample_init[advi] [32mPASSED[0m[31m   [ 77%][0m
tests/sampling/test_mcmc.py::TestSample::test_sample_init[advi_map] [32mPASSED[0m[31m [ 77%][0m
tests/sampling/test_mcmc.py::TestSample::test_sample_init[map] [32mPASSED[0m[31m    [ 77%][0m
tests/sampling/test_mcmc.py::TestSample::test_sample_init[adapt_diag] [32mPASSED[0m[31m [ 77%][0m
tests/sampling/test_mcmc.py::TestSample::test_sample_init[jitter+adapt_diag] [32mPASSED[0m[31m [ 77%][0m
tests/sampling/test_mcmc.py::TestSample::test_sample_init[jitter+adapt_diag_grad] [32mPASSED[0m[31m [ 77%][0m
tests/sampling/test_mcmc.py::TestSample::test_sample_init[adapt_full] [32mPASSED[0m[31m [ 77%][0m
tests/sampling/test_mcmc.py::TestSample::test_sample_init[jitter+adapt_full] [32mPASSED[0m[31m [ 77%][0m
tests/sampling/test_mcmc.py::TestSample::test_sample_args [32mPASSED[0m[31m         [ 77%][0m
tests/sampling/test_mcmc.py::TestSample::test_parallel_start [32mPASSED[0m[31m      [ 77%][0m
tests/sampling/test_mcmc.py::TestSample::test_reset_tuning [32mPASSED[0m[31m        [ 78%][0m
tests/sampling/test_mcmc.py::TestSample::test_sample_start_bad_shape[start0-ValueError] [32mPASSED[0m[31m [ 78%][0m
tests/sampling/test_mcmc.py::TestSample::test_sample_start_bad_shape[start1-ValueError] [32mPASSED[0m[31m [ 78%][0m
tests/sampling/test_mcmc.py::TestSample::test_sample_start_bad_shape[start2-ValueError] [32mPASSED[0m[31m [ 78%][0m
tests/sampling/test_mcmc.py::TestSample::test_sample_start_good_shape[start0] [32mPASSED[0m[31m [ 78%][0m
tests/sampling/test_mcmc.py::TestSample::test_sample_start_good_shape[start1] [32mPASSED[0m[31m [ 78%][0m
tests/sampling/test_mcmc.py::TestSample::test_sample_start_good_shape[start2] [32mPASSED[0m[31m [ 78%][0m
tests/sampling/test_mcmc.py::TestSample::test_sample_callback [32mPASSED[0m[31m     [ 78%][0m
tests/sampling/test_mcmc.py::TestSample::test_callback_can_cancel [32mPASSED[0m[31m [ 78%][0m
tests/sampling/test_mcmc.py::TestSample::test_sequential_backend [32mPASSED[0m[31m  [ 78%][0m
tests/sampling/test_mcmc.py::TestSample::test_deterministic_of_unobserved[False] [32mPASSED[0m[31m [ 78%][0m
tests/sampling/test_mcmc.py::TestSample::test_deterministic_of_unobserved[True] [32mPASSED[0m[31m [ 78%][0m
tests/sampling/test_mcmc.py::TestSample::test_transform_with_rv_dependency[False] [32mPASSED[0m[31m [ 78%][0m
tests/sampling/test_mcmc.py::TestSample::test_transform_with_rv_dependency[True] [32mPASSED[0m[31m [ 78%][0m
tests/sampling/test_mcmc.py::TestSampleReturn::test_sample_return_lengths [32mPASSED[0m[31m [ 78%][0m
tests/sampling/test_mcmc.py::TestSampleReturn::test_logs_sampler_warnings[1] [32mPASSED[0m[31m [ 78%][0m
tests/sampling/test_mcmc.py::TestSampleReturn::test_logs_sampler_warnings[2] [32mPASSED[0m[31m [ 78%][0m
tests/sampling/test_mcmc.py::TestSampleReturn::test_keep_warning_stat_setting[None] [32mPASSED[0m[31m [ 78%][0m
tests/sampling/test_mcmc.py::TestSampleReturn::test_keep_warning_stat_setting[True] [32mPASSED[0m[31m [ 78%][0m
tests/sampling/test_mcmc.py::test_sample_find_MAP_does_not_modify_start [32mPASSED[0m[31m [ 78%][0m
tests/sampling/test_mcmc.py::test_empty_model [32mPASSED[0m[31m                     [ 78%][0m
tests/sampling/test_mcmc.py::test_blas_cores [32mPASSED[0m[31m                      [ 78%][0m
tests/sampling/test_mcmc.py::test_partial_trace_with_trace_unsupported [32mPASSED[0m[31m [ 78%][0m
tests/sampling/test_mcmc.py::TestNamedSampling::test_shared_named [32mPASSED[0m[31m [ 78%][0m
tests/sampling/test_mcmc.py::TestNamedSampling::test_shared_unnamed [32mPASSED[0m[31m [ 78%][0m
tests/sampling/test_mcmc.py::TestNamedSampling::test_constant_named [32mPASSED[0m[31m [ 78%][0m
tests/sampling/test_mcmc.py::test_exec_nuts_init[advi] [32mPASSED[0m[31m            [ 78%][0m
tests/sampling/test_mcmc.py::test_exec_nuts_init[ADVI+adapt_diag] [32mPASSED[0m[31m [ 78%][0m
tests/sampling/test_mcmc.py::test_exec_nuts_init[advi_map] [32mPASSED[0m[31m        [ 78%][0m
tests/sampling/test_mcmc.py::test_exec_nuts_init[jitter+adapt_diag] [32mPASSED[0m[31m [ 78%][0m
tests/sampling/test_mcmc.py::test_exec_nuts_init[adapt_diag] [32mPASSED[0m[31m      [ 78%][0m
tests/sampling/test_mcmc.py::test_exec_nuts_init[map] [32mPASSED[0m[31m             [ 78%][0m
tests/sampling/test_mcmc.py::test_exec_nuts_init[adapt_full] [32mPASSED[0m[31m      [ 78%][0m
tests/sampling/test_mcmc.py::test_exec_nuts_init[jitter+adapt_full] [32mPASSED[0m[31m [ 78%][0m
tests/sampling/test_mcmc.py::test_init_jitter[0-0-expectation0] [33mSKIPPED[0m[31m  [ 78%][0m
tests/sampling/test_mcmc.py::test_init_jitter[0-1-expectation1] [33mSKIPPED[0m[31m  [ 78%][0m
tests/sampling/test_mcmc.py::test_init_jitter[0-4-expectation2] [33mSKIPPED[0m[31m  [ 78%][0m
tests/sampling/test_mcmc.py::test_init_jitter[0-10-expectation3] [33mSKIPPED[0m[31m [ 79%][0m
tests/sampling/test_mcmc.py::test_init_jitter[1-0-expectation4] [33mSKIPPED[0m[31m  [ 79%][0m
tests/sampling/test_mcmc.py::test_step_args [32mPASSED[0m[31m                       [ 79%][0m
tests/sampling/test_mcmc.py::test_init_nuts [32mPASSED[0m[31m                       [ 79%][0m
tests/sampling/test_mcmc.py::test_no_init_nuts_step [32mPASSED[0m[31m               [ 79%][0m
tests/sampling/test_mcmc.py::test_no_init_nuts_compound [32mPASSED[0m[31m           [ 79%][0m
tests/sampling/test_mcmc.py::test_sample_var_names [32mPASSED[0m[31m                [ 79%][0m
tests/sampling/test_mcmc.py::TestAssignStepMethods::test_bernoulli [32mPASSED[0m[31m [ 79%][0m
tests/sampling/test_mcmc.py::TestAssignStepMethods::test_normal [32mPASSED[0m[31m   [ 79%][0m
tests/sampling/test_mcmc.py::TestAssignStepMethods::test_categorical [32mPASSED[0m[31m [ 79%][0m
tests/sampling/test_mcmc.py::TestAssignStepMethods::test_binomial [32mPASSED[0m[31m [ 79%][0m
tests/sampling/test_mcmc.py::TestAssignStepMethods::test_normal_nograd_op [32mPASSED[0m[31m [ 79%][0m
tests/sampling/test_mcmc.py::TestAssignStepMethods::test_modify_step_methods [32mPASSED[0m[31m [ 79%][0m
tests/sampling/test_mcmc.py::TestAssignStepMethods::test_step_vars_in_model [32mPASSED[0m[31m [ 79%][0m
tests/sampling/test_mcmc.py::TestType::test_float64 [32mPASSED[0m[31m               [ 79%][0m
tests/sampling/test_mcmc.py::TestType::test_float32 [32mPASSED[0m[31m               [ 79%][0m
tests/sampling/test_mcmc.py::TestShared::test_sample [32mPASSED[0m[31m              [ 79%][0m
tests/sampling/test_mcmc_external.py::test_external_nuts_sampler[pymc] [32mPASSED[0m[31m [ 79%][0m
tests/sampling/test_mcmc_external.py::test_external_nuts_sampler[nutpie] [33mSKIPPED[0m[31m [ 79%][0m
tests/sampling/test_mcmc_external.py::test_external_nuts_sampler[blackjax] [33mSKIPPED[0m[31m [ 79%][0m
tests/sampling/test_mcmc_external.py::test_external_nuts_sampler[numpyro] [33mSKIPPED[0m[31m [ 79%][0m
tests/sampling/test_mcmc_external.py::test_step_args [33mSKIPPED[0m (could not
import 'numpyro': No module named 'numpyro')[31m                             [ 79%][0m
tests/sampling/test_mcmc_external.py::test_sample_var_names[pymc] [32mPASSED[0m[31m [ 79%][0m
tests/sampling/test_mcmc_external.py::test_sample_var_names[nutpie] [33mSKIPPED[0m[31m [ 79%][0m
tests/sampling/test_mcmc_external.py::test_sample_var_names[blackjax] [33mSKIPPED[0m[31m [ 79%][0m
tests/sampling/test_mcmc_external.py::test_sample_var_names[numpyro] [33mSKIPPED[0m[31m [ 79%][0m
tests/sampling/test_parallel.py::test_context [32mPASSED[0m[31m                     [ 79%][0m
tests/sampling/test_parallel.py::test_bad_unpickle [32mPASSED[0m[31m                [ 79%][0m
tests/sampling/test_parallel.py::test_remote_pipe_closed [32mPASSED[0m[31m          [ 79%][0m
tests/sampling/test_parallel.py::test_abort[spawn] [33mSKIPPED[0m (Unclear)[31m     [ 79%][0m
tests/sampling/test_parallel.py::test_abort[fork] [33mSKIPPED[0m (Unclear)[31m      [ 79%][0m
tests/sampling/test_parallel.py::test_explicit_sample[spawn] [32mPASSED[0m[31m      [ 79%][0m
tests/sampling/test_parallel.py::test_explicit_sample[fork] [32mPASSED[0m[31m       [ 79%][0m
tests/sampling/test_parallel.py::test_iterator [32mPASSED[0m[31m                    [ 79%][0m
tests/sampling/test_parallel.py::test_spawn_densitydist_function [32mPASSED[0m[31m  [ 79%][0m
tests/sampling/test_parallel.py::test_spawn_densitydist_bound_method [32mPASSED[0m[31m [ 79%][0m
tests/sampling/test_parallel.py::test_sampling_with_random_generator_matches[1] [32mPASSED[0m[31m [ 79%][0m
tests/sampling/test_parallel.py::test_sampling_with_random_generator_matches[2] [32mPASSED[0m[31m [ 80%][0m
tests/sampling/test_population.py::TestPopulationSamplers::test_checks_population_size [32mPASSED[0m[31m [ 80%][0m
tests/sampling/test_population.py::TestPopulationSamplers::test_demcmc_warning_on_small_populations [32mPASSED[0m[31m [ 80%][0m
tests/sampling/test_population.py::TestPopulationSamplers::test_nonparallelized_chains_are_random [32mPASSED[0m[31m [ 80%][0m
tests/sampling/test_population.py::TestPopulationSamplers::test_parallelized_chains_are_random [32mPASSED[0m[31m [ 80%][0m
tests/smc/test_smc.py::TestSMC::test_sample [32mPASSED[0m[31m                       [ 80%][0m
tests/smc/test_smc.py::TestSMC::test_discrete_rounding_proposal [32mPASSED[0m[31m   [ 80%][0m
tests/smc/test_smc.py::TestSMC::test_unobserved_bernoulli [32mPASSED[0m[31m         [ 80%][0m
tests/smc/test_smc.py::TestSMC::test_unobserved_categorical [32mPASSED[0m[31m       [ 80%][0m
tests/smc/test_smc.py::TestSMC::test_parallel_custom [32mPASSED[0m[31m              [ 80%][0m
tests/smc/test_smc.py::TestSMC::test_marginal_likelihood [32mPASSED[0m[31m          [ 80%][0m
tests/smc/test_smc.py::TestSMC::test_start [32mPASSED[0m[31m                        [ 80%][0m
tests/smc/test_smc.py::TestSMC::test_kernel_kwargs [32mPASSED[0m[31m                [ 80%][0m
tests/smc/test_smc.py::TestSMC::test_return_datatype[1] [32mPASSED[0m[31m           [ 80%][0m
tests/smc/test_smc.py::TestSMC::test_return_datatype[2] [32mPASSED[0m[31m           [ 80%][0m
tests/smc/test_smc.py::TestSMC::test_convergence_checks [32mPASSED[0m[31m           [ 80%][0m
tests/smc/test_smc.py::TestSMC::test_ordered [32mPASSED[0m[31m                      [ 80%][0m
tests/smc/test_smc.py::TestMHKernel::test_normal_model [32mPASSED[0m[31m            [ 80%][0m
tests/smc/test_smc.py::TestMHKernel::test_proposal_dist_shape [32mPASSED[0m[31m     [ 80%][0m
tests/smc/test_smc.py::test_systematic [32mPASSED[0m[31m                            [ 80%][0m
tests/stats/test_convergence.py::test_warn_divergences[plural] [32mPASSED[0m[31m    [ 80%][0m
tests/stats/test_convergence.py::test_warn_divergences[singular] [32mPASSED[0m[31m  [ 80%][0m
tests/stats/test_convergence.py::test_warn_treedepth [32mPASSED[0m[31m              [ 80%][0m
tests/stats/test_convergence.py::test_warn_treedepth_multiple_samplers [32mPASSED[0m[31m [ 80%][0m
tests/stats/test_convergence.py::test_log_warning_stats [32mPASSED[0m[31m           [ 80%][0m
tests/stats/test_convergence.py::test_log_warning_stats_knows_SamplerWarning [32mPASSED[0m[31m [ 80%][0m
tests/stats/test_log_density.py::TestComputeLogLikelihood::test_basic[False] [32mPASSED[0m[31m [ 80%][0m
tests/stats/test_log_density.py::TestComputeLogLikelihood::test_basic[True] [32mPASSED[0m[31m [ 80%][0m
tests/stats/test_log_density.py::TestComputeLogLikelihood::test_multivariate [32mPASSED[0m[31m [ 80%][0m
tests/stats/test_log_density.py::TestComputeLogLikelihood::test_var_names [32mPASSED[0m[31m [ 80%][0m
tests/stats/test_log_density.py::TestComputeLogLikelihood::test_invalid_var_names [32mPASSED[0m[31m [ 80%][0m
tests/stats/test_log_density.py::TestComputeLogLikelihood::test_dims_without_coords [32mPASSED[0m[31m [ 80%][0m
tests/stats/test_log_density.py::TestComputeLogLikelihood::test_basic_log_prior[False] [32mPASSED[0m[31m [ 80%][0m
tests/stats/test_log_density.py::TestComputeLogLikelihood::test_basic_log_prior[True] [32mPASSED[0m[31m [ 80%][0m
tests/stats/test_log_density.py::TestComputeLogLikelihood::test_deterministic_log_prior [32mPASSED[0m[31m [ 80%][0m
tests/stats/test_log_density.py::TestComputeLogLikelihood::test_compilation_kwargs [32mPASSED[0m[31m [ 80%][0m
tests/step_methods/hmc/test_hmc.py::TestStepHamiltonianMC::test_step_continuous[<lambda>-1000_0] [32mPASSED[0m[31m [ 80%][0m
tests/step_methods/hmc/test_hmc.py::TestStepHamiltonianMC::test_step_continuous[<lambda>-1000_1] [32mPASSED[0m[31m [ 81%][0m
tests/step_methods/hmc/test_hmc.py::TestRVsAssignmentHamiltonianMC::test_continuous_steps[HamiltonianMC-step_kwargs0] [32mPASSED[0m[31m [ 81%][0m
tests/step_methods/hmc/test_hmc.py::test_leapfrog_reversible [32mPASSED[0m[31m      [ 81%][0m
tests/step_methods/hmc/test_hmc.py::test_nuts_tuning [32mPASSED[0m[31m              [ 81%][0m
tests/step_methods/hmc/test_nuts.py::TestNUTSUniform::test_kstest <- tests/sampler_fixtures.py [32mPASSED[0m[31m [ 81%][0m
tests/step_methods/hmc/test_nuts.py::TestNUTSUniform::test_var <- tests/sampler_fixtures.py [32mPASSED[0m[31m [ 81%][0m
tests/step_methods/hmc/test_nuts.py::TestNUTSUniform::test_mean <- tests/sampler_fixtures.py [32mPASSED[0m[31m [ 81%][0m
tests/step_methods/hmc/test_nuts.py::TestNUTSUniform::test_neff <- tests/sampler_fixtures.py [32mPASSED[0m[31m [ 81%][0m
tests/step_methods/hmc/test_nuts.py::TestNUTSUniform::test_Rhat <- tests/sampler_fixtures.py [32mPASSED[0m[31m [ 81%][0m
tests/step_methods/hmc/test_nuts.py::TestNUTSUniform::test_target_accept <- tests/sampler_fixtures.py [32mPASSED[0m[31m [ 81%][0m
tests/step_methods/hmc/test_nuts.py::TestNUTSUniform2::test_kstest <- tests/sampler_fixtures.py [32mPASSED[0m[31m [ 81%][0m
tests/step_methods/hmc/test_nuts.py::TestNUTSUniform2::test_var <- tests/sampler_fixtures.py [32mPASSED[0m[31m [ 81%][0m
tests/step_methods/hmc/test_nuts.py::TestNUTSUniform2::test_mean <- tests/sampler_fixtures.py [32mPASSED[0m[31m [ 81%][0m
tests/step_methods/hmc/test_nuts.py::TestNUTSUniform2::test_neff <- tests/sampler_fixtures.py [32mPASSED[0m[31m [ 81%][0m
tests/step_methods/hmc/test_nuts.py::TestNUTSUniform2::test_Rhat <- tests/sampler_fixtures.py [32mPASSED[0m[31m [ 81%][0m
tests/step_methods/hmc/test_nuts.py::TestNUTSUniform2::test_target_accept <- tests/sampler_fixtures.py [32mPASSED[0m[31m [ 81%][0m
tests/step_methods/hmc/test_nuts.py::TestNUTSUniform3::test_kstest <- tests/sampler_fixtures.py [32mPASSED[0m[31m [ 81%][0m
tests/step_methods/hmc/test_nuts.py::TestNUTSUniform3::test_var <- tests/sampler_fixtures.py [32mPASSED[0m[31m [ 81%][0m
tests/step_methods/hmc/test_nuts.py::TestNUTSUniform3::test_mean <- tests/sampler_fixtures.py [32mPASSED[0m[31m [ 81%][0m
tests/step_methods/hmc/test_nuts.py::TestNUTSUniform3::test_neff <- tests/sampler_fixtures.py [32mPASSED[0m[31m [ 81%][0m
tests/step_methods/hmc/test_nuts.py::TestNUTSUniform3::test_Rhat <- tests/sampler_fixtures.py [32mPASSED[0m[31m [ 81%][0m
tests/step_methods/hmc/test_nuts.py::TestNUTSUniform3::test_target_accept <- tests/sampler_fixtures.py [32mPASSED[0m[31m [ 81%][0m
tests/step_methods/hmc/test_nuts.py::TestNUTSNormal::test_kstest <- tests/sampler_fixtures.py [32mPASSED[0m[31m [ 81%][0m
tests/step_methods/hmc/test_nuts.py::TestNUTSNormal::test_var <- tests/sampler_fixtures.py [32mPASSED[0m[31m [ 81%][0m
tests/step_methods/hmc/test_nuts.py::TestNUTSNormal::test_mean <- tests/sampler_fixtures.py [32mPASSED[0m[31m [ 81%][0m
tests/step_methods/hmc/test_nuts.py::TestNUTSNormal::test_neff <- tests/sampler_fixtures.py [32mPASSED[0m[31m [ 81%][0m
tests/step_methods/hmc/test_nuts.py::TestNUTSNormal::test_Rhat <- tests/sampler_fixtures.py [32mPASSED[0m[31m [ 81%][0m
tests/step_methods/hmc/test_nuts.py::TestNUTSNormal::test_target_accept <- tests/sampler_fixtures.py [32mPASSED[0m[31m [ 81%][0m
tests/step_methods/hmc/test_nuts.py::TestNUTSBetaBinomial::test_kstest <- tests/sampler_fixtures.py [32mPASSED[0m[31m [ 81%][0m
tests/step_methods/hmc/test_nuts.py::TestNUTSBetaBinomial::test_neff <- tests/sampler_fixtures.py [32mPASSED[0m[31m [ 81%][0m
tests/step_methods/hmc/test_nuts.py::TestNUTSBetaBinomial::test_Rhat <- tests/sampler_fixtures.py [32mPASSED[0m[31m [ 81%][0m
tests/step_methods/hmc/test_nuts.py::TestNUTSBetaBinomial::test_target_accept <- tests/sampler_fixtures.py [32mPASSED[0m[31m [ 81%][0m
tests/step_methods/hmc/test_nuts.py::TestNUTSStudentT::test_kstest <- tests/sampler_fixtures.py [32mPASSED[0m[31m [ 81%][0m
tests/step_methods/hmc/test_nuts.py::TestNUTSStudentT::test_mean <- tests/sampler_fixtures.py [32mPASSED[0m[31m [ 81%][0m
tests/step_methods/hmc/test_nuts.py::TestNUTSStudentT::test_neff <- tests/sampler_fixtures.py [32mPASSED[0m[31m [ 81%][0m
tests/step_methods/hmc/test_nuts.py::TestNUTSStudentT::test_Rhat <- tests/sampler_fixtures.py [32mPASSED[0m[31m [ 81%][0m
tests/step_methods/hmc/test_nuts.py::TestNUTSStudentT::test_target_accept <- tests/sampler_fixtures.py [32mPASSED[0m[31m [ 81%][0m
tests/step_methods/hmc/test_nuts.py::TestNUTSNormalLong::test_kstest <- tests/sampler_fixtures.py [33mSKIPPED[0m[31m [ 82%][0m
tests/step_methods/hmc/test_nuts.py::TestNUTSNormalLong::test_var <- tests/sampler_fixtures.py [33mSKIPPED[0m[31m [ 82%][0m
tests/step_methods/hmc/test_nuts.py::TestNUTSNormalLong::test_mean <- tests/sampler_fixtures.py [33mSKIPPED[0m[31m [ 82%][0m
tests/step_methods/hmc/test_nuts.py::TestNUTSNormalLong::test_neff <- tests/sampler_fixtures.py [33mSKIPPED[0m[31m [ 82%][0m
tests/step_methods/hmc/test_nuts.py::TestNUTSNormalLong::test_Rhat <- tests/sampler_fixtures.py [33mSKIPPED[0m[31m [ 82%][0m
tests/step_methods/hmc/test_nuts.py::TestNUTSNormalLong::test_target_accept <- tests/sampler_fixtures.py [33mSKIPPED[0m[31m [ 82%][0m
tests/step_methods/hmc/test_nuts.py::TestNUTSLKJCholeskyCov::test_kstest <- tests/sampler_fixtures.py [32mPASSED[0m[31m [ 82%][0m
tests/step_methods/hmc/test_nuts.py::TestNUTSLKJCholeskyCov::test_neff <- tests/sampler_fixtures.py [32mPASSED[0m[31m [ 82%][0m
tests/step_methods/hmc/test_nuts.py::TestNUTSLKJCholeskyCov::test_Rhat <- tests/sampler_fixtures.py [32mPASSED[0m[31m [ 82%][0m
tests/step_methods/hmc/test_nuts.py::TestNUTSLKJCholeskyCov::test_target_accept <- tests/sampler_fixtures.py [32mPASSED[0m[31m [ 82%][0m
tests/step_methods/hmc/test_nuts.py::TestNutsCheckTrace::test_multiple_samplers [32mPASSED[0m[31m [ 82%][0m
tests/step_methods/hmc/test_nuts.py::TestNutsCheckTrace::test_bad_init_nonparallel [32mPASSED[0m[31m [ 82%][0m
tests/step_methods/hmc/test_nuts.py::TestNutsCheckTrace::test_bad_init_parallel [32mPASSED[0m[31m [ 82%][0m
tests/step_methods/hmc/test_nuts.py::TestNutsCheckTrace::test_emits_energy_warnings [32mPASSED[0m[31m [ 82%][0m
tests/step_methods/hmc/test_nuts.py::TestNutsCheckTrace::test_sampler_stats [32mPASSED[0m[31m [ 82%][0m
tests/step_methods/hmc/test_nuts.py::TestStepNUTS::test_step_continuous[<lambda>-1000_0] [32mPASSED[0m[31m [ 82%][0m
tests/step_methods/hmc/test_nuts.py::TestStepNUTS::test_step_continuous[<lambda>-1000_1] [32mPASSED[0m[31m [ 82%][0m
tests/step_methods/hmc/test_nuts.py::TestRVsAssignmentNUTS::test_continuous_steps[NUTS-step_kwargs0] [32mPASSED[0m[31m [ 82%][0m
tests/step_methods/hmc/test_nuts.py::test_nuts_step_legacy_value_grad_function [32mPASSED[0m[31m [ 82%][0m
tests/step_methods/hmc/test_quadpotential.py::test_elemwise_posdef [32mPASSED[0m[31m [ 82%][0m
tests/step_methods/hmc/test_quadpotential.py::test_elemwise_velocity [32mPASSED[0m[31m [ 82%][0m
tests/step_methods/hmc/test_quadpotential.py::test_elemwise_energy [32mPASSED[0m[31m [ 82%][0m
tests/step_methods/hmc/test_quadpotential.py::test_equal_diag [32mPASSED[0m[31m     [ 82%][0m
tests/step_methods/hmc/test_quadpotential.py::test_equal_dense [32mPASSED[0m[31m    [ 82%][0m
tests/step_methods/hmc/test_quadpotential.py::test_random_diag [32mPASSED[0m[31m    [ 82%][0m
tests/step_methods/hmc/test_quadpotential.py::test_random_dense [32mPASSED[0m[31m   [ 82%][0m
tests/step_methods/hmc/test_quadpotential.py::test_user_potential [32mPASSED[0m[31m [ 82%][0m
tests/step_methods/hmc/test_quadpotential.py::test_weighted_covariance [32mPASSED[0m[31m [ 82%][0m
tests/step_methods/hmc/test_quadpotential.py::test_full_adapt_sample_p [32mPASSED[0m[31m [ 82%][0m
tests/step_methods/hmc/test_quadpotential.py::test_full_adapt_update_window [32mPASSED[0m[31m [ 82%][0m
tests/step_methods/hmc/test_quadpotential.py::test_full_adapt_adaptation_window [32mPASSED[0m[31m [ 82%][0m
tests/step_methods/hmc/test_quadpotential.py::test_full_adapt_not_invertible [32mPASSED[0m[31m [ 82%][0m
tests/step_methods/hmc/test_quadpotential.py::test_full_adapt_warn [32mPASSED[0m[31m [ 82%][0m
tests/step_methods/hmc/test_quadpotential.py::test_full_adapt_sampling [32mPASSED[0m[31m [ 82%][0m
tests/step_methods/test_compound.py::test_all_stepmethods_emit_tune_stat [32mPASSED[0m[31m [ 82%][0m
tests/step_methods/test_compound.py::TestCompoundStep::test_non_blocked [32mPASSED[0m[31m [ 82%][0m
tests/step_methods/test_compound.py::TestCompoundStep::test_blocked [32mPASSED[0m[31m [ 83%][0m
tests/step_methods/test_compound.py::TestCompoundStep::test_name [32mPASSED[0m[31m  [ 83%][0m
tests/step_methods/test_compound.py::TestStepCompound::test_step_continuous[<function TestStepCompound.<lambda> at 0x7f0bb3a45a60>-1000] [32mPASSED[0m[31m [ 83%][0m
tests/step_methods/test_compound.py::TestRVsAssignmentCompound::test_compound_step [32mPASSED[0m[31m [ 83%][0m
tests/step_methods/test_compound.py::TestStatsMetadata::test_infer_warn_stats_info [32mPASSED[0m[31m [ 83%][0m
tests/step_methods/test_compound.py::TestStatsMetadata::test_stats_from_steps [32mPASSED[0m[31m [ 83%][0m
tests/step_methods/test_compound.py::TestStatsBijection::test_flatten_steps [32mPASSED[0m[31m [ 83%][0m
tests/step_methods/test_compound.py::TestStatsBijection::test_stats_bijection [32mPASSED[0m[31m [ 83%][0m
tests/step_methods/test_metropolis.py::TestMetropolisUniform::test_kstest <- tests/sampler_fixtures.py [32mPASSED[0m[31m [ 83%][0m
tests/step_methods/test_metropolis.py::TestMetropolisUniform::test_var <- tests/sampler_fixtures.py [32mPASSED[0m[31m [ 83%][0m
tests/step_methods/test_metropolis.py::TestMetropolisUniform::test_mean <- tests/sampler_fixtures.py [32mPASSED[0m[31m [ 83%][0m
tests/step_methods/test_metropolis.py::TestMetropolisUniform::test_neff <- tests/sampler_fixtures.py [32mPASSED[0m[31m [ 83%][0m
tests/step_methods/test_metropolis.py::TestMetropolisUniform::test_Rhat <- tests/sampler_fixtures.py [32mPASSED[0m[31m [ 83%][0m
tests/step_methods/test_metropolis.py::TestMetropolis::test_proposal_choice [32mPASSED[0m[31m [ 83%][0m
tests/step_methods/test_metropolis.py::TestMetropolis::test_mv_proposal [32mPASSED[0m[31m [ 83%][0m
tests/step_methods/test_metropolis.py::TestMetropolis::test_tuning_reset [32mPASSED[0m[31m [ 83%][0m
tests/step_methods/test_metropolis.py::TestMetropolis::test_elemwise_update[batched_dist0] [32mPASSED[0m[31m [ 83%][0m
tests/step_methods/test_metropolis.py::TestMetropolis::test_elemwise_update[batched_dist1] [32mPASSED[0m[31m [ 83%][0m
tests/step_methods/test_metropolis.py::TestMetropolis::test_elemwise_update[batched_dist2] [32mPASSED[0m[31m [ 83%][0m
tests/step_methods/test_metropolis.py::TestMetropolis::test_elemwise_update[batched_dist3] [32mPASSED[0m[31m [ 83%][0m
tests/step_methods/test_metropolis.py::TestMetropolis::test_elemwise_update[batched_dist4] [32mPASSED[0m[31m [ 83%][0m
tests/step_methods/test_metropolis.py::TestMetropolis::test_elemwise_update_different_scales [32mPASSED[0m[31m [ 83%][0m
tests/step_methods/test_metropolis.py::TestMetropolis::test_multinomial_no_elemwise_update [32mPASSED[0m[31m [ 83%][0m
tests/step_methods/test_metropolis.py::TestDEMetropolis::test_demcmc_tune_parameter [32mPASSED[0m[31m [ 83%][0m
tests/step_methods/test_metropolis.py::TestDEMetropolisZ::test_tuning_lambda_sequential [32mPASSED[0m[31m [ 83%][0m
tests/step_methods/test_metropolis.py::TestDEMetropolisZ::test_tuning_epsilon_parallel [32mPASSED[0m[31m [ 83%][0m
tests/step_methods/test_metropolis.py::TestDEMetropolisZ::test_tuning_none [32mPASSED[0m[31m [ 83%][0m
tests/step_methods/test_metropolis.py::TestDEMetropolisZ::test_tuning_reset [32mPASSED[0m[31m [ 83%][0m
tests/step_methods/test_metropolis.py::TestDEMetropolisZ::test_tune_drop_fraction [32mPASSED[0m[31m [ 83%][0m
tests/step_methods/test_metropolis.py::TestDEMetropolisZ::test_competence[n-True-1] [32mPASSED[0m[31m [ 83%][0m
tests/step_methods/test_metropolis.py::TestDEMetropolisZ::test_competence[n-False-1] [32mPASSED[0m[31m [ 83%][0m
tests/step_methods/test_metropolis.py::TestDEMetropolisZ::test_competence[b-True-0] [32mPASSED[0m[31m [ 83%][0m
tests/step_methods/test_metropolis.py::TestDEMetropolisZ::test_competence[b-False-0] [32mPASSED[0m[31m [ 83%][0m
tests/step_methods/test_metropolis.py::TestDEMetropolisZ::test_invalid_tune[foo] [32mPASSED[0m[31m [ 83%][0m
tests/step_methods/test_metropolis.py::TestDEMetropolisZ::test_invalid_tune[True] [32mPASSED[0m[31m [ 83%][0m
tests/step_methods/test_metropolis.py::TestDEMetropolisZ::test_invalid_tune[False] [32mPASSED[0m[31m [ 83%][0m
tests/step_methods/test_metropolis.py::TestDEMetropolisZ::test_custom_proposal_dist [32mPASSED[0m[31m [ 83%][0m
tests/step_methods/test_metropolis.py::TestStepMetropolis::test_step_discrete [32mPASSED[0m[31m [ 84%][0m
tests/step_methods/test_metropolis.py::TestStepMetropolis::test_step_categorical[uniform] [32mPASSED[0m[31m [ 84%][0m
tests/step_methods/test_metropolis.py::TestStepMetropolis::test_step_categorical[proportional] [32mPASSED[0m[31m [ 84%][0m
tests/step_methods/test_metropolis.py::TestStepMetropolis::test_step_continuous[<function TestStepMetropolis.<lambda> at 0x7f0bb3a46fb0>-4000] [32mPASSED[0m[31m [ 84%][0m
tests/step_methods/test_metropolis.py::TestRVsAssignmentMetropolis::test_discrete_steps[BinaryMetropolis] [32mPASSED[0m[31m [ 84%][0m
tests/step_methods/test_metropolis.py::TestRVsAssignmentMetropolis::test_discrete_steps[BinaryGibbsMetropolis] [32mPASSED[0m[31m [ 84%][0m
tests/step_methods/test_metropolis.py::TestRVsAssignmentMetropolis::test_discrete_steps[CategoricalGibbsMetropolis] [32mPASSED[0m[31m [ 84%][0m
tests/step_methods/test_metropolis.py::TestRVsAssignmentMetropolis::test_continuous_steps[Metropolis-step_kwargs0] [32mPASSED[0m[31m [ 84%][0m
tests/step_methods/test_metropolis.py::TestRVsAssignmentMetropolis::test_continuous_steps[DEMetropolis-step_kwargs1] [32mPASSED[0m[31m [ 84%][0m
tests/step_methods/test_metropolis.py::TestRVsAssignmentMetropolis::test_continuous_steps[DEMetropolisZ-step_kwargs2] [32mPASSED[0m[31m [ 84%][0m
tests/step_methods/test_metropolis.py::test_sampling_state[Metropolis-simple_model] [32mPASSED[0m[31m [ 84%][0m
tests/step_methods/test_metropolis.py::test_sampling_state[BinaryMetropolis-simple_binary] [32mPASSED[0m[31m [ 84%][0m
tests/step_methods/test_metropolis.py::test_sampling_state[BinaryGibbsMetropolis-simple_binary] [32mPASSED[0m[31m [ 84%][0m
tests/step_methods/test_metropolis.py::test_sampling_state[CategoricalGibbsMetropolis-simple_categorical] [32mPASSED[0m[31m [ 84%][0m
tests/step_methods/test_metropolis.py::test_sampling_state[DEMetropolis-simple_model] [32mPASSED[0m[31m [ 84%][0m
tests/step_methods/test_metropolis.py::test_sampling_state[DEMetropolisZ-simple_model] [32mPASSED[0m[31m [ 84%][0m
tests/step_methods/test_slicer.py::TestSliceUniform::test_kstest <- tests/sampler_fixtures.py [32mPASSED[0m[31m [ 84%][0m
tests/step_methods/test_slicer.py::TestSliceUniform::test_var <- tests/sampler_fixtures.py [32mPASSED[0m[31m [ 84%][0m
tests/step_methods/test_slicer.py::TestSliceUniform::test_mean <- tests/sampler_fixtures.py [32mPASSED[0m[31m [ 84%][0m
tests/step_methods/test_slicer.py::TestSliceUniform::test_neff <- tests/sampler_fixtures.py [32mPASSED[0m[31m [ 84%][0m
tests/step_methods/test_slicer.py::TestSliceUniform::test_Rhat <- tests/sampler_fixtures.py [32mPASSED[0m[31m [ 84%][0m
tests/step_methods/test_slicer.py::TestStepSlicer::test_step_continuous[<function TestStepSlicer.<lambda> at 0x7f0bb3881900>-2000] [32mPASSED[0m[31m [ 84%][0m
tests/step_methods/test_slicer.py::TestStepSlicer::test_step_continuous[<function TestStepSlicer.<lambda> at 0x7f0bb3880ca0>-2000] [32mPASSED[0m[31m [ 84%][0m
tests/step_methods/test_slicer.py::TestRVsAssignmentSlicer::test_continuous_steps[Slice-step_kwargs0] [32mPASSED[0m[31m [ 84%][0m
tests/step_methods/test_state.py::test_sampling_state [32mPASSED[0m[31m             [ 84%][0m
tests/step_methods/test_state.py::test_sampling_state_rng[default_rng] [32mPASSED[0m[31m [ 84%][0m
tests/step_methods/test_state.py::test_sampling_state_rng[default_rng(1)] [32mPASSED[0m[31m [ 84%][0m
tests/step_methods/test_state.py::test_sampling_state_rng[philox] [32mPASSED[0m[31m [ 84%][0m
tests/test_data.py::TestData::test_deterministic [32mPASSED[0m[31m                  [ 84%][0m
tests/test_data.py::TestData::test_sample [32mPASSED[0m[31m                         [ 84%][0m
tests/test_data.py::TestData::test_sample_posterior_predictive_after_set_data [32mPASSED[0m[31m [ 84%][0m
tests/test_data.py::TestData::test_sample_posterior_predictive_after_set_data_with_coords [32mPASSED[0m[31m [ 84%][0m
tests/test_data.py::TestData::test_sample_after_set_data [32mPASSED[0m[31m          [ 84%][0m
tests/test_data.py::TestData::test_shared_data_as_index [32mPASSED[0m[31m           [ 84%][0m
tests/test_data.py::TestData::test_shared_data_as_rv_input [32mPASSED[0m[31m        [ 84%][0m
tests/test_data.py::TestData::test_shared_scalar_as_rv_input [32mPASSED[0m[31m      [ 84%][0m
tests/test_data.py::TestData::test_creation_of_data_outside_model_context [32mPASSED[0m[31m [ 84%][0m
tests/test_data.py::TestData::test_set_data_to_non_data_container_variables [32mPASSED[0m[31m [ 85%][0m
tests/test_data.py::TestData::test_model_to_graphviz_for_model_with_data_container [33mXFAIL[0m[31m [ 85%][0m
tests/test_data.py::TestData::test_explicit_coords [32mPASSED[0m[31m                [ 85%][0m
tests/test_data.py::TestData::test_set_coords_through_pmdata [32mPASSED[0m[31m      [ 85%][0m
tests/test_data.py::TestData::test_symbolic_coords [32mPASSED[0m[31m                [ 85%][0m
tests/test_data.py::TestData::test_implicit_coords_series [32mPASSED[0m[31m         [ 85%][0m
tests/test_data.py::TestData::test_implicit_coords_dataframe [32mPASSED[0m[31m      [ 85%][0m
tests/test_data.py::TestData::test_implicit_coords_xarray [32mPASSED[0m[31m         [ 85%][0m
tests/test_data.py::TestData::test_data_kwargs [32mPASSED[0m[31m                    [ 85%][0m
tests/test_data.py::TestData::test_masked_array_error [32mPASSED[0m[31m             [ 85%][0m
tests/test_data.py::test_data_naming [32mPASSED[0m[31m                              [ 85%][0m
tests/test_data.py::test_get_data [32mPASSED[0m[31m                                 [ 85%][0m
tests/test_data.py::TestMinibatch::test_1d [32mPASSED[0m[31m                        [ 85%][0m
tests/test_data.py::TestMinibatch::test_allowed [32mPASSED[0m[31m                   [ 85%][0m
tests/test_data.py::TestMinibatch::test_not_allowed [32mPASSED[0m[31m               [ 85%][0m
tests/test_data.py::TestMinibatch::test_assert [32mPASSED[0m[31m                    [ 85%][0m
tests/test_data.py::TestMinibatch::test_multiple_vars [32mPASSED[0m[31m             [ 85%][0m
tests/test_data.py::test_scaling_data_works_in_likelihood [32mPASSED[0m[31m         [ 85%][0m
tests/test_func_utils.py::test_find_constrained_prior[0.5-Gamma-0.1-0.4-init_guess0-fixed_params0-None] [32mPASSED[0m[31m [ 85%][0m
tests/test_func_utils.py::test_find_constrained_prior[0.5-Normal-155-180-init_guess1-fixed_params1-None] [32mPASSED[0m[31m [ 85%][0m
tests/test_func_utils.py::test_find_constrained_prior[0.5-StudentT-0.1-0.4-init_guess2-fixed_params2-None] [32mPASSED[0m[31m [ 85%][0m
tests/test_func_utils.py::test_find_constrained_prior[0.5-StudentT-0-1-init_guess3-fixed_params3-None] [32mPASSED[0m[31m [ 85%][0m
tests/test_func_utils.py::test_find_constrained_prior[0.5-Exponential-0-1-init_guess4-fixed_params4-0] [32mPASSED[0m[31m [ 85%][0m
tests/test_func_utils.py::test_find_constrained_prior[0.5-HalfNormal-0-1-init_guess5-fixed_params5-0] [32mPASSED[0m[31m [ 85%][0m
tests/test_func_utils.py::test_find_constrained_prior[0.5-Binomial-0-8-init_guess6-fixed_params6-None] [32mPASSED[0m[31m [ 85%][0m
tests/test_func_utils.py::test_find_constrained_prior[0.5-Poisson-1-15-init_guess7-fixed_params7-None] [32mPASSED[0m[31m [ 85%][0m
tests/test_func_utils.py::test_find_constrained_prior[0.5-Poisson-19-41-init_guess8-fixed_params8-None] [32mPASSED[0m[31m [ 85%][0m
tests/test_func_utils.py::test_find_constrained_prior[0.75-Gamma-0.1-0.4-init_guess0-fixed_params0-None] [32mPASSED[0m[31m [ 85%][0m
tests/test_func_utils.py::test_find_constrained_prior[0.75-Normal-155-180-init_guess1-fixed_params1-None] [32mPASSED[0m[31m [ 85%][0m
tests/test_func_utils.py::test_find_constrained_prior[0.75-StudentT-0.1-0.4-init_guess2-fixed_params2-None] [32mPASSED[0m[31m [ 85%][0m
tests/test_func_utils.py::test_find_constrained_prior[0.75-StudentT-0-1-init_guess3-fixed_params3-None] [32mPASSED[0m[31m [ 85%][0m
tests/test_func_utils.py::test_find_constrained_prior[0.75-Exponential-0-1-init_guess4-fixed_params4-0] [32mPASSED[0m[31m [ 85%][0m
tests/test_func_utils.py::test_find_constrained_prior[0.75-HalfNormal-0-1-init_guess5-fixed_params5-0] [32mPASSED[0m[31m [ 85%][0m
tests/test_func_utils.py::test_find_constrained_prior[0.75-Binomial-0-8-init_guess6-fixed_params6-None] [32mPASSED[0m[31m [ 85%][0m
tests/test_func_utils.py::test_find_constrained_prior[0.75-Poisson-1-15-init_guess7-fixed_params7-None] [32mPASSED[0m[31m [ 85%][0m
tests/test_func_utils.py::test_find_constrained_prior[0.75-Poisson-19-41-init_guess8-fixed_params8-None] [32mPASSED[0m[31m [ 85%][0m
tests/test_func_utils.py::test_find_constrained_prior[0.95-Gamma-0.1-0.4-init_guess0-fixed_params0-None] [32mPASSED[0m[31m [ 85%][0m
tests/test_func_utils.py::test_find_constrained_prior[0.95-Normal-155-180-init_guess1-fixed_params1-None] [32mPASSED[0m[31m [ 86%][0m
tests/test_func_utils.py::test_find_constrained_prior[0.95-StudentT-0.1-0.4-init_guess2-fixed_params2-None] [32mPASSED[0m[31m [ 86%][0m
tests/test_func_utils.py::test_find_constrained_prior[0.95-StudentT-0-1-init_guess3-fixed_params3-None] [32mPASSED[0m[31m [ 86%][0m
tests/test_func_utils.py::test_find_constrained_prior[0.95-Exponential-0-1-init_guess4-fixed_params4-0] [32mPASSED[0m[31m [ 86%][0m
tests/test_func_utils.py::test_find_constrained_prior[0.95-HalfNormal-0-1-init_guess5-fixed_params5-0] [32mPASSED[0m[31m [ 86%][0m
tests/test_func_utils.py::test_find_constrained_prior[0.95-Binomial-0-8-init_guess6-fixed_params6-None] [32mPASSED[0m[31m [ 86%][0m
tests/test_func_utils.py::test_find_constrained_prior[0.95-Poisson-1-15-init_guess7-fixed_params7-None] [32mPASSED[0m[31m [ 86%][0m
tests/test_func_utils.py::test_find_constrained_prior[0.95-Poisson-19-41-init_guess8-fixed_params8-None] [32mPASSED[0m[31m [ 86%][0m
tests/test_func_utils.py::test_find_constrained_prior_error_too_large[Gamma-0.1-0.4-init_guess0-fixed_params0] [32mPASSED[0m[31m [ 86%][0m
tests/test_func_utils.py::test_find_constrained_prior_error_too_large[Exponential-0.1-1-init_guess1-fixed_params1] [32mPASSED[0m[31m [ 86%][0m
tests/test_func_utils.py::test_find_constrained_prior_error_too_large[Binomial-0-2-init_guess2-fixed_params2] [32mPASSED[0m[31m [ 86%][0m
tests/test_func_utils.py::test_find_constrained_prior_input_errors [32mPASSED[0m[31m [ 86%][0m
tests/test_initial_point.py::TestInitvalEvaluation::test_make_initial_point_fns_per_chain_checks_kwargs [32mPASSED[0m[31m [ 86%][0m
tests/test_initial_point.py::TestInitvalEvaluation::test_dependent_initvals[False] [32mPASSED[0m[31m [ 86%][0m
tests/test_initial_point.py::TestInitvalEvaluation::test_dependent_initvals[True] [32mPASSED[0m[31m [ 86%][0m
tests/test_initial_point.py::TestInitvalEvaluation::test_symbolic_initval_not_supported [32mPASSED[0m[31m [ 86%][0m
tests/test_initial_point.py::TestInitvalEvaluation::test_nested_initvals [32mPASSED[0m[31m [ 86%][0m
tests/test_initial_point.py::TestInitvalEvaluation::test_initval_resizing [32mPASSED[0m[31m [ 86%][0m
tests/test_initial_point.py::TestInitvalEvaluation::test_seeding [32mPASSED[0m[31m  [ 86%][0m
tests/test_initial_point.py::TestInitvalEvaluation::test_untransformed_initial_point [32mPASSED[0m[31m [ 86%][0m
tests/test_initial_point.py::TestInitvalEvaluation::test_adds_jitter [32mPASSED[0m[31m [ 86%][0m
tests/test_initial_point.py::TestInitvalEvaluation::test_respects_overrides [32mPASSED[0m[31m [ 86%][0m
tests/test_initial_point.py::TestInitvalEvaluation::test_string_overrides_work [32mPASSED[0m[31m [ 86%][0m
tests/test_initial_point.py::TestInitvalEvaluation::test_dependent_initval_from_OFG[False] [32mPASSED[0m[31m [ 86%][0m
tests/test_initial_point.py::TestInitvalEvaluation::test_dependent_initval_from_OFG[True] [32mPASSED[0m[31m [ 86%][0m
tests/test_initial_point.py::TestSupportPoint::test_basic [32mPASSED[0m[31m         [ 86%][0m
tests/test_initial_point.py::TestSupportPoint::test_numeric_support_point_shape[Flat] [32mPASSED[0m[31m [ 86%][0m
tests/test_initial_point.py::TestSupportPoint::test_numeric_support_point_shape[HalfFlat] [32mPASSED[0m[31m [ 86%][0m
tests/test_initial_point.py::TestSupportPoint::test_symbolic_support_point_shape[Flat] [32mPASSED[0m[31m [ 86%][0m
tests/test_initial_point.py::TestSupportPoint::test_symbolic_support_point_shape[HalfFlat] [32mPASSED[0m[31m [ 86%][0m
tests/test_initial_point.py::TestSupportPoint::test_support_point_from_dims[Flat] [32mPASSED[0m[31m [ 86%][0m
tests/test_initial_point.py::TestSupportPoint::test_support_point_from_dims[HalfFlat] [32mPASSED[0m[31m [ 86%][0m
tests/test_initial_point.py::TestSupportPoint::test_support_point_not_implemented_fallback [32mPASSED[0m[31m [ 86%][0m
tests/test_initial_point.py::test_pickling_issue_5090 [32mPASSED[0m[31m             [ 86%][0m
tests/test_math.py::test_kronecker [32mPASSED[0m[31m                                [ 86%][0m
tests/test_math.py::test_cartesian [32mPASSED[0m[31m                                [ 86%][0m
tests/test_math.py::test_cartesian_2d [32mPASSED[0m[31m                             [ 86%][0m
tests/test_math.py::test_kron_dot [32mPASSED[0m[31m                                 [ 87%][0m
tests/test_math.py::test_kron_solve_lower [32mPASSED[0m[31m                         [ 87%][0m
tests/test_math.py::test_probit [32mPASSED[0m[31m                                   [ 87%][0m
tests/test_math.py::test_log1mexp_deprecation_warnings [32mPASSED[0m[31m            [ 87%][0m
tests/test_math.py::test_logdiffexp [32mPASSED[0m[31m                               [ 87%][0m
tests/test_math.py::TestLogDet::test_basic [32mPASSED[0m[31m                        [ 87%][0m
tests/test_math.py::test_expand_packed_triangular [32mPASSED[0m[31m                 [ 87%][0m
tests/test_model_graph.py::TestRadonModel::test_inputs [32mPASSED[0m[31m            [ 87%][0m
tests/test_model_graph.py::TestRadonModel::test_compute_graph [32mPASSED[0m[31m     [ 87%][0m
tests/test_model_graph.py::TestRadonModel::test_plates [32mPASSED[0m[31m            [ 87%][0m
tests/test_model_graph.py::TestRadonModel::test_graphviz [32mPASSED[0m[31m          [ 87%][0m
tests/test_model_graph.py::TestRadonModel::test_checks_formatting [32mPASSED[0m[31m [ 87%][0m
tests/test_model_graph.py::TestImputationModel::test_inputs [32mPASSED[0m[31m       [ 87%][0m
tests/test_model_graph.py::TestImputationModel::test_compute_graph [32mPASSED[0m[31m [ 87%][0m
tests/test_model_graph.py::TestImputationModel::test_plates [32mPASSED[0m[31m       [ 87%][0m
tests/test_model_graph.py::TestImputationModel::test_graphviz [32mPASSED[0m[31m     [ 87%][0m
tests/test_model_graph.py::TestModelWithDims::test_inputs [32mPASSED[0m[31m         [ 87%][0m
tests/test_model_graph.py::TestModelWithDims::test_compute_graph [32mPASSED[0m[31m  [ 87%][0m
tests/test_model_graph.py::TestModelWithDims::test_plates [32mPASSED[0m[31m         [ 87%][0m
tests/test_model_graph.py::TestModelWithDims::test_graphviz [32mPASSED[0m[31m       [ 87%][0m
tests/test_model_graph.py::TestModelWithDims::test_issue_6335_dims_containing_none [32mPASSED[0m[31m [ 87%][0m
tests/test_model_graph.py::TestUnnamedObservedNodes::test_inputs [32mPASSED[0m[31m  [ 87%][0m
tests/test_model_graph.py::TestUnnamedObservedNodes::test_compute_graph [32mPASSED[0m[31m [ 87%][0m
tests/test_model_graph.py::TestUnnamedObservedNodes::test_plates [32mPASSED[0m[31m  [ 87%][0m
tests/test_model_graph.py::TestUnnamedObservedNodes::test_graphviz [32mPASSED[0m[31m [ 87%][0m
tests/test_model_graph.py::TestObservationDtypeCasting::test_inputs [32mPASSED[0m[31m [ 87%][0m
tests/test_model_graph.py::TestObservationDtypeCasting::test_compute_graph [32mPASSED[0m[31m [ 87%][0m
tests/test_model_graph.py::TestObservationDtypeCasting::test_plates [32mPASSED[0m[31m [ 87%][0m
tests/test_model_graph.py::TestObservationDtypeCasting::test_graphviz [32mPASSED[0m[31m [ 87%][0m
tests/test_model_graph.py::TestVariableSelection::test_subgraph[var_names0-vars_to_plot0-compute_graph0] [32mPASSED[0m[31m [ 87%][0m
tests/test_model_graph.py::TestVariableSelection::test_subgraph[var_names1-vars_to_plot1-compute_graph1] [32mPASSED[0m[31m [ 87%][0m
tests/test_model_graph.py::TestVariableSelection::test_subgraph[var_names2-vars_to_plot2-compute_graph2] [32mPASSED[0m[31m [ 87%][0m
tests/test_model_graph.py::TestVariableSelection::test_subgraph[var_names3-vars_to_plot3-compute_graph3] [32mPASSED[0m[31m [ 87%][0m
tests/test_model_graph.py::TestModelNonRandomVariableRVs::test_inputs [32mPASSED[0m[31m [ 87%][0m
tests/test_model_graph.py::TestModelNonRandomVariableRVs::test_compute_graph [32mPASSED[0m[31m [ 87%][0m
tests/test_model_graph.py::TestModelNonRandomVariableRVs::test_plates [32mPASSED[0m[31m [ 87%][0m
tests/test_model_graph.py::TestModelNonRandomVariableRVs::test_graphviz [32mPASSED[0m[31m [ 87%][0m
tests/test_model_graph.py::test_model_graph_with_intermediate_named_variables [32mPASSED[0m[31m [ 88%][0m
tests/test_model_graph.py::test_model_graph_complex_observed_dependency [32mPASSED[0m[31m [ 88%][0m
tests/test_model_graph.py::test_unknown_node_type [32mPASSED[0m[31m                 [ 88%][0m
tests/test_model_graph.py::test_custom_node_formatting_networkx [32mPASSED[0m[31m   [ 88%][0m
tests/test_model_graph.py::test_custom_node_formatting_graphviz [32mPASSED[0m[31m   [ 88%][0m
tests/test_model_graph.py::test_none_dim_in_plate [32mPASSED[0m[31m                 [ 88%][0m
tests/test_model_graph.py::test_shape_without_dims [32mPASSED[0m[31m                [ 88%][0m
tests/test_model_graph.py::test_scalars_dim_info [32mPASSED[0m[31m                  [ 88%][0m
tests/test_model_graph.py::test_model_to_mermaid [32mPASSED[0m[31m                  [ 88%][0m
tests/test_model_graph.py::test_model_to_mermaid_with_variable_with_space [32mPASSED[0m[31m [ 88%][0m
tests/test_printing.py::TestMonolith::test__repr_latex_ [32mPASSED[0m[31m           [ 88%][0m
tests/test_printing.py::TestMonolith::test_str_repr [32mPASSED[0m[31m               [ 88%][0m
tests/test_printing.py::TestData::test__repr_latex_ [32mPASSED[0m[31m               [ 88%][0m
tests/test_printing.py::TestData::test_str_repr [32mPASSED[0m[31m                   [ 88%][0m
tests/test_printing.py::test_model_latex_repr_three_levels_model [32mPASSED[0m[31m  [ 88%][0m
tests/test_printing.py::test_model_latex_repr_mixture_model [32mPASSED[0m[31m       [ 88%][0m
tests/test_printing.py::test_model_repr_variables_without_monkey_patched_repr [32mPASSED[0m[31m [ 88%][0m
tests/test_printing.py::test_truncated_repr [32mPASSED[0m[31m                       [ 88%][0m
tests/test_printing.py::test_custom_dist_repr [32mPASSED[0m[31m                     [ 88%][0m
tests/test_printing.py::TestLatexRepr::test_latex_escaped_underscore [32mPASSED[0m[31m [ 88%][0m
tests/test_progress_bar.py::test_progressbar_nested_compound [32mPASSED[0m[31m      [ 88%][0m
tests/test_pytensorf.py::test_pd_dataframe_as_tensor_variable[np_array0] [32mPASSED[0m[31m [ 88%][0m
tests/test_pytensorf.py::test_pd_dataframe_as_tensor_variable[np_array1] [32mPASSED[0m[31m [ 88%][0m
tests/test_pytensorf.py::test_pd_dataframe_as_tensor_variable[np_array2] [32mPASSED[0m[31m [ 88%][0m
tests/test_pytensorf.py::test_pd_series_as_tensor_variable[np_array0] [32mPASSED[0m[31m [ 88%][0m
tests/test_pytensorf.py::test_pd_series_as_tensor_variable[np_array1] [32mPASSED[0m[31m [ 88%][0m
tests/test_pytensorf.py::test_pd_series_as_tensor_variable[np_array2] [32mPASSED[0m[31m [ 88%][0m
tests/test_pytensorf.py::test_pd_series_as_tensor_variable[np_array3] [32mPASSED[0m[31m [ 88%][0m
tests/test_pytensorf.py::test_pd_as_tensor_variable_multiindex [32mPASSED[0m[31m    [ 88%][0m
tests/test_pytensorf.py::TestBroadcasting::test_make_shared_replacements [32mPASSED[0m[31m [ 88%][0m
tests/test_pytensorf.py::TestBroadcasting::test_metropolis_sampling [32mPASSED[0m[31m [ 88%][0m
tests/test_pytensorf.py::TestExtractObsData::test_root_variable [32mPASSED[0m[31m   [ 88%][0m
tests/test_pytensorf.py::TestExtractObsData::test_constant_variable [32mPASSED[0m[31m [ 88%][0m
tests/test_pytensorf.py::TestExtractObsData::test_shared_variable [32mPASSED[0m[31m [ 88%][0m
tests/test_pytensorf.py::TestExtractObsData::test_masked_variable [32mPASSED[0m[31m [ 88%][0m
tests/test_pytensorf.py::TestExtractObsData::test_cast_variable [32mPASSED[0m[31m   [ 88%][0m
tests/test_pytensorf.py::TestExtractObsData::test_minibatch_variable [32mPASSED[0m[31m [ 89%][0m
tests/test_pytensorf.py::TestExtractObsData::test_pytensor_operations [32mPASSED[0m[31m [ 89%][0m
tests/test_pytensorf.py::TestExtractObsData::test_pytensor_operations_raises [32mPASSED[0m[31m [ 89%][0m
tests/test_pytensorf.py::test_convert_data[int32] [32mPASSED[0m[31m                 [ 89%][0m
tests/test_pytensorf.py::test_convert_data[int64] [32mPASSED[0m[31m                 [ 89%][0m
tests/test_pytensorf.py::test_convert_data[float32] [32mPASSED[0m[31m               [ 89%][0m
tests/test_pytensorf.py::test_convert_data[float64] [32mPASSED[0m[31m               [ 89%][0m
tests/test_pytensorf.py::test_pandas_to_array_pandas_index [32mPASSED[0m[31m        [ 89%][0m
tests/test_pytensorf.py::TestCompile::test_check_bounds_flag [32mPASSED[0m[31m      [ 89%][0m
tests/test_pytensorf.py::TestCompile::test_check_parameters_can_be_replaced_by_ninf [32mPASSED[0m[31m [ 89%][0m
tests/test_pytensorf.py::TestCompile::test_compile_pymc_sets_rng_updates [32mPASSED[0m[31m [ 89%][0m
tests/test_pytensorf.py::TestCompile::test_compile_pymc_with_updates [32mPASSED[0m[31m [ 89%][0m
tests/test_pytensorf.py::TestCompile::test_compile_pymc_missing_default_explicit_updates [32mPASSED[0m[31m [ 89%][0m
tests/test_pytensorf.py::TestCompile::test_compile_pymc_updates_inputs [32mPASSED[0m[31m [ 89%][0m
tests/test_pytensorf.py::TestCompile::test_compile_pymc_symbolic_rv_missing_update [32mPASSED[0m[31m [ 89%][0m
tests/test_pytensorf.py::TestCompile::test_random_seed [32mPASSED[0m[31m            [ 89%][0m
tests/test_pytensorf.py::TestCompile::test_multiple_updates_same_variable [32mPASSED[0m[31m [ 89%][0m
tests/test_pytensorf.py::TestCompile::test_duplicated_client_nodes [32mPASSED[0m[31m [ 89%][0m
tests/test_pytensorf.py::TestCompile::test_nested_updates [32mPASSED[0m[31m         [ 89%][0m
tests/test_pytensorf.py::TestCompile::test_collect_default_updates_must_be_shared [32mPASSED[0m[31m [ 89%][0m
tests/test_pytensorf.py::TestCompile::test_scan_updates [32mPASSED[0m[31m           [ 89%][0m
tests/test_pytensorf.py::TestCompile::test_op_from_graph_updates [32mPASSED[0m[31m  [ 89%][0m
tests/test_pytensorf.py::TestCompile::test_unused_ofg_rng [32mPASSED[0m[31m         [ 89%][0m
tests/test_pytensorf.py::test_replace_rng_nodes [32mPASSED[0m[31m                   [ 89%][0m
tests/test_pytensorf.py::test_reseed_rngs [32mPASSED[0m[31m                         [ 89%][0m
tests/test_pytensorf.py::TestConstantFold::test_constant_fold [32mPASSED[0m[31m     [ 89%][0m
tests/test_pytensorf.py::TestConstantFold::test_constant_fold_raises [32mPASSED[0m[31m [ 89%][0m
tests/test_pytensorf.py::TestConstantFold::test_inputs_preserved [32mPASSED[0m[31m  [ 89%][0m
tests/test_pytensorf.py::TestConstantFold::test_constant_fold_alloc [32mPASSED[0m[31m [ 89%][0m
tests/test_pytensorf.py::test_replace_vars_in_graphs [32mPASSED[0m[31m              [ 89%][0m
tests/test_pytensorf.py::test_replace_vars_in_graphs_nested_reference [32mPASSED[0m[31m [ 89%][0m
tests/test_pytensorf.py::test_hessian_sign_change_warning[hessian] [32mPASSED[0m[31m [ 89%][0m
tests/test_pytensorf.py::test_hessian_sign_change_warning[hessian_diag] [32mPASSED[0m[31m [ 89%][0m
tests/test_pytensorf.py::test_point_func [32mPASSED[0m[31m                          [ 89%][0m
tests/test_pytensorf.py::test_pickle_point_func [32mPASSED[0m[31m                   [ 89%][0m
tests/test_testing.py::test_domain[values0-None-expectation0] [32mPASSED[0m[31m     [ 89%][0m
tests/test_testing.py::test_domain[values1-edges1-expectation1] [32mPASSED[0m[31m   [ 89%][0m
tests/test_testing.py::test_domain[values2-None-expectation2] [32mPASSED[0m[31m     [ 90%][0m
tests/test_testing.py::test_domain[values3-edges3-expectation3] [32mPASSED[0m[31m   [ 90%][0m
tests/test_testing.py::test_domain[values4-None-expectation4] [32mPASSED[0m[31m     [ 90%][0m
tests/test_testing.py::test_domain[values5-None-expectation5] [32mPASSED[0m[31m     [ 90%][0m
tests/test_testing.py::test_mock_sample[default] [32mPASSED[0m[31m                  [ 90%][0m
tests/test_testing.py::test_mock_sample[positional-draws] [32mPASSED[0m[31m         [ 90%][0m
tests/test_testing.py::test_mock_sample[keyword-draws] [32mPASSED[0m[31m            [ 90%][0m
tests/test_testing.py::test_mock_sample[chains] [32mPASSED[0m[31m                   [ 90%][0m
tests/test_testing.py::test_mock_sample[with_sample_stats] [32mPASSED[0m[31m        [ 90%][0m
tests/test_testing.py::test_fixture [32mPASSED[0m[31m                               [ 90%][0m
tests/test_testing.py::test_mock_pymc_sample_var_names [32mPASSED[0m[31m            [ 90%][0m
tests/test_util.py::TestTransformName::test_get_transformed_name [32mPASSED[0m[31m  [ 90%][0m
tests/test_util.py::TestTransformName::test_is_transformed_name [32mPASSED[0m[31m   [ 90%][0m
tests/test_util.py::TestTransformName::test_get_untransformed_name [32mPASSED[0m[31m [ 90%][0m
tests/test_util.py::TestExceptions::test_shape_error [32mPASSED[0m[31m              [ 90%][0m
tests/test_util.py::TestExceptions::test_dtype_error [32mPASSED[0m[31m              [ 90%][0m
tests/test_util.py::test_hashing_of_rv_tuples [32mPASSED[0m[31m                     [ 90%][0m
tests/test_util.py::test_hash_key [32mPASSED[0m[31m                                 [ 90%][0m
tests/test_util.py::test_unset_repr [32mPASSED[0m[31m                               [ 90%][0m
tests/test_util.py::test_drop_warning_stat [32mPASSED[0m[31m                        [ 90%][0m
tests/test_util.py::test_get_seeds_per_chain [32mPASSED[0m[31m                      [ 90%][0m
tests/test_util.py::test_get_value_vars_from_user_vars [32mPASSED[0m[31m            [ 90%][0m
tests/tuning/test_scaling.py::test_adjust_precision [32mPASSED[0m[31m               [ 90%][0m
tests/tuning/test_scaling.py::test_guess_scaling [32mPASSED[0m[31m                  [ 90%][0m
tests/tuning/test_starting.py::test_mle_jacobian[False] [32mPASSED[0m[31m           [ 90%][0m
tests/tuning/test_starting.py::test_mle_jacobian[True] [32mPASSED[0m[31m            [ 90%][0m
tests/tuning/test_starting.py::test_tune_not_inplace [32mPASSED[0m[31m              [ 90%][0m
tests/tuning/test_starting.py::test_accuracy_normal [32mPASSED[0m[31m               [ 90%][0m
tests/tuning/test_starting.py::test_accuracy_non_normal [32mPASSED[0m[31m           [ 90%][0m
tests/tuning/test_starting.py::test_find_MAP_discrete [32mPASSED[0m[31m             [ 90%][0m
tests/tuning/test_starting.py::test_find_MAP_no_gradient [32mPASSED[0m[31m          [ 90%][0m
tests/tuning/test_starting.py::test_find_MAP [32mPASSED[0m[31m                      [ 90%][0m
tests/tuning/test_starting.py::test_find_MAP_issue_5923 [32mPASSED[0m[31m           [ 90%][0m
tests/tuning/test_starting.py::test_find_MAP_issue_4488 [32mPASSED[0m[31m           [ 90%][0m
tests/tuning/test_starting.py::test_find_MAP_warning_non_free_RVs [32mPASSED[0m[31m [ 90%][0m
tests/variational/test_approximations.py::test_empirical_does_not_support_inference_data [32mPASSED[0m[31m [ 90%][0m
tests/variational/test_approximations.py::test_empirical_from_trace [32mPASSED[0m[31m [ 90%][0m
tests/variational/test_approximations.py::test_elbo [32mPASSED[0m[31m               [ 91%][0m
tests/variational/test_approximations.py::test_scale_cost_to_minibatch_works[2] [32mPASSED[0m[31m [ 91%][0m
tests/variational/test_approximations.py::test_scale_cost_to_minibatch_works[5] [32mPASSED[0m[31m [ 91%][0m
tests/variational/test_approximations.py::test_scale_cost_to_minibatch_works[8] [32mPASSED[0m[31m [ 91%][0m
tests/variational/test_approximations.py::test_elbo_beta_kl[2] [32mPASSED[0m[31m    [ 91%][0m
tests/variational/test_approximations.py::test_elbo_beta_kl[5] [32mPASSED[0m[31m    [ 91%][0m
tests/variational/test_approximations.py::test_elbo_beta_kl[8] [32mPASSED[0m[31m    [ 91%][0m
tests/variational/test_approximations.py::test_seeding_advi_fit [32mPASSED[0m[31m   [ 91%][0m
tests/variational/test_callbacks.py::test_callbacks_convergence[1-relative] [32mPASSED[0m[31m [ 91%][0m
tests/variational/test_callbacks.py::test_callbacks_convergence[1-absolute] [32mPASSED[0m[31m [ 91%][0m
tests/variational/test_callbacks.py::test_callbacks_convergence[2-relative] [32mPASSED[0m[31m [ 91%][0m
tests/variational/test_callbacks.py::test_callbacks_convergence[2-absolute] [32mPASSED[0m[31m [ 91%][0m
tests/variational/test_callbacks.py::test_callbacks_convergence[inf-relative] [32mPASSED[0m[31m [ 91%][0m
tests/variational/test_callbacks.py::test_callbacks_convergence[inf-absolute] [32mPASSED[0m[31m [ 91%][0m
tests/variational/test_callbacks.py::test_tracker_callback [32mPASSED[0m[31m        [ 91%][0m
tests/variational/test_inference.py::test_fit_with_nans[True] [32mPASSED[0m[31m     [ 91%][0m
tests/variational/test_inference.py::test_fit_with_nans[False] [32mPASSED[0m[31m    [ 91%][0m
tests/variational/test_inference.py::test_fit_oo[ADVI-mini] [32mPASSED[0m[31m       [ 91%][0m
tests/variational/test_inference.py::test_fit_start[ADVI-mini] [32mPASSED[0m[31m    [ 91%][0m
tests/variational/test_inference.py::test_profile[ADVI-mini] [32mPASSED[0m[31m      [ 91%][0m
tests/variational/test_inference.py::test_fit_data[ADVI-mini] [32mPASSED[0m[31m     [ 91%][0m
tests/variational/test_inference.py::test_fit_oo[ADVI-full] [32mPASSED[0m[31m       [ 91%][0m
tests/variational/test_inference.py::test_fit_start[ADVI-full] [32mPASSED[0m[31m    [ 91%][0m
tests/variational/test_inference.py::test_profile[ADVI-full] [32mPASSED[0m[31m      [ 91%][0m
tests/variational/test_inference.py::test_fit_data[ADVI-full] [32mPASSED[0m[31m     [ 91%][0m
tests/variational/test_inference.py::test_fit_oo[FullRankADVI-full] [32mPASSED[0m[31m [ 91%][0m
tests/variational/test_inference.py::test_fit_start[FullRankADVI-full] [32mPASSED[0m[31m [ 91%][0m
tests/variational/test_inference.py::test_profile[FullRankADVI-full] [32mPASSED[0m[31m [ 91%][0m
tests/variational/test_inference.py::test_fit_data[FullRankADVI-full] [32mPASSED[0m[31m [ 91%][0m
tests/variational/test_inference.py::test_fit_oo[FullRankADVI-mini] [32mPASSED[0m[31m [ 91%][0m
tests/variational/test_inference.py::test_fit_start[FullRankADVI-mini] [32mPASSED[0m[31m [ 91%][0m
tests/variational/test_inference.py::test_profile[FullRankADVI-mini] [32mPASSED[0m[31m [ 91%][0m
tests/variational/test_inference.py::test_fit_data[FullRankADVI-mini] [32mPASSED[0m[31m [ 91%][0m
tests/variational/test_inference.py::test_replacements[FullRankADVI] [32mPASSED[0m[31m [ 91%][0m
tests/variational/test_inference.py::test_sample_replacements[FullRankADVI] [32mPASSED[0m[31m [ 91%][0m
tests/variational/test_inference.py::test_fit_oo[SVGD-full] [32mPASSED[0m[31m       [ 91%][0m
tests/variational/test_inference.py::test_fit_start[SVGD-full] [32mPASSED[0m[31m    [ 91%][0m
tests/variational/test_inference.py::test_profile[SVGD-full] [33mSKIPPED[0m[31m     [ 92%][0m
tests/variational/test_inference.py::test_fit_data[SVGD-full] [32mPASSED[0m[31m     [ 92%][0m
tests/variational/test_inference.py::test_fit_oo[SVGD-mini] [33mSKIPPED[0m (Not
Implemented Inference)[31m                                                   [ 92%][0m
tests/variational/test_inference.py::test_fit_start[SVGD-mini] [33mSKIPPED[0m[31m   [ 92%][0m
tests/variational/test_inference.py::test_profile[SVGD-mini] [33mSKIPPED[0m[31m     [ 92%][0m
tests/variational/test_inference.py::test_fit_data[SVGD-mini] [33mSKIPPED[0m[31m    [ 92%][0m
tests/variational/test_inference.py::test_replacements[SVGD] [32mPASSED[0m[31m      [ 92%][0m
tests/variational/test_inference.py::test_sample_replacements[SVGD] [32mPASSED[0m[31m [ 92%][0m
tests/variational/test_inference.py::test_fit_oo[ASVGD-full] [32mPASSED[0m[31m      [ 92%][0m
tests/variational/test_inference.py::test_fit_start[ASVGD-full] [32mPASSED[0m[31m   [ 92%][0m
tests/variational/test_inference.py::test_profile[ASVGD-full] [33mSKIPPED[0m[31m    [ 92%][0m
tests/variational/test_inference.py::test_fit_data[ASVGD-full] [32mPASSED[0m[31m    [ 92%][0m
tests/variational/test_inference.py::test_fit_oo[ASVGD-mini] [33mSKIPPED[0m[31m     [ 92%][0m
tests/variational/test_inference.py::test_fit_start[ASVGD-mini] [32mPASSED[0m[31m   [ 92%][0m
tests/variational/test_inference.py::test_profile[ASVGD-mini] [33mSKIPPED[0m[31m    [ 92%][0m
tests/variational/test_inference.py::test_fit_data[ASVGD-mini] [33mSKIPPED[0m[31m   [ 92%][0m
tests/variational/test_inference.py::test_replacements[ASVGD] [32mPASSED[0m[31m     [ 92%][0m
tests/variational/test_inference.py::test_sample_replacements[ASVGD] [32mPASSED[0m[31m [ 92%][0m
tests/variational/test_inference.py::test_replacements[ADVI] [32mPASSED[0m[31m      [ 92%][0m
tests/variational/test_inference.py::test_sample_replacements[ADVI] [32mPASSED[0m[31m [ 92%][0m
tests/variational/test_inference.py::test_fit_fn_text[undefined-kwargs0-KeyError] [32mPASSED[0m[31m [ 92%][0m
tests/variational/test_inference.py::test_fit_fn_text[1-kwargs1-TypeError] [32mPASSED[0m[31m [ 92%][0m
tests/variational/test_inference.py::test_fit_fn_text[advi-kwargs2-None] [32mPASSED[0m[31m [ 92%][0m
tests/variational/test_inference.py::test_fit_fn_text[fullrank_advi-kwargs3-None] [32mPASSED[0m[31m [ 92%][0m
tests/variational/test_inference.py::test_fit_fn_text[svgd-kwargs4-None] [32mPASSED[0m[31m [ 92%][0m
tests/variational/test_inference.py::test_fit_fn_text[svgd-kwargs5-None] [32mPASSED[0m[31m [ 92%][0m
tests/variational/test_inference.py::test_fit_fn_text[asvgd-kwargs6-TypeError] [32mPASSED[0m[31m [ 92%][0m
tests/variational/test_inference.py::test_fit_fn_text[asvgd-kwargs7-None] [32mPASSED[0m[31m [ 92%][0m
tests/variational/test_inference.py::test_fit_fn_text[nfvi=bad-formula-kwargs8-KeyError] [32mPASSED[0m[31m [ 92%][0m
tests/variational/test_inference.py::test_remove_scan_op [32mPASSED[0m[31m          [ 92%][0m
tests/variational/test_inference.py::test_var_replacement [32mPASSED[0m[31m         [ 92%][0m
tests/variational/test_inference.py::test_clear_cache [32mPASSED[0m[31m             [ 92%][0m
tests/variational/test_inference.py::test_fit_data_coords [32mPASSED[0m[31m         [ 92%][0m
tests/variational/test_inference.py::test_multiple_minibatch_variables [32mPASSED[0m[31m [ 92%][0m
tests/variational/test_minibatch_rv.py::TestMinibatchRandomVariable::test_density_scaling [32mPASSED[0m[31m [ 92%][0m
tests/variational/test_minibatch_rv.py::TestMinibatchRandomVariable::test_multidim_scaling [32mPASSED[0m[31m [ 92%][0m
tests/variational/test_minibatch_rv.py::TestMinibatchRandomVariable::test_common_errors [32mPASSED[0m[31m [ 92%][0m
tests/variational/test_minibatch_rv.py::TestMinibatchRandomVariable::test_mixed1 [32mPASSED[0m[31m [ 93%][0m
tests/variational/test_minibatch_rv.py::TestMinibatchRandomVariable::test_random [32mPASSED[0m[31m [ 93%][0m
tests/variational/test_minibatch_rv.py::TestMinibatchRandomVariable::test_warning_on_missing_total_size [32mPASSED[0m[31m [ 93%][0m
tests/variational/test_minibatch_rv.py::TestMinibatchRandomVariable::test_minibatch_parameter_and_value [32mPASSED[0m[31m [ 93%][0m
tests/variational/test_minibatch_rv.py::TestMinibatchRandomVariable::test_derived_rv [32mPASSED[0m[31m [ 93%][0m
tests/variational/test_opvi.py::test_discrete_not_allowed [32mPASSED[0m[31m         [ 93%][0m
tests/variational/test_opvi.py::test_group_api_vfam[raises0-mean_field-MeanFieldGroup-kw0] [32mPASSED[0m[31m [ 93%][0m
tests/variational/test_opvi.py::test_group_api_vfam[raises1-mf-MeanFieldGroup-kw1] [32mPASSED[0m[31m [ 93%][0m
tests/variational/test_opvi.py::test_group_api_vfam[raises2-full_rank-FullRankGroup-kw2] [32mPASSED[0m[31m [ 93%][0m
tests/variational/test_opvi.py::test_group_api_vfam[raises3-fr-FullRankGroup-kw3] [32mPASSED[0m[31m [ 93%][0m
tests/variational/test_opvi.py::test_group_api_vfam[raises4-FR-FullRankGroup-kw4] [32mPASSED[0m[31m [ 93%][0m
tests/variational/test_opvi.py::test_group_api_vfam[raises5-empirical-EmpiricalGroup-kw5] [32mPASSED[0m[31m [ 93%][0m
tests/variational/test_opvi.py::test_group_api_vfam[raises6-empirical-EmpiricalGroup-kw6] [32mPASSED[0m[31m [ 93%][0m
tests/variational/test_opvi.py::test_group_api_params[raises0-params0-MeanFieldGroup-kw0-None] [32mPASSED[0m[31m [ 93%][0m
tests/variational/test_opvi.py::test_group_api_params[raises1-params1-FullRankGroup-kw1-None] [32mPASSED[0m[31m [ 93%][0m
tests/variational/test_opvi.py::test_single_group_shortcuts[MeanFieldGroup-MeanField-kw0] [32mPASSED[0m[31m [ 93%][0m
tests/variational/test_opvi.py::test_single_group_shortcuts[FullRankGroup-FullRank-kw1] [32mPASSED[0m[31m [ 93%][0m
tests/variational/test_opvi.py::test_single_group_shortcuts[EmpiricalGroup-Empirical-kw2] [32mPASSED[0m[31m [ 93%][0m
tests/variational/test_opvi.py::test_init_groups[raises0-grouping0] [32mPASSED[0m[31m [ 93%][0m
tests/variational/test_opvi.py::test_init_groups[raises1-grouping1] [32mPASSED[0m[31m [ 93%][0m
tests/variational/test_opvi.py::test_init_groups[raises2-grouping2] [32mPASSED[0m[31m [ 93%][0m
tests/variational/test_opvi.py::test_init_groups[raises3-grouping3] [32mPASSED[0m[31m [ 93%][0m
tests/variational/test_opvi.py::test_init_groups[raises4-grouping4] [32mPASSED[0m[31m [ 93%][0m
tests/variational/test_opvi.py::test_init_groups[raises5-grouping5] [32mPASSED[0m[31m [ 93%][0m
tests/variational/test_opvi.py::test_pickle_approx[MeanFieldGroup: None] [32mPASSED[0m[31m [ 93%][0m
tests/variational/test_opvi.py::test_pickle_approx[FullRankGroup: None, MeanFieldGroup: ['one']] [32mPASSED[0m[31m [ 93%][0m
tests/variational/test_opvi.py::test_pickle_approx[MeanFieldGroup: ['one'], FullRankGroup: ['two', 'three']] [32mPASSED[0m[31m [ 93%][0m
tests/variational/test_opvi.py::test_pickle_approx[MeanFieldGroup: ['one'], EmpiricalGroup: ['two', 'three']] [32mPASSED[0m[31m [ 93%][0m
tests/variational/test_opvi.py::test_pickle_single_group [32mPASSED[0m[31m          [ 93%][0m
tests/variational/test_opvi.py::test_sample_simple[MeanFieldGroup: None] [32mPASSED[0m[31m [ 93%][0m
tests/variational/test_opvi.py::test_sample_simple[FullRankGroup: None, MeanFieldGroup: ['one']] [32mPASSED[0m[31m [ 93%][0m
tests/variational/test_opvi.py::test_sample_simple[MeanFieldGroup: ['one'], FullRankGroup: ['two', 'three']] [32mPASSED[0m[31m [ 93%][0m
tests/variational/test_opvi.py::test_sample_simple[MeanFieldGroup: ['one'], EmpiricalGroup: ['two', 'three']] [32mPASSED[0m[31m [ 93%][0m
tests/variational/test_opvi.py::test_logq_mini_1_sample_1_var[MeanFieldGroup: {}] [32mPASSED[0m[31m [ 93%][0m
tests/variational/test_opvi.py::test_logq_mini_1_sample_1_var[FullRankGroup: {}] [32mPASSED[0m[31m [ 93%][0m
tests/variational/test_opvi.py::test_logq_mini_2_sample_2_var[MeanFieldGroup: {}] [32mPASSED[0m[31m [ 93%][0m
tests/variational/test_opvi.py::test_logq_mini_2_sample_2_var[FullRankGroup: {}] [32mPASSED[0m[31m [ 93%][0m
tests/variational/test_opvi.py::test_logq_globals[MeanFieldGroup: None] [32mPASSED[0m[31m [ 94%][0m
tests/variational/test_opvi.py::test_logq_globals[FullRankGroup: None, MeanFieldGroup: ['one']] [32mPASSED[0m[31m [ 94%][0m
tests/variational/test_opvi.py::test_logq_globals[MeanFieldGroup: ['one'], FullRankGroup: ['two', 'three']] [32mPASSED[0m[31m [ 94%][0m
tests/variational/test_opvi.py::test_logq_globals[MeanFieldGroup: ['one'], EmpiricalGroup: ['two', 'three']] [33mSKIPPED[0m[31m [ 94%][0m
tests/variational/test_opvi.py::test_symbolic_normalizing_constant_no_rvs [32mPASSED[0m[31m [ 94%][0m
tests/variational/test_updates.py::test_updates_fast[scalar-without_args-all_params-sgd] [32mPASSED[0m[31m [ 94%][0m
tests/variational/test_updates.py::test_updates_fast[scalar-without_args-all_params-momentum] [32mPASSED[0m[31m [ 94%][0m
tests/variational/test_updates.py::test_updates_fast[scalar-without_args-all_params-nesterov_momentum] [32mPASSED[0m[31m [ 94%][0m
tests/variational/test_updates.py::test_updates_fast[scalar-without_args-all_params-adagrad] [32mPASSED[0m[31m [ 94%][0m
tests/variational/test_updates.py::test_updates_fast[scalar-without_args-all_params-rmsprop] [32mPASSED[0m[31m [ 94%][0m
tests/variational/test_updates.py::test_updates_fast[scalar-without_args-all_params-adadelta] [32mPASSED[0m[31m [ 94%][0m
tests/variational/test_updates.py::test_updates_fast[scalar-without_args-all_params-adam] [32mPASSED[0m[31m [ 94%][0m
tests/variational/test_updates.py::test_updates_fast[scalar-without_args-all_params-adamax] [32mPASSED[0m[31m [ 94%][0m
tests/variational/test_updates.py::test_updates_fast[scalar-without_args-all_params-adagrad_window] [32mPASSED[0m[31m [ 94%][0m
tests/variational/test_updates.py::test_updates_fast[scalar-without_args-missing_loss-sgd] [32mPASSED[0m[31m [ 94%][0m
tests/variational/test_updates.py::test_updates_fast[scalar-without_args-missing_loss-momentum] [32mPASSED[0m[31m [ 94%][0m
tests/variational/test_updates.py::test_updates_fast[scalar-without_args-missing_loss-nesterov_momentum] [32mPASSED[0m[31m [ 94%][0m
tests/variational/test_updates.py::test_updates_fast[scalar-without_args-missing_loss-adagrad] [32mPASSED[0m[31m [ 94%][0m
tests/variational/test_updates.py::test_updates_fast[scalar-without_args-missing_loss-rmsprop] [32mPASSED[0m[31m [ 94%][0m
tests/variational/test_updates.py::test_updates_fast[scalar-without_args-missing_loss-adadelta] [32mPASSED[0m[31m [ 94%][0m
tests/variational/test_updates.py::test_updates_fast[scalar-without_args-missing_loss-adam] [32mPASSED[0m[31m [ 94%][0m
tests/variational/test_updates.py::test_updates_fast[scalar-without_args-missing_loss-adamax] [32mPASSED[0m[31m [ 94%][0m
tests/variational/test_updates.py::test_updates_fast[scalar-without_args-missing_loss-adagrad_window] [32mPASSED[0m[31m [ 94%][0m
tests/variational/test_updates.py::test_updates_fast[scalar-without_args-missing_params-sgd] [32mPASSED[0m[31m [ 94%][0m
tests/variational/test_updates.py::test_updates_fast[scalar-without_args-missing_params-momentum] [32mPASSED[0m[31m [ 94%][0m
tests/variational/test_updates.py::test_updates_fast[scalar-without_args-missing_params-nesterov_momentum] [32mPASSED[0m[31m [ 94%][0m
tests/variational/test_updates.py::test_updates_fast[scalar-without_args-missing_params-adagrad] [32mPASSED[0m[31m [ 94%][0m
tests/variational/test_updates.py::test_updates_fast[scalar-without_args-missing_params-rmsprop] [32mPASSED[0m[31m [ 94%][0m
tests/variational/test_updates.py::test_updates_fast[scalar-without_args-missing_params-adadelta] [32mPASSED[0m[31m [ 94%][0m
tests/variational/test_updates.py::test_updates_fast[scalar-without_args-missing_params-adam] [32mPASSED[0m[31m [ 94%][0m
tests/variational/test_updates.py::test_updates_fast[scalar-without_args-missing_params-adamax] [32mPASSED[0m[31m [ 94%][0m
tests/variational/test_updates.py::test_updates_fast[scalar-without_args-missing_params-adagrad_window] [32mPASSED[0m[31m [ 94%][0m
tests/variational/test_updates.py::test_updates_fast[scalar-without_args-all_missing-sgd] [32mPASSED[0m[31m [ 94%][0m
tests/variational/test_updates.py::test_updates_fast[scalar-without_args-all_missing-momentum] [32mPASSED[0m[31m [ 94%][0m
tests/variational/test_updates.py::test_updates_fast[scalar-without_args-all_missing-nesterov_momentum] [32mPASSED[0m[31m [ 94%][0m
tests/variational/test_updates.py::test_updates_fast[scalar-without_args-all_missing-adagrad] [32mPASSED[0m[31m [ 94%][0m
tests/variational/test_updates.py::test_updates_fast[scalar-without_args-all_missing-rmsprop] [32mPASSED[0m[31m [ 95%][0m
tests/variational/test_updates.py::test_updates_fast[scalar-without_args-all_missing-adadelta] [32mPASSED[0m[31m [ 95%][0m
tests/variational/test_updates.py::test_updates_fast[scalar-without_args-all_missing-adam] [32mPASSED[0m[31m [ 95%][0m
tests/variational/test_updates.py::test_updates_fast[scalar-without_args-all_missing-adamax] [32mPASSED[0m[31m [ 95%][0m
tests/variational/test_updates.py::test_updates_fast[scalar-without_args-all_missing-adagrad_window] [32mPASSED[0m[31m [ 95%][0m
tests/variational/test_updates.py::test_updates_fast[scalar-with_args-all_params-sgd] [32mPASSED[0m[31m [ 95%][0m
tests/variational/test_updates.py::test_updates_fast[scalar-with_args-all_params-momentum] [32mPASSED[0m[31m [ 95%][0m
tests/variational/test_updates.py::test_updates_fast[scalar-with_args-all_params-nesterov_momentum] [32mPASSED[0m[31m [ 95%][0m
tests/variational/test_updates.py::test_updates_fast[scalar-with_args-all_params-adagrad] [32mPASSED[0m[31m [ 95%][0m
tests/variational/test_updates.py::test_updates_fast[scalar-with_args-all_params-rmsprop] [32mPASSED[0m[31m [ 95%][0m
tests/variational/test_updates.py::test_updates_fast[scalar-with_args-all_params-adadelta] [32mPASSED[0m[31m [ 95%][0m
tests/variational/test_updates.py::test_updates_fast[scalar-with_args-all_params-adam] [32mPASSED[0m[31m [ 95%][0m
tests/variational/test_updates.py::test_updates_fast[scalar-with_args-all_params-adamax] [32mPASSED[0m[31m [ 95%][0m
tests/variational/test_updates.py::test_updates_fast[scalar-with_args-all_params-adagrad_window] [32mPASSED[0m[31m [ 95%][0m
tests/variational/test_updates.py::test_updates_fast[scalar-with_args-missing_loss-sgd] [32mPASSED[0m[31m [ 95%][0m
tests/variational/test_updates.py::test_updates_fast[scalar-with_args-missing_loss-momentum] [32mPASSED[0m[31m [ 95%][0m
tests/variational/test_updates.py::test_updates_fast[scalar-with_args-missing_loss-nesterov_momentum] [32mPASSED[0m[31m [ 95%][0m
tests/variational/test_updates.py::test_updates_fast[scalar-with_args-missing_loss-adagrad] [32mPASSED[0m[31m [ 95%][0m
tests/variational/test_updates.py::test_updates_fast[scalar-with_args-missing_loss-rmsprop] [32mPASSED[0m[31m [ 95%][0m
tests/variational/test_updates.py::test_updates_fast[scalar-with_args-missing_loss-adadelta] [32mPASSED[0m[31m [ 95%][0m
tests/variational/test_updates.py::test_updates_fast[scalar-with_args-missing_loss-adam] [32mPASSED[0m[31m [ 95%][0m
tests/variational/test_updates.py::test_updates_fast[scalar-with_args-missing_loss-adamax] [32mPASSED[0m[31m [ 95%][0m
tests/variational/test_updates.py::test_updates_fast[scalar-with_args-missing_loss-adagrad_window] [32mPASSED[0m[31m [ 95%][0m
tests/variational/test_updates.py::test_updates_fast[scalar-with_args-missing_params-sgd] [32mPASSED[0m[31m [ 95%][0m
tests/variational/test_updates.py::test_updates_fast[scalar-with_args-missing_params-momentum] [32mPASSED[0m[31m [ 95%][0m
tests/variational/test_updates.py::test_updates_fast[scalar-with_args-missing_params-nesterov_momentum] [32mPASSED[0m[31m [ 95%][0m
tests/variational/test_updates.py::test_updates_fast[scalar-with_args-missing_params-adagrad] [32mPASSED[0m[31m [ 95%][0m
tests/variational/test_updates.py::test_updates_fast[scalar-with_args-missing_params-rmsprop] [32mPASSED[0m[31m [ 95%][0m
tests/variational/test_updates.py::test_updates_fast[scalar-with_args-missing_params-adadelta] [32mPASSED[0m[31m [ 95%][0m
tests/variational/test_updates.py::test_updates_fast[scalar-with_args-missing_params-adam] [32mPASSED[0m[31m [ 95%][0m
tests/variational/test_updates.py::test_updates_fast[scalar-with_args-missing_params-adamax] [32mPASSED[0m[31m [ 95%][0m
tests/variational/test_updates.py::test_updates_fast[scalar-with_args-missing_params-adagrad_window] [32mPASSED[0m[31m [ 95%][0m
tests/variational/test_updates.py::test_updates_fast[scalar-with_args-all_missing-sgd] [32mPASSED[0m[31m [ 95%][0m
tests/variational/test_updates.py::test_updates_fast[scalar-with_args-all_missing-momentum] [32mPASSED[0m[31m [ 95%][0m
tests/variational/test_updates.py::test_updates_fast[scalar-with_args-all_missing-nesterov_momentum] [32mPASSED[0m[31m [ 95%][0m
tests/variational/test_updates.py::test_updates_fast[scalar-with_args-all_missing-adagrad] [32mPASSED[0m[31m [ 95%][0m
tests/variational/test_updates.py::test_updates_fast[scalar-with_args-all_missing-rmsprop] [32mPASSED[0m[31m [ 95%][0m
tests/variational/test_updates.py::test_updates_fast[scalar-with_args-all_missing-adadelta] [32mPASSED[0m[31m [ 96%][0m
tests/variational/test_updates.py::test_updates_fast[scalar-with_args-all_missing-adam] [32mPASSED[0m[31m [ 96%][0m
tests/variational/test_updates.py::test_updates_fast[scalar-with_args-all_missing-adamax] [32mPASSED[0m[31m [ 96%][0m
tests/variational/test_updates.py::test_updates_fast[scalar-with_args-all_missing-adagrad_window] [32mPASSED[0m[31m [ 96%][0m
tests/variational/test_updates.py::test_updates_fast[matrix-without_args-all_params-sgd] [32mPASSED[0m[31m [ 96%][0m
tests/variational/test_updates.py::test_updates_fast[matrix-without_args-all_params-momentum] [32mPASSED[0m[31m [ 96%][0m
tests/variational/test_updates.py::test_updates_fast[matrix-without_args-all_params-nesterov_momentum] [32mPASSED[0m[31m [ 96%][0m
tests/variational/test_updates.py::test_updates_fast[matrix-without_args-all_params-adagrad] [32mPASSED[0m[31m [ 96%][0m
tests/variational/test_updates.py::test_updates_fast[matrix-without_args-all_params-rmsprop] [32mPASSED[0m[31m [ 96%][0m
tests/variational/test_updates.py::test_updates_fast[matrix-without_args-all_params-adadelta] [32mPASSED[0m[31m [ 96%][0m
tests/variational/test_updates.py::test_updates_fast[matrix-without_args-all_params-adam] [32mPASSED[0m[31m [ 96%][0m
tests/variational/test_updates.py::test_updates_fast[matrix-without_args-all_params-adamax] [32mPASSED[0m[31m [ 96%][0m
tests/variational/test_updates.py::test_updates_fast[matrix-without_args-all_params-adagrad_window] [32mPASSED[0m[31m [ 96%][0m
tests/variational/test_updates.py::test_updates_fast[matrix-without_args-missing_loss-sgd] [32mPASSED[0m[31m [ 96%][0m
tests/variational/test_updates.py::test_updates_fast[matrix-without_args-missing_loss-momentum] [32mPASSED[0m[31m [ 96%][0m
tests/variational/test_updates.py::test_updates_fast[matrix-without_args-missing_loss-nesterov_momentum] [32mPASSED[0m[31m [ 96%][0m
tests/variational/test_updates.py::test_updates_fast[matrix-without_args-missing_loss-adagrad] [32mPASSED[0m[31m [ 96%][0m
tests/variational/test_updates.py::test_updates_fast[matrix-without_args-missing_loss-rmsprop] [32mPASSED[0m[31m [ 96%][0m
tests/variational/test_updates.py::test_updates_fast[matrix-without_args-missing_loss-adadelta] [32mPASSED[0m[31m [ 96%][0m
tests/variational/test_updates.py::test_updates_fast[matrix-without_args-missing_loss-adam] [32mPASSED[0m[31m [ 96%][0m
tests/variational/test_updates.py::test_updates_fast[matrix-without_args-missing_loss-adamax] [32mPASSED[0m[31m [ 96%][0m
tests/variational/test_updates.py::test_updates_fast[matrix-without_args-missing_loss-adagrad_window] [32mPASSED[0m[31m [ 96%][0m
tests/variational/test_updates.py::test_updates_fast[matrix-without_args-missing_params-sgd] [32mPASSED[0m[31m [ 96%][0m
tests/variational/test_updates.py::test_updates_fast[matrix-without_args-missing_params-momentum] [32mPASSED[0m[31m [ 96%][0m
tests/variational/test_updates.py::test_updates_fast[matrix-without_args-missing_params-nesterov_momentum] [32mPASSED[0m[31m [ 96%][0m
tests/variational/test_updates.py::test_updates_fast[matrix-without_args-missing_params-adagrad] [32mPASSED[0m[31m [ 96%][0m
tests/variational/test_updates.py::test_updates_fast[matrix-without_args-missing_params-rmsprop] [32mPASSED[0m[31m [ 96%][0m
tests/variational/test_updates.py::test_updates_fast[matrix-without_args-missing_params-adadelta] [32mPASSED[0m[31m [ 96%][0m
tests/variational/test_updates.py::test_updates_fast[matrix-without_args-missing_params-adam] [32mPASSED[0m[31m [ 96%][0m
tests/variational/test_updates.py::test_updates_fast[matrix-without_args-missing_params-adamax] [32mPASSED[0m[31m [ 96%][0m
tests/variational/test_updates.py::test_updates_fast[matrix-without_args-missing_params-adagrad_window] [32mPASSED[0m[31m [ 96%][0m
tests/variational/test_updates.py::test_updates_fast[matrix-without_args-all_missing-sgd] [32mPASSED[0m[31m [ 96%][0m
tests/variational/test_updates.py::test_updates_fast[matrix-without_args-all_missing-momentum] [32mPASSED[0m[31m [ 96%][0m
tests/variational/test_updates.py::test_updates_fast[matrix-without_args-all_missing-nesterov_momentum] [32mPASSED[0m[31m [ 96%][0m
tests/variational/test_updates.py::test_updates_fast[matrix-without_args-all_missing-adagrad] [32mPASSED[0m[31m [ 96%][0m
tests/variational/test_updates.py::test_updates_fast[matrix-without_args-all_missing-rmsprop] [32mPASSED[0m[31m [ 96%][0m
tests/variational/test_updates.py::test_updates_fast[matrix-without_args-all_missing-adadelta] [32mPASSED[0m[31m [ 96%][0m
tests/variational/test_updates.py::test_updates_fast[matrix-without_args-all_missing-adam] [32mPASSED[0m[31m [ 97%][0m
tests/variational/test_updates.py::test_updates_fast[matrix-without_args-all_missing-adamax] [32mPASSED[0m[31m [ 97%][0m
tests/variational/test_updates.py::test_updates_fast[matrix-without_args-all_missing-adagrad_window] [32mPASSED[0m[31m [ 97%][0m
tests/variational/test_updates.py::test_updates_fast[matrix-with_args-all_params-sgd] [32mPASSED[0m[31m [ 97%][0m
tests/variational/test_updates.py::test_updates_fast[matrix-with_args-all_params-momentum] [32mPASSED[0m[31m [ 97%][0m
tests/variational/test_updates.py::test_updates_fast[matrix-with_args-all_params-nesterov_momentum] [32mPASSED[0m[31m [ 97%][0m
tests/variational/test_updates.py::test_updates_fast[matrix-with_args-all_params-adagrad] [32mPASSED[0m[31m [ 97%][0m
tests/variational/test_updates.py::test_updates_fast[matrix-with_args-all_params-rmsprop] [32mPASSED[0m[31m [ 97%][0m
tests/variational/test_updates.py::test_updates_fast[matrix-with_args-all_params-adadelta] [32mPASSED[0m[31m [ 97%][0m
tests/variational/test_updates.py::test_updates_fast[matrix-with_args-all_params-adam] [32mPASSED[0m[31m [ 97%][0m
tests/variational/test_updates.py::test_updates_fast[matrix-with_args-all_params-adamax] [32mPASSED[0m[31m [ 97%][0m
tests/variational/test_updates.py::test_updates_fast[matrix-with_args-all_params-adagrad_window] [32mPASSED[0m[31m [ 97%][0m
tests/variational/test_updates.py::test_updates_fast[matrix-with_args-missing_loss-sgd] [32mPASSED[0m[31m [ 97%][0m
tests/variational/test_updates.py::test_updates_fast[matrix-with_args-missing_loss-momentum] [32mPASSED[0m[31m [ 97%][0m
tests/variational/test_updates.py::test_updates_fast[matrix-with_args-missing_loss-nesterov_momentum] [32mPASSED[0m[31m [ 97%][0m
tests/variational/test_updates.py::test_updates_fast[matrix-with_args-missing_loss-adagrad] [32mPASSED[0m[31m [ 97%][0m
tests/variational/test_updates.py::test_updates_fast[matrix-with_args-missing_loss-rmsprop] [32mPASSED[0m[31m [ 97%][0m
tests/variational/test_updates.py::test_updates_fast[matrix-with_args-missing_loss-adadelta] [32mPASSED[0m[31m [ 97%][0m
tests/variational/test_updates.py::test_updates_fast[matrix-with_args-missing_loss-adam] [32mPASSED[0m[31m [ 97%][0m
tests/variational/test_updates.py::test_updates_fast[matrix-with_args-missing_loss-adamax] [32mPASSED[0m[31m [ 97%][0m
tests/variational/test_updates.py::test_updates_fast[matrix-with_args-missing_loss-adagrad_window] [32mPASSED[0m[31m [ 97%][0m
tests/variational/test_updates.py::test_updates_fast[matrix-with_args-missing_params-sgd] [32mPASSED[0m[31m [ 97%][0m
tests/variational/test_updates.py::test_updates_fast[matrix-with_args-missing_params-momentum] [32mPASSED[0m[31m [ 97%][0m
tests/variational/test_updates.py::test_updates_fast[matrix-with_args-missing_params-nesterov_momentum] [32mPASSED[0m[31m [ 97%][0m
tests/variational/test_updates.py::test_updates_fast[matrix-with_args-missing_params-adagrad] [32mPASSED[0m[31m [ 97%][0m
tests/variational/test_updates.py::test_updates_fast[matrix-with_args-missing_params-rmsprop] [32mPASSED[0m[31m [ 97%][0m
tests/variational/test_updates.py::test_updates_fast[matrix-with_args-missing_params-adadelta] [32mPASSED[0m[31m [ 97%][0m
tests/variational/test_updates.py::test_updates_fast[matrix-with_args-missing_params-adam] [32mPASSED[0m[31m [ 97%][0m
tests/variational/test_updates.py::test_updates_fast[matrix-with_args-missing_params-adamax] [32mPASSED[0m[31m [ 97%][0m
tests/variational/test_updates.py::test_updates_fast[matrix-with_args-missing_params-adagrad_window] [32mPASSED[0m[31m [ 97%][0m
tests/variational/test_updates.py::test_updates_fast[matrix-with_args-all_missing-sgd] [32mPASSED[0m[31m [ 97%][0m
tests/variational/test_updates.py::test_updates_fast[matrix-with_args-all_missing-momentum] [32mPASSED[0m[31m [ 97%][0m
tests/variational/test_updates.py::test_updates_fast[matrix-with_args-all_missing-nesterov_momentum] [32mPASSED[0m[31m [ 97%][0m
tests/variational/test_updates.py::test_updates_fast[matrix-with_args-all_missing-adagrad] [32mPASSED[0m[31m [ 97%][0m
tests/variational/test_updates.py::test_updates_fast[matrix-with_args-all_missing-rmsprop] [32mPASSED[0m[31m [ 97%][0m
tests/variational/test_updates.py::test_updates_fast[matrix-with_args-all_missing-adadelta] [32mPASSED[0m[31m [ 97%][0m
tests/variational/test_updates.py::test_updates_fast[matrix-with_args-all_missing-adam] [32mPASSED[0m[31m [ 97%][0m
tests/variational/test_updates.py::test_updates_fast[matrix-with_args-all_missing-adamax] [32mPASSED[0m[31m [ 98%][0m
tests/variational/test_updates.py::test_updates_fast[matrix-with_args-all_missing-adagrad_window] [32mPASSED[0m[31m [ 98%][0m
tests/variational/test_updates.py::test_updates_fast[mixed-without_args-all_params-sgd] [32mPASSED[0m[31m [ 98%][0m
tests/variational/test_updates.py::test_updates_fast[mixed-without_args-all_params-momentum] [32mPASSED[0m[31m [ 98%][0m
tests/variational/test_updates.py::test_updates_fast[mixed-without_args-all_params-nesterov_momentum] [32mPASSED[0m[31m [ 98%][0m
tests/variational/test_updates.py::test_updates_fast[mixed-without_args-all_params-adagrad] [32mPASSED[0m[31m [ 98%][0m
tests/variational/test_updates.py::test_updates_fast[mixed-without_args-all_params-rmsprop] [32mPASSED[0m[31m [ 98%][0m
tests/variational/test_updates.py::test_updates_fast[mixed-without_args-all_params-adadelta] [32mPASSED[0m[31m [ 98%][0m
tests/variational/test_updates.py::test_updates_fast[mixed-without_args-all_params-adam] [32mPASSED[0m[31m [ 98%][0m
tests/variational/test_updates.py::test_updates_fast[mixed-without_args-all_params-adamax] [32mPASSED[0m[31m [ 98%][0m
tests/variational/test_updates.py::test_updates_fast[mixed-without_args-all_params-adagrad_window] [32mPASSED[0m[31m [ 98%][0m
tests/variational/test_updates.py::test_updates_fast[mixed-without_args-missing_loss-sgd] [32mPASSED[0m[31m [ 98%][0m
tests/variational/test_updates.py::test_updates_fast[mixed-without_args-missing_loss-momentum] [32mPASSED[0m[31m [ 98%][0m
tests/variational/test_updates.py::test_updates_fast[mixed-without_args-missing_loss-nesterov_momentum] [32mPASSED[0m[31m [ 98%][0m
tests/variational/test_updates.py::test_updates_fast[mixed-without_args-missing_loss-adagrad] [32mPASSED[0m[31m [ 98%][0m
tests/variational/test_updates.py::test_updates_fast[mixed-without_args-missing_loss-rmsprop] [32mPASSED[0m[31m [ 98%][0m
tests/variational/test_updates.py::test_updates_fast[mixed-without_args-missing_loss-adadelta] [32mPASSED[0m[31m [ 98%][0m
tests/variational/test_updates.py::test_updates_fast[mixed-without_args-missing_loss-adam] [32mPASSED[0m[31m [ 98%][0m
tests/variational/test_updates.py::test_updates_fast[mixed-without_args-missing_loss-adamax] [32mPASSED[0m[31m [ 98%][0m
tests/variational/test_updates.py::test_updates_fast[mixed-without_args-missing_loss-adagrad_window] [32mPASSED[0m[31m [ 98%][0m
tests/variational/test_updates.py::test_updates_fast[mixed-without_args-missing_params-sgd] [32mPASSED[0m[31m [ 98%][0m
tests/variational/test_updates.py::test_updates_fast[mixed-without_args-missing_params-momentum] [32mPASSED[0m[31m [ 98%][0m
tests/variational/test_updates.py::test_updates_fast[mixed-without_args-missing_params-nesterov_momentum] [32mPASSED[0m[31m [ 98%][0m
tests/variational/test_updates.py::test_updates_fast[mixed-without_args-missing_params-adagrad] [32mPASSED[0m[31m [ 98%][0m
tests/variational/test_updates.py::test_updates_fast[mixed-without_args-missing_params-rmsprop] [32mPASSED[0m[31m [ 98%][0m
tests/variational/test_updates.py::test_updates_fast[mixed-without_args-missing_params-adadelta] [32mPASSED[0m[31m [ 98%][0m
tests/variational/test_updates.py::test_updates_fast[mixed-without_args-missing_params-adam] [32mPASSED[0m[31m [ 98%][0m
tests/variational/test_updates.py::test_updates_fast[mixed-without_args-missing_params-adamax] [32mPASSED[0m[31m [ 98%][0m
tests/variational/test_updates.py::test_updates_fast[mixed-without_args-missing_params-adagrad_window] [32mPASSED[0m[31m [ 98%][0m
tests/variational/test_updates.py::test_updates_fast[mixed-without_args-all_missing-sgd] [32mPASSED[0m[31m [ 98%][0m
tests/variational/test_updates.py::test_updates_fast[mixed-without_args-all_missing-momentum] [32mPASSED[0m[31m [ 98%][0m
tests/variational/test_updates.py::test_updates_fast[mixed-without_args-all_missing-nesterov_momentum] [32mPASSED[0m[31m [ 98%][0m
tests/variational/test_updates.py::test_updates_fast[mixed-without_args-all_missing-adagrad] [32mPASSED[0m[31m [ 98%][0m
tests/variational/test_updates.py::test_updates_fast[mixed-without_args-all_missing-rmsprop] [32mPASSED[0m[31m [ 98%][0m
tests/variational/test_updates.py::test_updates_fast[mixed-without_args-all_missing-adadelta] [32mPASSED[0m[31m [ 98%][0m
tests/variational/test_updates.py::test_updates_fast[mixed-without_args-all_missing-adam] [32mPASSED[0m[31m [ 98%][0m
tests/variational/test_updates.py::test_updates_fast[mixed-without_args-all_missing-adamax] [32mPASSED[0m[31m [ 98%][0m
tests/variational/test_updates.py::test_updates_fast[mixed-without_args-all_missing-adagrad_window] [32mPASSED[0m[31m [ 99%][0m
tests/variational/test_updates.py::test_updates_fast[mixed-with_args-all_params-sgd] [32mPASSED[0m[31m [ 99%][0m
tests/variational/test_updates.py::test_updates_fast[mixed-with_args-all_params-momentum] [32mPASSED[0m[31m [ 99%][0m
tests/variational/test_updates.py::test_updates_fast[mixed-with_args-all_params-nesterov_momentum] [32mPASSED[0m[31m [ 99%][0m
tests/variational/test_updates.py::test_updates_fast[mixed-with_args-all_params-adagrad] [32mPASSED[0m[31m [ 99%][0m
tests/variational/test_updates.py::test_updates_fast[mixed-with_args-all_params-rmsprop] [32mPASSED[0m[31m [ 99%][0m
tests/variational/test_updates.py::test_updates_fast[mixed-with_args-all_params-adadelta] [32mPASSED[0m[31m [ 99%][0m
tests/variational/test_updates.py::test_updates_fast[mixed-with_args-all_params-adam] [32mPASSED[0m[31m [ 99%][0m
tests/variational/test_updates.py::test_updates_fast[mixed-with_args-all_params-adamax] [32mPASSED[0m[31m [ 99%][0m
tests/variational/test_updates.py::test_updates_fast[mixed-with_args-all_params-adagrad_window] [32mPASSED[0m[31m [ 99%][0m
tests/variational/test_updates.py::test_updates_fast[mixed-with_args-missing_loss-sgd] [32mPASSED[0m[31m [ 99%][0m
tests/variational/test_updates.py::test_updates_fast[mixed-with_args-missing_loss-momentum] [32mPASSED[0m[31m [ 99%][0m
tests/variational/test_updates.py::test_updates_fast[mixed-with_args-missing_loss-nesterov_momentum] [32mPASSED[0m[31m [ 99%][0m
tests/variational/test_updates.py::test_updates_fast[mixed-with_args-missing_loss-adagrad] [32mPASSED[0m[31m [ 99%][0m
tests/variational/test_updates.py::test_updates_fast[mixed-with_args-missing_loss-rmsprop] [32mPASSED[0m[31m [ 99%][0m
tests/variational/test_updates.py::test_updates_fast[mixed-with_args-missing_loss-adadelta] [32mPASSED[0m[31m [ 99%][0m
tests/variational/test_updates.py::test_updates_fast[mixed-with_args-missing_loss-adam] [32mPASSED[0m[31m [ 99%][0m
tests/variational/test_updates.py::test_updates_fast[mixed-with_args-missing_loss-adamax] [32mPASSED[0m[31m [ 99%][0m
tests/variational/test_updates.py::test_updates_fast[mixed-with_args-missing_loss-adagrad_window] [32mPASSED[0m[31m [ 99%][0m
tests/variational/test_updates.py::test_updates_fast[mixed-with_args-missing_params-sgd] [32mPASSED[0m[31m [ 99%][0m
tests/variational/test_updates.py::test_updates_fast[mixed-with_args-missing_params-momentum] [32mPASSED[0m[31m [ 99%][0m
tests/variational/test_updates.py::test_updates_fast[mixed-with_args-missing_params-nesterov_momentum] [32mPASSED[0m[31m [ 99%][0m
tests/variational/test_updates.py::test_updates_fast[mixed-with_args-missing_params-adagrad] [32mPASSED[0m[31m [ 99%][0m
tests/variational/test_updates.py::test_updates_fast[mixed-with_args-missing_params-rmsprop] [32mPASSED[0m[31m [ 99%][0m
tests/variational/test_updates.py::test_updates_fast[mixed-with_args-missing_params-adadelta] [32mPASSED[0m[31m [ 99%][0m
tests/variational/test_updates.py::test_updates_fast[mixed-with_args-missing_params-adam] [32mPASSED[0m[31m [ 99%][0m
tests/variational/test_updates.py::test_updates_fast[mixed-with_args-missing_params-adamax] [32mPASSED[0m[31m [ 99%][0m
tests/variational/test_updates.py::test_updates_fast[mixed-with_args-missing_params-adagrad_window] [32mPASSED[0m[31m [ 99%][0m
tests/variational/test_updates.py::test_updates_fast[mixed-with_args-all_missing-sgd] [32mPASSED[0m[31m [ 99%][0m
tests/variational/test_updates.py::test_updates_fast[mixed-with_args-all_missing-momentum] [32mPASSED[0m[31m [ 99%][0m
tests/variational/test_updates.py::test_updates_fast[mixed-with_args-all_missing-nesterov_momentum] [32mPASSED[0m[31m [ 99%][0m
tests/variational/test_updates.py::test_updates_fast[mixed-with_args-all_missing-adagrad] [32mPASSED[0m[31m [ 99%][0m
tests/variational/test_updates.py::test_updates_fast[mixed-with_args-all_missing-rmsprop] [32mPASSED[0m[31m [ 99%][0m
tests/variational/test_updates.py::test_updates_fast[mixed-with_args-all_missing-adadelta] [32mPASSED[0m[31m [ 99%][0m
tests/variational/test_updates.py::test_updates_fast[mixed-with_args-all_missing-adam] [32mPASSED[0m[31m [ 99%][0m
tests/variational/test_updates.py::test_updates_fast[mixed-with_args-all_missing-adamax] [32mPASSED[0m[31m [ 99%][0m
tests/variational/test_updates.py::test_updates_fast[mixed-with_args-all_missing-adagrad_window] [32mPASSED[0m[31m [100%][0m

=================================== FAILURES ===================================
[31m[1m_________________ TestDataPyMC.test_multivariate_observations __________________[0m

self = <tests.backends.test_arviz.TestDataPyMC object at 0x7f0bb5624980>

    [0m[94mdef[39;49;00m[90m [39;49;00m[92mtest_multivariate_observations[39;49;00m([96mself[39;49;00m):[90m[39;49;00m
        coords = {[33m"[39;49;00m[33mdirection[39;49;00m[33m"[39;49;00m: [[33m"[39;49;00m[33mx[39;49;00m[33m"[39;49;00m, [33m"[39;49;00m[33my[39;49;00m[33m"[39;49;00m, [33m"[39;49;00m[33mz[39;49;00m[33m"[39;49;00m], [33m"[39;49;00m[33mexperiment[39;49;00m[33m"[39;49;00m: np.arange([94m20[39;49;00m)}[90m[39;49;00m
        data = np.random.multinomial([94m20[39;49;00m, [[94m0.2[39;49;00m, [94m0.3[39;49;00m, [94m0.5[39;49;00m], size=[94m20[39;49;00m)[90m[39;49;00m
        [94mwith[39;49;00m pm.Model(coords=coords):[90m[39;49;00m
            p = pm.Beta([33m"[39;49;00m[33mp[39;49;00m[33m"[39;49;00m, [94m1[39;49;00m, [94m1[39;49;00m, size=([94m3[39;49;00m,))[90m[39;49;00m
            p = p / p.sum()[90m[39;49;00m
            pm.Multinomial([33m"[39;49;00m[33my[39;49;00m[33m"[39;49;00m, [94m20[39;49;00m, p, dims=([33m"[39;49;00m[33mexperiment[39;49;00m[33m"[39;49;00m, [33m"[39;49;00m[33mdirection[39;49;00m[33m"[39;49;00m), observed=data)[90m[39;49;00m
            [94mwith[39;49;00m warnings.catch_warnings():[90m[39;49;00m
                warnings.filterwarnings([33m"[39;49;00m[33mignore[39;49;00m[33m"[39;49;00m, [33m"[39;49;00m[33m.*number of samples.*[39;49;00m[33m"[39;49;00m, [96mUserWarning[39;49;00m)[90m[39;49;00m
                idata = pm.sample([90m[39;49;00m
                    draws=[94m50[39;49;00m,[90m[39;49;00m
                    chains=[94m2[39;49;00m,[90m[39;49;00m
                    tune=[94m100[39;49;00m,[90m[39;49;00m
                    return_inferencedata=[94mTrue[39;49;00m,[90m[39;49;00m
                    idata_kwargs={[33m"[39;49;00m[33mlog_likelihood[39;49;00m[33m"[39;49;00m: [94mTrue[39;49;00m},[90m[39;49;00m
                )[90m[39;49;00m
        test_dict = {[90m[39;49;00m
            [33m"[39;49;00m[33mposterior[39;49;00m[33m"[39;49;00m: [[33m"[39;49;00m[33mp[39;49;00m[33m"[39;49;00m],[90m[39;49;00m
            [33m"[39;49;00m[33msample_stats[39;49;00m[33m"[39;49;00m: [[33m"[39;49;00m[33mlp[39;49;00m[33m"[39;49;00m],[90m[39;49;00m
            [33m"[39;49;00m[33mlog_likelihood[39;49;00m[33m"[39;49;00m: [[33m"[39;49;00m[33my[39;49;00m[33m"[39;49;00m],[90m[39;49;00m
            [33m"[39;49;00m[33mobserved_data[39;49;00m[33m"[39;49;00m: [[33m"[39;49;00m[33my[39;49;00m[33m"[39;49;00m],[90m[39;49;00m
        }[90m[39;49;00m
        fails = check_multiple_attrs(test_dict, idata)[90m[39;49;00m
        [94massert[39;49;00m [95mnot[39;49;00m fails[90m[39;49;00m
        [94massert[39;49;00m [33m"[39;49;00m[33mdirection[39;49;00m[33m"[39;49;00m [95mnot[39;49;00m [95min[39;49;00m idata.log_likelihood.dims[90m[39;49;00m
        [94massert[39;49;00m [33m"[39;49;00m[33mdirection[39;49;00m[33m"[39;49;00m [95min[39;49;00m idata.observed_data.dims[90m[39;49;00m
>       [94massert[39;49;00m idata.log_likelihood[[33m"[39;49;00m[33my[39;49;00m[33m"[39;49;00m].shape == ([94m2[39;49;00m, [94m50[39;49;00m, [94m20[39;49;00m)[90m[39;49;00m
[1m[31mE       assert (2, 50, 1) == (2, 50, 20)[0m
[1m[31mE         [0m
[1m[31mE         At index 2 diff: [0m[94m1[39;49;00m[90m[39;49;00m != [0m[94m20[39;49;00m[90m[39;49;00m[0m
[1m[31mE         [0m
[1m[31mE         Full diff:[0m
[1m[31mE         [0m[90m [39;49;00m ([90m[39;49;00m[0m
[1m[31mE         [90m [39;49;00m     2,[90m[39;49;00m[0m
[1m[31mE         [90m [39;49;00m     50,[90m[39;49;00m[0m
[1m[31mE         [91m-     20,[39;49;00m[90m[39;49;00m[0m
[1m[31mE         ?     ^^[90m[39;49;00m[0m
[1m[31mE         [92m+     1,[39;49;00m[90m[39;49;00m[0m
[1m[31mE         ?     ^[90m[39;49;00m[0m
[1m[31mE         [90m [39;49;00m )[90m[39;49;00m[0m

[1m[31mtests/backends/test_arviz.py[0m:623: AssertionError
----------------------------- Captured stdout call -----------------------------

                              Step      Grad      Sampli…
  Progre…   Draws   Diverg…   size      evals     Speed     Elapsed   Remaini…
 ──────────────────────────────────────────────────────────────────────────────
  ━━━━━━━   150     0         0.188     23        726.71    0:00:00   0:00:00
                                                  draws/s
  ━━━━━━━   150     0         0.262     11        213.99    0:00:00   0:00:00
                                                  draws/s

----------------------------- Captured stderr call -----------------------------
Only 50 samples per chain. Reliable r-hat and ESS diagnostics require longer chains for accurate estimate.
Initializing NUTS using jitter+adapt_diag...
Multiprocess sampling (2 chains in 2 jobs)
NUTS: [p]
Sampling 2 chains for 100 tune and 50 draw iterations (200 + 100 draws total) took 6 seconds.
The number of samples is too small to check convergence reliably.
------------------------------ Captured log call -------------------------------
[33mWARNING [0m pymc.sampling.mcmc:mcmc.py:780 Only 50 samples per chain. Reliable r-hat and ESS diagnostics require longer chains for accurate estimate.
[32mINFO    [0m pymc.sampling.mcmc:mcmc.py:1582 Initializing NUTS using jitter+adapt_diag...
[32mINFO    [0m pymc.sampling.mcmc:mcmc.py:925 Multiprocess sampling (2 chains in 2 jobs)
[32mINFO    [0m pymc.sampling.mcmc:mcmc.py:282 NUTS: [p]
[32mINFO    [0m pymc.sampling.mcmc:mcmc.py:1068 Sampling 2 chains for 100 tune and 50 draw iterations (200 + 100 draws total) took 6 seconds.
[32mINFO    [0m pymc.stats.convergence:convergence.py:187 The number of samples is too small to check convergence reliably.
[31m[1m_____________ TestMixtureSameFamily.test_with_multinomial[(3, 4)] ______________[0m

self = <pytensor.compile.function.types.Function object at 0x7f0ba2c2b2f0>
output_subset = None, args = (), kwargs = {}, trust_input = False
vm = <pytensor.link.c.cvm.CVM object at 0x7f0ba11cbe30>, profile = None

    [0m[94mdef[39;49;00m[90m [39;49;00m[92m__call__[39;49;00m([96mself[39;49;00m, *args, output_subset=[94mNone[39;49;00m, **kwargs):[90m[39;49;00m
    [90m    [39;49;00m[33m"""[39;49;00m
    [33m    Evaluates value of a function on given arguments.[39;49;00m
    [33m[39;49;00m
    [33m    Parameters[39;49;00m
    [33m    ----------[39;49;00m
    [33m    args : list[39;49;00m
    [33m        List of inputs to the function. All inputs are required, even when[39;49;00m
    [33m        some of them are not necessary to calculate requested subset of[39;49;00m
    [33m        outputs.[39;49;00m
    [33m[39;49;00m
    [33m    kwargs : dict[39;49;00m
    [33m        The function inputs can be passed as keyword argument. For this, use[39;49;00m
    [33m        the name of the input or the input instance as the key.[39;49;00m
    [33m[39;49;00m
    [33m        Keyword argument ``output_subset`` is a list of either indices of the[39;49;00m
    [33m        function's outputs or the keys belonging to the `output_keys` dict[39;49;00m
    [33m        and represent outputs that are requested to be calculated. Regardless[39;49;00m
    [33m        of the presence of ``output_subset``, the updates are always calculated[39;49;00m
    [33m        and processed. To disable the updates, you should use the ``copy``[39;49;00m
    [33m        method with ``delete_updates=True``.[39;49;00m
    [33m[39;49;00m
    [33m    Returns[39;49;00m
    [33m    -------[39;49;00m
    [33m    list[39;49;00m
    [33m        List of outputs on indices/keys from ``output_subset`` or all of them,[39;49;00m
    [33m        if ``output_subset`` is not passed.[39;49;00m
    [33m    """[39;49;00m[90m[39;49;00m
        trust_input = [96mself[39;49;00m.trust_input[90m[39;49;00m
        input_storage = [96mself[39;49;00m.input_storage[90m[39;49;00m
        vm = [96mself[39;49;00m.vm[90m[39;49;00m
        profile = [96mself[39;49;00m.profile[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0 = time.perf_counter()[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m output_subset [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
            warnings.warn([33m"[39;49;00m[33moutput_subset is deprecated.[39;49;00m[33m"[39;49;00m, [96mFutureWarning[39;49;00m)[90m[39;49;00m
            [94mif[39;49;00m [96mself[39;49;00m.output_keys [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                output_subset = [[96mself[39;49;00m.output_keys.index(key) [94mfor[39;49;00m key [95min[39;49;00m output_subset][90m[39;49;00m
    [90m[39;49;00m
        [90m# Reinitialize each container's 'provided' counter[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m trust_input:[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
        [94melse[39;49;00m:[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                arg_container.provided = [94m0[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
            [94mif[39;49;00m [96mlen[39;49;00m(args) + [96mlen[39;49;00m(kwargs) > [96mlen[39;49;00m(input_storage):[90m[39;49;00m
                [94mraise[39;49;00m [96mTypeError[39;49;00m([33m"[39;49;00m[33mToo many parameter passed to pytensor function[39;49;00m[33m"[39;49;00m)[90m[39;49;00m
    [90m[39;49;00m
            [90m# Set positional arguments[39;49;00m[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                [90m# See discussion about None as input[39;49;00m[90m[39;49;00m
                [90m# https://groups.google.com/group/theano-dev/browse_thread/thread/920a5e904e8a8525/4f1b311a28fc27e5[39;49;00m[90m[39;49;00m
                [94mif[39;49;00m arg [95mis[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                    arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
                [94melse[39;49;00m:[90m[39;49;00m
                    [94mtry[39;49;00m:[90m[39;49;00m
                        arg_container.storage[[94m0[39;49;00m] = arg_container.type.filter([90m[39;49;00m
                            arg,[90m[39;49;00m
                            strict=arg_container.strict,[90m[39;49;00m
                            allow_downcast=arg_container.allow_downcast,[90m[39;49;00m
                        )[90m[39;49;00m
    [90m[39;49;00m
                    [94mexcept[39;49;00m [96mException[39;49;00m [94mas[39;49;00m e:[90m[39;49;00m
                        i = input_storage.index(arg_container)[90m[39;49;00m
                        function_name = [33m"[39;49;00m[33mpytensor function[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        argument_name = [33m"[39;49;00m[33margument[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mself[39;49;00m.name:[90m[39;49;00m
                            function_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + [96mself[39;49;00m.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mhasattr[39;49;00m(arg, [33m"[39;49;00m[33mname[39;49;00m[33m"[39;49;00m) [95mand[39;49;00m arg.name:[90m[39;49;00m
                            argument_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + arg.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        where = get_variable_trace_string([96mself[39;49;00m.maker.inputs[i].variable)[90m[39;49;00m
                        [94mif[39;49;00m [96mlen[39;49;00m(e.args) == [94m1[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + e.args[[94m0[39;49;00m],[90m[39;49;00m
                            )[90m[39;49;00m
                        [94melse[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                            ) + e.args[90m[39;49;00m
                        [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                        [94mraise[39;49;00m[90m[39;49;00m
                arg_container.provided += [94m1[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
        [90m# Set keyword arguments[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m kwargs:  [90m# for speed, skip the items for empty kwargs[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m k, arg [95min[39;49;00m kwargs.items():[90m[39;49;00m
                [96mself[39;49;00m[k] = arg[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m [95mnot[39;49;00m trust_input:[90m[39;49;00m
            [90m# Collect aliased inputs among the storage space[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m potential_group [95min[39;49;00m [96mself[39;49;00m._potential_aliased_input_groups:[90m[39;49;00m
                args_share_memory: [96mlist[39;49;00m[[96mlist[39;49;00m[[96mint[39;49;00m]] = [][90m[39;49;00m
                [94mfor[39;49;00m i [95min[39;49;00m potential_group:[90m[39;49;00m
                    i_type = [96mself[39;49;00m.maker.inputs[i].variable.type[90m[39;49;00m
                    i_val = input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
    [90m[39;49;00m
                    [90m# Check if value is aliased with any of the values in one of the groups[39;49;00m[90m[39;49;00m
                    [94mfor[39;49;00m j_group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                        [94mif[39;49;00m [96many[39;49;00m([90m[39;49;00m
                            i_type.may_share_memory(input_storage[j].storage[[94m0[39;49;00m], i_val)[90m[39;49;00m
                            [94mfor[39;49;00m j [95min[39;49;00m j_group[90m[39;49;00m
                        ):[90m[39;49;00m
                            j_group.append(i)[90m[39;49;00m
                            [94mbreak[39;49;00m[90m[39;49;00m
                    [94melse[39;49;00m:  [90m# no break[39;49;00m[90m[39;49;00m
                        [90m# Create a new group[39;49;00m[90m[39;49;00m
                        args_share_memory.append([i])[90m[39;49;00m
    [90m[39;49;00m
                [90m# Check for groups of more than one argument that share memory[39;49;00m[90m[39;49;00m
                [94mfor[39;49;00m group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                    [94mif[39;49;00m [96mlen[39;49;00m(group) > [94m1[39;49;00m:[90m[39;49;00m
                        [90m# copy all but the first[39;49;00m[90m[39;49;00m
                        [94mfor[39;49;00m i [95min[39;49;00m group[[94m1[39;49;00m:]:[90m[39;49;00m
                            input_storage[i].storage[[94m0[39;49;00m] = copy.copy([90m[39;49;00m
                                input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
                            )[90m[39;49;00m
    [90m[39;49;00m
            [90m# Check if inputs are missing, or if inputs were set more than once, or[39;49;00m[90m[39;49;00m
            [90m# if we tried to provide inputs that are supposed to be implicit.[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                [94mif[39;49;00m arg_container.required [95mand[39;49;00m [95mnot[39;49;00m arg_container.provided:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMissing required input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.provided > [94m1[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMultiple values for input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.implicit [95mand[39;49;00m arg_container.provided > [94m0[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mTried to provide value for implicit input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
    [90m[39;49;00m
        [90m# Do the actual work[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0_fn = time.perf_counter()[90m[39;49;00m
        [94mtry[39;49;00m:[90m[39;49;00m
>           outputs = vm() [94mif[39;49;00m output_subset [95mis[39;49;00m [94mNone[39;49;00m [94melse[39;49;00m vm(output_subset=output_subset)[90m[39;49;00m
                      ^^^^[90m[39;49;00m
[1m[31mE           pymc.logprob.utils.ParameterValueError[0m

[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/compile/function/types.py[0m:1038: ParameterValueError

[33mDuring handling of the above exception, another exception occurred:[0m

self = <tests.distributions.test_mixture.TestMixtureSameFamily object at 0x7f0bb3f8d590>
seeded_test = None, batch_shape = (3, 4)

    [0m[37m@pytest[39;49;00m.mark.parametrize([33m"[39;49;00m[33mbatch_shape[39;49;00m[33m"[39;49;00m, [([94m3[39;49;00m, [94m4[39;49;00m), ([94m20[39;49;00m,)], ids=[96mstr[39;49;00m)[90m[39;49;00m
    [94mdef[39;49;00m[90m [39;49;00m[92mtest_with_multinomial[39;49;00m([96mself[39;49;00m, seeded_test, batch_shape):[90m[39;49;00m
        p = np.random.uniform(size=(*batch_shape, [96mself[39;49;00m.mixture_comps, [94m3[39;49;00m))[90m[39;49;00m
        p /= p.sum(axis=-[94m1[39;49;00m, keepdims=[94mTrue[39;49;00m)[90m[39;49;00m
        n = [94m100[39;49;00m * np.ones((*batch_shape, [94m1[39;49;00m))[90m[39;49;00m
        w = np.ones([96mself[39;49;00m.mixture_comps) / [96mself[39;49;00m.mixture_comps[90m[39;49;00m
        mixture_axis = [96mlen[39;49;00m(batch_shape)[90m[39;49;00m
        [94mwith[39;49;00m Model() [94mas[39;49;00m model:[90m[39;49;00m
            comp_dists = Multinomial.dist(p=p, n=n, shape=(*batch_shape, [96mself[39;49;00m.mixture_comps, [94m3[39;49;00m))[90m[39;49;00m
            mixture = Mixture([90m[39;49;00m
                [33m"[39;49;00m[33mmixture[39;49;00m[33m"[39;49;00m,[90m[39;49;00m
                w=w,[90m[39;49;00m
                comp_dists=comp_dists,[90m[39;49;00m
                shape=(*batch_shape, [94m3[39;49;00m),[90m[39;49;00m
            )[90m[39;49;00m
            prior = sample_prior_predictive(draws=[96mself[39;49;00m.n_samples, return_inferencedata=[94mFalse[39;49;00m)[90m[39;49;00m
    [90m[39;49;00m
        [94massert[39;49;00m prior[[33m"[39;49;00m[33mmixture[39;49;00m[33m"[39;49;00m].shape == ([96mself[39;49;00m.n_samples, *batch_shape, [94m3[39;49;00m)[90m[39;49;00m
        [94massert[39;49;00m draw(mixture, draws=[96mself[39;49;00m.size).shape == ([96mself[39;49;00m.size, *batch_shape, [94m3[39;49;00m)[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m pytensor.config.floatX == [33m"[39;49;00m[33mfloat32[39;49;00m[33m"[39;49;00m:[90m[39;49;00m
            rtol = [94m1e-4[39;49;00m[90m[39;49;00m
        [94melse[39;49;00m:[90m[39;49;00m
            rtol = [94m1e-7[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
        initial_point = model.initial_point()[90m[39;49;00m
        comp_logp = logp(comp_dists, initial_point[[33m"[39;49;00m[33mmixture[39;49;00m[33m"[39;49;00m].reshape(*batch_shape, [94m1[39;49;00m, [94m3[39;49;00m))[90m[39;49;00m
        log_sum_exp = logsumexp([90m[39;49;00m
>           comp_logp.eval() + np.log(w), axis=mixture_axis, keepdims=[94mTrue[39;49;00m[90m[39;49;00m
            ^^^^^^^^^^^^^^^^[90m[39;49;00m
        ).sum()[90m[39;49;00m

[1m[31mtests/distributions/test_mixture.py[0m:1058:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/graph/basic.py[0m:668: in eval
    [0m[94mreturn[39;49;00m fn(*args)[90m[39;49;00m
           ^^^^^^^^^[90m[39;49;00m
[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/compile/function/types.py[0m:1048: in __call__
    [0mraise_with_op([90m[39;49;00m
[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/link/utils.py[0m:526: in raise_with_op
    [0m[94mraise[39;49;00m exc_value.with_traceback(exc_trace)[90m[39;49;00m
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <pytensor.compile.function.types.Function object at 0x7f0ba2c2b2f0>
output_subset = None, args = (), kwargs = {}, trust_input = False
vm = <pytensor.link.c.cvm.CVM object at 0x7f0ba11cbe30>, profile = None

    [0m[94mdef[39;49;00m[90m [39;49;00m[92m__call__[39;49;00m([96mself[39;49;00m, *args, output_subset=[94mNone[39;49;00m, **kwargs):[90m[39;49;00m
    [90m    [39;49;00m[33m"""[39;49;00m
    [33m    Evaluates value of a function on given arguments.[39;49;00m
    [33m[39;49;00m
    [33m    Parameters[39;49;00m
    [33m    ----------[39;49;00m
    [33m    args : list[39;49;00m
    [33m        List of inputs to the function. All inputs are required, even when[39;49;00m
    [33m        some of them are not necessary to calculate requested subset of[39;49;00m
    [33m        outputs.[39;49;00m
    [33m[39;49;00m
    [33m    kwargs : dict[39;49;00m
    [33m        The function inputs can be passed as keyword argument. For this, use[39;49;00m
    [33m        the name of the input or the input instance as the key.[39;49;00m
    [33m[39;49;00m
    [33m        Keyword argument ``output_subset`` is a list of either indices of the[39;49;00m
    [33m        function's outputs or the keys belonging to the `output_keys` dict[39;49;00m
    [33m        and represent outputs that are requested to be calculated. Regardless[39;49;00m
    [33m        of the presence of ``output_subset``, the updates are always calculated[39;49;00m
    [33m        and processed. To disable the updates, you should use the ``copy``[39;49;00m
    [33m        method with ``delete_updates=True``.[39;49;00m
    [33m[39;49;00m
    [33m    Returns[39;49;00m
    [33m    -------[39;49;00m
    [33m    list[39;49;00m
    [33m        List of outputs on indices/keys from ``output_subset`` or all of them,[39;49;00m
    [33m        if ``output_subset`` is not passed.[39;49;00m
    [33m    """[39;49;00m[90m[39;49;00m
        trust_input = [96mself[39;49;00m.trust_input[90m[39;49;00m
        input_storage = [96mself[39;49;00m.input_storage[90m[39;49;00m
        vm = [96mself[39;49;00m.vm[90m[39;49;00m
        profile = [96mself[39;49;00m.profile[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0 = time.perf_counter()[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m output_subset [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
            warnings.warn([33m"[39;49;00m[33moutput_subset is deprecated.[39;49;00m[33m"[39;49;00m, [96mFutureWarning[39;49;00m)[90m[39;49;00m
            [94mif[39;49;00m [96mself[39;49;00m.output_keys [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                output_subset = [[96mself[39;49;00m.output_keys.index(key) [94mfor[39;49;00m key [95min[39;49;00m output_subset][90m[39;49;00m
    [90m[39;49;00m
        [90m# Reinitialize each container's 'provided' counter[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m trust_input:[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
        [94melse[39;49;00m:[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                arg_container.provided = [94m0[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
            [94mif[39;49;00m [96mlen[39;49;00m(args) + [96mlen[39;49;00m(kwargs) > [96mlen[39;49;00m(input_storage):[90m[39;49;00m
                [94mraise[39;49;00m [96mTypeError[39;49;00m([33m"[39;49;00m[33mToo many parameter passed to pytensor function[39;49;00m[33m"[39;49;00m)[90m[39;49;00m
    [90m[39;49;00m
            [90m# Set positional arguments[39;49;00m[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                [90m# See discussion about None as input[39;49;00m[90m[39;49;00m
                [90m# https://groups.google.com/group/theano-dev/browse_thread/thread/920a5e904e8a8525/4f1b311a28fc27e5[39;49;00m[90m[39;49;00m
                [94mif[39;49;00m arg [95mis[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                    arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
                [94melse[39;49;00m:[90m[39;49;00m
                    [94mtry[39;49;00m:[90m[39;49;00m
                        arg_container.storage[[94m0[39;49;00m] = arg_container.type.filter([90m[39;49;00m
                            arg,[90m[39;49;00m
                            strict=arg_container.strict,[90m[39;49;00m
                            allow_downcast=arg_container.allow_downcast,[90m[39;49;00m
                        )[90m[39;49;00m
    [90m[39;49;00m
                    [94mexcept[39;49;00m [96mException[39;49;00m [94mas[39;49;00m e:[90m[39;49;00m
                        i = input_storage.index(arg_container)[90m[39;49;00m
                        function_name = [33m"[39;49;00m[33mpytensor function[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        argument_name = [33m"[39;49;00m[33margument[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mself[39;49;00m.name:[90m[39;49;00m
                            function_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + [96mself[39;49;00m.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mhasattr[39;49;00m(arg, [33m"[39;49;00m[33mname[39;49;00m[33m"[39;49;00m) [95mand[39;49;00m arg.name:[90m[39;49;00m
                            argument_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + arg.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        where = get_variable_trace_string([96mself[39;49;00m.maker.inputs[i].variable)[90m[39;49;00m
                        [94mif[39;49;00m [96mlen[39;49;00m(e.args) == [94m1[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + e.args[[94m0[39;49;00m],[90m[39;49;00m
                            )[90m[39;49;00m
                        [94melse[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                            ) + e.args[90m[39;49;00m
                        [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                        [94mraise[39;49;00m[90m[39;49;00m
                arg_container.provided += [94m1[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
        [90m# Set keyword arguments[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m kwargs:  [90m# for speed, skip the items for empty kwargs[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m k, arg [95min[39;49;00m kwargs.items():[90m[39;49;00m
                [96mself[39;49;00m[k] = arg[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m [95mnot[39;49;00m trust_input:[90m[39;49;00m
            [90m# Collect aliased inputs among the storage space[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m potential_group [95min[39;49;00m [96mself[39;49;00m._potential_aliased_input_groups:[90m[39;49;00m
                args_share_memory: [96mlist[39;49;00m[[96mlist[39;49;00m[[96mint[39;49;00m]] = [][90m[39;49;00m
                [94mfor[39;49;00m i [95min[39;49;00m potential_group:[90m[39;49;00m
                    i_type = [96mself[39;49;00m.maker.inputs[i].variable.type[90m[39;49;00m
                    i_val = input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
    [90m[39;49;00m
                    [90m# Check if value is aliased with any of the values in one of the groups[39;49;00m[90m[39;49;00m
                    [94mfor[39;49;00m j_group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                        [94mif[39;49;00m [96many[39;49;00m([90m[39;49;00m
                            i_type.may_share_memory(input_storage[j].storage[[94m0[39;49;00m], i_val)[90m[39;49;00m
                            [94mfor[39;49;00m j [95min[39;49;00m j_group[90m[39;49;00m
                        ):[90m[39;49;00m
                            j_group.append(i)[90m[39;49;00m
                            [94mbreak[39;49;00m[90m[39;49;00m
                    [94melse[39;49;00m:  [90m# no break[39;49;00m[90m[39;49;00m
                        [90m# Create a new group[39;49;00m[90m[39;49;00m
                        args_share_memory.append([i])[90m[39;49;00m
    [90m[39;49;00m
                [90m# Check for groups of more than one argument that share memory[39;49;00m[90m[39;49;00m
                [94mfor[39;49;00m group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                    [94mif[39;49;00m [96mlen[39;49;00m(group) > [94m1[39;49;00m:[90m[39;49;00m
                        [90m# copy all but the first[39;49;00m[90m[39;49;00m
                        [94mfor[39;49;00m i [95min[39;49;00m group[[94m1[39;49;00m:]:[90m[39;49;00m
                            input_storage[i].storage[[94m0[39;49;00m] = copy.copy([90m[39;49;00m
                                input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
                            )[90m[39;49;00m
    [90m[39;49;00m
            [90m# Check if inputs are missing, or if inputs were set more than once, or[39;49;00m[90m[39;49;00m
            [90m# if we tried to provide inputs that are supposed to be implicit.[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                [94mif[39;49;00m arg_container.required [95mand[39;49;00m [95mnot[39;49;00m arg_container.provided:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMissing required input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.provided > [94m1[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMultiple values for input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.implicit [95mand[39;49;00m arg_container.provided > [94m0[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mTried to provide value for implicit input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
    [90m[39;49;00m
        [90m# Do the actual work[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0_fn = time.perf_counter()[90m[39;49;00m
        [94mtry[39;49;00m:[90m[39;49;00m
>           outputs = vm() [94mif[39;49;00m output_subset [95mis[39;49;00m [94mNone[39;49;00m [94melse[39;49;00m vm(output_subset=output_subset)[90m[39;49;00m
                      ^^^^[90m[39;49;00m
[1m[31mE           pymc.logprob.utils.ParameterValueError: [0m
[1m[31mE           Apply node that caused the error: Check{}([[[-17642. ... 4381612]]], False)[0m
[1m[31mE           Toposort index: 0[0m
[1m[31mE           Inputs types: [TensorType(float64, shape=(3, 4, 1)), ScalarType(bool)][0m
[1m[31mE           Inputs shapes: [(3, 4, 1), ()][0m
[1m[31mE           Inputs strides: [(32, 8, 8), ()][0m
[1m[31mE           Inputs values: ['not shown', np.False_][0m
[1m[31mE           Inputs type_num: [12, 0][0m
[1m[31mE           Outputs clients: [[DeepCopyOp(Check{}.0)]][0m
[1m[31mE           [0m
[1m[31mE           Backtrace when the node is created (use PyTensor flag traceback__limit=N to make it longer):[0m
[1m[31mE             File "/app/pymc/logprob/basic.py", line 193, in logp[0m
[1m[31mE               return _logprob_helper(rv, value, **kwargs)[0m
[1m[31mE             File "/app/pymc/logprob/abstract.py", line 70, in _logprob_helper[0m
[1m[31mE               logprob = _logprob(rv.owner.op, values, *rv.owner.inputs, **kwargs)[0m
[1m[31mE             File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/functools.py", line 982, in wrapper[0m
[1m[31mE               return dispatch(args[0].__class__)(*args, **kw)[0m
[1m[31mE             File "/app/pymc/distributions/distribution.py", line 140, in logp[0m
[1m[31mE               return class_logp(value, *dist_params)[0m
[1m[31mE             File "/app/tests/distributions/test_dist_math.py", line 96, in logp[0m
[1m[31mE               return check_parameters([0m
[1m[31mE             File "/app/pymc/distributions/dist_math.py", line 72, in check_parameters[0m
[1m[31mE               return CheckParameterValue(msg, can_be_replaced_by_ninf)(expr, all_true_scalar)[0m
[1m[31mE             File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/graph/op.py", line 294, in __call__[0m
[1m[31mE               node = self.make_node(*inputs, **kwargs)[0m
[1m[31mE             File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/raise_op.py", line 81, in make_node[0m
[1m[31mE               [value.type()],[0m
[1m[31mE           [0m
[1m[31mE           Debug print of the apply node: [0m
[1m[31mE           Check{} [id A] <Tensor3(float64, shape=(3, 4, 1))>[0m
[1m[31mE            ├─ [[[-17642. ... 4381612]]] [id B] <Tensor3(float64, shape=(3, 4, 1))>[0m
[1m[31mE            └─ False [id C] <bool>[0m
[1m[31mE           [0m
[1m[31mE           Storage map footprint:[0m
[1m[31mE            - [[[-17642. ... 4381612]]], Shape: (3, 4, 1), ElemSize: 8 Byte(s), TotalSize: 96 Byte(s)[0m
[1m[31mE            - False, Shape: (), ElemSize: 1 Byte(s), TotalSize: 1.0 Byte(s)[0m
[1m[31mE            TotalSize: 97.0 Byte(s) 0.000 GB[0m
[1m[31mE            TotalSize inputs: 97.0 Byte(s) 0.000 GB[0m

[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/compile/function/types.py[0m:1038: ParameterValueError
----------------------------- Captured stderr call -----------------------------
Sampling: [mixture]
------------------------------ Captured log call -------------------------------
[32mINFO    [0m pymc.sampling.forward:forward.py:477 Sampling: [mixture]
[31m[1m______________ TestMixtureSameFamily.test_with_multinomial[(20,)] ______________[0m

self = <pytensor.compile.function.types.Function object at 0x7f0b9a63d6d0>
output_subset = None, args = (), kwargs = {}, trust_input = False
vm = <pytensor.link.c.cvm.CVM object at 0x7f0ba148d910>, profile = None

    [0m[94mdef[39;49;00m[90m [39;49;00m[92m__call__[39;49;00m([96mself[39;49;00m, *args, output_subset=[94mNone[39;49;00m, **kwargs):[90m[39;49;00m
    [90m    [39;49;00m[33m"""[39;49;00m
    [33m    Evaluates value of a function on given arguments.[39;49;00m
    [33m[39;49;00m
    [33m    Parameters[39;49;00m
    [33m    ----------[39;49;00m
    [33m    args : list[39;49;00m
    [33m        List of inputs to the function. All inputs are required, even when[39;49;00m
    [33m        some of them are not necessary to calculate requested subset of[39;49;00m
    [33m        outputs.[39;49;00m
    [33m[39;49;00m
    [33m    kwargs : dict[39;49;00m
    [33m        The function inputs can be passed as keyword argument. For this, use[39;49;00m
    [33m        the name of the input or the input instance as the key.[39;49;00m
    [33m[39;49;00m
    [33m        Keyword argument ``output_subset`` is a list of either indices of the[39;49;00m
    [33m        function's outputs or the keys belonging to the `output_keys` dict[39;49;00m
    [33m        and represent outputs that are requested to be calculated. Regardless[39;49;00m
    [33m        of the presence of ``output_subset``, the updates are always calculated[39;49;00m
    [33m        and processed. To disable the updates, you should use the ``copy``[39;49;00m
    [33m        method with ``delete_updates=True``.[39;49;00m
    [33m[39;49;00m
    [33m    Returns[39;49;00m
    [33m    -------[39;49;00m
    [33m    list[39;49;00m
    [33m        List of outputs on indices/keys from ``output_subset`` or all of them,[39;49;00m
    [33m        if ``output_subset`` is not passed.[39;49;00m
    [33m    """[39;49;00m[90m[39;49;00m
        trust_input = [96mself[39;49;00m.trust_input[90m[39;49;00m
        input_storage = [96mself[39;49;00m.input_storage[90m[39;49;00m
        vm = [96mself[39;49;00m.vm[90m[39;49;00m
        profile = [96mself[39;49;00m.profile[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0 = time.perf_counter()[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m output_subset [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
            warnings.warn([33m"[39;49;00m[33moutput_subset is deprecated.[39;49;00m[33m"[39;49;00m, [96mFutureWarning[39;49;00m)[90m[39;49;00m
            [94mif[39;49;00m [96mself[39;49;00m.output_keys [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                output_subset = [[96mself[39;49;00m.output_keys.index(key) [94mfor[39;49;00m key [95min[39;49;00m output_subset][90m[39;49;00m
    [90m[39;49;00m
        [90m# Reinitialize each container's 'provided' counter[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m trust_input:[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
        [94melse[39;49;00m:[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                arg_container.provided = [94m0[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
            [94mif[39;49;00m [96mlen[39;49;00m(args) + [96mlen[39;49;00m(kwargs) > [96mlen[39;49;00m(input_storage):[90m[39;49;00m
                [94mraise[39;49;00m [96mTypeError[39;49;00m([33m"[39;49;00m[33mToo many parameter passed to pytensor function[39;49;00m[33m"[39;49;00m)[90m[39;49;00m
    [90m[39;49;00m
            [90m# Set positional arguments[39;49;00m[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                [90m# See discussion about None as input[39;49;00m[90m[39;49;00m
                [90m# https://groups.google.com/group/theano-dev/browse_thread/thread/920a5e904e8a8525/4f1b311a28fc27e5[39;49;00m[90m[39;49;00m
                [94mif[39;49;00m arg [95mis[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                    arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
                [94melse[39;49;00m:[90m[39;49;00m
                    [94mtry[39;49;00m:[90m[39;49;00m
                        arg_container.storage[[94m0[39;49;00m] = arg_container.type.filter([90m[39;49;00m
                            arg,[90m[39;49;00m
                            strict=arg_container.strict,[90m[39;49;00m
                            allow_downcast=arg_container.allow_downcast,[90m[39;49;00m
                        )[90m[39;49;00m
    [90m[39;49;00m
                    [94mexcept[39;49;00m [96mException[39;49;00m [94mas[39;49;00m e:[90m[39;49;00m
                        i = input_storage.index(arg_container)[90m[39;49;00m
                        function_name = [33m"[39;49;00m[33mpytensor function[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        argument_name = [33m"[39;49;00m[33margument[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mself[39;49;00m.name:[90m[39;49;00m
                            function_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + [96mself[39;49;00m.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mhasattr[39;49;00m(arg, [33m"[39;49;00m[33mname[39;49;00m[33m"[39;49;00m) [95mand[39;49;00m arg.name:[90m[39;49;00m
                            argument_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + arg.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        where = get_variable_trace_string([96mself[39;49;00m.maker.inputs[i].variable)[90m[39;49;00m
                        [94mif[39;49;00m [96mlen[39;49;00m(e.args) == [94m1[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + e.args[[94m0[39;49;00m],[90m[39;49;00m
                            )[90m[39;49;00m
                        [94melse[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                            ) + e.args[90m[39;49;00m
                        [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                        [94mraise[39;49;00m[90m[39;49;00m
                arg_container.provided += [94m1[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
        [90m# Set keyword arguments[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m kwargs:  [90m# for speed, skip the items for empty kwargs[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m k, arg [95min[39;49;00m kwargs.items():[90m[39;49;00m
                [96mself[39;49;00m[k] = arg[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m [95mnot[39;49;00m trust_input:[90m[39;49;00m
            [90m# Collect aliased inputs among the storage space[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m potential_group [95min[39;49;00m [96mself[39;49;00m._potential_aliased_input_groups:[90m[39;49;00m
                args_share_memory: [96mlist[39;49;00m[[96mlist[39;49;00m[[96mint[39;49;00m]] = [][90m[39;49;00m
                [94mfor[39;49;00m i [95min[39;49;00m potential_group:[90m[39;49;00m
                    i_type = [96mself[39;49;00m.maker.inputs[i].variable.type[90m[39;49;00m
                    i_val = input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
    [90m[39;49;00m
                    [90m# Check if value is aliased with any of the values in one of the groups[39;49;00m[90m[39;49;00m
                    [94mfor[39;49;00m j_group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                        [94mif[39;49;00m [96many[39;49;00m([90m[39;49;00m
                            i_type.may_share_memory(input_storage[j].storage[[94m0[39;49;00m], i_val)[90m[39;49;00m
                            [94mfor[39;49;00m j [95min[39;49;00m j_group[90m[39;49;00m
                        ):[90m[39;49;00m
                            j_group.append(i)[90m[39;49;00m
                            [94mbreak[39;49;00m[90m[39;49;00m
                    [94melse[39;49;00m:  [90m# no break[39;49;00m[90m[39;49;00m
                        [90m# Create a new group[39;49;00m[90m[39;49;00m
                        args_share_memory.append([i])[90m[39;49;00m
    [90m[39;49;00m
                [90m# Check for groups of more than one argument that share memory[39;49;00m[90m[39;49;00m
                [94mfor[39;49;00m group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                    [94mif[39;49;00m [96mlen[39;49;00m(group) > [94m1[39;49;00m:[90m[39;49;00m
                        [90m# copy all but the first[39;49;00m[90m[39;49;00m
                        [94mfor[39;49;00m i [95min[39;49;00m group[[94m1[39;49;00m:]:[90m[39;49;00m
                            input_storage[i].storage[[94m0[39;49;00m] = copy.copy([90m[39;49;00m
                                input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
                            )[90m[39;49;00m
    [90m[39;49;00m
            [90m# Check if inputs are missing, or if inputs were set more than once, or[39;49;00m[90m[39;49;00m
            [90m# if we tried to provide inputs that are supposed to be implicit.[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                [94mif[39;49;00m arg_container.required [95mand[39;49;00m [95mnot[39;49;00m arg_container.provided:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMissing required input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.provided > [94m1[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMultiple values for input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.implicit [95mand[39;49;00m arg_container.provided > [94m0[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mTried to provide value for implicit input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
    [90m[39;49;00m
        [90m# Do the actual work[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0_fn = time.perf_counter()[90m[39;49;00m
        [94mtry[39;49;00m:[90m[39;49;00m
>           outputs = vm() [94mif[39;49;00m output_subset [95mis[39;49;00m [94mNone[39;49;00m [94melse[39;49;00m vm(output_subset=output_subset)[90m[39;49;00m
                      ^^^^[90m[39;49;00m
[1m[31mE           pymc.logprob.utils.ParameterValueError[0m

[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/compile/function/types.py[0m:1038: ParameterValueError

[33mDuring handling of the above exception, another exception occurred:[0m

self = <tests.distributions.test_mixture.TestMixtureSameFamily object at 0x7f0bb3f8d6d0>
seeded_test = None, batch_shape = (20,)

    [0m[37m@pytest[39;49;00m.mark.parametrize([33m"[39;49;00m[33mbatch_shape[39;49;00m[33m"[39;49;00m, [([94m3[39;49;00m, [94m4[39;49;00m), ([94m20[39;49;00m,)], ids=[96mstr[39;49;00m)[90m[39;49;00m
    [94mdef[39;49;00m[90m [39;49;00m[92mtest_with_multinomial[39;49;00m([96mself[39;49;00m, seeded_test, batch_shape):[90m[39;49;00m
        p = np.random.uniform(size=(*batch_shape, [96mself[39;49;00m.mixture_comps, [94m3[39;49;00m))[90m[39;49;00m
        p /= p.sum(axis=-[94m1[39;49;00m, keepdims=[94mTrue[39;49;00m)[90m[39;49;00m
        n = [94m100[39;49;00m * np.ones((*batch_shape, [94m1[39;49;00m))[90m[39;49;00m
        w = np.ones([96mself[39;49;00m.mixture_comps) / [96mself[39;49;00m.mixture_comps[90m[39;49;00m
        mixture_axis = [96mlen[39;49;00m(batch_shape)[90m[39;49;00m
        [94mwith[39;49;00m Model() [94mas[39;49;00m model:[90m[39;49;00m
            comp_dists = Multinomial.dist(p=p, n=n, shape=(*batch_shape, [96mself[39;49;00m.mixture_comps, [94m3[39;49;00m))[90m[39;49;00m
            mixture = Mixture([90m[39;49;00m
                [33m"[39;49;00m[33mmixture[39;49;00m[33m"[39;49;00m,[90m[39;49;00m
                w=w,[90m[39;49;00m
                comp_dists=comp_dists,[90m[39;49;00m
                shape=(*batch_shape, [94m3[39;49;00m),[90m[39;49;00m
            )[90m[39;49;00m
            prior = sample_prior_predictive(draws=[96mself[39;49;00m.n_samples, return_inferencedata=[94mFalse[39;49;00m)[90m[39;49;00m
    [90m[39;49;00m
        [94massert[39;49;00m prior[[33m"[39;49;00m[33mmixture[39;49;00m[33m"[39;49;00m].shape == ([96mself[39;49;00m.n_samples, *batch_shape, [94m3[39;49;00m)[90m[39;49;00m
        [94massert[39;49;00m draw(mixture, draws=[96mself[39;49;00m.size).shape == ([96mself[39;49;00m.size, *batch_shape, [94m3[39;49;00m)[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m pytensor.config.floatX == [33m"[39;49;00m[33mfloat32[39;49;00m[33m"[39;49;00m:[90m[39;49;00m
            rtol = [94m1e-4[39;49;00m[90m[39;49;00m
        [94melse[39;49;00m:[90m[39;49;00m
            rtol = [94m1e-7[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
        initial_point = model.initial_point()[90m[39;49;00m
        comp_logp = logp(comp_dists, initial_point[[33m"[39;49;00m[33mmixture[39;49;00m[33m"[39;49;00m].reshape(*batch_shape, [94m1[39;49;00m, [94m3[39;49;00m))[90m[39;49;00m
        log_sum_exp = logsumexp([90m[39;49;00m
>           comp_logp.eval() + np.log(w), axis=mixture_axis, keepdims=[94mTrue[39;49;00m[90m[39;49;00m
            ^^^^^^^^^^^^^^^^[90m[39;49;00m
        ).sum()[90m[39;49;00m

[1m[31mtests/distributions/test_mixture.py[0m:1058:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/graph/basic.py[0m:668: in eval
    [0m[94mreturn[39;49;00m fn(*args)[90m[39;49;00m
           ^^^^^^^^^[90m[39;49;00m
[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/compile/function/types.py[0m:1048: in __call__
    [0mraise_with_op([90m[39;49;00m
[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/link/utils.py[0m:526: in raise_with_op
    [0m[94mraise[39;49;00m exc_value.with_traceback(exc_trace)[90m[39;49;00m
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <pytensor.compile.function.types.Function object at 0x7f0b9a63d6d0>
output_subset = None, args = (), kwargs = {}, trust_input = False
vm = <pytensor.link.c.cvm.CVM object at 0x7f0ba148d910>, profile = None

    [0m[94mdef[39;49;00m[90m [39;49;00m[92m__call__[39;49;00m([96mself[39;49;00m, *args, output_subset=[94mNone[39;49;00m, **kwargs):[90m[39;49;00m
    [90m    [39;49;00m[33m"""[39;49;00m
    [33m    Evaluates value of a function on given arguments.[39;49;00m
    [33m[39;49;00m
    [33m    Parameters[39;49;00m
    [33m    ----------[39;49;00m
    [33m    args : list[39;49;00m
    [33m        List of inputs to the function. All inputs are required, even when[39;49;00m
    [33m        some of them are not necessary to calculate requested subset of[39;49;00m
    [33m        outputs.[39;49;00m
    [33m[39;49;00m
    [33m    kwargs : dict[39;49;00m
    [33m        The function inputs can be passed as keyword argument. For this, use[39;49;00m
    [33m        the name of the input or the input instance as the key.[39;49;00m
    [33m[39;49;00m
    [33m        Keyword argument ``output_subset`` is a list of either indices of the[39;49;00m
    [33m        function's outputs or the keys belonging to the `output_keys` dict[39;49;00m
    [33m        and represent outputs that are requested to be calculated. Regardless[39;49;00m
    [33m        of the presence of ``output_subset``, the updates are always calculated[39;49;00m
    [33m        and processed. To disable the updates, you should use the ``copy``[39;49;00m
    [33m        method with ``delete_updates=True``.[39;49;00m
    [33m[39;49;00m
    [33m    Returns[39;49;00m
    [33m    -------[39;49;00m
    [33m    list[39;49;00m
    [33m        List of outputs on indices/keys from ``output_subset`` or all of them,[39;49;00m
    [33m        if ``output_subset`` is not passed.[39;49;00m
    [33m    """[39;49;00m[90m[39;49;00m
        trust_input = [96mself[39;49;00m.trust_input[90m[39;49;00m
        input_storage = [96mself[39;49;00m.input_storage[90m[39;49;00m
        vm = [96mself[39;49;00m.vm[90m[39;49;00m
        profile = [96mself[39;49;00m.profile[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0 = time.perf_counter()[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m output_subset [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
            warnings.warn([33m"[39;49;00m[33moutput_subset is deprecated.[39;49;00m[33m"[39;49;00m, [96mFutureWarning[39;49;00m)[90m[39;49;00m
            [94mif[39;49;00m [96mself[39;49;00m.output_keys [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                output_subset = [[96mself[39;49;00m.output_keys.index(key) [94mfor[39;49;00m key [95min[39;49;00m output_subset][90m[39;49;00m
    [90m[39;49;00m
        [90m# Reinitialize each container's 'provided' counter[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m trust_input:[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
        [94melse[39;49;00m:[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                arg_container.provided = [94m0[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
            [94mif[39;49;00m [96mlen[39;49;00m(args) + [96mlen[39;49;00m(kwargs) > [96mlen[39;49;00m(input_storage):[90m[39;49;00m
                [94mraise[39;49;00m [96mTypeError[39;49;00m([33m"[39;49;00m[33mToo many parameter passed to pytensor function[39;49;00m[33m"[39;49;00m)[90m[39;49;00m
    [90m[39;49;00m
            [90m# Set positional arguments[39;49;00m[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                [90m# See discussion about None as input[39;49;00m[90m[39;49;00m
                [90m# https://groups.google.com/group/theano-dev/browse_thread/thread/920a5e904e8a8525/4f1b311a28fc27e5[39;49;00m[90m[39;49;00m
                [94mif[39;49;00m arg [95mis[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                    arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
                [94melse[39;49;00m:[90m[39;49;00m
                    [94mtry[39;49;00m:[90m[39;49;00m
                        arg_container.storage[[94m0[39;49;00m] = arg_container.type.filter([90m[39;49;00m
                            arg,[90m[39;49;00m
                            strict=arg_container.strict,[90m[39;49;00m
                            allow_downcast=arg_container.allow_downcast,[90m[39;49;00m
                        )[90m[39;49;00m
    [90m[39;49;00m
                    [94mexcept[39;49;00m [96mException[39;49;00m [94mas[39;49;00m e:[90m[39;49;00m
                        i = input_storage.index(arg_container)[90m[39;49;00m
                        function_name = [33m"[39;49;00m[33mpytensor function[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        argument_name = [33m"[39;49;00m[33margument[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mself[39;49;00m.name:[90m[39;49;00m
                            function_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + [96mself[39;49;00m.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mhasattr[39;49;00m(arg, [33m"[39;49;00m[33mname[39;49;00m[33m"[39;49;00m) [95mand[39;49;00m arg.name:[90m[39;49;00m
                            argument_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + arg.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        where = get_variable_trace_string([96mself[39;49;00m.maker.inputs[i].variable)[90m[39;49;00m
                        [94mif[39;49;00m [96mlen[39;49;00m(e.args) == [94m1[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + e.args[[94m0[39;49;00m],[90m[39;49;00m
                            )[90m[39;49;00m
                        [94melse[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                            ) + e.args[90m[39;49;00m
                        [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                        [94mraise[39;49;00m[90m[39;49;00m
                arg_container.provided += [94m1[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
        [90m# Set keyword arguments[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m kwargs:  [90m# for speed, skip the items for empty kwargs[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m k, arg [95min[39;49;00m kwargs.items():[90m[39;49;00m
                [96mself[39;49;00m[k] = arg[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m [95mnot[39;49;00m trust_input:[90m[39;49;00m
            [90m# Collect aliased inputs among the storage space[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m potential_group [95min[39;49;00m [96mself[39;49;00m._potential_aliased_input_groups:[90m[39;49;00m
                args_share_memory: [96mlist[39;49;00m[[96mlist[39;49;00m[[96mint[39;49;00m]] = [][90m[39;49;00m
                [94mfor[39;49;00m i [95min[39;49;00m potential_group:[90m[39;49;00m
                    i_type = [96mself[39;49;00m.maker.inputs[i].variable.type[90m[39;49;00m
                    i_val = input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
    [90m[39;49;00m
                    [90m# Check if value is aliased with any of the values in one of the groups[39;49;00m[90m[39;49;00m
                    [94mfor[39;49;00m j_group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                        [94mif[39;49;00m [96many[39;49;00m([90m[39;49;00m
                            i_type.may_share_memory(input_storage[j].storage[[94m0[39;49;00m], i_val)[90m[39;49;00m
                            [94mfor[39;49;00m j [95min[39;49;00m j_group[90m[39;49;00m
                        ):[90m[39;49;00m
                            j_group.append(i)[90m[39;49;00m
                            [94mbreak[39;49;00m[90m[39;49;00m
                    [94melse[39;49;00m:  [90m# no break[39;49;00m[90m[39;49;00m
                        [90m# Create a new group[39;49;00m[90m[39;49;00m
                        args_share_memory.append([i])[90m[39;49;00m
    [90m[39;49;00m
                [90m# Check for groups of more than one argument that share memory[39;49;00m[90m[39;49;00m
                [94mfor[39;49;00m group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                    [94mif[39;49;00m [96mlen[39;49;00m(group) > [94m1[39;49;00m:[90m[39;49;00m
                        [90m# copy all but the first[39;49;00m[90m[39;49;00m
                        [94mfor[39;49;00m i [95min[39;49;00m group[[94m1[39;49;00m:]:[90m[39;49;00m
                            input_storage[i].storage[[94m0[39;49;00m] = copy.copy([90m[39;49;00m
                                input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
                            )[90m[39;49;00m
    [90m[39;49;00m
            [90m# Check if inputs are missing, or if inputs were set more than once, or[39;49;00m[90m[39;49;00m
            [90m# if we tried to provide inputs that are supposed to be implicit.[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                [94mif[39;49;00m arg_container.required [95mand[39;49;00m [95mnot[39;49;00m arg_container.provided:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMissing required input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.provided > [94m1[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMultiple values for input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.implicit [95mand[39;49;00m arg_container.provided > [94m0[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mTried to provide value for implicit input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
    [90m[39;49;00m
        [90m# Do the actual work[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0_fn = time.perf_counter()[90m[39;49;00m
        [94mtry[39;49;00m:[90m[39;49;00m
>           outputs = vm() [94mif[39;49;00m output_subset [95mis[39;49;00m [94mNone[39;49;00m [94melse[39;49;00m vm(output_subset=output_subset)[90m[39;49;00m
                      ^^^^[90m[39;49;00m
[1m[31mE           pymc.logprob.utils.ParameterValueError: [0m
[1m[31mE           Apply node that caused the error: Check{}([[-30495.1 ... 11099217]], False)[0m
[1m[31mE           Toposort index: 0[0m
[1m[31mE           Inputs types: [TensorType(float64, shape=(20, 1)), ScalarType(bool)][0m
[1m[31mE           Inputs shapes: [(20, 1), ()][0m
[1m[31mE           Inputs strides: [(8, 8), ()][0m
[1m[31mE           Inputs values: ['not shown', np.False_][0m
[1m[31mE           Inputs type_num: [12, 0][0m
[1m[31mE           Outputs clients: [[DeepCopyOp(Check{}.0)]][0m
[1m[31mE           [0m
[1m[31mE           Backtrace when the node is created (use PyTensor flag traceback__limit=N to make it longer):[0m
[1m[31mE             File "/app/pymc/logprob/basic.py", line 193, in logp[0m
[1m[31mE               return _logprob_helper(rv, value, **kwargs)[0m
[1m[31mE             File "/app/pymc/logprob/abstract.py", line 70, in _logprob_helper[0m
[1m[31mE               logprob = _logprob(rv.owner.op, values, *rv.owner.inputs, **kwargs)[0m
[1m[31mE             File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/functools.py", line 982, in wrapper[0m
[1m[31mE               return dispatch(args[0].__class__)(*args, **kw)[0m
[1m[31mE             File "/app/pymc/distributions/distribution.py", line 140, in logp[0m
[1m[31mE               return class_logp(value, *dist_params)[0m
[1m[31mE             File "/app/tests/distributions/test_dist_math.py", line 96, in logp[0m
[1m[31mE               return check_parameters([0m
[1m[31mE             File "/app/pymc/distributions/dist_math.py", line 72, in check_parameters[0m
[1m[31mE               return CheckParameterValue(msg, can_be_replaced_by_ninf)(expr, all_true_scalar)[0m
[1m[31mE             File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/graph/op.py", line 294, in __call__[0m
[1m[31mE               node = self.make_node(*inputs, **kwargs)[0m
[1m[31mE             File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/raise_op.py", line 81, in make_node[0m
[1m[31mE               [value.type()],[0m
[1m[31mE           [0m
[1m[31mE           Debug print of the apply node: [0m
[1m[31mE           Check{} [id A] <Matrix(float64, shape=(20, 1))>[0m
[1m[31mE            ├─ [[-30495.1 ... 11099217]] [id B] <Matrix(float64, shape=(20, 1))>[0m
[1m[31mE            └─ False [id C] <bool>[0m
[1m[31mE           [0m
[1m[31mE           Storage map footprint:[0m
[1m[31mE            - [[-30495.1 ... 11099217]], Shape: (20, 1), ElemSize: 8 Byte(s), TotalSize: 160 Byte(s)[0m
[1m[31mE            - False, Shape: (), ElemSize: 1 Byte(s), TotalSize: 1.0 Byte(s)[0m
[1m[31mE            TotalSize: 161.0 Byte(s) 0.000 GB[0m
[1m[31mE            TotalSize inputs: 161.0 Byte(s) 0.000 GB[0m

[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/compile/function/types.py[0m:1038: ParameterValueError
----------------------------- Captured stderr call -----------------------------
Sampling: [mixture]
------------------------------ Captured log call -------------------------------
[32mINFO    [0m pymc.sampling.forward:forward.py:477 Sampling: [mixture]
[31m[1m_____________________ TestMatchesScipy.test_multinomial[2] _____________________[0m

self = <tests.distributions.test_multivariate.TestMatchesScipy object at 0x7f0bb35c6ee0>
n = 2

    [0m[37m@pytest[39;49;00m.mark.parametrize([33m"[39;49;00m[33mn[39;49;00m[33m"[39;49;00m, [[94m2[39;49;00m, [94m3[39;49;00m])[90m[39;49;00m
    [94mdef[39;49;00m[90m [39;49;00m[92mtest_multinomial[39;49;00m([96mself[39;49;00m, n):[90m[39;49;00m
>       check_logp([90m[39;49;00m
            pm.Multinomial,[90m[39;49;00m
            Vector(Nat, n),[90m[39;49;00m
            {[33m"[39;49;00m[33mp[39;49;00m[33m"[39;49;00m: Simplex(n), [33m"[39;49;00m[33mn[39;49;00m[33m"[39;49;00m: Nat},[90m[39;49;00m
            [94mlambda[39;49;00m value, n, p: st.multinomial.logpmf(value, n, p),[90m[39;49;00m
        )[90m[39;49;00m

[1m[31mtests/distributions/test_multivariate.py[0m:619:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

pymc_dist = <class 'pymc.distributions.multivariate.Multinomial'>
domain = <pymc.testing.ProductDomain object at 0x7f0b96a40d00>
paramdomains = {'n': <pymc.testing.Domain object at 0x7f0bb5703cb0>, 'p': <pymc.testing.Domain object at 0x7f0b96a42f20>}
scipy_logp = <function TestMatchesScipy.test_multinomial.<locals>.<lambda> at 0x7f0b98a1c880>
decimal = 6, n_samples = 100, extra_args = None, scipy_args = {}
skip_paramdomain_outside_edge_test = False

    [0m[94mdef[39;49;00m[90m [39;49;00m[92mcheck_logp[39;49;00m([90m[39;49;00m
        pymc_dist: Distribution,[90m[39;49;00m
        domain: Domain,[90m[39;49;00m
        paramdomains: [96mdict[39;49;00m[[96mstr[39;49;00m, Domain],[90m[39;49;00m
        scipy_logp: Callable,[90m[39;49;00m
        decimal: [96mint[39;49;00m | [94mNone[39;49;00m = [94mNone[39;49;00m,[90m[39;49;00m
        n_samples: [96mint[39;49;00m = [94m100[39;49;00m,[90m[39;49;00m
        extra_args: [96mdict[39;49;00m[[96mstr[39;49;00m, Any] | [94mNone[39;49;00m = [94mNone[39;49;00m,[90m[39;49;00m
        scipy_args: [96mdict[39;49;00m[[96mstr[39;49;00m, Any] | [94mNone[39;49;00m = [94mNone[39;49;00m,[90m[39;49;00m
        skip_paramdomain_outside_edge_test: [96mbool[39;49;00m = [94mFalse[39;49;00m,[90m[39;49;00m
    ) -> [94mNone[39;49;00m:[90m[39;49;00m
    [90m    [39;49;00m[33m"""[39;49;00m
    [33m    Test PyMC logp and equivalent scipy logpmf/logpdf methods give similar results for valid values and parameters inside the supported edges.[39;49;00m
    [33m[39;49;00m
    [33m    Edges are excluded by default, but can be artificially included by[39;49;00m
    [33m    creating a domain with repeated values (e.g., `Domain([0, 0, .5, 1, 1]`)[39;49;00m
    [33m[39;49;00m
    [33m    Parameters[39;49;00m
    [33m    ----------[39;49;00m
    [33m    pymc_dist: PyMC distribution[39;49;00m
    [33m    domain : Domain[39;49;00m
    [33m        Supported domain of distribution values[39;49;00m
    [33m    paramdomains : Dictionary of Parameter : Domain pairs[39;49;00m
    [33m        Supported domains of distribution parameters[39;49;00m
    [33m    scipy_logp : Scipy logpmf/logpdf method[39;49;00m
    [33m        Scipy logp method of equivalent pymc_dist distribution[39;49;00m
    [33m    decimal : Int[39;49;00m
    [33m        Level of precision with which pymc_dist and scipy logp are compared.[39;49;00m
    [33m        Defaults to 6 for float64 and 3 for float32[39;49;00m
    [33m    n_samples : Int[39;49;00m
    [33m        Upper limit on the number of valid domain and value combinations that[39;49;00m
    [33m        are compared between pymc and scipy methods. If n_samples is below the[39;49;00m
    [33m        total number of combinations, a random subset is evaluated. Setting[39;49;00m
    [33m        n_samples = -1, will return all possible combinations. Defaults to 100[39;49;00m
    [33m    extra_args : Dictionary with extra arguments needed to build pymc model[39;49;00m
    [33m        Dictionary is passed to helper function `build_model` from which[39;49;00m
    [33m        the pymc distribution logp is calculated[39;49;00m
    [33m    scipy_args : Dictionary with extra arguments needed to call scipy logp method[39;49;00m
    [33m        Usually the same as extra_args[39;49;00m
    [33m    """[39;49;00m[90m[39;49;00m
        [94mimport[39;49;00m[90m [39;49;00m[04m[96mpytest[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m decimal [95mis[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
            decimal = select_by_precision(float64=[94m6[39;49;00m, float32=[94m3[39;49;00m)[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m scipy_args [95mis[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
            scipy_args = {}[90m[39;49;00m
    [90m[39;49;00m
        [94mdef[39;49;00m[90m [39;49;00m[92mscipy_logp_with_scipy_args[39;49;00m(**args):[90m[39;49;00m
            args.update(scipy_args)[90m[39;49;00m
            [94mreturn[39;49;00m scipy_logp(**args)[90m[39;49;00m
    [90m[39;49;00m
        dist = create_dist_from_paramdomains(pymc_dist, paramdomains, extra_args)[90m[39;49;00m
        value = dist.type()[90m[39;49;00m
        value.name = [33m"[39;49;00m[33mvalue[39;49;00m[33m"[39;49;00m[90m[39;49;00m
        pymc_dist_logp = logp(dist, value).sum()[90m[39;49;00m
        pymc_logp = pytensor.function([96mlist[39;49;00m(inputvars(pymc_dist_logp)), pymc_dist_logp)[90m[39;49;00m
    [90m[39;49;00m
        [90m# Test supported value and parameters domain matches Scipy[39;49;00m[90m[39;49;00m
        domains = paramdomains.copy()[90m[39;49;00m
        domains[[33m"[39;49;00m[33mvalue[39;49;00m[33m"[39;49;00m] = domain[90m[39;49;00m
        [94mfor[39;49;00m point [95min[39;49;00m product(domains, n_samples=n_samples):[90m[39;49;00m
            point = [96mdict[39;49;00m(point)[90m[39;49;00m
>           npt.assert_almost_equal([90m[39;49;00m
                pymc_logp(**point),[90m[39;49;00m
                scipy_logp_with_scipy_args(**point),[90m[39;49;00m
                decimal=decimal,[90m[39;49;00m
                err_msg=[96mstr[39;49;00m(point),[90m[39;49;00m
            )[90m[39;49;00m
[1m[31mE           AssertionError: [0m
[1m[31mE           Arrays are not almost equal to 6 decimals[0m
[1m[31mE           {'p': array([0.5, 0.5]), 'n': array(1), 'value': (array(3), array(2))}[0m
[1m[31mE           -inf location mismatch:[0m
[1m[31mE            ACTUAL: array(-5.950643)[0m
[1m[31mE            DESIRED: array(-inf)[0m

[1m[31mpymc/testing.py[0m:372: AssertionError
[31m[1m_____________________ TestMatchesScipy.test_multinomial[3] _____________________[0m

self = <tests.distributions.test_multivariate.TestMatchesScipy object at 0x7f0bb35c6f30>
n = 3

    [0m[37m@pytest[39;49;00m.mark.parametrize([33m"[39;49;00m[33mn[39;49;00m[33m"[39;49;00m, [[94m2[39;49;00m, [94m3[39;49;00m])[90m[39;49;00m
    [94mdef[39;49;00m[90m [39;49;00m[92mtest_multinomial[39;49;00m([96mself[39;49;00m, n):[90m[39;49;00m
>       check_logp([90m[39;49;00m
            pm.Multinomial,[90m[39;49;00m
            Vector(Nat, n),[90m[39;49;00m
            {[33m"[39;49;00m[33mp[39;49;00m[33m"[39;49;00m: Simplex(n), [33m"[39;49;00m[33mn[39;49;00m[33m"[39;49;00m: Nat},[90m[39;49;00m
            [94mlambda[39;49;00m value, n, p: st.multinomial.logpmf(value, n, p),[90m[39;49;00m
        )[90m[39;49;00m

[1m[31mtests/distributions/test_multivariate.py[0m:619:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

pymc_dist = <class 'pymc.distributions.multivariate.Multinomial'>
domain = <pymc.testing.ProductDomain object at 0x7f0b96e37e00>
paramdomains = {'n': <pymc.testing.Domain object at 0x7f0bb5703cb0>, 'p': <pymc.testing.Domain object at 0x7f0b96e35080>}
scipy_logp = <function TestMatchesScipy.test_multinomial.<locals>.<lambda> at 0x7f0b98a421f0>
decimal = 6, n_samples = 100, extra_args = None, scipy_args = {}
skip_paramdomain_outside_edge_test = False

    [0m[94mdef[39;49;00m[90m [39;49;00m[92mcheck_logp[39;49;00m([90m[39;49;00m
        pymc_dist: Distribution,[90m[39;49;00m
        domain: Domain,[90m[39;49;00m
        paramdomains: [96mdict[39;49;00m[[96mstr[39;49;00m, Domain],[90m[39;49;00m
        scipy_logp: Callable,[90m[39;49;00m
        decimal: [96mint[39;49;00m | [94mNone[39;49;00m = [94mNone[39;49;00m,[90m[39;49;00m
        n_samples: [96mint[39;49;00m = [94m100[39;49;00m,[90m[39;49;00m
        extra_args: [96mdict[39;49;00m[[96mstr[39;49;00m, Any] | [94mNone[39;49;00m = [94mNone[39;49;00m,[90m[39;49;00m
        scipy_args: [96mdict[39;49;00m[[96mstr[39;49;00m, Any] | [94mNone[39;49;00m = [94mNone[39;49;00m,[90m[39;49;00m
        skip_paramdomain_outside_edge_test: [96mbool[39;49;00m = [94mFalse[39;49;00m,[90m[39;49;00m
    ) -> [94mNone[39;49;00m:[90m[39;49;00m
    [90m    [39;49;00m[33m"""[39;49;00m
    [33m    Test PyMC logp and equivalent scipy logpmf/logpdf methods give similar results for valid values and parameters inside the supported edges.[39;49;00m
    [33m[39;49;00m
    [33m    Edges are excluded by default, but can be artificially included by[39;49;00m
    [33m    creating a domain with repeated values (e.g., `Domain([0, 0, .5, 1, 1]`)[39;49;00m
    [33m[39;49;00m
    [33m    Parameters[39;49;00m
    [33m    ----------[39;49;00m
    [33m    pymc_dist: PyMC distribution[39;49;00m
    [33m    domain : Domain[39;49;00m
    [33m        Supported domain of distribution values[39;49;00m
    [33m    paramdomains : Dictionary of Parameter : Domain pairs[39;49;00m
    [33m        Supported domains of distribution parameters[39;49;00m
    [33m    scipy_logp : Scipy logpmf/logpdf method[39;49;00m
    [33m        Scipy logp method of equivalent pymc_dist distribution[39;49;00m
    [33m    decimal : Int[39;49;00m
    [33m        Level of precision with which pymc_dist and scipy logp are compared.[39;49;00m
    [33m        Defaults to 6 for float64 and 3 for float32[39;49;00m
    [33m    n_samples : Int[39;49;00m
    [33m        Upper limit on the number of valid domain and value combinations that[39;49;00m
    [33m        are compared between pymc and scipy methods. If n_samples is below the[39;49;00m
    [33m        total number of combinations, a random subset is evaluated. Setting[39;49;00m
    [33m        n_samples = -1, will return all possible combinations. Defaults to 100[39;49;00m
    [33m    extra_args : Dictionary with extra arguments needed to build pymc model[39;49;00m
    [33m        Dictionary is passed to helper function `build_model` from which[39;49;00m
    [33m        the pymc distribution logp is calculated[39;49;00m
    [33m    scipy_args : Dictionary with extra arguments needed to call scipy logp method[39;49;00m
    [33m        Usually the same as extra_args[39;49;00m
    [33m    """[39;49;00m[90m[39;49;00m
        [94mimport[39;49;00m[90m [39;49;00m[04m[96mpytest[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m decimal [95mis[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
            decimal = select_by_precision(float64=[94m6[39;49;00m, float32=[94m3[39;49;00m)[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m scipy_args [95mis[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
            scipy_args = {}[90m[39;49;00m
    [90m[39;49;00m
        [94mdef[39;49;00m[90m [39;49;00m[92mscipy_logp_with_scipy_args[39;49;00m(**args):[90m[39;49;00m
            args.update(scipy_args)[90m[39;49;00m
            [94mreturn[39;49;00m scipy_logp(**args)[90m[39;49;00m
    [90m[39;49;00m
        dist = create_dist_from_paramdomains(pymc_dist, paramdomains, extra_args)[90m[39;49;00m
        value = dist.type()[90m[39;49;00m
        value.name = [33m"[39;49;00m[33mvalue[39;49;00m[33m"[39;49;00m[90m[39;49;00m
        pymc_dist_logp = logp(dist, value).sum()[90m[39;49;00m
        pymc_logp = pytensor.function([96mlist[39;49;00m(inputvars(pymc_dist_logp)), pymc_dist_logp)[90m[39;49;00m
    [90m[39;49;00m
        [90m# Test supported value and parameters domain matches Scipy[39;49;00m[90m[39;49;00m
        domains = paramdomains.copy()[90m[39;49;00m
        domains[[33m"[39;49;00m[33mvalue[39;49;00m[33m"[39;49;00m] = domain[90m[39;49;00m
        [94mfor[39;49;00m point [95min[39;49;00m product(domains, n_samples=n_samples):[90m[39;49;00m
            point = [96mdict[39;49;00m(point)[90m[39;49;00m
>           npt.assert_almost_equal([90m[39;49;00m
                pymc_logp(**point),[90m[39;49;00m
                scipy_logp_with_scipy_args(**point),[90m[39;49;00m
                decimal=decimal,[90m[39;49;00m
                err_msg=[96mstr[39;49;00m(point),[90m[39;49;00m
            )[90m[39;49;00m
[1m[31mE           AssertionError: [0m
[1m[31mE           Arrays are not almost equal to 6 decimals[0m
[1m[31mE           {'p': array([0.5  , 0.375, 0.125]), 'n': array(3), 'value': (array(2), array(3), array(1))}[0m
[1m[31mE           -inf location mismatch:[0m
[1m[31mE            ACTUAL: array(-7.101371)[0m
[1m[31mE            DESIRED: array(-inf)[0m

[1m[31mpymc/testing.py[0m:372: AssertionError
[31m[1m_______________ TestMatchesScipy.test_multinomial_invalid_value ________________[0m

self = <pytensor.compile.function.types.Function object at 0x7f0ba0704dd0>
output_subset = None, args = (), kwargs = {}, trust_input = False
vm = <pytensor.link.c.cvm.CVM object at 0x7f0ba148c470>, profile = None

    [0m[94mdef[39;49;00m[90m [39;49;00m[92m__call__[39;49;00m([96mself[39;49;00m, *args, output_subset=[94mNone[39;49;00m, **kwargs):[90m[39;49;00m
    [90m    [39;49;00m[33m"""[39;49;00m
    [33m    Evaluates value of a function on given arguments.[39;49;00m
    [33m[39;49;00m
    [33m    Parameters[39;49;00m
    [33m    ----------[39;49;00m
    [33m    args : list[39;49;00m
    [33m        List of inputs to the function. All inputs are required, even when[39;49;00m
    [33m        some of them are not necessary to calculate requested subset of[39;49;00m
    [33m        outputs.[39;49;00m
    [33m[39;49;00m
    [33m    kwargs : dict[39;49;00m
    [33m        The function inputs can be passed as keyword argument. For this, use[39;49;00m
    [33m        the name of the input or the input instance as the key.[39;49;00m
    [33m[39;49;00m
    [33m        Keyword argument ``output_subset`` is a list of either indices of the[39;49;00m
    [33m        function's outputs or the keys belonging to the `output_keys` dict[39;49;00m
    [33m        and represent outputs that are requested to be calculated. Regardless[39;49;00m
    [33m        of the presence of ``output_subset``, the updates are always calculated[39;49;00m
    [33m        and processed. To disable the updates, you should use the ``copy``[39;49;00m
    [33m        method with ``delete_updates=True``.[39;49;00m
    [33m[39;49;00m
    [33m    Returns[39;49;00m
    [33m    -------[39;49;00m
    [33m    list[39;49;00m
    [33m        List of outputs on indices/keys from ``output_subset`` or all of them,[39;49;00m
    [33m        if ``output_subset`` is not passed.[39;49;00m
    [33m    """[39;49;00m[90m[39;49;00m
        trust_input = [96mself[39;49;00m.trust_input[90m[39;49;00m
        input_storage = [96mself[39;49;00m.input_storage[90m[39;49;00m
        vm = [96mself[39;49;00m.vm[90m[39;49;00m
        profile = [96mself[39;49;00m.profile[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0 = time.perf_counter()[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m output_subset [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
            warnings.warn([33m"[39;49;00m[33moutput_subset is deprecated.[39;49;00m[33m"[39;49;00m, [96mFutureWarning[39;49;00m)[90m[39;49;00m
            [94mif[39;49;00m [96mself[39;49;00m.output_keys [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                output_subset = [[96mself[39;49;00m.output_keys.index(key) [94mfor[39;49;00m key [95min[39;49;00m output_subset][90m[39;49;00m
    [90m[39;49;00m
        [90m# Reinitialize each container's 'provided' counter[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m trust_input:[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
        [94melse[39;49;00m:[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                arg_container.provided = [94m0[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
            [94mif[39;49;00m [96mlen[39;49;00m(args) + [96mlen[39;49;00m(kwargs) > [96mlen[39;49;00m(input_storage):[90m[39;49;00m
                [94mraise[39;49;00m [96mTypeError[39;49;00m([33m"[39;49;00m[33mToo many parameter passed to pytensor function[39;49;00m[33m"[39;49;00m)[90m[39;49;00m
    [90m[39;49;00m
            [90m# Set positional arguments[39;49;00m[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                [90m# See discussion about None as input[39;49;00m[90m[39;49;00m
                [90m# https://groups.google.com/group/theano-dev/browse_thread/thread/920a5e904e8a8525/4f1b311a28fc27e5[39;49;00m[90m[39;49;00m
                [94mif[39;49;00m arg [95mis[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                    arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
                [94melse[39;49;00m:[90m[39;49;00m
                    [94mtry[39;49;00m:[90m[39;49;00m
                        arg_container.storage[[94m0[39;49;00m] = arg_container.type.filter([90m[39;49;00m
                            arg,[90m[39;49;00m
                            strict=arg_container.strict,[90m[39;49;00m
                            allow_downcast=arg_container.allow_downcast,[90m[39;49;00m
                        )[90m[39;49;00m
    [90m[39;49;00m
                    [94mexcept[39;49;00m [96mException[39;49;00m [94mas[39;49;00m e:[90m[39;49;00m
                        i = input_storage.index(arg_container)[90m[39;49;00m
                        function_name = [33m"[39;49;00m[33mpytensor function[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        argument_name = [33m"[39;49;00m[33margument[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mself[39;49;00m.name:[90m[39;49;00m
                            function_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + [96mself[39;49;00m.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mhasattr[39;49;00m(arg, [33m"[39;49;00m[33mname[39;49;00m[33m"[39;49;00m) [95mand[39;49;00m arg.name:[90m[39;49;00m
                            argument_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + arg.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        where = get_variable_trace_string([96mself[39;49;00m.maker.inputs[i].variable)[90m[39;49;00m
                        [94mif[39;49;00m [96mlen[39;49;00m(e.args) == [94m1[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + e.args[[94m0[39;49;00m],[90m[39;49;00m
                            )[90m[39;49;00m
                        [94melse[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                            ) + e.args[90m[39;49;00m
                        [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                        [94mraise[39;49;00m[90m[39;49;00m
                arg_container.provided += [94m1[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
        [90m# Set keyword arguments[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m kwargs:  [90m# for speed, skip the items for empty kwargs[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m k, arg [95min[39;49;00m kwargs.items():[90m[39;49;00m
                [96mself[39;49;00m[k] = arg[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m [95mnot[39;49;00m trust_input:[90m[39;49;00m
            [90m# Collect aliased inputs among the storage space[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m potential_group [95min[39;49;00m [96mself[39;49;00m._potential_aliased_input_groups:[90m[39;49;00m
                args_share_memory: [96mlist[39;49;00m[[96mlist[39;49;00m[[96mint[39;49;00m]] = [][90m[39;49;00m
                [94mfor[39;49;00m i [95min[39;49;00m potential_group:[90m[39;49;00m
                    i_type = [96mself[39;49;00m.maker.inputs[i].variable.type[90m[39;49;00m
                    i_val = input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
    [90m[39;49;00m
                    [90m# Check if value is aliased with any of the values in one of the groups[39;49;00m[90m[39;49;00m
                    [94mfor[39;49;00m j_group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                        [94mif[39;49;00m [96many[39;49;00m([90m[39;49;00m
                            i_type.may_share_memory(input_storage[j].storage[[94m0[39;49;00m], i_val)[90m[39;49;00m
                            [94mfor[39;49;00m j [95min[39;49;00m j_group[90m[39;49;00m
                        ):[90m[39;49;00m
                            j_group.append(i)[90m[39;49;00m
                            [94mbreak[39;49;00m[90m[39;49;00m
                    [94melse[39;49;00m:  [90m# no break[39;49;00m[90m[39;49;00m
                        [90m# Create a new group[39;49;00m[90m[39;49;00m
                        args_share_memory.append([i])[90m[39;49;00m
    [90m[39;49;00m
                [90m# Check for groups of more than one argument that share memory[39;49;00m[90m[39;49;00m
                [94mfor[39;49;00m group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                    [94mif[39;49;00m [96mlen[39;49;00m(group) > [94m1[39;49;00m:[90m[39;49;00m
                        [90m# copy all but the first[39;49;00m[90m[39;49;00m
                        [94mfor[39;49;00m i [95min[39;49;00m group[[94m1[39;49;00m:]:[90m[39;49;00m
                            input_storage[i].storage[[94m0[39;49;00m] = copy.copy([90m[39;49;00m
                                input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
                            )[90m[39;49;00m
    [90m[39;49;00m
            [90m# Check if inputs are missing, or if inputs were set more than once, or[39;49;00m[90m[39;49;00m
            [90m# if we tried to provide inputs that are supposed to be implicit.[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                [94mif[39;49;00m arg_container.required [95mand[39;49;00m [95mnot[39;49;00m arg_container.provided:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMissing required input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.provided > [94m1[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMultiple values for input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.implicit [95mand[39;49;00m arg_container.provided > [94m0[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mTried to provide value for implicit input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
    [90m[39;49;00m
        [90m# Do the actual work[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0_fn = time.perf_counter()[90m[39;49;00m
        [94mtry[39;49;00m:[90m[39;49;00m
>           outputs = vm() [94mif[39;49;00m output_subset [95mis[39;49;00m [94mNone[39;49;00m [94melse[39;49;00m vm(output_subset=output_subset)[90m[39;49;00m
                      ^^^^[90m[39;49;00m
[1m[31mE           pymc.logprob.utils.ParameterValueError[0m

[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/compile/function/types.py[0m:1038: ParameterValueError

[33mDuring handling of the above exception, another exception occurred:[0m

self = <tests.distributions.test_multivariate.TestMatchesScipy object at 0x7f0bb35c6f80>

    [0m[94mdef[39;49;00m[90m [39;49;00m[92mtest_multinomial_invalid_value[39;49;00m([96mself[39;49;00m):[90m[39;49;00m
        [90m# Test passing non-scalar invalid parameters/values to an otherwise valid Multinomial,[39;49;00m[90m[39;49;00m
        [90m# evaluates to -inf[39;49;00m[90m[39;49;00m
        value = np.array([[[94m1[39;49;00m, [94m2[39;49;00m, [94m2[39;49;00m], [[94m3[39;49;00m, -[94m1[39;49;00m, [94m0[39;49;00m]])[90m[39;49;00m
        valid_dist = pm.Multinomial.dist(n=[94m5[39;49;00m, p=np.ones([94m3[39;49;00m) / [94m3[39;49;00m)[90m[39;49;00m
>       [94massert[39;49;00m np.all(np.isfinite(pm.logp(valid_dist, value).eval()) == np.array([[94mTrue[39;49;00m, [94mFalse[39;49;00m]))[90m[39;49;00m
                                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m

[1m[31mtests/distributions/test_multivariate.py[0m:631:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/graph/basic.py[0m:668: in eval
    [0m[94mreturn[39;49;00m fn(*args)[90m[39;49;00m
           ^^^^^^^^^[90m[39;49;00m
[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/compile/function/types.py[0m:1048: in __call__
    [0mraise_with_op([90m[39;49;00m
[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/link/utils.py[0m:526: in raise_with_op
    [0m[94mraise[39;49;00m exc_value.with_traceback(exc_trace)[90m[39;49;00m
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <pytensor.compile.function.types.Function object at 0x7f0ba0704dd0>
output_subset = None, args = (), kwargs = {}, trust_input = False
vm = <pytensor.link.c.cvm.CVM object at 0x7f0ba148c470>, profile = None

    [0m[94mdef[39;49;00m[90m [39;49;00m[92m__call__[39;49;00m([96mself[39;49;00m, *args, output_subset=[94mNone[39;49;00m, **kwargs):[90m[39;49;00m
    [90m    [39;49;00m[33m"""[39;49;00m
    [33m    Evaluates value of a function on given arguments.[39;49;00m
    [33m[39;49;00m
    [33m    Parameters[39;49;00m
    [33m    ----------[39;49;00m
    [33m    args : list[39;49;00m
    [33m        List of inputs to the function. All inputs are required, even when[39;49;00m
    [33m        some of them are not necessary to calculate requested subset of[39;49;00m
    [33m        outputs.[39;49;00m
    [33m[39;49;00m
    [33m    kwargs : dict[39;49;00m
    [33m        The function inputs can be passed as keyword argument. For this, use[39;49;00m
    [33m        the name of the input or the input instance as the key.[39;49;00m
    [33m[39;49;00m
    [33m        Keyword argument ``output_subset`` is a list of either indices of the[39;49;00m
    [33m        function's outputs or the keys belonging to the `output_keys` dict[39;49;00m
    [33m        and represent outputs that are requested to be calculated. Regardless[39;49;00m
    [33m        of the presence of ``output_subset``, the updates are always calculated[39;49;00m
    [33m        and processed. To disable the updates, you should use the ``copy``[39;49;00m
    [33m        method with ``delete_updates=True``.[39;49;00m
    [33m[39;49;00m
    [33m    Returns[39;49;00m
    [33m    -------[39;49;00m
    [33m    list[39;49;00m
    [33m        List of outputs on indices/keys from ``output_subset`` or all of them,[39;49;00m
    [33m        if ``output_subset`` is not passed.[39;49;00m
    [33m    """[39;49;00m[90m[39;49;00m
        trust_input = [96mself[39;49;00m.trust_input[90m[39;49;00m
        input_storage = [96mself[39;49;00m.input_storage[90m[39;49;00m
        vm = [96mself[39;49;00m.vm[90m[39;49;00m
        profile = [96mself[39;49;00m.profile[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0 = time.perf_counter()[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m output_subset [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
            warnings.warn([33m"[39;49;00m[33moutput_subset is deprecated.[39;49;00m[33m"[39;49;00m, [96mFutureWarning[39;49;00m)[90m[39;49;00m
            [94mif[39;49;00m [96mself[39;49;00m.output_keys [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                output_subset = [[96mself[39;49;00m.output_keys.index(key) [94mfor[39;49;00m key [95min[39;49;00m output_subset][90m[39;49;00m
    [90m[39;49;00m
        [90m# Reinitialize each container's 'provided' counter[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m trust_input:[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
        [94melse[39;49;00m:[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                arg_container.provided = [94m0[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
            [94mif[39;49;00m [96mlen[39;49;00m(args) + [96mlen[39;49;00m(kwargs) > [96mlen[39;49;00m(input_storage):[90m[39;49;00m
                [94mraise[39;49;00m [96mTypeError[39;49;00m([33m"[39;49;00m[33mToo many parameter passed to pytensor function[39;49;00m[33m"[39;49;00m)[90m[39;49;00m
    [90m[39;49;00m
            [90m# Set positional arguments[39;49;00m[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                [90m# See discussion about None as input[39;49;00m[90m[39;49;00m
                [90m# https://groups.google.com/group/theano-dev/browse_thread/thread/920a5e904e8a8525/4f1b311a28fc27e5[39;49;00m[90m[39;49;00m
                [94mif[39;49;00m arg [95mis[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                    arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
                [94melse[39;49;00m:[90m[39;49;00m
                    [94mtry[39;49;00m:[90m[39;49;00m
                        arg_container.storage[[94m0[39;49;00m] = arg_container.type.filter([90m[39;49;00m
                            arg,[90m[39;49;00m
                            strict=arg_container.strict,[90m[39;49;00m
                            allow_downcast=arg_container.allow_downcast,[90m[39;49;00m
                        )[90m[39;49;00m
    [90m[39;49;00m
                    [94mexcept[39;49;00m [96mException[39;49;00m [94mas[39;49;00m e:[90m[39;49;00m
                        i = input_storage.index(arg_container)[90m[39;49;00m
                        function_name = [33m"[39;49;00m[33mpytensor function[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        argument_name = [33m"[39;49;00m[33margument[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mself[39;49;00m.name:[90m[39;49;00m
                            function_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + [96mself[39;49;00m.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mhasattr[39;49;00m(arg, [33m"[39;49;00m[33mname[39;49;00m[33m"[39;49;00m) [95mand[39;49;00m arg.name:[90m[39;49;00m
                            argument_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + arg.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        where = get_variable_trace_string([96mself[39;49;00m.maker.inputs[i].variable)[90m[39;49;00m
                        [94mif[39;49;00m [96mlen[39;49;00m(e.args) == [94m1[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + e.args[[94m0[39;49;00m],[90m[39;49;00m
                            )[90m[39;49;00m
                        [94melse[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                            ) + e.args[90m[39;49;00m
                        [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                        [94mraise[39;49;00m[90m[39;49;00m
                arg_container.provided += [94m1[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
        [90m# Set keyword arguments[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m kwargs:  [90m# for speed, skip the items for empty kwargs[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m k, arg [95min[39;49;00m kwargs.items():[90m[39;49;00m
                [96mself[39;49;00m[k] = arg[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m [95mnot[39;49;00m trust_input:[90m[39;49;00m
            [90m# Collect aliased inputs among the storage space[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m potential_group [95min[39;49;00m [96mself[39;49;00m._potential_aliased_input_groups:[90m[39;49;00m
                args_share_memory: [96mlist[39;49;00m[[96mlist[39;49;00m[[96mint[39;49;00m]] = [][90m[39;49;00m
                [94mfor[39;49;00m i [95min[39;49;00m potential_group:[90m[39;49;00m
                    i_type = [96mself[39;49;00m.maker.inputs[i].variable.type[90m[39;49;00m
                    i_val = input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
    [90m[39;49;00m
                    [90m# Check if value is aliased with any of the values in one of the groups[39;49;00m[90m[39;49;00m
                    [94mfor[39;49;00m j_group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                        [94mif[39;49;00m [96many[39;49;00m([90m[39;49;00m
                            i_type.may_share_memory(input_storage[j].storage[[94m0[39;49;00m], i_val)[90m[39;49;00m
                            [94mfor[39;49;00m j [95min[39;49;00m j_group[90m[39;49;00m
                        ):[90m[39;49;00m
                            j_group.append(i)[90m[39;49;00m
                            [94mbreak[39;49;00m[90m[39;49;00m
                    [94melse[39;49;00m:  [90m# no break[39;49;00m[90m[39;49;00m
                        [90m# Create a new group[39;49;00m[90m[39;49;00m
                        args_share_memory.append([i])[90m[39;49;00m
    [90m[39;49;00m
                [90m# Check for groups of more than one argument that share memory[39;49;00m[90m[39;49;00m
                [94mfor[39;49;00m group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                    [94mif[39;49;00m [96mlen[39;49;00m(group) > [94m1[39;49;00m:[90m[39;49;00m
                        [90m# copy all but the first[39;49;00m[90m[39;49;00m
                        [94mfor[39;49;00m i [95min[39;49;00m group[[94m1[39;49;00m:]:[90m[39;49;00m
                            input_storage[i].storage[[94m0[39;49;00m] = copy.copy([90m[39;49;00m
                                input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
                            )[90m[39;49;00m
    [90m[39;49;00m
            [90m# Check if inputs are missing, or if inputs were set more than once, or[39;49;00m[90m[39;49;00m
            [90m# if we tried to provide inputs that are supposed to be implicit.[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                [94mif[39;49;00m arg_container.required [95mand[39;49;00m [95mnot[39;49;00m arg_container.provided:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMissing required input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.provided > [94m1[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMultiple values for input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.implicit [95mand[39;49;00m arg_container.provided > [94m0[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mTried to provide value for implicit input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
    [90m[39;49;00m
        [90m# Do the actual work[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0_fn = time.perf_counter()[90m[39;49;00m
        [94mtry[39;49;00m:[90m[39;49;00m
>           outputs = vm() [94mif[39;49;00m output_subset [95mis[39;49;00m [94mNone[39;49;00m [94melse[39;49;00m vm(output_subset=output_subset)[90m[39;49;00m
                      ^^^^[90m[39;49;00m
[1m[31mE           pymc.logprob.utils.ParameterValueError: [0m
[1m[31mE           Apply node that caused the error: Check{}(-inf, False)[0m
[1m[31mE           Toposort index: 0[0m
[1m[31mE           Inputs types: [TensorType(float64, shape=()), ScalarType(bool)][0m
[1m[31mE           Inputs shapes: [(), ()][0m
[1m[31mE           Inputs strides: [(), ()][0m
[1m[31mE           Inputs values: [array(-inf), np.False_][0m
[1m[31mE           Inputs type_num: [12, 0][0m
[1m[31mE           Outputs clients: [[DeepCopyOp(Check{}.0)]][0m
[1m[31mE           [0m
[1m[31mE           Backtrace when the node is created (use PyTensor flag traceback__limit=N to make it longer):[0m
[1m[31mE             File "/app/pymc/logprob/basic.py", line 193, in logp[0m
[1m[31mE               return _logprob_helper(rv, value, **kwargs)[0m
[1m[31mE             File "/app/pymc/logprob/abstract.py", line 70, in _logprob_helper[0m
[1m[31mE               logprob = _logprob(rv.owner.op, values, *rv.owner.inputs, **kwargs)[0m
[1m[31mE             File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/functools.py", line 982, in wrapper[0m
[1m[31mE               return dispatch(args[0].__class__)(*args, **kw)[0m
[1m[31mE             File "/app/pymc/distributions/distribution.py", line 140, in logp[0m
[1m[31mE               return class_logp(value, *dist_params)[0m
[1m[31mE             File "/app/tests/distributions/test_dist_math.py", line 96, in logp[0m
[1m[31mE               return check_parameters([0m
[1m[31mE             File "/app/pymc/distributions/dist_math.py", line 72, in check_parameters[0m
[1m[31mE               return CheckParameterValue(msg, can_be_replaced_by_ninf)(expr, all_true_scalar)[0m
[1m[31mE             File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/graph/op.py", line 294, in __call__[0m
[1m[31mE               node = self.make_node(*inputs, **kwargs)[0m
[1m[31mE             File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/raise_op.py", line 81, in make_node[0m
[1m[31mE               [value.type()],[0m
[1m[31mE           [0m
[1m[31mE           Debug print of the apply node: [0m
[1m[31mE           Check{} [id A] <Scalar(float64, shape=())>[0m
[1m[31mE            ├─ -inf [id B] <Scalar(float64, shape=())>[0m
[1m[31mE            └─ False [id C] <bool>[0m
[1m[31mE           [0m
[1m[31mE           Storage map footprint:[0m
[1m[31mE            - -inf, Shape: (), ElemSize: 8 Byte(s), TotalSize: 8.0 Byte(s)[0m
[1m[31mE            - False, Shape: (), ElemSize: 1 Byte(s), TotalSize: 1.0 Byte(s)[0m
[1m[31mE            TotalSize: 9.0 Byte(s) 0.000 GB[0m
[1m[31mE            TotalSize inputs: 9.0 Byte(s) 0.000 GB[0m

[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/compile/function/types.py[0m:1038: ParameterValueError
[31m[1m_______ TestMatchesScipy.test_multinomial_vectorized[extra_size0-p0-n1] ________[0m

self = <tests.distributions.test_multivariate.TestMatchesScipy object at 0x7f0bb35c7200>
n = array([10, 11]), p = array([0.2, 0.3, 0.5]), extra_size = (1,)

    [0m[37m@pytest[39;49;00m.mark.parametrize([33m"[39;49;00m[33mn[39;49;00m[33m"[39;49;00m, [([94m10[39;49;00m), ([[94m10[39;49;00m, [94m11[39;49;00m]), ([[[94m5[39;49;00m, [94m6[39;49;00m], [[94m10[39;49;00m, [94m11[39;49;00m]])])[90m[39;49;00m
    [37m@pytest[39;49;00m.mark.parametrize([90m[39;49;00m
        [33m"[39;49;00m[33mp[39;49;00m[33m"[39;49;00m,[90m[39;49;00m
        [[90m[39;49;00m
            ([[94m0.2[39;49;00m, [94m0.3[39;49;00m, [94m0.5[39;49;00m]),[90m[39;49;00m
            ([[[94m0.2[39;49;00m, [94m0.3[39;49;00m, [94m0.5[39;49;00m], [[94m0.9[39;49;00m, [94m0.09[39;49;00m, [94m0.01[39;49;00m]]),[90m[39;49;00m
            (np.abs(np.random.randn([94m2[39;49;00m, [94m2[39;49;00m, [94m4[39;49;00m))),[90m[39;49;00m
        ],[90m[39;49;00m
    )[90m[39;49;00m
    [37m@pytest[39;49;00m.mark.parametrize([33m"[39;49;00m[33mextra_size[39;49;00m[33m"[39;49;00m, [([94m1[39;49;00m,), ([94m2[39;49;00m,), ([94m2[39;49;00m, [94m3[39;49;00m)])[90m[39;49;00m
    [94mdef[39;49;00m[90m [39;49;00m[92mtest_multinomial_vectorized[39;49;00m([96mself[39;49;00m, n, p, extra_size):[90m[39;49;00m
        n = np.array(n)[90m[39;49;00m
        p = np.array(p)[90m[39;49;00m
        p /= p.sum(axis=-[94m1[39;49;00m, keepdims=[94mTrue[39;49;00m)[90m[39;49;00m
    [90m[39;49;00m
        _, bcast_p = broadcast_params([n, p], ndims_params=[[94m0[39;49;00m, [94m1[39;49;00m])[90m[39;49;00m
        size = extra_size + bcast_p.shape[:-[94m1[39;49;00m][90m[39;49;00m
    [90m[39;49;00m
        mn = pm.Multinomial.dist(n=n, p=p, size=size)[90m[39;49;00m
        vals = mn.eval()[90m[39;49;00m
    [90m[39;49;00m
>       npt.assert_almost_equal([90m[39;49;00m
            st.multinomial.logpmf(vals, n, p),[90m[39;49;00m
            pm.logp(mn, vals).eval(),[90m[39;49;00m
            decimal=[94m4[39;49;00m,[90m[39;49;00m
            err_msg=[33mf[39;49;00m[33m"[39;49;00m[33mvals=[39;49;00m[33m{[39;49;00mvals[33m}[39;49;00m[33m"[39;49;00m,[90m[39;49;00m
        )[90m[39;49;00m
[1m[31mE       AssertionError: [0m
[1m[31mE       Arrays are not almost equal to 4 decimals[0m
[1m[31mE       vals=[[[2 2 6][0m
[1m[31mE         [1 5 5]]][0m
[1m[31mE       Mismatched elements: 2 / 2 (100%)[0m
[1m[31mE       Max absolute difference among violations: 20.67002132[0m
[1m[31mE       Max relative difference among violations: 0.88648396[0m
[1m[31mE        ACTUAL: array([[-2.6468, -3.1677]])[0m
[1m[31mE        DESIRED: array([[-23.3169, -20.919 ]])[0m

[1m[31mtests/distributions/test_multivariate.py[0m:690: AssertionError
[31m[1m_______ TestMatchesScipy.test_multinomial_vectorized[extra_size0-p0-n2] ________[0m

self = <tests.distributions.test_multivariate.TestMatchesScipy object at 0x7f0bb35c7250>
n = array([[ 5,  6],
       [10, 11]]), p = array([0.2, 0.3, 0.5])
extra_size = (1,)

    [0m[37m@pytest[39;49;00m.mark.parametrize([33m"[39;49;00m[33mn[39;49;00m[33m"[39;49;00m, [([94m10[39;49;00m), ([[94m10[39;49;00m, [94m11[39;49;00m]), ([[[94m5[39;49;00m, [94m6[39;49;00m], [[94m10[39;49;00m, [94m11[39;49;00m]])])[90m[39;49;00m
    [37m@pytest[39;49;00m.mark.parametrize([90m[39;49;00m
        [33m"[39;49;00m[33mp[39;49;00m[33m"[39;49;00m,[90m[39;49;00m
        [[90m[39;49;00m
            ([[94m0.2[39;49;00m, [94m0.3[39;49;00m, [94m0.5[39;49;00m]),[90m[39;49;00m
            ([[[94m0.2[39;49;00m, [94m0.3[39;49;00m, [94m0.5[39;49;00m], [[94m0.9[39;49;00m, [94m0.09[39;49;00m, [94m0.01[39;49;00m]]),[90m[39;49;00m
            (np.abs(np.random.randn([94m2[39;49;00m, [94m2[39;49;00m, [94m4[39;49;00m))),[90m[39;49;00m
        ],[90m[39;49;00m
    )[90m[39;49;00m
    [37m@pytest[39;49;00m.mark.parametrize([33m"[39;49;00m[33mextra_size[39;49;00m[33m"[39;49;00m, [([94m1[39;49;00m,), ([94m2[39;49;00m,), ([94m2[39;49;00m, [94m3[39;49;00m)])[90m[39;49;00m
    [94mdef[39;49;00m[90m [39;49;00m[92mtest_multinomial_vectorized[39;49;00m([96mself[39;49;00m, n, p, extra_size):[90m[39;49;00m
        n = np.array(n)[90m[39;49;00m
        p = np.array(p)[90m[39;49;00m
        p /= p.sum(axis=-[94m1[39;49;00m, keepdims=[94mTrue[39;49;00m)[90m[39;49;00m
    [90m[39;49;00m
        _, bcast_p = broadcast_params([n, p], ndims_params=[[94m0[39;49;00m, [94m1[39;49;00m])[90m[39;49;00m
        size = extra_size + bcast_p.shape[:-[94m1[39;49;00m][90m[39;49;00m
    [90m[39;49;00m
        mn = pm.Multinomial.dist(n=n, p=p, size=size)[90m[39;49;00m
        vals = mn.eval()[90m[39;49;00m
    [90m[39;49;00m
>       npt.assert_almost_equal([90m[39;49;00m
            st.multinomial.logpmf(vals, n, p),[90m[39;49;00m
            pm.logp(mn, vals).eval(),[90m[39;49;00m
            decimal=[94m4[39;49;00m,[90m[39;49;00m
            err_msg=[33mf[39;49;00m[33m"[39;49;00m[33mvals=[39;49;00m[33m{[39;49;00mvals[33m}[39;49;00m[33m"[39;49;00m,[90m[39;49;00m
        )[90m[39;49;00m
[1m[31mE       AssertionError: [0m
[1m[31mE       Arrays are not almost equal to 4 decimals[0m
[1m[31mE       vals=[[[[0 3 2][0m
[1m[31mE          [1 2 3]][0m
[1m[31mE       [0m
[1m[31mE         [[2 3 5][0m
[1m[31mE          [2 2 7]]]][0m
[1m[31mE       Mismatched elements: 4 / 4 (100%)[0m
[1m[31mE       Max absolute difference among violations: 46.54096767[0m
[1m[31mE       Max relative difference among violations: 0.9577935[0m
[1m[31mE        ACTUAL: array([[[-2.6956, -2.0025],[0m
[1m[31mE               [-2.4645, -2.888 ]]])[0m
[1m[31mE        DESIRED: array([[[-49.2366, -47.4448],[0m
[1m[31mE               [-38.9197, -36.5218]]])[0m

[1m[31mtests/distributions/test_multivariate.py[0m:690: AssertionError
[31m[1m_______ TestMatchesScipy.test_multinomial_vectorized[extra_size0-p1-10] ________[0m

self = <pytensor.compile.function.types.Function object at 0x7f0b9d4d0b90>
output_subset = None, args = (), kwargs = {}, trust_input = False
vm = <pytensor.link.c.cvm.CVM object at 0x7f0b9c577a10>, profile = None

    [0m[94mdef[39;49;00m[90m [39;49;00m[92m__call__[39;49;00m([96mself[39;49;00m, *args, output_subset=[94mNone[39;49;00m, **kwargs):[90m[39;49;00m
    [90m    [39;49;00m[33m"""[39;49;00m
    [33m    Evaluates value of a function on given arguments.[39;49;00m
    [33m[39;49;00m
    [33m    Parameters[39;49;00m
    [33m    ----------[39;49;00m
    [33m    args : list[39;49;00m
    [33m        List of inputs to the function. All inputs are required, even when[39;49;00m
    [33m        some of them are not necessary to calculate requested subset of[39;49;00m
    [33m        outputs.[39;49;00m
    [33m[39;49;00m
    [33m    kwargs : dict[39;49;00m
    [33m        The function inputs can be passed as keyword argument. For this, use[39;49;00m
    [33m        the name of the input or the input instance as the key.[39;49;00m
    [33m[39;49;00m
    [33m        Keyword argument ``output_subset`` is a list of either indices of the[39;49;00m
    [33m        function's outputs or the keys belonging to the `output_keys` dict[39;49;00m
    [33m        and represent outputs that are requested to be calculated. Regardless[39;49;00m
    [33m        of the presence of ``output_subset``, the updates are always calculated[39;49;00m
    [33m        and processed. To disable the updates, you should use the ``copy``[39;49;00m
    [33m        method with ``delete_updates=True``.[39;49;00m
    [33m[39;49;00m
    [33m    Returns[39;49;00m
    [33m    -------[39;49;00m
    [33m    list[39;49;00m
    [33m        List of outputs on indices/keys from ``output_subset`` or all of them,[39;49;00m
    [33m        if ``output_subset`` is not passed.[39;49;00m
    [33m    """[39;49;00m[90m[39;49;00m
        trust_input = [96mself[39;49;00m.trust_input[90m[39;49;00m
        input_storage = [96mself[39;49;00m.input_storage[90m[39;49;00m
        vm = [96mself[39;49;00m.vm[90m[39;49;00m
        profile = [96mself[39;49;00m.profile[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0 = time.perf_counter()[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m output_subset [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
            warnings.warn([33m"[39;49;00m[33moutput_subset is deprecated.[39;49;00m[33m"[39;49;00m, [96mFutureWarning[39;49;00m)[90m[39;49;00m
            [94mif[39;49;00m [96mself[39;49;00m.output_keys [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                output_subset = [[96mself[39;49;00m.output_keys.index(key) [94mfor[39;49;00m key [95min[39;49;00m output_subset][90m[39;49;00m
    [90m[39;49;00m
        [90m# Reinitialize each container's 'provided' counter[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m trust_input:[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
        [94melse[39;49;00m:[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                arg_container.provided = [94m0[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
            [94mif[39;49;00m [96mlen[39;49;00m(args) + [96mlen[39;49;00m(kwargs) > [96mlen[39;49;00m(input_storage):[90m[39;49;00m
                [94mraise[39;49;00m [96mTypeError[39;49;00m([33m"[39;49;00m[33mToo many parameter passed to pytensor function[39;49;00m[33m"[39;49;00m)[90m[39;49;00m
    [90m[39;49;00m
            [90m# Set positional arguments[39;49;00m[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                [90m# See discussion about None as input[39;49;00m[90m[39;49;00m
                [90m# https://groups.google.com/group/theano-dev/browse_thread/thread/920a5e904e8a8525/4f1b311a28fc27e5[39;49;00m[90m[39;49;00m
                [94mif[39;49;00m arg [95mis[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                    arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
                [94melse[39;49;00m:[90m[39;49;00m
                    [94mtry[39;49;00m:[90m[39;49;00m
                        arg_container.storage[[94m0[39;49;00m] = arg_container.type.filter([90m[39;49;00m
                            arg,[90m[39;49;00m
                            strict=arg_container.strict,[90m[39;49;00m
                            allow_downcast=arg_container.allow_downcast,[90m[39;49;00m
                        )[90m[39;49;00m
    [90m[39;49;00m
                    [94mexcept[39;49;00m [96mException[39;49;00m [94mas[39;49;00m e:[90m[39;49;00m
                        i = input_storage.index(arg_container)[90m[39;49;00m
                        function_name = [33m"[39;49;00m[33mpytensor function[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        argument_name = [33m"[39;49;00m[33margument[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mself[39;49;00m.name:[90m[39;49;00m
                            function_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + [96mself[39;49;00m.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mhasattr[39;49;00m(arg, [33m"[39;49;00m[33mname[39;49;00m[33m"[39;49;00m) [95mand[39;49;00m arg.name:[90m[39;49;00m
                            argument_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + arg.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        where = get_variable_trace_string([96mself[39;49;00m.maker.inputs[i].variable)[90m[39;49;00m
                        [94mif[39;49;00m [96mlen[39;49;00m(e.args) == [94m1[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + e.args[[94m0[39;49;00m],[90m[39;49;00m
                            )[90m[39;49;00m
                        [94melse[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                            ) + e.args[90m[39;49;00m
                        [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                        [94mraise[39;49;00m[90m[39;49;00m
                arg_container.provided += [94m1[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
        [90m# Set keyword arguments[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m kwargs:  [90m# for speed, skip the items for empty kwargs[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m k, arg [95min[39;49;00m kwargs.items():[90m[39;49;00m
                [96mself[39;49;00m[k] = arg[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m [95mnot[39;49;00m trust_input:[90m[39;49;00m
            [90m# Collect aliased inputs among the storage space[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m potential_group [95min[39;49;00m [96mself[39;49;00m._potential_aliased_input_groups:[90m[39;49;00m
                args_share_memory: [96mlist[39;49;00m[[96mlist[39;49;00m[[96mint[39;49;00m]] = [][90m[39;49;00m
                [94mfor[39;49;00m i [95min[39;49;00m potential_group:[90m[39;49;00m
                    i_type = [96mself[39;49;00m.maker.inputs[i].variable.type[90m[39;49;00m
                    i_val = input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
    [90m[39;49;00m
                    [90m# Check if value is aliased with any of the values in one of the groups[39;49;00m[90m[39;49;00m
                    [94mfor[39;49;00m j_group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                        [94mif[39;49;00m [96many[39;49;00m([90m[39;49;00m
                            i_type.may_share_memory(input_storage[j].storage[[94m0[39;49;00m], i_val)[90m[39;49;00m
                            [94mfor[39;49;00m j [95min[39;49;00m j_group[90m[39;49;00m
                        ):[90m[39;49;00m
                            j_group.append(i)[90m[39;49;00m
                            [94mbreak[39;49;00m[90m[39;49;00m
                    [94melse[39;49;00m:  [90m# no break[39;49;00m[90m[39;49;00m
                        [90m# Create a new group[39;49;00m[90m[39;49;00m
                        args_share_memory.append([i])[90m[39;49;00m
    [90m[39;49;00m
                [90m# Check for groups of more than one argument that share memory[39;49;00m[90m[39;49;00m
                [94mfor[39;49;00m group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                    [94mif[39;49;00m [96mlen[39;49;00m(group) > [94m1[39;49;00m:[90m[39;49;00m
                        [90m# copy all but the first[39;49;00m[90m[39;49;00m
                        [94mfor[39;49;00m i [95min[39;49;00m group[[94m1[39;49;00m:]:[90m[39;49;00m
                            input_storage[i].storage[[94m0[39;49;00m] = copy.copy([90m[39;49;00m
                                input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
                            )[90m[39;49;00m
    [90m[39;49;00m
            [90m# Check if inputs are missing, or if inputs were set more than once, or[39;49;00m[90m[39;49;00m
            [90m# if we tried to provide inputs that are supposed to be implicit.[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                [94mif[39;49;00m arg_container.required [95mand[39;49;00m [95mnot[39;49;00m arg_container.provided:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMissing required input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.provided > [94m1[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMultiple values for input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.implicit [95mand[39;49;00m arg_container.provided > [94m0[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mTried to provide value for implicit input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
    [90m[39;49;00m
        [90m# Do the actual work[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0_fn = time.perf_counter()[90m[39;49;00m
        [94mtry[39;49;00m:[90m[39;49;00m
>           outputs = vm() [94mif[39;49;00m output_subset [95mis[39;49;00m [94mNone[39;49;00m [94melse[39;49;00m vm(output_subset=output_subset)[90m[39;49;00m
                      ^^^^[90m[39;49;00m
[1m[31mE           pymc.logprob.utils.ParameterValueError[0m

[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/compile/function/types.py[0m:1038: ParameterValueError

[33mDuring handling of the above exception, another exception occurred:[0m

self = <tests.distributions.test_multivariate.TestMatchesScipy object at 0x7f0bb35c72a0>
n = array(10), p = array([[0.2 , 0.3 , 0.5 ],
       [0.9 , 0.09, 0.01]])
extra_size = (1,)

    [0m[37m@pytest[39;49;00m.mark.parametrize([33m"[39;49;00m[33mn[39;49;00m[33m"[39;49;00m, [([94m10[39;49;00m), ([[94m10[39;49;00m, [94m11[39;49;00m]), ([[[94m5[39;49;00m, [94m6[39;49;00m], [[94m10[39;49;00m, [94m11[39;49;00m]])])[90m[39;49;00m
    [37m@pytest[39;49;00m.mark.parametrize([90m[39;49;00m
        [33m"[39;49;00m[33mp[39;49;00m[33m"[39;49;00m,[90m[39;49;00m
        [[90m[39;49;00m
            ([[94m0.2[39;49;00m, [94m0.3[39;49;00m, [94m0.5[39;49;00m]),[90m[39;49;00m
            ([[[94m0.2[39;49;00m, [94m0.3[39;49;00m, [94m0.5[39;49;00m], [[94m0.9[39;49;00m, [94m0.09[39;49;00m, [94m0.01[39;49;00m]]),[90m[39;49;00m
            (np.abs(np.random.randn([94m2[39;49;00m, [94m2[39;49;00m, [94m4[39;49;00m))),[90m[39;49;00m
        ],[90m[39;49;00m
    )[90m[39;49;00m
    [37m@pytest[39;49;00m.mark.parametrize([33m"[39;49;00m[33mextra_size[39;49;00m[33m"[39;49;00m, [([94m1[39;49;00m,), ([94m2[39;49;00m,), ([94m2[39;49;00m, [94m3[39;49;00m)])[90m[39;49;00m
    [94mdef[39;49;00m[90m [39;49;00m[92mtest_multinomial_vectorized[39;49;00m([96mself[39;49;00m, n, p, extra_size):[90m[39;49;00m
        n = np.array(n)[90m[39;49;00m
        p = np.array(p)[90m[39;49;00m
        p /= p.sum(axis=-[94m1[39;49;00m, keepdims=[94mTrue[39;49;00m)[90m[39;49;00m
    [90m[39;49;00m
        _, bcast_p = broadcast_params([n, p], ndims_params=[[94m0[39;49;00m, [94m1[39;49;00m])[90m[39;49;00m
        size = extra_size + bcast_p.shape[:-[94m1[39;49;00m][90m[39;49;00m
    [90m[39;49;00m
        mn = pm.Multinomial.dist(n=n, p=p, size=size)[90m[39;49;00m
        vals = mn.eval()[90m[39;49;00m
    [90m[39;49;00m
        npt.assert_almost_equal([90m[39;49;00m
            st.multinomial.logpmf(vals, n, p),[90m[39;49;00m
>           pm.logp(mn, vals).eval(),[90m[39;49;00m
            ^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
            decimal=[94m4[39;49;00m,[90m[39;49;00m
            err_msg=[33mf[39;49;00m[33m"[39;49;00m[33mvals=[39;49;00m[33m{[39;49;00mvals[33m}[39;49;00m[33m"[39;49;00m,[90m[39;49;00m
        )[90m[39;49;00m

[1m[31mtests/distributions/test_multivariate.py[0m:692:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/graph/basic.py[0m:668: in eval
    [0m[94mreturn[39;49;00m fn(*args)[90m[39;49;00m
           ^^^^^^^^^[90m[39;49;00m
[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/compile/function/types.py[0m:1048: in __call__
    [0mraise_with_op([90m[39;49;00m
[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/link/utils.py[0m:526: in raise_with_op
    [0m[94mraise[39;49;00m exc_value.with_traceback(exc_trace)[90m[39;49;00m
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <pytensor.compile.function.types.Function object at 0x7f0b9d4d0b90>
output_subset = None, args = (), kwargs = {}, trust_input = False
vm = <pytensor.link.c.cvm.CVM object at 0x7f0b9c577a10>, profile = None

    [0m[94mdef[39;49;00m[90m [39;49;00m[92m__call__[39;49;00m([96mself[39;49;00m, *args, output_subset=[94mNone[39;49;00m, **kwargs):[90m[39;49;00m
    [90m    [39;49;00m[33m"""[39;49;00m
    [33m    Evaluates value of a function on given arguments.[39;49;00m
    [33m[39;49;00m
    [33m    Parameters[39;49;00m
    [33m    ----------[39;49;00m
    [33m    args : list[39;49;00m
    [33m        List of inputs to the function. All inputs are required, even when[39;49;00m
    [33m        some of them are not necessary to calculate requested subset of[39;49;00m
    [33m        outputs.[39;49;00m
    [33m[39;49;00m
    [33m    kwargs : dict[39;49;00m
    [33m        The function inputs can be passed as keyword argument. For this, use[39;49;00m
    [33m        the name of the input or the input instance as the key.[39;49;00m
    [33m[39;49;00m
    [33m        Keyword argument ``output_subset`` is a list of either indices of the[39;49;00m
    [33m        function's outputs or the keys belonging to the `output_keys` dict[39;49;00m
    [33m        and represent outputs that are requested to be calculated. Regardless[39;49;00m
    [33m        of the presence of ``output_subset``, the updates are always calculated[39;49;00m
    [33m        and processed. To disable the updates, you should use the ``copy``[39;49;00m
    [33m        method with ``delete_updates=True``.[39;49;00m
    [33m[39;49;00m
    [33m    Returns[39;49;00m
    [33m    -------[39;49;00m
    [33m    list[39;49;00m
    [33m        List of outputs on indices/keys from ``output_subset`` or all of them,[39;49;00m
    [33m        if ``output_subset`` is not passed.[39;49;00m
    [33m    """[39;49;00m[90m[39;49;00m
        trust_input = [96mself[39;49;00m.trust_input[90m[39;49;00m
        input_storage = [96mself[39;49;00m.input_storage[90m[39;49;00m
        vm = [96mself[39;49;00m.vm[90m[39;49;00m
        profile = [96mself[39;49;00m.profile[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0 = time.perf_counter()[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m output_subset [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
            warnings.warn([33m"[39;49;00m[33moutput_subset is deprecated.[39;49;00m[33m"[39;49;00m, [96mFutureWarning[39;49;00m)[90m[39;49;00m
            [94mif[39;49;00m [96mself[39;49;00m.output_keys [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                output_subset = [[96mself[39;49;00m.output_keys.index(key) [94mfor[39;49;00m key [95min[39;49;00m output_subset][90m[39;49;00m
    [90m[39;49;00m
        [90m# Reinitialize each container's 'provided' counter[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m trust_input:[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
        [94melse[39;49;00m:[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                arg_container.provided = [94m0[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
            [94mif[39;49;00m [96mlen[39;49;00m(args) + [96mlen[39;49;00m(kwargs) > [96mlen[39;49;00m(input_storage):[90m[39;49;00m
                [94mraise[39;49;00m [96mTypeError[39;49;00m([33m"[39;49;00m[33mToo many parameter passed to pytensor function[39;49;00m[33m"[39;49;00m)[90m[39;49;00m
    [90m[39;49;00m
            [90m# Set positional arguments[39;49;00m[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                [90m# See discussion about None as input[39;49;00m[90m[39;49;00m
                [90m# https://groups.google.com/group/theano-dev/browse_thread/thread/920a5e904e8a8525/4f1b311a28fc27e5[39;49;00m[90m[39;49;00m
                [94mif[39;49;00m arg [95mis[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                    arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
                [94melse[39;49;00m:[90m[39;49;00m
                    [94mtry[39;49;00m:[90m[39;49;00m
                        arg_container.storage[[94m0[39;49;00m] = arg_container.type.filter([90m[39;49;00m
                            arg,[90m[39;49;00m
                            strict=arg_container.strict,[90m[39;49;00m
                            allow_downcast=arg_container.allow_downcast,[90m[39;49;00m
                        )[90m[39;49;00m
    [90m[39;49;00m
                    [94mexcept[39;49;00m [96mException[39;49;00m [94mas[39;49;00m e:[90m[39;49;00m
                        i = input_storage.index(arg_container)[90m[39;49;00m
                        function_name = [33m"[39;49;00m[33mpytensor function[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        argument_name = [33m"[39;49;00m[33margument[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mself[39;49;00m.name:[90m[39;49;00m
                            function_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + [96mself[39;49;00m.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mhasattr[39;49;00m(arg, [33m"[39;49;00m[33mname[39;49;00m[33m"[39;49;00m) [95mand[39;49;00m arg.name:[90m[39;49;00m
                            argument_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + arg.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        where = get_variable_trace_string([96mself[39;49;00m.maker.inputs[i].variable)[90m[39;49;00m
                        [94mif[39;49;00m [96mlen[39;49;00m(e.args) == [94m1[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + e.args[[94m0[39;49;00m],[90m[39;49;00m
                            )[90m[39;49;00m
                        [94melse[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                            ) + e.args[90m[39;49;00m
                        [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                        [94mraise[39;49;00m[90m[39;49;00m
                arg_container.provided += [94m1[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
        [90m# Set keyword arguments[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m kwargs:  [90m# for speed, skip the items for empty kwargs[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m k, arg [95min[39;49;00m kwargs.items():[90m[39;49;00m
                [96mself[39;49;00m[k] = arg[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m [95mnot[39;49;00m trust_input:[90m[39;49;00m
            [90m# Collect aliased inputs among the storage space[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m potential_group [95min[39;49;00m [96mself[39;49;00m._potential_aliased_input_groups:[90m[39;49;00m
                args_share_memory: [96mlist[39;49;00m[[96mlist[39;49;00m[[96mint[39;49;00m]] = [][90m[39;49;00m
                [94mfor[39;49;00m i [95min[39;49;00m potential_group:[90m[39;49;00m
                    i_type = [96mself[39;49;00m.maker.inputs[i].variable.type[90m[39;49;00m
                    i_val = input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
    [90m[39;49;00m
                    [90m# Check if value is aliased with any of the values in one of the groups[39;49;00m[90m[39;49;00m
                    [94mfor[39;49;00m j_group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                        [94mif[39;49;00m [96many[39;49;00m([90m[39;49;00m
                            i_type.may_share_memory(input_storage[j].storage[[94m0[39;49;00m], i_val)[90m[39;49;00m
                            [94mfor[39;49;00m j [95min[39;49;00m j_group[90m[39;49;00m
                        ):[90m[39;49;00m
                            j_group.append(i)[90m[39;49;00m
                            [94mbreak[39;49;00m[90m[39;49;00m
                    [94melse[39;49;00m:  [90m# no break[39;49;00m[90m[39;49;00m
                        [90m# Create a new group[39;49;00m[90m[39;49;00m
                        args_share_memory.append([i])[90m[39;49;00m
    [90m[39;49;00m
                [90m# Check for groups of more than one argument that share memory[39;49;00m[90m[39;49;00m
                [94mfor[39;49;00m group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                    [94mif[39;49;00m [96mlen[39;49;00m(group) > [94m1[39;49;00m:[90m[39;49;00m
                        [90m# copy all but the first[39;49;00m[90m[39;49;00m
                        [94mfor[39;49;00m i [95min[39;49;00m group[[94m1[39;49;00m:]:[90m[39;49;00m
                            input_storage[i].storage[[94m0[39;49;00m] = copy.copy([90m[39;49;00m
                                input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
                            )[90m[39;49;00m
    [90m[39;49;00m
            [90m# Check if inputs are missing, or if inputs were set more than once, or[39;49;00m[90m[39;49;00m
            [90m# if we tried to provide inputs that are supposed to be implicit.[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                [94mif[39;49;00m arg_container.required [95mand[39;49;00m [95mnot[39;49;00m arg_container.provided:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMissing required input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.provided > [94m1[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMultiple values for input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.implicit [95mand[39;49;00m arg_container.provided > [94m0[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mTried to provide value for implicit input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
    [90m[39;49;00m
        [90m# Do the actual work[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0_fn = time.perf_counter()[90m[39;49;00m
        [94mtry[39;49;00m:[90m[39;49;00m
>           outputs = vm() [94mif[39;49;00m output_subset [95mis[39;49;00m [94mNone[39;49;00m [94melse[39;49;00m vm(output_subset=output_subset)[90m[39;49;00m
                      ^^^^[90m[39;49;00m
[1m[31mE           pymc.logprob.utils.ParameterValueError: [0m
[1m[31mE           Apply node that caused the error: Check{}([[-21.74401717]], False)[0m
[1m[31mE           Toposort index: 0[0m
[1m[31mE           Inputs types: [TensorType(float64, shape=(1, 1)), ScalarType(bool)][0m
[1m[31mE           Inputs shapes: [(1, 1), ()][0m
[1m[31mE           Inputs strides: [(8, 8), ()][0m
[1m[31mE           Inputs values: [array([[-21.74401717]]), np.False_][0m
[1m[31mE           Inputs type_num: [12, 0][0m
[1m[31mE           Outputs clients: [[DeepCopyOp(Check{}.0)]][0m
[1m[31mE           [0m
[1m[31mE           Backtrace when the node is created (use PyTensor flag traceback__limit=N to make it longer):[0m
[1m[31mE             File "/app/pymc/logprob/basic.py", line 193, in logp[0m
[1m[31mE               return _logprob_helper(rv, value, **kwargs)[0m
[1m[31mE             File "/app/pymc/logprob/abstract.py", line 70, in _logprob_helper[0m
[1m[31mE               logprob = _logprob(rv.owner.op, values, *rv.owner.inputs, **kwargs)[0m
[1m[31mE             File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/functools.py", line 982, in wrapper[0m
[1m[31mE               return dispatch(args[0].__class__)(*args, **kw)[0m
[1m[31mE             File "/app/pymc/distributions/distribution.py", line 140, in logp[0m
[1m[31mE               return class_logp(value, *dist_params)[0m
[1m[31mE             File "/app/tests/distributions/test_dist_math.py", line 96, in logp[0m
[1m[31mE               return check_parameters([0m
[1m[31mE             File "/app/pymc/distributions/dist_math.py", line 72, in check_parameters[0m
[1m[31mE               return CheckParameterValue(msg, can_be_replaced_by_ninf)(expr, all_true_scalar)[0m
[1m[31mE             File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/graph/op.py", line 294, in __call__[0m
[1m[31mE               node = self.make_node(*inputs, **kwargs)[0m
[1m[31mE             File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/raise_op.py", line 81, in make_node[0m
[1m[31mE               [value.type()],[0m
[1m[31mE           [0m
[1m[31mE           Debug print of the apply node: [0m
[1m[31mE           Check{} [id A] <Matrix(float64, shape=(1, 1))>[0m
[1m[31mE            ├─ [[-21.74401717]] [id B] <Matrix(float64, shape=(1, 1))>[0m
[1m[31mE            └─ False [id C] <bool>[0m
[1m[31mE           [0m
[1m[31mE           Storage map footprint:[0m
[1m[31mE            - [[-21.74401717]], Shape: (1, 1), ElemSize: 8 Byte(s), TotalSize: 8 Byte(s)[0m
[1m[31mE            - False, Shape: (), ElemSize: 1 Byte(s), TotalSize: 1.0 Byte(s)[0m
[1m[31mE            TotalSize: 9.0 Byte(s) 0.000 GB[0m
[1m[31mE            TotalSize inputs: 9.0 Byte(s) 0.000 GB[0m

[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/compile/function/types.py[0m:1038: ParameterValueError
[31m[1m_______ TestMatchesScipy.test_multinomial_vectorized[extra_size0-p1-n1] ________[0m

self = <pytensor.compile.function.types.Function object at 0x7f0b9d4d2b10>
output_subset = None, args = (), kwargs = {}, trust_input = False
vm = <pytensor.link.c.cvm.CVM object at 0x7f0b9c576990>, profile = None

    [0m[94mdef[39;49;00m[90m [39;49;00m[92m__call__[39;49;00m([96mself[39;49;00m, *args, output_subset=[94mNone[39;49;00m, **kwargs):[90m[39;49;00m
    [90m    [39;49;00m[33m"""[39;49;00m
    [33m    Evaluates value of a function on given arguments.[39;49;00m
    [33m[39;49;00m
    [33m    Parameters[39;49;00m
    [33m    ----------[39;49;00m
    [33m    args : list[39;49;00m
    [33m        List of inputs to the function. All inputs are required, even when[39;49;00m
    [33m        some of them are not necessary to calculate requested subset of[39;49;00m
    [33m        outputs.[39;49;00m
    [33m[39;49;00m
    [33m    kwargs : dict[39;49;00m
    [33m        The function inputs can be passed as keyword argument. For this, use[39;49;00m
    [33m        the name of the input or the input instance as the key.[39;49;00m
    [33m[39;49;00m
    [33m        Keyword argument ``output_subset`` is a list of either indices of the[39;49;00m
    [33m        function's outputs or the keys belonging to the `output_keys` dict[39;49;00m
    [33m        and represent outputs that are requested to be calculated. Regardless[39;49;00m
    [33m        of the presence of ``output_subset``, the updates are always calculated[39;49;00m
    [33m        and processed. To disable the updates, you should use the ``copy``[39;49;00m
    [33m        method with ``delete_updates=True``.[39;49;00m
    [33m[39;49;00m
    [33m    Returns[39;49;00m
    [33m    -------[39;49;00m
    [33m    list[39;49;00m
    [33m        List of outputs on indices/keys from ``output_subset`` or all of them,[39;49;00m
    [33m        if ``output_subset`` is not passed.[39;49;00m
    [33m    """[39;49;00m[90m[39;49;00m
        trust_input = [96mself[39;49;00m.trust_input[90m[39;49;00m
        input_storage = [96mself[39;49;00m.input_storage[90m[39;49;00m
        vm = [96mself[39;49;00m.vm[90m[39;49;00m
        profile = [96mself[39;49;00m.profile[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0 = time.perf_counter()[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m output_subset [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
            warnings.warn([33m"[39;49;00m[33moutput_subset is deprecated.[39;49;00m[33m"[39;49;00m, [96mFutureWarning[39;49;00m)[90m[39;49;00m
            [94mif[39;49;00m [96mself[39;49;00m.output_keys [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                output_subset = [[96mself[39;49;00m.output_keys.index(key) [94mfor[39;49;00m key [95min[39;49;00m output_subset][90m[39;49;00m
    [90m[39;49;00m
        [90m# Reinitialize each container's 'provided' counter[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m trust_input:[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
        [94melse[39;49;00m:[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                arg_container.provided = [94m0[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
            [94mif[39;49;00m [96mlen[39;49;00m(args) + [96mlen[39;49;00m(kwargs) > [96mlen[39;49;00m(input_storage):[90m[39;49;00m
                [94mraise[39;49;00m [96mTypeError[39;49;00m([33m"[39;49;00m[33mToo many parameter passed to pytensor function[39;49;00m[33m"[39;49;00m)[90m[39;49;00m
    [90m[39;49;00m
            [90m# Set positional arguments[39;49;00m[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                [90m# See discussion about None as input[39;49;00m[90m[39;49;00m
                [90m# https://groups.google.com/group/theano-dev/browse_thread/thread/920a5e904e8a8525/4f1b311a28fc27e5[39;49;00m[90m[39;49;00m
                [94mif[39;49;00m arg [95mis[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                    arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
                [94melse[39;49;00m:[90m[39;49;00m
                    [94mtry[39;49;00m:[90m[39;49;00m
                        arg_container.storage[[94m0[39;49;00m] = arg_container.type.filter([90m[39;49;00m
                            arg,[90m[39;49;00m
                            strict=arg_container.strict,[90m[39;49;00m
                            allow_downcast=arg_container.allow_downcast,[90m[39;49;00m
                        )[90m[39;49;00m
    [90m[39;49;00m
                    [94mexcept[39;49;00m [96mException[39;49;00m [94mas[39;49;00m e:[90m[39;49;00m
                        i = input_storage.index(arg_container)[90m[39;49;00m
                        function_name = [33m"[39;49;00m[33mpytensor function[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        argument_name = [33m"[39;49;00m[33margument[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mself[39;49;00m.name:[90m[39;49;00m
                            function_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + [96mself[39;49;00m.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mhasattr[39;49;00m(arg, [33m"[39;49;00m[33mname[39;49;00m[33m"[39;49;00m) [95mand[39;49;00m arg.name:[90m[39;49;00m
                            argument_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + arg.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        where = get_variable_trace_string([96mself[39;49;00m.maker.inputs[i].variable)[90m[39;49;00m
                        [94mif[39;49;00m [96mlen[39;49;00m(e.args) == [94m1[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + e.args[[94m0[39;49;00m],[90m[39;49;00m
                            )[90m[39;49;00m
                        [94melse[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                            ) + e.args[90m[39;49;00m
                        [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                        [94mraise[39;49;00m[90m[39;49;00m
                arg_container.provided += [94m1[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
        [90m# Set keyword arguments[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m kwargs:  [90m# for speed, skip the items for empty kwargs[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m k, arg [95min[39;49;00m kwargs.items():[90m[39;49;00m
                [96mself[39;49;00m[k] = arg[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m [95mnot[39;49;00m trust_input:[90m[39;49;00m
            [90m# Collect aliased inputs among the storage space[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m potential_group [95min[39;49;00m [96mself[39;49;00m._potential_aliased_input_groups:[90m[39;49;00m
                args_share_memory: [96mlist[39;49;00m[[96mlist[39;49;00m[[96mint[39;49;00m]] = [][90m[39;49;00m
                [94mfor[39;49;00m i [95min[39;49;00m potential_group:[90m[39;49;00m
                    i_type = [96mself[39;49;00m.maker.inputs[i].variable.type[90m[39;49;00m
                    i_val = input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
    [90m[39;49;00m
                    [90m# Check if value is aliased with any of the values in one of the groups[39;49;00m[90m[39;49;00m
                    [94mfor[39;49;00m j_group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                        [94mif[39;49;00m [96many[39;49;00m([90m[39;49;00m
                            i_type.may_share_memory(input_storage[j].storage[[94m0[39;49;00m], i_val)[90m[39;49;00m
                            [94mfor[39;49;00m j [95min[39;49;00m j_group[90m[39;49;00m
                        ):[90m[39;49;00m
                            j_group.append(i)[90m[39;49;00m
                            [94mbreak[39;49;00m[90m[39;49;00m
                    [94melse[39;49;00m:  [90m# no break[39;49;00m[90m[39;49;00m
                        [90m# Create a new group[39;49;00m[90m[39;49;00m
                        args_share_memory.append([i])[90m[39;49;00m
    [90m[39;49;00m
                [90m# Check for groups of more than one argument that share memory[39;49;00m[90m[39;49;00m
                [94mfor[39;49;00m group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                    [94mif[39;49;00m [96mlen[39;49;00m(group) > [94m1[39;49;00m:[90m[39;49;00m
                        [90m# copy all but the first[39;49;00m[90m[39;49;00m
                        [94mfor[39;49;00m i [95min[39;49;00m group[[94m1[39;49;00m:]:[90m[39;49;00m
                            input_storage[i].storage[[94m0[39;49;00m] = copy.copy([90m[39;49;00m
                                input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
                            )[90m[39;49;00m
    [90m[39;49;00m
            [90m# Check if inputs are missing, or if inputs were set more than once, or[39;49;00m[90m[39;49;00m
            [90m# if we tried to provide inputs that are supposed to be implicit.[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                [94mif[39;49;00m arg_container.required [95mand[39;49;00m [95mnot[39;49;00m arg_container.provided:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMissing required input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.provided > [94m1[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMultiple values for input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.implicit [95mand[39;49;00m arg_container.provided > [94m0[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mTried to provide value for implicit input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
    [90m[39;49;00m
        [90m# Do the actual work[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0_fn = time.perf_counter()[90m[39;49;00m
        [94mtry[39;49;00m:[90m[39;49;00m
>           outputs = vm() [94mif[39;49;00m output_subset [95mis[39;49;00m [94mNone[39;49;00m [94melse[39;49;00m vm(output_subset=output_subset)[90m[39;49;00m
                      ^^^^[90m[39;49;00m
[1m[31mE           pymc.logprob.utils.ParameterValueError[0m

[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/compile/function/types.py[0m:1038: ParameterValueError

[33mDuring handling of the above exception, another exception occurred:[0m

self = <tests.distributions.test_multivariate.TestMatchesScipy object at 0x7f0bb35c72f0>
n = array([10, 11]), p = array([[0.2 , 0.3 , 0.5 ],
       [0.9 , 0.09, 0.01]])
extra_size = (1,)

    [0m[37m@pytest[39;49;00m.mark.parametrize([33m"[39;49;00m[33mn[39;49;00m[33m"[39;49;00m, [([94m10[39;49;00m), ([[94m10[39;49;00m, [94m11[39;49;00m]), ([[[94m5[39;49;00m, [94m6[39;49;00m], [[94m10[39;49;00m, [94m11[39;49;00m]])])[90m[39;49;00m
    [37m@pytest[39;49;00m.mark.parametrize([90m[39;49;00m
        [33m"[39;49;00m[33mp[39;49;00m[33m"[39;49;00m,[90m[39;49;00m
        [[90m[39;49;00m
            ([[94m0.2[39;49;00m, [94m0.3[39;49;00m, [94m0.5[39;49;00m]),[90m[39;49;00m
            ([[[94m0.2[39;49;00m, [94m0.3[39;49;00m, [94m0.5[39;49;00m], [[94m0.9[39;49;00m, [94m0.09[39;49;00m, [94m0.01[39;49;00m]]),[90m[39;49;00m
            (np.abs(np.random.randn([94m2[39;49;00m, [94m2[39;49;00m, [94m4[39;49;00m))),[90m[39;49;00m
        ],[90m[39;49;00m
    )[90m[39;49;00m
    [37m@pytest[39;49;00m.mark.parametrize([33m"[39;49;00m[33mextra_size[39;49;00m[33m"[39;49;00m, [([94m1[39;49;00m,), ([94m2[39;49;00m,), ([94m2[39;49;00m, [94m3[39;49;00m)])[90m[39;49;00m
    [94mdef[39;49;00m[90m [39;49;00m[92mtest_multinomial_vectorized[39;49;00m([96mself[39;49;00m, n, p, extra_size):[90m[39;49;00m
        n = np.array(n)[90m[39;49;00m
        p = np.array(p)[90m[39;49;00m
        p /= p.sum(axis=-[94m1[39;49;00m, keepdims=[94mTrue[39;49;00m)[90m[39;49;00m
    [90m[39;49;00m
        _, bcast_p = broadcast_params([n, p], ndims_params=[[94m0[39;49;00m, [94m1[39;49;00m])[90m[39;49;00m
        size = extra_size + bcast_p.shape[:-[94m1[39;49;00m][90m[39;49;00m
    [90m[39;49;00m
        mn = pm.Multinomial.dist(n=n, p=p, size=size)[90m[39;49;00m
        vals = mn.eval()[90m[39;49;00m
    [90m[39;49;00m
        npt.assert_almost_equal([90m[39;49;00m
            st.multinomial.logpmf(vals, n, p),[90m[39;49;00m
>           pm.logp(mn, vals).eval(),[90m[39;49;00m
            ^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
            decimal=[94m4[39;49;00m,[90m[39;49;00m
            err_msg=[33mf[39;49;00m[33m"[39;49;00m[33mvals=[39;49;00m[33m{[39;49;00mvals[33m}[39;49;00m[33m"[39;49;00m,[90m[39;49;00m
        )[90m[39;49;00m

[1m[31mtests/distributions/test_multivariate.py[0m:692:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/graph/basic.py[0m:668: in eval
    [0m[94mreturn[39;49;00m fn(*args)[90m[39;49;00m
           ^^^^^^^^^[90m[39;49;00m
[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/compile/function/types.py[0m:1048: in __call__
    [0mraise_with_op([90m[39;49;00m
[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/link/utils.py[0m:526: in raise_with_op
    [0m[94mraise[39;49;00m exc_value.with_traceback(exc_trace)[90m[39;49;00m
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <pytensor.compile.function.types.Function object at 0x7f0b9d4d2b10>
output_subset = None, args = (), kwargs = {}, trust_input = False
vm = <pytensor.link.c.cvm.CVM object at 0x7f0b9c576990>, profile = None

    [0m[94mdef[39;49;00m[90m [39;49;00m[92m__call__[39;49;00m([96mself[39;49;00m, *args, output_subset=[94mNone[39;49;00m, **kwargs):[90m[39;49;00m
    [90m    [39;49;00m[33m"""[39;49;00m
    [33m    Evaluates value of a function on given arguments.[39;49;00m
    [33m[39;49;00m
    [33m    Parameters[39;49;00m
    [33m    ----------[39;49;00m
    [33m    args : list[39;49;00m
    [33m        List of inputs to the function. All inputs are required, even when[39;49;00m
    [33m        some of them are not necessary to calculate requested subset of[39;49;00m
    [33m        outputs.[39;49;00m
    [33m[39;49;00m
    [33m    kwargs : dict[39;49;00m
    [33m        The function inputs can be passed as keyword argument. For this, use[39;49;00m
    [33m        the name of the input or the input instance as the key.[39;49;00m
    [33m[39;49;00m
    [33m        Keyword argument ``output_subset`` is a list of either indices of the[39;49;00m
    [33m        function's outputs or the keys belonging to the `output_keys` dict[39;49;00m
    [33m        and represent outputs that are requested to be calculated. Regardless[39;49;00m
    [33m        of the presence of ``output_subset``, the updates are always calculated[39;49;00m
    [33m        and processed. To disable the updates, you should use the ``copy``[39;49;00m
    [33m        method with ``delete_updates=True``.[39;49;00m
    [33m[39;49;00m
    [33m    Returns[39;49;00m
    [33m    -------[39;49;00m
    [33m    list[39;49;00m
    [33m        List of outputs on indices/keys from ``output_subset`` or all of them,[39;49;00m
    [33m        if ``output_subset`` is not passed.[39;49;00m
    [33m    """[39;49;00m[90m[39;49;00m
        trust_input = [96mself[39;49;00m.trust_input[90m[39;49;00m
        input_storage = [96mself[39;49;00m.input_storage[90m[39;49;00m
        vm = [96mself[39;49;00m.vm[90m[39;49;00m
        profile = [96mself[39;49;00m.profile[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0 = time.perf_counter()[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m output_subset [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
            warnings.warn([33m"[39;49;00m[33moutput_subset is deprecated.[39;49;00m[33m"[39;49;00m, [96mFutureWarning[39;49;00m)[90m[39;49;00m
            [94mif[39;49;00m [96mself[39;49;00m.output_keys [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                output_subset = [[96mself[39;49;00m.output_keys.index(key) [94mfor[39;49;00m key [95min[39;49;00m output_subset][90m[39;49;00m
    [90m[39;49;00m
        [90m# Reinitialize each container's 'provided' counter[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m trust_input:[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
        [94melse[39;49;00m:[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                arg_container.provided = [94m0[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
            [94mif[39;49;00m [96mlen[39;49;00m(args) + [96mlen[39;49;00m(kwargs) > [96mlen[39;49;00m(input_storage):[90m[39;49;00m
                [94mraise[39;49;00m [96mTypeError[39;49;00m([33m"[39;49;00m[33mToo many parameter passed to pytensor function[39;49;00m[33m"[39;49;00m)[90m[39;49;00m
    [90m[39;49;00m
            [90m# Set positional arguments[39;49;00m[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                [90m# See discussion about None as input[39;49;00m[90m[39;49;00m
                [90m# https://groups.google.com/group/theano-dev/browse_thread/thread/920a5e904e8a8525/4f1b311a28fc27e5[39;49;00m[90m[39;49;00m
                [94mif[39;49;00m arg [95mis[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                    arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
                [94melse[39;49;00m:[90m[39;49;00m
                    [94mtry[39;49;00m:[90m[39;49;00m
                        arg_container.storage[[94m0[39;49;00m] = arg_container.type.filter([90m[39;49;00m
                            arg,[90m[39;49;00m
                            strict=arg_container.strict,[90m[39;49;00m
                            allow_downcast=arg_container.allow_downcast,[90m[39;49;00m
                        )[90m[39;49;00m
    [90m[39;49;00m
                    [94mexcept[39;49;00m [96mException[39;49;00m [94mas[39;49;00m e:[90m[39;49;00m
                        i = input_storage.index(arg_container)[90m[39;49;00m
                        function_name = [33m"[39;49;00m[33mpytensor function[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        argument_name = [33m"[39;49;00m[33margument[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mself[39;49;00m.name:[90m[39;49;00m
                            function_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + [96mself[39;49;00m.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mhasattr[39;49;00m(arg, [33m"[39;49;00m[33mname[39;49;00m[33m"[39;49;00m) [95mand[39;49;00m arg.name:[90m[39;49;00m
                            argument_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + arg.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        where = get_variable_trace_string([96mself[39;49;00m.maker.inputs[i].variable)[90m[39;49;00m
                        [94mif[39;49;00m [96mlen[39;49;00m(e.args) == [94m1[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + e.args[[94m0[39;49;00m],[90m[39;49;00m
                            )[90m[39;49;00m
                        [94melse[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                            ) + e.args[90m[39;49;00m
                        [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                        [94mraise[39;49;00m[90m[39;49;00m
                arg_container.provided += [94m1[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
        [90m# Set keyword arguments[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m kwargs:  [90m# for speed, skip the items for empty kwargs[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m k, arg [95min[39;49;00m kwargs.items():[90m[39;49;00m
                [96mself[39;49;00m[k] = arg[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m [95mnot[39;49;00m trust_input:[90m[39;49;00m
            [90m# Collect aliased inputs among the storage space[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m potential_group [95min[39;49;00m [96mself[39;49;00m._potential_aliased_input_groups:[90m[39;49;00m
                args_share_memory: [96mlist[39;49;00m[[96mlist[39;49;00m[[96mint[39;49;00m]] = [][90m[39;49;00m
                [94mfor[39;49;00m i [95min[39;49;00m potential_group:[90m[39;49;00m
                    i_type = [96mself[39;49;00m.maker.inputs[i].variable.type[90m[39;49;00m
                    i_val = input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
    [90m[39;49;00m
                    [90m# Check if value is aliased with any of the values in one of the groups[39;49;00m[90m[39;49;00m
                    [94mfor[39;49;00m j_group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                        [94mif[39;49;00m [96many[39;49;00m([90m[39;49;00m
                            i_type.may_share_memory(input_storage[j].storage[[94m0[39;49;00m], i_val)[90m[39;49;00m
                            [94mfor[39;49;00m j [95min[39;49;00m j_group[90m[39;49;00m
                        ):[90m[39;49;00m
                            j_group.append(i)[90m[39;49;00m
                            [94mbreak[39;49;00m[90m[39;49;00m
                    [94melse[39;49;00m:  [90m# no break[39;49;00m[90m[39;49;00m
                        [90m# Create a new group[39;49;00m[90m[39;49;00m
                        args_share_memory.append([i])[90m[39;49;00m
    [90m[39;49;00m
                [90m# Check for groups of more than one argument that share memory[39;49;00m[90m[39;49;00m
                [94mfor[39;49;00m group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                    [94mif[39;49;00m [96mlen[39;49;00m(group) > [94m1[39;49;00m:[90m[39;49;00m
                        [90m# copy all but the first[39;49;00m[90m[39;49;00m
                        [94mfor[39;49;00m i [95min[39;49;00m group[[94m1[39;49;00m:]:[90m[39;49;00m
                            input_storage[i].storage[[94m0[39;49;00m] = copy.copy([90m[39;49;00m
                                input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
                            )[90m[39;49;00m
    [90m[39;49;00m
            [90m# Check if inputs are missing, or if inputs were set more than once, or[39;49;00m[90m[39;49;00m
            [90m# if we tried to provide inputs that are supposed to be implicit.[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                [94mif[39;49;00m arg_container.required [95mand[39;49;00m [95mnot[39;49;00m arg_container.provided:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMissing required input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.provided > [94m1[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMultiple values for input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.implicit [95mand[39;49;00m arg_container.provided > [94m0[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mTried to provide value for implicit input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
    [90m[39;49;00m
        [90m# Do the actual work[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0_fn = time.perf_counter()[90m[39;49;00m
        [94mtry[39;49;00m:[90m[39;49;00m
>           outputs = vm() [94mif[39;49;00m output_subset [95mis[39;49;00m [94mNone[39;49;00m [94melse[39;49;00m vm(output_subset=output_subset)[90m[39;49;00m
                      ^^^^[90m[39;49;00m
[1m[31mE           pymc.logprob.utils.ParameterValueError: [0m
[1m[31mE           Apply node that caused the error: Check{}([[-22.3377 ... 93983518]], False)[0m
[1m[31mE           Toposort index: 0[0m
[1m[31mE           Inputs types: [TensorType(float64, shape=(1, 2)), ScalarType(bool)][0m
[1m[31mE           Inputs shapes: [(1, 2), ()][0m
[1m[31mE           Inputs strides: [(16, 8), ()][0m
[1m[31mE           Inputs values: [array([[-22.33773045, -19.93983518]]), np.False_][0m
[1m[31mE           Inputs type_num: [12, 0][0m
[1m[31mE           Outputs clients: [[DeepCopyOp(Check{}.0)]][0m
[1m[31mE           [0m
[1m[31mE           Backtrace when the node is created (use PyTensor flag traceback__limit=N to make it longer):[0m
[1m[31mE             File "/app/pymc/logprob/basic.py", line 193, in logp[0m
[1m[31mE               return _logprob_helper(rv, value, **kwargs)[0m
[1m[31mE             File "/app/pymc/logprob/abstract.py", line 70, in _logprob_helper[0m
[1m[31mE               logprob = _logprob(rv.owner.op, values, *rv.owner.inputs, **kwargs)[0m
[1m[31mE             File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/functools.py", line 982, in wrapper[0m
[1m[31mE               return dispatch(args[0].__class__)(*args, **kw)[0m
[1m[31mE             File "/app/pymc/distributions/distribution.py", line 140, in logp[0m
[1m[31mE               return class_logp(value, *dist_params)[0m
[1m[31mE             File "/app/tests/distributions/test_dist_math.py", line 96, in logp[0m
[1m[31mE               return check_parameters([0m
[1m[31mE             File "/app/pymc/distributions/dist_math.py", line 72, in check_parameters[0m
[1m[31mE               return CheckParameterValue(msg, can_be_replaced_by_ninf)(expr, all_true_scalar)[0m
[1m[31mE             File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/graph/op.py", line 294, in __call__[0m
[1m[31mE               node = self.make_node(*inputs, **kwargs)[0m
[1m[31mE             File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/raise_op.py", line 81, in make_node[0m
[1m[31mE               [value.type()],[0m
[1m[31mE           [0m
[1m[31mE           Debug print of the apply node: [0m
[1m[31mE           Check{} [id A] <Matrix(float64, shape=(1, 2))>[0m
[1m[31mE            ├─ [[-22.3377 ... 93983518]] [id B] <Matrix(float64, shape=(1, 2))>[0m
[1m[31mE            └─ False [id C] <bool>[0m
[1m[31mE           [0m
[1m[31mE           Storage map footprint:[0m
[1m[31mE            - [[-22.3377 ... 93983518]], Shape: (1, 2), ElemSize: 8 Byte(s), TotalSize: 16 Byte(s)[0m
[1m[31mE            - False, Shape: (), ElemSize: 1 Byte(s), TotalSize: 1.0 Byte(s)[0m
[1m[31mE            TotalSize: 17.0 Byte(s) 0.000 GB[0m
[1m[31mE            TotalSize inputs: 17.0 Byte(s) 0.000 GB[0m

[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/compile/function/types.py[0m:1038: ParameterValueError
[31m[1m_______ TestMatchesScipy.test_multinomial_vectorized[extra_size0-p1-n2] ________[0m

self = <pytensor.compile.function.types.Function object at 0x7f0b9e22fe30>
output_subset = None, args = (), kwargs = {}, trust_input = False
vm = <pytensor.link.c.cvm.CVM object at 0x7f0b9c577750>, profile = None

    [0m[94mdef[39;49;00m[90m [39;49;00m[92m__call__[39;49;00m([96mself[39;49;00m, *args, output_subset=[94mNone[39;49;00m, **kwargs):[90m[39;49;00m
    [90m    [39;49;00m[33m"""[39;49;00m
    [33m    Evaluates value of a function on given arguments.[39;49;00m
    [33m[39;49;00m
    [33m    Parameters[39;49;00m
    [33m    ----------[39;49;00m
    [33m    args : list[39;49;00m
    [33m        List of inputs to the function. All inputs are required, even when[39;49;00m
    [33m        some of them are not necessary to calculate requested subset of[39;49;00m
    [33m        outputs.[39;49;00m
    [33m[39;49;00m
    [33m    kwargs : dict[39;49;00m
    [33m        The function inputs can be passed as keyword argument. For this, use[39;49;00m
    [33m        the name of the input or the input instance as the key.[39;49;00m
    [33m[39;49;00m
    [33m        Keyword argument ``output_subset`` is a list of either indices of the[39;49;00m
    [33m        function's outputs or the keys belonging to the `output_keys` dict[39;49;00m
    [33m        and represent outputs that are requested to be calculated. Regardless[39;49;00m
    [33m        of the presence of ``output_subset``, the updates are always calculated[39;49;00m
    [33m        and processed. To disable the updates, you should use the ``copy``[39;49;00m
    [33m        method with ``delete_updates=True``.[39;49;00m
    [33m[39;49;00m
    [33m    Returns[39;49;00m
    [33m    -------[39;49;00m
    [33m    list[39;49;00m
    [33m        List of outputs on indices/keys from ``output_subset`` or all of them,[39;49;00m
    [33m        if ``output_subset`` is not passed.[39;49;00m
    [33m    """[39;49;00m[90m[39;49;00m
        trust_input = [96mself[39;49;00m.trust_input[90m[39;49;00m
        input_storage = [96mself[39;49;00m.input_storage[90m[39;49;00m
        vm = [96mself[39;49;00m.vm[90m[39;49;00m
        profile = [96mself[39;49;00m.profile[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0 = time.perf_counter()[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m output_subset [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
            warnings.warn([33m"[39;49;00m[33moutput_subset is deprecated.[39;49;00m[33m"[39;49;00m, [96mFutureWarning[39;49;00m)[90m[39;49;00m
            [94mif[39;49;00m [96mself[39;49;00m.output_keys [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                output_subset = [[96mself[39;49;00m.output_keys.index(key) [94mfor[39;49;00m key [95min[39;49;00m output_subset][90m[39;49;00m
    [90m[39;49;00m
        [90m# Reinitialize each container's 'provided' counter[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m trust_input:[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
        [94melse[39;49;00m:[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                arg_container.provided = [94m0[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
            [94mif[39;49;00m [96mlen[39;49;00m(args) + [96mlen[39;49;00m(kwargs) > [96mlen[39;49;00m(input_storage):[90m[39;49;00m
                [94mraise[39;49;00m [96mTypeError[39;49;00m([33m"[39;49;00m[33mToo many parameter passed to pytensor function[39;49;00m[33m"[39;49;00m)[90m[39;49;00m
    [90m[39;49;00m
            [90m# Set positional arguments[39;49;00m[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                [90m# See discussion about None as input[39;49;00m[90m[39;49;00m
                [90m# https://groups.google.com/group/theano-dev/browse_thread/thread/920a5e904e8a8525/4f1b311a28fc27e5[39;49;00m[90m[39;49;00m
                [94mif[39;49;00m arg [95mis[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                    arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
                [94melse[39;49;00m:[90m[39;49;00m
                    [94mtry[39;49;00m:[90m[39;49;00m
                        arg_container.storage[[94m0[39;49;00m] = arg_container.type.filter([90m[39;49;00m
                            arg,[90m[39;49;00m
                            strict=arg_container.strict,[90m[39;49;00m
                            allow_downcast=arg_container.allow_downcast,[90m[39;49;00m
                        )[90m[39;49;00m
    [90m[39;49;00m
                    [94mexcept[39;49;00m [96mException[39;49;00m [94mas[39;49;00m e:[90m[39;49;00m
                        i = input_storage.index(arg_container)[90m[39;49;00m
                        function_name = [33m"[39;49;00m[33mpytensor function[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        argument_name = [33m"[39;49;00m[33margument[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mself[39;49;00m.name:[90m[39;49;00m
                            function_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + [96mself[39;49;00m.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mhasattr[39;49;00m(arg, [33m"[39;49;00m[33mname[39;49;00m[33m"[39;49;00m) [95mand[39;49;00m arg.name:[90m[39;49;00m
                            argument_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + arg.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        where = get_variable_trace_string([96mself[39;49;00m.maker.inputs[i].variable)[90m[39;49;00m
                        [94mif[39;49;00m [96mlen[39;49;00m(e.args) == [94m1[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + e.args[[94m0[39;49;00m],[90m[39;49;00m
                            )[90m[39;49;00m
                        [94melse[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                            ) + e.args[90m[39;49;00m
                        [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                        [94mraise[39;49;00m[90m[39;49;00m
                arg_container.provided += [94m1[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
        [90m# Set keyword arguments[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m kwargs:  [90m# for speed, skip the items for empty kwargs[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m k, arg [95min[39;49;00m kwargs.items():[90m[39;49;00m
                [96mself[39;49;00m[k] = arg[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m [95mnot[39;49;00m trust_input:[90m[39;49;00m
            [90m# Collect aliased inputs among the storage space[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m potential_group [95min[39;49;00m [96mself[39;49;00m._potential_aliased_input_groups:[90m[39;49;00m
                args_share_memory: [96mlist[39;49;00m[[96mlist[39;49;00m[[96mint[39;49;00m]] = [][90m[39;49;00m
                [94mfor[39;49;00m i [95min[39;49;00m potential_group:[90m[39;49;00m
                    i_type = [96mself[39;49;00m.maker.inputs[i].variable.type[90m[39;49;00m
                    i_val = input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
    [90m[39;49;00m
                    [90m# Check if value is aliased with any of the values in one of the groups[39;49;00m[90m[39;49;00m
                    [94mfor[39;49;00m j_group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                        [94mif[39;49;00m [96many[39;49;00m([90m[39;49;00m
                            i_type.may_share_memory(input_storage[j].storage[[94m0[39;49;00m], i_val)[90m[39;49;00m
                            [94mfor[39;49;00m j [95min[39;49;00m j_group[90m[39;49;00m
                        ):[90m[39;49;00m
                            j_group.append(i)[90m[39;49;00m
                            [94mbreak[39;49;00m[90m[39;49;00m
                    [94melse[39;49;00m:  [90m# no break[39;49;00m[90m[39;49;00m
                        [90m# Create a new group[39;49;00m[90m[39;49;00m
                        args_share_memory.append([i])[90m[39;49;00m
    [90m[39;49;00m
                [90m# Check for groups of more than one argument that share memory[39;49;00m[90m[39;49;00m
                [94mfor[39;49;00m group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                    [94mif[39;49;00m [96mlen[39;49;00m(group) > [94m1[39;49;00m:[90m[39;49;00m
                        [90m# copy all but the first[39;49;00m[90m[39;49;00m
                        [94mfor[39;49;00m i [95min[39;49;00m group[[94m1[39;49;00m:]:[90m[39;49;00m
                            input_storage[i].storage[[94m0[39;49;00m] = copy.copy([90m[39;49;00m
                                input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
                            )[90m[39;49;00m
    [90m[39;49;00m
            [90m# Check if inputs are missing, or if inputs were set more than once, or[39;49;00m[90m[39;49;00m
            [90m# if we tried to provide inputs that are supposed to be implicit.[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                [94mif[39;49;00m arg_container.required [95mand[39;49;00m [95mnot[39;49;00m arg_container.provided:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMissing required input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.provided > [94m1[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMultiple values for input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.implicit [95mand[39;49;00m arg_container.provided > [94m0[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mTried to provide value for implicit input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
    [90m[39;49;00m
        [90m# Do the actual work[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0_fn = time.perf_counter()[90m[39;49;00m
        [94mtry[39;49;00m:[90m[39;49;00m
>           outputs = vm() [94mif[39;49;00m output_subset [95mis[39;49;00m [94mNone[39;49;00m [94melse[39;49;00m vm(output_subset=output_subset)[90m[39;49;00m
                      ^^^^[90m[39;49;00m
[1m[31mE           pymc.logprob.utils.ParameterValueError[0m

[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/compile/function/types.py[0m:1038: ParameterValueError

[33mDuring handling of the above exception, another exception occurred:[0m

self = <tests.distributions.test_multivariate.TestMatchesScipy object at 0x7f0bb35c7340>
n = array([[ 5,  6],
       [10, 11]])
p = array([[0.2 , 0.3 , 0.5 ],
       [0.9 , 0.09, 0.01]]), extra_size = (1,)

    [0m[37m@pytest[39;49;00m.mark.parametrize([33m"[39;49;00m[33mn[39;49;00m[33m"[39;49;00m, [([94m10[39;49;00m), ([[94m10[39;49;00m, [94m11[39;49;00m]), ([[[94m5[39;49;00m, [94m6[39;49;00m], [[94m10[39;49;00m, [94m11[39;49;00m]])])[90m[39;49;00m
    [37m@pytest[39;49;00m.mark.parametrize([90m[39;49;00m
        [33m"[39;49;00m[33mp[39;49;00m[33m"[39;49;00m,[90m[39;49;00m
        [[90m[39;49;00m
            ([[94m0.2[39;49;00m, [94m0.3[39;49;00m, [94m0.5[39;49;00m]),[90m[39;49;00m
            ([[[94m0.2[39;49;00m, [94m0.3[39;49;00m, [94m0.5[39;49;00m], [[94m0.9[39;49;00m, [94m0.09[39;49;00m, [94m0.01[39;49;00m]]),[90m[39;49;00m
            (np.abs(np.random.randn([94m2[39;49;00m, [94m2[39;49;00m, [94m4[39;49;00m))),[90m[39;49;00m
        ],[90m[39;49;00m
    )[90m[39;49;00m
    [37m@pytest[39;49;00m.mark.parametrize([33m"[39;49;00m[33mextra_size[39;49;00m[33m"[39;49;00m, [([94m1[39;49;00m,), ([94m2[39;49;00m,), ([94m2[39;49;00m, [94m3[39;49;00m)])[90m[39;49;00m
    [94mdef[39;49;00m[90m [39;49;00m[92mtest_multinomial_vectorized[39;49;00m([96mself[39;49;00m, n, p, extra_size):[90m[39;49;00m
        n = np.array(n)[90m[39;49;00m
        p = np.array(p)[90m[39;49;00m
        p /= p.sum(axis=-[94m1[39;49;00m, keepdims=[94mTrue[39;49;00m)[90m[39;49;00m
    [90m[39;49;00m
        _, bcast_p = broadcast_params([n, p], ndims_params=[[94m0[39;49;00m, [94m1[39;49;00m])[90m[39;49;00m
        size = extra_size + bcast_p.shape[:-[94m1[39;49;00m][90m[39;49;00m
    [90m[39;49;00m
        mn = pm.Multinomial.dist(n=n, p=p, size=size)[90m[39;49;00m
        vals = mn.eval()[90m[39;49;00m
    [90m[39;49;00m
        npt.assert_almost_equal([90m[39;49;00m
            st.multinomial.logpmf(vals, n, p),[90m[39;49;00m
>           pm.logp(mn, vals).eval(),[90m[39;49;00m
            ^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
            decimal=[94m4[39;49;00m,[90m[39;49;00m
            err_msg=[33mf[39;49;00m[33m"[39;49;00m[33mvals=[39;49;00m[33m{[39;49;00mvals[33m}[39;49;00m[33m"[39;49;00m,[90m[39;49;00m
        )[90m[39;49;00m

[1m[31mtests/distributions/test_multivariate.py[0m:692:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/graph/basic.py[0m:668: in eval
    [0m[94mreturn[39;49;00m fn(*args)[90m[39;49;00m
           ^^^^^^^^^[90m[39;49;00m
[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/compile/function/types.py[0m:1048: in __call__
    [0mraise_with_op([90m[39;49;00m
[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/link/utils.py[0m:526: in raise_with_op
    [0m[94mraise[39;49;00m exc_value.with_traceback(exc_trace)[90m[39;49;00m
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <pytensor.compile.function.types.Function object at 0x7f0b9e22fe30>
output_subset = None, args = (), kwargs = {}, trust_input = False
vm = <pytensor.link.c.cvm.CVM object at 0x7f0b9c577750>, profile = None

    [0m[94mdef[39;49;00m[90m [39;49;00m[92m__call__[39;49;00m([96mself[39;49;00m, *args, output_subset=[94mNone[39;49;00m, **kwargs):[90m[39;49;00m
    [90m    [39;49;00m[33m"""[39;49;00m
    [33m    Evaluates value of a function on given arguments.[39;49;00m
    [33m[39;49;00m
    [33m    Parameters[39;49;00m
    [33m    ----------[39;49;00m
    [33m    args : list[39;49;00m
    [33m        List of inputs to the function. All inputs are required, even when[39;49;00m
    [33m        some of them are not necessary to calculate requested subset of[39;49;00m
    [33m        outputs.[39;49;00m
    [33m[39;49;00m
    [33m    kwargs : dict[39;49;00m
    [33m        The function inputs can be passed as keyword argument. For this, use[39;49;00m
    [33m        the name of the input or the input instance as the key.[39;49;00m
    [33m[39;49;00m
    [33m        Keyword argument ``output_subset`` is a list of either indices of the[39;49;00m
    [33m        function's outputs or the keys belonging to the `output_keys` dict[39;49;00m
    [33m        and represent outputs that are requested to be calculated. Regardless[39;49;00m
    [33m        of the presence of ``output_subset``, the updates are always calculated[39;49;00m
    [33m        and processed. To disable the updates, you should use the ``copy``[39;49;00m
    [33m        method with ``delete_updates=True``.[39;49;00m
    [33m[39;49;00m
    [33m    Returns[39;49;00m
    [33m    -------[39;49;00m
    [33m    list[39;49;00m
    [33m        List of outputs on indices/keys from ``output_subset`` or all of them,[39;49;00m
    [33m        if ``output_subset`` is not passed.[39;49;00m
    [33m    """[39;49;00m[90m[39;49;00m
        trust_input = [96mself[39;49;00m.trust_input[90m[39;49;00m
        input_storage = [96mself[39;49;00m.input_storage[90m[39;49;00m
        vm = [96mself[39;49;00m.vm[90m[39;49;00m
        profile = [96mself[39;49;00m.profile[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0 = time.perf_counter()[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m output_subset [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
            warnings.warn([33m"[39;49;00m[33moutput_subset is deprecated.[39;49;00m[33m"[39;49;00m, [96mFutureWarning[39;49;00m)[90m[39;49;00m
            [94mif[39;49;00m [96mself[39;49;00m.output_keys [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                output_subset = [[96mself[39;49;00m.output_keys.index(key) [94mfor[39;49;00m key [95min[39;49;00m output_subset][90m[39;49;00m
    [90m[39;49;00m
        [90m# Reinitialize each container's 'provided' counter[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m trust_input:[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
        [94melse[39;49;00m:[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                arg_container.provided = [94m0[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
            [94mif[39;49;00m [96mlen[39;49;00m(args) + [96mlen[39;49;00m(kwargs) > [96mlen[39;49;00m(input_storage):[90m[39;49;00m
                [94mraise[39;49;00m [96mTypeError[39;49;00m([33m"[39;49;00m[33mToo many parameter passed to pytensor function[39;49;00m[33m"[39;49;00m)[90m[39;49;00m
    [90m[39;49;00m
            [90m# Set positional arguments[39;49;00m[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                [90m# See discussion about None as input[39;49;00m[90m[39;49;00m
                [90m# https://groups.google.com/group/theano-dev/browse_thread/thread/920a5e904e8a8525/4f1b311a28fc27e5[39;49;00m[90m[39;49;00m
                [94mif[39;49;00m arg [95mis[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                    arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
                [94melse[39;49;00m:[90m[39;49;00m
                    [94mtry[39;49;00m:[90m[39;49;00m
                        arg_container.storage[[94m0[39;49;00m] = arg_container.type.filter([90m[39;49;00m
                            arg,[90m[39;49;00m
                            strict=arg_container.strict,[90m[39;49;00m
                            allow_downcast=arg_container.allow_downcast,[90m[39;49;00m
                        )[90m[39;49;00m
    [90m[39;49;00m
                    [94mexcept[39;49;00m [96mException[39;49;00m [94mas[39;49;00m e:[90m[39;49;00m
                        i = input_storage.index(arg_container)[90m[39;49;00m
                        function_name = [33m"[39;49;00m[33mpytensor function[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        argument_name = [33m"[39;49;00m[33margument[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mself[39;49;00m.name:[90m[39;49;00m
                            function_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + [96mself[39;49;00m.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mhasattr[39;49;00m(arg, [33m"[39;49;00m[33mname[39;49;00m[33m"[39;49;00m) [95mand[39;49;00m arg.name:[90m[39;49;00m
                            argument_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + arg.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        where = get_variable_trace_string([96mself[39;49;00m.maker.inputs[i].variable)[90m[39;49;00m
                        [94mif[39;49;00m [96mlen[39;49;00m(e.args) == [94m1[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + e.args[[94m0[39;49;00m],[90m[39;49;00m
                            )[90m[39;49;00m
                        [94melse[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                            ) + e.args[90m[39;49;00m
                        [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                        [94mraise[39;49;00m[90m[39;49;00m
                arg_container.provided += [94m1[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
        [90m# Set keyword arguments[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m kwargs:  [90m# for speed, skip the items for empty kwargs[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m k, arg [95min[39;49;00m kwargs.items():[90m[39;49;00m
                [96mself[39;49;00m[k] = arg[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m [95mnot[39;49;00m trust_input:[90m[39;49;00m
            [90m# Collect aliased inputs among the storage space[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m potential_group [95min[39;49;00m [96mself[39;49;00m._potential_aliased_input_groups:[90m[39;49;00m
                args_share_memory: [96mlist[39;49;00m[[96mlist[39;49;00m[[96mint[39;49;00m]] = [][90m[39;49;00m
                [94mfor[39;49;00m i [95min[39;49;00m potential_group:[90m[39;49;00m
                    i_type = [96mself[39;49;00m.maker.inputs[i].variable.type[90m[39;49;00m
                    i_val = input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
    [90m[39;49;00m
                    [90m# Check if value is aliased with any of the values in one of the groups[39;49;00m[90m[39;49;00m
                    [94mfor[39;49;00m j_group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                        [94mif[39;49;00m [96many[39;49;00m([90m[39;49;00m
                            i_type.may_share_memory(input_storage[j].storage[[94m0[39;49;00m], i_val)[90m[39;49;00m
                            [94mfor[39;49;00m j [95min[39;49;00m j_group[90m[39;49;00m
                        ):[90m[39;49;00m
                            j_group.append(i)[90m[39;49;00m
                            [94mbreak[39;49;00m[90m[39;49;00m
                    [94melse[39;49;00m:  [90m# no break[39;49;00m[90m[39;49;00m
                        [90m# Create a new group[39;49;00m[90m[39;49;00m
                        args_share_memory.append([i])[90m[39;49;00m
    [90m[39;49;00m
                [90m# Check for groups of more than one argument that share memory[39;49;00m[90m[39;49;00m
                [94mfor[39;49;00m group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                    [94mif[39;49;00m [96mlen[39;49;00m(group) > [94m1[39;49;00m:[90m[39;49;00m
                        [90m# copy all but the first[39;49;00m[90m[39;49;00m
                        [94mfor[39;49;00m i [95min[39;49;00m group[[94m1[39;49;00m:]:[90m[39;49;00m
                            input_storage[i].storage[[94m0[39;49;00m] = copy.copy([90m[39;49;00m
                                input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
                            )[90m[39;49;00m
    [90m[39;49;00m
            [90m# Check if inputs are missing, or if inputs were set more than once, or[39;49;00m[90m[39;49;00m
            [90m# if we tried to provide inputs that are supposed to be implicit.[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                [94mif[39;49;00m arg_container.required [95mand[39;49;00m [95mnot[39;49;00m arg_container.provided:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMissing required input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.provided > [94m1[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMultiple values for input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.implicit [95mand[39;49;00m arg_container.provided > [94m0[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mTried to provide value for implicit input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
    [90m[39;49;00m
        [90m# Do the actual work[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0_fn = time.perf_counter()[90m[39;49;00m
        [94mtry[39;49;00m:[90m[39;49;00m
>           outputs = vm() [94mif[39;49;00m output_subset [95mis[39;49;00m [94mNone[39;49;00m [94melse[39;49;00m vm(output_subset=output_subset)[90m[39;49;00m
                      ^^^^[90m[39;49;00m
[1m[31mE           pymc.logprob.utils.ParameterValueError: [0m
[1m[31mE           Apply node that caused the error: Check{}([[[-46.838 ... 2354329]]], False)[0m
[1m[31mE           Toposort index: 0[0m
[1m[31mE           Inputs types: [TensorType(float64, shape=(1, 2, 2)), ScalarType(bool)][0m
[1m[31mE           Inputs shapes: [(1, 2, 2), ()][0m
[1m[31mE           Inputs strides: [(32, 16, 8), ()][0m
[1m[31mE           Inputs values: [array([[[-46.83835939, -45.04659992],[0m
[1m[31mE                   [-36.52143856, -34.12354329]]]), np.False_][0m
[1m[31mE           Inputs type_num: [12, 0][0m
[1m[31mE           Outputs clients: [[DeepCopyOp(Check{}.0)]][0m
[1m[31mE           [0m
[1m[31mE           Backtrace when the node is created (use PyTensor flag traceback__limit=N to make it longer):[0m
[1m[31mE             File "/app/pymc/logprob/basic.py", line 193, in logp[0m
[1m[31mE               return _logprob_helper(rv, value, **kwargs)[0m
[1m[31mE             File "/app/pymc/logprob/abstract.py", line 70, in _logprob_helper[0m
[1m[31mE               logprob = _logprob(rv.owner.op, values, *rv.owner.inputs, **kwargs)[0m
[1m[31mE             File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/functools.py", line 982, in wrapper[0m
[1m[31mE               return dispatch(args[0].__class__)(*args, **kw)[0m
[1m[31mE             File "/app/pymc/distributions/distribution.py", line 140, in logp[0m
[1m[31mE               return class_logp(value, *dist_params)[0m
[1m[31mE             File "/app/tests/distributions/test_dist_math.py", line 96, in logp[0m
[1m[31mE               return check_parameters([0m
[1m[31mE             File "/app/pymc/distributions/dist_math.py", line 72, in check_parameters[0m
[1m[31mE               return CheckParameterValue(msg, can_be_replaced_by_ninf)(expr, all_true_scalar)[0m
[1m[31mE             File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/graph/op.py", line 294, in __call__[0m
[1m[31mE               node = self.make_node(*inputs, **kwargs)[0m
[1m[31mE             File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/raise_op.py", line 81, in make_node[0m
[1m[31mE               [value.type()],[0m
[1m[31mE           [0m
[1m[31mE           Debug print of the apply node: [0m
[1m[31mE           Check{} [id A] <Tensor3(float64, shape=(1, 2, 2))>[0m
[1m[31mE            ├─ [[[-46.838 ... 2354329]]] [id B] <Tensor3(float64, shape=(1, 2, 2))>[0m
[1m[31mE            └─ False [id C] <bool>[0m
[1m[31mE           [0m
[1m[31mE           Storage map footprint:[0m
[1m[31mE            - [[[-46.838 ... 2354329]]], Shape: (1, 2, 2), ElemSize: 8 Byte(s), TotalSize: 32 Byte(s)[0m
[1m[31mE            - False, Shape: (), ElemSize: 1 Byte(s), TotalSize: 1.0 Byte(s)[0m
[1m[31mE            TotalSize: 33.0 Byte(s) 0.000 GB[0m
[1m[31mE            TotalSize inputs: 33.0 Byte(s) 0.000 GB[0m

[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/compile/function/types.py[0m:1038: ParameterValueError
[31m[1m_______ TestMatchesScipy.test_multinomial_vectorized[extra_size0-p2-10] ________[0m

self = <pytensor.compile.function.types.Function object at 0x7f0ba0bd97f0>
output_subset = None, args = (), kwargs = {}, trust_input = False
vm = <pytensor.link.c.cvm.CVM object at 0x7f0b9c576c50>, profile = None

    [0m[94mdef[39;49;00m[90m [39;49;00m[92m__call__[39;49;00m([96mself[39;49;00m, *args, output_subset=[94mNone[39;49;00m, **kwargs):[90m[39;49;00m
    [90m    [39;49;00m[33m"""[39;49;00m
    [33m    Evaluates value of a function on given arguments.[39;49;00m
    [33m[39;49;00m
    [33m    Parameters[39;49;00m
    [33m    ----------[39;49;00m
    [33m    args : list[39;49;00m
    [33m        List of inputs to the function. All inputs are required, even when[39;49;00m
    [33m        some of them are not necessary to calculate requested subset of[39;49;00m
    [33m        outputs.[39;49;00m
    [33m[39;49;00m
    [33m    kwargs : dict[39;49;00m
    [33m        The function inputs can be passed as keyword argument. For this, use[39;49;00m
    [33m        the name of the input or the input instance as the key.[39;49;00m
    [33m[39;49;00m
    [33m        Keyword argument ``output_subset`` is a list of either indices of the[39;49;00m
    [33m        function's outputs or the keys belonging to the `output_keys` dict[39;49;00m
    [33m        and represent outputs that are requested to be calculated. Regardless[39;49;00m
    [33m        of the presence of ``output_subset``, the updates are always calculated[39;49;00m
    [33m        and processed. To disable the updates, you should use the ``copy``[39;49;00m
    [33m        method with ``delete_updates=True``.[39;49;00m
    [33m[39;49;00m
    [33m    Returns[39;49;00m
    [33m    -------[39;49;00m
    [33m    list[39;49;00m
    [33m        List of outputs on indices/keys from ``output_subset`` or all of them,[39;49;00m
    [33m        if ``output_subset`` is not passed.[39;49;00m
    [33m    """[39;49;00m[90m[39;49;00m
        trust_input = [96mself[39;49;00m.trust_input[90m[39;49;00m
        input_storage = [96mself[39;49;00m.input_storage[90m[39;49;00m
        vm = [96mself[39;49;00m.vm[90m[39;49;00m
        profile = [96mself[39;49;00m.profile[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0 = time.perf_counter()[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m output_subset [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
            warnings.warn([33m"[39;49;00m[33moutput_subset is deprecated.[39;49;00m[33m"[39;49;00m, [96mFutureWarning[39;49;00m)[90m[39;49;00m
            [94mif[39;49;00m [96mself[39;49;00m.output_keys [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                output_subset = [[96mself[39;49;00m.output_keys.index(key) [94mfor[39;49;00m key [95min[39;49;00m output_subset][90m[39;49;00m
    [90m[39;49;00m
        [90m# Reinitialize each container's 'provided' counter[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m trust_input:[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
        [94melse[39;49;00m:[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                arg_container.provided = [94m0[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
            [94mif[39;49;00m [96mlen[39;49;00m(args) + [96mlen[39;49;00m(kwargs) > [96mlen[39;49;00m(input_storage):[90m[39;49;00m
                [94mraise[39;49;00m [96mTypeError[39;49;00m([33m"[39;49;00m[33mToo many parameter passed to pytensor function[39;49;00m[33m"[39;49;00m)[90m[39;49;00m
    [90m[39;49;00m
            [90m# Set positional arguments[39;49;00m[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                [90m# See discussion about None as input[39;49;00m[90m[39;49;00m
                [90m# https://groups.google.com/group/theano-dev/browse_thread/thread/920a5e904e8a8525/4f1b311a28fc27e5[39;49;00m[90m[39;49;00m
                [94mif[39;49;00m arg [95mis[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                    arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
                [94melse[39;49;00m:[90m[39;49;00m
                    [94mtry[39;49;00m:[90m[39;49;00m
                        arg_container.storage[[94m0[39;49;00m] = arg_container.type.filter([90m[39;49;00m
                            arg,[90m[39;49;00m
                            strict=arg_container.strict,[90m[39;49;00m
                            allow_downcast=arg_container.allow_downcast,[90m[39;49;00m
                        )[90m[39;49;00m
    [90m[39;49;00m
                    [94mexcept[39;49;00m [96mException[39;49;00m [94mas[39;49;00m e:[90m[39;49;00m
                        i = input_storage.index(arg_container)[90m[39;49;00m
                        function_name = [33m"[39;49;00m[33mpytensor function[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        argument_name = [33m"[39;49;00m[33margument[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mself[39;49;00m.name:[90m[39;49;00m
                            function_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + [96mself[39;49;00m.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mhasattr[39;49;00m(arg, [33m"[39;49;00m[33mname[39;49;00m[33m"[39;49;00m) [95mand[39;49;00m arg.name:[90m[39;49;00m
                            argument_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + arg.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        where = get_variable_trace_string([96mself[39;49;00m.maker.inputs[i].variable)[90m[39;49;00m
                        [94mif[39;49;00m [96mlen[39;49;00m(e.args) == [94m1[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + e.args[[94m0[39;49;00m],[90m[39;49;00m
                            )[90m[39;49;00m
                        [94melse[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                            ) + e.args[90m[39;49;00m
                        [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                        [94mraise[39;49;00m[90m[39;49;00m
                arg_container.provided += [94m1[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
        [90m# Set keyword arguments[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m kwargs:  [90m# for speed, skip the items for empty kwargs[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m k, arg [95min[39;49;00m kwargs.items():[90m[39;49;00m
                [96mself[39;49;00m[k] = arg[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m [95mnot[39;49;00m trust_input:[90m[39;49;00m
            [90m# Collect aliased inputs among the storage space[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m potential_group [95min[39;49;00m [96mself[39;49;00m._potential_aliased_input_groups:[90m[39;49;00m
                args_share_memory: [96mlist[39;49;00m[[96mlist[39;49;00m[[96mint[39;49;00m]] = [][90m[39;49;00m
                [94mfor[39;49;00m i [95min[39;49;00m potential_group:[90m[39;49;00m
                    i_type = [96mself[39;49;00m.maker.inputs[i].variable.type[90m[39;49;00m
                    i_val = input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
    [90m[39;49;00m
                    [90m# Check if value is aliased with any of the values in one of the groups[39;49;00m[90m[39;49;00m
                    [94mfor[39;49;00m j_group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                        [94mif[39;49;00m [96many[39;49;00m([90m[39;49;00m
                            i_type.may_share_memory(input_storage[j].storage[[94m0[39;49;00m], i_val)[90m[39;49;00m
                            [94mfor[39;49;00m j [95min[39;49;00m j_group[90m[39;49;00m
                        ):[90m[39;49;00m
                            j_group.append(i)[90m[39;49;00m
                            [94mbreak[39;49;00m[90m[39;49;00m
                    [94melse[39;49;00m:  [90m# no break[39;49;00m[90m[39;49;00m
                        [90m# Create a new group[39;49;00m[90m[39;49;00m
                        args_share_memory.append([i])[90m[39;49;00m
    [90m[39;49;00m
                [90m# Check for groups of more than one argument that share memory[39;49;00m[90m[39;49;00m
                [94mfor[39;49;00m group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                    [94mif[39;49;00m [96mlen[39;49;00m(group) > [94m1[39;49;00m:[90m[39;49;00m
                        [90m# copy all but the first[39;49;00m[90m[39;49;00m
                        [94mfor[39;49;00m i [95min[39;49;00m group[[94m1[39;49;00m:]:[90m[39;49;00m
                            input_storage[i].storage[[94m0[39;49;00m] = copy.copy([90m[39;49;00m
                                input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
                            )[90m[39;49;00m
    [90m[39;49;00m
            [90m# Check if inputs are missing, or if inputs were set more than once, or[39;49;00m[90m[39;49;00m
            [90m# if we tried to provide inputs that are supposed to be implicit.[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                [94mif[39;49;00m arg_container.required [95mand[39;49;00m [95mnot[39;49;00m arg_container.provided:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMissing required input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.provided > [94m1[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMultiple values for input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.implicit [95mand[39;49;00m arg_container.provided > [94m0[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mTried to provide value for implicit input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
    [90m[39;49;00m
        [90m# Do the actual work[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0_fn = time.perf_counter()[90m[39;49;00m
        [94mtry[39;49;00m:[90m[39;49;00m
>           outputs = vm() [94mif[39;49;00m output_subset [95mis[39;49;00m [94mNone[39;49;00m [94melse[39;49;00m vm(output_subset=output_subset)[90m[39;49;00m
                      ^^^^[90m[39;49;00m
[1m[31mE           pymc.logprob.utils.ParameterValueError[0m

[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/compile/function/types.py[0m:1038: ParameterValueError

[33mDuring handling of the above exception, another exception occurred:[0m

self = <tests.distributions.test_multivariate.TestMatchesScipy object at 0x7f0bb35c7390>
n = array(10)
p = array([[[0.17876157, 0.39760757, 0.0449895 , 0.37864137],
        [0.06511207, 0.35563681, 0.30921865, 0.27003247]],

       [[0.2899355 , 0.11278839, 0.36678067, 0.23049544],
        [0.13152157, 0.0916917 , 0.25354174, 0.52324499]]])
extra_size = (1,)

    [0m[37m@pytest[39;49;00m.mark.parametrize([33m"[39;49;00m[33mn[39;49;00m[33m"[39;49;00m, [([94m10[39;49;00m), ([[94m10[39;49;00m, [94m11[39;49;00m]), ([[[94m5[39;49;00m, [94m6[39;49;00m], [[94m10[39;49;00m, [94m11[39;49;00m]])])[90m[39;49;00m
    [37m@pytest[39;49;00m.mark.parametrize([90m[39;49;00m
        [33m"[39;49;00m[33mp[39;49;00m[33m"[39;49;00m,[90m[39;49;00m
        [[90m[39;49;00m
            ([[94m0.2[39;49;00m, [94m0.3[39;49;00m, [94m0.5[39;49;00m]),[90m[39;49;00m
            ([[[94m0.2[39;49;00m, [94m0.3[39;49;00m, [94m0.5[39;49;00m], [[94m0.9[39;49;00m, [94m0.09[39;49;00m, [94m0.01[39;49;00m]]),[90m[39;49;00m
            (np.abs(np.random.randn([94m2[39;49;00m, [94m2[39;49;00m, [94m4[39;49;00m))),[90m[39;49;00m
        ],[90m[39;49;00m
    )[90m[39;49;00m
    [37m@pytest[39;49;00m.mark.parametrize([33m"[39;49;00m[33mextra_size[39;49;00m[33m"[39;49;00m, [([94m1[39;49;00m,), ([94m2[39;49;00m,), ([94m2[39;49;00m, [94m3[39;49;00m)])[90m[39;49;00m
    [94mdef[39;49;00m[90m [39;49;00m[92mtest_multinomial_vectorized[39;49;00m([96mself[39;49;00m, n, p, extra_size):[90m[39;49;00m
        n = np.array(n)[90m[39;49;00m
        p = np.array(p)[90m[39;49;00m
        p /= p.sum(axis=-[94m1[39;49;00m, keepdims=[94mTrue[39;49;00m)[90m[39;49;00m
    [90m[39;49;00m
        _, bcast_p = broadcast_params([n, p], ndims_params=[[94m0[39;49;00m, [94m1[39;49;00m])[90m[39;49;00m
        size = extra_size + bcast_p.shape[:-[94m1[39;49;00m][90m[39;49;00m
    [90m[39;49;00m
        mn = pm.Multinomial.dist(n=n, p=p, size=size)[90m[39;49;00m
        vals = mn.eval()[90m[39;49;00m
    [90m[39;49;00m
        npt.assert_almost_equal([90m[39;49;00m
            st.multinomial.logpmf(vals, n, p),[90m[39;49;00m
>           pm.logp(mn, vals).eval(),[90m[39;49;00m
            ^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
            decimal=[94m4[39;49;00m,[90m[39;49;00m
            err_msg=[33mf[39;49;00m[33m"[39;49;00m[33mvals=[39;49;00m[33m{[39;49;00mvals[33m}[39;49;00m[33m"[39;49;00m,[90m[39;49;00m
        )[90m[39;49;00m

[1m[31mtests/distributions/test_multivariate.py[0m:692:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/graph/basic.py[0m:668: in eval
    [0m[94mreturn[39;49;00m fn(*args)[90m[39;49;00m
           ^^^^^^^^^[90m[39;49;00m
[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/compile/function/types.py[0m:1048: in __call__
    [0mraise_with_op([90m[39;49;00m
[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/link/utils.py[0m:526: in raise_with_op
    [0m[94mraise[39;49;00m exc_value.with_traceback(exc_trace)[90m[39;49;00m
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <pytensor.compile.function.types.Function object at 0x7f0ba0bd97f0>
output_subset = None, args = (), kwargs = {}, trust_input = False
vm = <pytensor.link.c.cvm.CVM object at 0x7f0b9c576c50>, profile = None

    [0m[94mdef[39;49;00m[90m [39;49;00m[92m__call__[39;49;00m([96mself[39;49;00m, *args, output_subset=[94mNone[39;49;00m, **kwargs):[90m[39;49;00m
    [90m    [39;49;00m[33m"""[39;49;00m
    [33m    Evaluates value of a function on given arguments.[39;49;00m
    [33m[39;49;00m
    [33m    Parameters[39;49;00m
    [33m    ----------[39;49;00m
    [33m    args : list[39;49;00m
    [33m        List of inputs to the function. All inputs are required, even when[39;49;00m
    [33m        some of them are not necessary to calculate requested subset of[39;49;00m
    [33m        outputs.[39;49;00m
    [33m[39;49;00m
    [33m    kwargs : dict[39;49;00m
    [33m        The function inputs can be passed as keyword argument. For this, use[39;49;00m
    [33m        the name of the input or the input instance as the key.[39;49;00m
    [33m[39;49;00m
    [33m        Keyword argument ``output_subset`` is a list of either indices of the[39;49;00m
    [33m        function's outputs or the keys belonging to the `output_keys` dict[39;49;00m
    [33m        and represent outputs that are requested to be calculated. Regardless[39;49;00m
    [33m        of the presence of ``output_subset``, the updates are always calculated[39;49;00m
    [33m        and processed. To disable the updates, you should use the ``copy``[39;49;00m
    [33m        method with ``delete_updates=True``.[39;49;00m
    [33m[39;49;00m
    [33m    Returns[39;49;00m
    [33m    -------[39;49;00m
    [33m    list[39;49;00m
    [33m        List of outputs on indices/keys from ``output_subset`` or all of them,[39;49;00m
    [33m        if ``output_subset`` is not passed.[39;49;00m
    [33m    """[39;49;00m[90m[39;49;00m
        trust_input = [96mself[39;49;00m.trust_input[90m[39;49;00m
        input_storage = [96mself[39;49;00m.input_storage[90m[39;49;00m
        vm = [96mself[39;49;00m.vm[90m[39;49;00m
        profile = [96mself[39;49;00m.profile[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0 = time.perf_counter()[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m output_subset [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
            warnings.warn([33m"[39;49;00m[33moutput_subset is deprecated.[39;49;00m[33m"[39;49;00m, [96mFutureWarning[39;49;00m)[90m[39;49;00m
            [94mif[39;49;00m [96mself[39;49;00m.output_keys [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                output_subset = [[96mself[39;49;00m.output_keys.index(key) [94mfor[39;49;00m key [95min[39;49;00m output_subset][90m[39;49;00m
    [90m[39;49;00m
        [90m# Reinitialize each container's 'provided' counter[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m trust_input:[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
        [94melse[39;49;00m:[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                arg_container.provided = [94m0[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
            [94mif[39;49;00m [96mlen[39;49;00m(args) + [96mlen[39;49;00m(kwargs) > [96mlen[39;49;00m(input_storage):[90m[39;49;00m
                [94mraise[39;49;00m [96mTypeError[39;49;00m([33m"[39;49;00m[33mToo many parameter passed to pytensor function[39;49;00m[33m"[39;49;00m)[90m[39;49;00m
    [90m[39;49;00m
            [90m# Set positional arguments[39;49;00m[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                [90m# See discussion about None as input[39;49;00m[90m[39;49;00m
                [90m# https://groups.google.com/group/theano-dev/browse_thread/thread/920a5e904e8a8525/4f1b311a28fc27e5[39;49;00m[90m[39;49;00m
                [94mif[39;49;00m arg [95mis[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                    arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
                [94melse[39;49;00m:[90m[39;49;00m
                    [94mtry[39;49;00m:[90m[39;49;00m
                        arg_container.storage[[94m0[39;49;00m] = arg_container.type.filter([90m[39;49;00m
                            arg,[90m[39;49;00m
                            strict=arg_container.strict,[90m[39;49;00m
                            allow_downcast=arg_container.allow_downcast,[90m[39;49;00m
                        )[90m[39;49;00m
    [90m[39;49;00m
                    [94mexcept[39;49;00m [96mException[39;49;00m [94mas[39;49;00m e:[90m[39;49;00m
                        i = input_storage.index(arg_container)[90m[39;49;00m
                        function_name = [33m"[39;49;00m[33mpytensor function[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        argument_name = [33m"[39;49;00m[33margument[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mself[39;49;00m.name:[90m[39;49;00m
                            function_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + [96mself[39;49;00m.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mhasattr[39;49;00m(arg, [33m"[39;49;00m[33mname[39;49;00m[33m"[39;49;00m) [95mand[39;49;00m arg.name:[90m[39;49;00m
                            argument_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + arg.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        where = get_variable_trace_string([96mself[39;49;00m.maker.inputs[i].variable)[90m[39;49;00m
                        [94mif[39;49;00m [96mlen[39;49;00m(e.args) == [94m1[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + e.args[[94m0[39;49;00m],[90m[39;49;00m
                            )[90m[39;49;00m
                        [94melse[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                            ) + e.args[90m[39;49;00m
                        [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                        [94mraise[39;49;00m[90m[39;49;00m
                arg_container.provided += [94m1[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
        [90m# Set keyword arguments[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m kwargs:  [90m# for speed, skip the items for empty kwargs[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m k, arg [95min[39;49;00m kwargs.items():[90m[39;49;00m
                [96mself[39;49;00m[k] = arg[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m [95mnot[39;49;00m trust_input:[90m[39;49;00m
            [90m# Collect aliased inputs among the storage space[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m potential_group [95min[39;49;00m [96mself[39;49;00m._potential_aliased_input_groups:[90m[39;49;00m
                args_share_memory: [96mlist[39;49;00m[[96mlist[39;49;00m[[96mint[39;49;00m]] = [][90m[39;49;00m
                [94mfor[39;49;00m i [95min[39;49;00m potential_group:[90m[39;49;00m
                    i_type = [96mself[39;49;00m.maker.inputs[i].variable.type[90m[39;49;00m
                    i_val = input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
    [90m[39;49;00m
                    [90m# Check if value is aliased with any of the values in one of the groups[39;49;00m[90m[39;49;00m
                    [94mfor[39;49;00m j_group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                        [94mif[39;49;00m [96many[39;49;00m([90m[39;49;00m
                            i_type.may_share_memory(input_storage[j].storage[[94m0[39;49;00m], i_val)[90m[39;49;00m
                            [94mfor[39;49;00m j [95min[39;49;00m j_group[90m[39;49;00m
                        ):[90m[39;49;00m
                            j_group.append(i)[90m[39;49;00m
                            [94mbreak[39;49;00m[90m[39;49;00m
                    [94melse[39;49;00m:  [90m# no break[39;49;00m[90m[39;49;00m
                        [90m# Create a new group[39;49;00m[90m[39;49;00m
                        args_share_memory.append([i])[90m[39;49;00m
    [90m[39;49;00m
                [90m# Check for groups of more than one argument that share memory[39;49;00m[90m[39;49;00m
                [94mfor[39;49;00m group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                    [94mif[39;49;00m [96mlen[39;49;00m(group) > [94m1[39;49;00m:[90m[39;49;00m
                        [90m# copy all but the first[39;49;00m[90m[39;49;00m
                        [94mfor[39;49;00m i [95min[39;49;00m group[[94m1[39;49;00m:]:[90m[39;49;00m
                            input_storage[i].storage[[94m0[39;49;00m] = copy.copy([90m[39;49;00m
                                input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
                            )[90m[39;49;00m
    [90m[39;49;00m
            [90m# Check if inputs are missing, or if inputs were set more than once, or[39;49;00m[90m[39;49;00m
            [90m# if we tried to provide inputs that are supposed to be implicit.[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                [94mif[39;49;00m arg_container.required [95mand[39;49;00m [95mnot[39;49;00m arg_container.provided:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMissing required input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.provided > [94m1[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMultiple values for input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.implicit [95mand[39;49;00m arg_container.provided > [94m0[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mTried to provide value for implicit input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
    [90m[39;49;00m
        [90m# Do the actual work[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0_fn = time.perf_counter()[90m[39;49;00m
        [94mtry[39;49;00m:[90m[39;49;00m
>           outputs = vm() [94mif[39;49;00m output_subset [95mis[39;49;00m [94mNone[39;49;00m [94melse[39;49;00m vm(output_subset=output_subset)[90m[39;49;00m
                      ^^^^[90m[39;49;00m
[1m[31mE           pymc.logprob.utils.ParameterValueError: [0m
[1m[31mE           Apply node that caused the error: Check{}([[[-64.31255676]]], False)[0m
[1m[31mE           Toposort index: 0[0m
[1m[31mE           Inputs types: [TensorType(float64, shape=(1, 1, 1)), ScalarType(bool)][0m
[1m[31mE           Inputs shapes: [(1, 1, 1), ()][0m
[1m[31mE           Inputs strides: [(8, 8, 8), ()][0m
[1m[31mE           Inputs values: [array([[[-64.31255676]]]), np.False_][0m
[1m[31mE           Inputs type_num: [12, 0][0m
[1m[31mE           Outputs clients: [[DeepCopyOp(Check{}.0)]][0m
[1m[31mE           [0m
[1m[31mE           Backtrace when the node is created (use PyTensor flag traceback__limit=N to make it longer):[0m
[1m[31mE             File "/app/pymc/logprob/basic.py", line 193, in logp[0m
[1m[31mE               return _logprob_helper(rv, value, **kwargs)[0m
[1m[31mE             File "/app/pymc/logprob/abstract.py", line 70, in _logprob_helper[0m
[1m[31mE               logprob = _logprob(rv.owner.op, values, *rv.owner.inputs, **kwargs)[0m
[1m[31mE             File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/functools.py", line 982, in wrapper[0m
[1m[31mE               return dispatch(args[0].__class__)(*args, **kw)[0m
[1m[31mE             File "/app/pymc/distributions/distribution.py", line 140, in logp[0m
[1m[31mE               return class_logp(value, *dist_params)[0m
[1m[31mE             File "/app/tests/distributions/test_dist_math.py", line 96, in logp[0m
[1m[31mE               return check_parameters([0m
[1m[31mE             File "/app/pymc/distributions/dist_math.py", line 72, in check_parameters[0m
[1m[31mE               return CheckParameterValue(msg, can_be_replaced_by_ninf)(expr, all_true_scalar)[0m
[1m[31mE             File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/graph/op.py", line 294, in __call__[0m
[1m[31mE               node = self.make_node(*inputs, **kwargs)[0m
[1m[31mE             File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/raise_op.py", line 81, in make_node[0m
[1m[31mE               [value.type()],[0m
[1m[31mE           [0m
[1m[31mE           Debug print of the apply node: [0m
[1m[31mE           Check{} [id A] <Tensor3(float64, shape=(1, 1, 1))>[0m
[1m[31mE            ├─ [[[-64.31255676]]] [id B] <Tensor3(float64, shape=(1, 1, 1))>[0m
[1m[31mE            └─ False [id C] <bool>[0m
[1m[31mE           [0m
[1m[31mE           Storage map footprint:[0m
[1m[31mE            - [[[-64.31255676]]], Shape: (1, 1, 1), ElemSize: 8 Byte(s), TotalSize: 8 Byte(s)[0m
[1m[31mE            - False, Shape: (), ElemSize: 1 Byte(s), TotalSize: 1.0 Byte(s)[0m
[1m[31mE            TotalSize: 9.0 Byte(s) 0.000 GB[0m
[1m[31mE            TotalSize inputs: 9.0 Byte(s) 0.000 GB[0m

[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/compile/function/types.py[0m:1038: ParameterValueError
[31m[1m_______ TestMatchesScipy.test_multinomial_vectorized[extra_size0-p2-n1] ________[0m

self = <pytensor.compile.function.types.Function object at 0x7f0b9fa0d5b0>
output_subset = None, args = (), kwargs = {}, trust_input = False
vm = <pytensor.link.c.cvm.CVM object at 0x7f0ba293a830>, profile = None

    [0m[94mdef[39;49;00m[90m [39;49;00m[92m__call__[39;49;00m([96mself[39;49;00m, *args, output_subset=[94mNone[39;49;00m, **kwargs):[90m[39;49;00m
    [90m    [39;49;00m[33m"""[39;49;00m
    [33m    Evaluates value of a function on given arguments.[39;49;00m
    [33m[39;49;00m
    [33m    Parameters[39;49;00m
    [33m    ----------[39;49;00m
    [33m    args : list[39;49;00m
    [33m        List of inputs to the function. All inputs are required, even when[39;49;00m
    [33m        some of them are not necessary to calculate requested subset of[39;49;00m
    [33m        outputs.[39;49;00m
    [33m[39;49;00m
    [33m    kwargs : dict[39;49;00m
    [33m        The function inputs can be passed as keyword argument. For this, use[39;49;00m
    [33m        the name of the input or the input instance as the key.[39;49;00m
    [33m[39;49;00m
    [33m        Keyword argument ``output_subset`` is a list of either indices of the[39;49;00m
    [33m        function's outputs or the keys belonging to the `output_keys` dict[39;49;00m
    [33m        and represent outputs that are requested to be calculated. Regardless[39;49;00m
    [33m        of the presence of ``output_subset``, the updates are always calculated[39;49;00m
    [33m        and processed. To disable the updates, you should use the ``copy``[39;49;00m
    [33m        method with ``delete_updates=True``.[39;49;00m
    [33m[39;49;00m
    [33m    Returns[39;49;00m
    [33m    -------[39;49;00m
    [33m    list[39;49;00m
    [33m        List of outputs on indices/keys from ``output_subset`` or all of them,[39;49;00m
    [33m        if ``output_subset`` is not passed.[39;49;00m
    [33m    """[39;49;00m[90m[39;49;00m
        trust_input = [96mself[39;49;00m.trust_input[90m[39;49;00m
        input_storage = [96mself[39;49;00m.input_storage[90m[39;49;00m
        vm = [96mself[39;49;00m.vm[90m[39;49;00m
        profile = [96mself[39;49;00m.profile[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0 = time.perf_counter()[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m output_subset [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
            warnings.warn([33m"[39;49;00m[33moutput_subset is deprecated.[39;49;00m[33m"[39;49;00m, [96mFutureWarning[39;49;00m)[90m[39;49;00m
            [94mif[39;49;00m [96mself[39;49;00m.output_keys [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                output_subset = [[96mself[39;49;00m.output_keys.index(key) [94mfor[39;49;00m key [95min[39;49;00m output_subset][90m[39;49;00m
    [90m[39;49;00m
        [90m# Reinitialize each container's 'provided' counter[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m trust_input:[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
        [94melse[39;49;00m:[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                arg_container.provided = [94m0[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
            [94mif[39;49;00m [96mlen[39;49;00m(args) + [96mlen[39;49;00m(kwargs) > [96mlen[39;49;00m(input_storage):[90m[39;49;00m
                [94mraise[39;49;00m [96mTypeError[39;49;00m([33m"[39;49;00m[33mToo many parameter passed to pytensor function[39;49;00m[33m"[39;49;00m)[90m[39;49;00m
    [90m[39;49;00m
            [90m# Set positional arguments[39;49;00m[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                [90m# See discussion about None as input[39;49;00m[90m[39;49;00m
                [90m# https://groups.google.com/group/theano-dev/browse_thread/thread/920a5e904e8a8525/4f1b311a28fc27e5[39;49;00m[90m[39;49;00m
                [94mif[39;49;00m arg [95mis[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                    arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
                [94melse[39;49;00m:[90m[39;49;00m
                    [94mtry[39;49;00m:[90m[39;49;00m
                        arg_container.storage[[94m0[39;49;00m] = arg_container.type.filter([90m[39;49;00m
                            arg,[90m[39;49;00m
                            strict=arg_container.strict,[90m[39;49;00m
                            allow_downcast=arg_container.allow_downcast,[90m[39;49;00m
                        )[90m[39;49;00m
    [90m[39;49;00m
                    [94mexcept[39;49;00m [96mException[39;49;00m [94mas[39;49;00m e:[90m[39;49;00m
                        i = input_storage.index(arg_container)[90m[39;49;00m
                        function_name = [33m"[39;49;00m[33mpytensor function[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        argument_name = [33m"[39;49;00m[33margument[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mself[39;49;00m.name:[90m[39;49;00m
                            function_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + [96mself[39;49;00m.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mhasattr[39;49;00m(arg, [33m"[39;49;00m[33mname[39;49;00m[33m"[39;49;00m) [95mand[39;49;00m arg.name:[90m[39;49;00m
                            argument_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + arg.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        where = get_variable_trace_string([96mself[39;49;00m.maker.inputs[i].variable)[90m[39;49;00m
                        [94mif[39;49;00m [96mlen[39;49;00m(e.args) == [94m1[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + e.args[[94m0[39;49;00m],[90m[39;49;00m
                            )[90m[39;49;00m
                        [94melse[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                            ) + e.args[90m[39;49;00m
                        [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                        [94mraise[39;49;00m[90m[39;49;00m
                arg_container.provided += [94m1[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
        [90m# Set keyword arguments[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m kwargs:  [90m# for speed, skip the items for empty kwargs[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m k, arg [95min[39;49;00m kwargs.items():[90m[39;49;00m
                [96mself[39;49;00m[k] = arg[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m [95mnot[39;49;00m trust_input:[90m[39;49;00m
            [90m# Collect aliased inputs among the storage space[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m potential_group [95min[39;49;00m [96mself[39;49;00m._potential_aliased_input_groups:[90m[39;49;00m
                args_share_memory: [96mlist[39;49;00m[[96mlist[39;49;00m[[96mint[39;49;00m]] = [][90m[39;49;00m
                [94mfor[39;49;00m i [95min[39;49;00m potential_group:[90m[39;49;00m
                    i_type = [96mself[39;49;00m.maker.inputs[i].variable.type[90m[39;49;00m
                    i_val = input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
    [90m[39;49;00m
                    [90m# Check if value is aliased with any of the values in one of the groups[39;49;00m[90m[39;49;00m
                    [94mfor[39;49;00m j_group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                        [94mif[39;49;00m [96many[39;49;00m([90m[39;49;00m
                            i_type.may_share_memory(input_storage[j].storage[[94m0[39;49;00m], i_val)[90m[39;49;00m
                            [94mfor[39;49;00m j [95min[39;49;00m j_group[90m[39;49;00m
                        ):[90m[39;49;00m
                            j_group.append(i)[90m[39;49;00m
                            [94mbreak[39;49;00m[90m[39;49;00m
                    [94melse[39;49;00m:  [90m# no break[39;49;00m[90m[39;49;00m
                        [90m# Create a new group[39;49;00m[90m[39;49;00m
                        args_share_memory.append([i])[90m[39;49;00m
    [90m[39;49;00m
                [90m# Check for groups of more than one argument that share memory[39;49;00m[90m[39;49;00m
                [94mfor[39;49;00m group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                    [94mif[39;49;00m [96mlen[39;49;00m(group) > [94m1[39;49;00m:[90m[39;49;00m
                        [90m# copy all but the first[39;49;00m[90m[39;49;00m
                        [94mfor[39;49;00m i [95min[39;49;00m group[[94m1[39;49;00m:]:[90m[39;49;00m
                            input_storage[i].storage[[94m0[39;49;00m] = copy.copy([90m[39;49;00m
                                input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
                            )[90m[39;49;00m
    [90m[39;49;00m
            [90m# Check if inputs are missing, or if inputs were set more than once, or[39;49;00m[90m[39;49;00m
            [90m# if we tried to provide inputs that are supposed to be implicit.[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                [94mif[39;49;00m arg_container.required [95mand[39;49;00m [95mnot[39;49;00m arg_container.provided:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMissing required input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.provided > [94m1[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMultiple values for input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.implicit [95mand[39;49;00m arg_container.provided > [94m0[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mTried to provide value for implicit input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
    [90m[39;49;00m
        [90m# Do the actual work[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0_fn = time.perf_counter()[90m[39;49;00m
        [94mtry[39;49;00m:[90m[39;49;00m
>           outputs = vm() [94mif[39;49;00m output_subset [95mis[39;49;00m [94mNone[39;49;00m [94melse[39;49;00m vm(output_subset=output_subset)[90m[39;49;00m
                      ^^^^[90m[39;49;00m
[1m[31mE           pymc.logprob.utils.ParameterValueError[0m

[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/compile/function/types.py[0m:1038: ParameterValueError

[33mDuring handling of the above exception, another exception occurred:[0m

self = <tests.distributions.test_multivariate.TestMatchesScipy object at 0x7f0bb35c73e0>
n = array([10, 11])
p = array([[[0.17876157, 0.39760757, 0.0449895 , 0.37864137],
        [0.06511207, 0.35563681, 0.30921865, 0.27003247]],

       [[0.2899355 , 0.11278839, 0.36678067, 0.23049544],
        [0.13152157, 0.0916917 , 0.25354174, 0.52324499]]])
extra_size = (1,)

    [0m[37m@pytest[39;49;00m.mark.parametrize([33m"[39;49;00m[33mn[39;49;00m[33m"[39;49;00m, [([94m10[39;49;00m), ([[94m10[39;49;00m, [94m11[39;49;00m]), ([[[94m5[39;49;00m, [94m6[39;49;00m], [[94m10[39;49;00m, [94m11[39;49;00m]])])[90m[39;49;00m
    [37m@pytest[39;49;00m.mark.parametrize([90m[39;49;00m
        [33m"[39;49;00m[33mp[39;49;00m[33m"[39;49;00m,[90m[39;49;00m
        [[90m[39;49;00m
            ([[94m0.2[39;49;00m, [94m0.3[39;49;00m, [94m0.5[39;49;00m]),[90m[39;49;00m
            ([[[94m0.2[39;49;00m, [94m0.3[39;49;00m, [94m0.5[39;49;00m], [[94m0.9[39;49;00m, [94m0.09[39;49;00m, [94m0.01[39;49;00m]]),[90m[39;49;00m
            (np.abs(np.random.randn([94m2[39;49;00m, [94m2[39;49;00m, [94m4[39;49;00m))),[90m[39;49;00m
        ],[90m[39;49;00m
    )[90m[39;49;00m
    [37m@pytest[39;49;00m.mark.parametrize([33m"[39;49;00m[33mextra_size[39;49;00m[33m"[39;49;00m, [([94m1[39;49;00m,), ([94m2[39;49;00m,), ([94m2[39;49;00m, [94m3[39;49;00m)])[90m[39;49;00m
    [94mdef[39;49;00m[90m [39;49;00m[92mtest_multinomial_vectorized[39;49;00m([96mself[39;49;00m, n, p, extra_size):[90m[39;49;00m
        n = np.array(n)[90m[39;49;00m
        p = np.array(p)[90m[39;49;00m
        p /= p.sum(axis=-[94m1[39;49;00m, keepdims=[94mTrue[39;49;00m)[90m[39;49;00m
    [90m[39;49;00m
        _, bcast_p = broadcast_params([n, p], ndims_params=[[94m0[39;49;00m, [94m1[39;49;00m])[90m[39;49;00m
        size = extra_size + bcast_p.shape[:-[94m1[39;49;00m][90m[39;49;00m
    [90m[39;49;00m
        mn = pm.Multinomial.dist(n=n, p=p, size=size)[90m[39;49;00m
        vals = mn.eval()[90m[39;49;00m
    [90m[39;49;00m
        npt.assert_almost_equal([90m[39;49;00m
            st.multinomial.logpmf(vals, n, p),[90m[39;49;00m
>           pm.logp(mn, vals).eval(),[90m[39;49;00m
            ^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
            decimal=[94m4[39;49;00m,[90m[39;49;00m
            err_msg=[33mf[39;49;00m[33m"[39;49;00m[33mvals=[39;49;00m[33m{[39;49;00mvals[33m}[39;49;00m[33m"[39;49;00m,[90m[39;49;00m
        )[90m[39;49;00m

[1m[31mtests/distributions/test_multivariate.py[0m:692:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/graph/basic.py[0m:668: in eval
    [0m[94mreturn[39;49;00m fn(*args)[90m[39;49;00m
           ^^^^^^^^^[90m[39;49;00m
[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/compile/function/types.py[0m:1048: in __call__
    [0mraise_with_op([90m[39;49;00m
[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/link/utils.py[0m:526: in raise_with_op
    [0m[94mraise[39;49;00m exc_value.with_traceback(exc_trace)[90m[39;49;00m
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <pytensor.compile.function.types.Function object at 0x7f0b9fa0d5b0>
output_subset = None, args = (), kwargs = {}, trust_input = False
vm = <pytensor.link.c.cvm.CVM object at 0x7f0ba293a830>, profile = None

    [0m[94mdef[39;49;00m[90m [39;49;00m[92m__call__[39;49;00m([96mself[39;49;00m, *args, output_subset=[94mNone[39;49;00m, **kwargs):[90m[39;49;00m
    [90m    [39;49;00m[33m"""[39;49;00m
    [33m    Evaluates value of a function on given arguments.[39;49;00m
    [33m[39;49;00m
    [33m    Parameters[39;49;00m
    [33m    ----------[39;49;00m
    [33m    args : list[39;49;00m
    [33m        List of inputs to the function. All inputs are required, even when[39;49;00m
    [33m        some of them are not necessary to calculate requested subset of[39;49;00m
    [33m        outputs.[39;49;00m
    [33m[39;49;00m
    [33m    kwargs : dict[39;49;00m
    [33m        The function inputs can be passed as keyword argument. For this, use[39;49;00m
    [33m        the name of the input or the input instance as the key.[39;49;00m
    [33m[39;49;00m
    [33m        Keyword argument ``output_subset`` is a list of either indices of the[39;49;00m
    [33m        function's outputs or the keys belonging to the `output_keys` dict[39;49;00m
    [33m        and represent outputs that are requested to be calculated. Regardless[39;49;00m
    [33m        of the presence of ``output_subset``, the updates are always calculated[39;49;00m
    [33m        and processed. To disable the updates, you should use the ``copy``[39;49;00m
    [33m        method with ``delete_updates=True``.[39;49;00m
    [33m[39;49;00m
    [33m    Returns[39;49;00m
    [33m    -------[39;49;00m
    [33m    list[39;49;00m
    [33m        List of outputs on indices/keys from ``output_subset`` or all of them,[39;49;00m
    [33m        if ``output_subset`` is not passed.[39;49;00m
    [33m    """[39;49;00m[90m[39;49;00m
        trust_input = [96mself[39;49;00m.trust_input[90m[39;49;00m
        input_storage = [96mself[39;49;00m.input_storage[90m[39;49;00m
        vm = [96mself[39;49;00m.vm[90m[39;49;00m
        profile = [96mself[39;49;00m.profile[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0 = time.perf_counter()[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m output_subset [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
            warnings.warn([33m"[39;49;00m[33moutput_subset is deprecated.[39;49;00m[33m"[39;49;00m, [96mFutureWarning[39;49;00m)[90m[39;49;00m
            [94mif[39;49;00m [96mself[39;49;00m.output_keys [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                output_subset = [[96mself[39;49;00m.output_keys.index(key) [94mfor[39;49;00m key [95min[39;49;00m output_subset][90m[39;49;00m
    [90m[39;49;00m
        [90m# Reinitialize each container's 'provided' counter[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m trust_input:[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
        [94melse[39;49;00m:[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                arg_container.provided = [94m0[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
            [94mif[39;49;00m [96mlen[39;49;00m(args) + [96mlen[39;49;00m(kwargs) > [96mlen[39;49;00m(input_storage):[90m[39;49;00m
                [94mraise[39;49;00m [96mTypeError[39;49;00m([33m"[39;49;00m[33mToo many parameter passed to pytensor function[39;49;00m[33m"[39;49;00m)[90m[39;49;00m
    [90m[39;49;00m
            [90m# Set positional arguments[39;49;00m[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                [90m# See discussion about None as input[39;49;00m[90m[39;49;00m
                [90m# https://groups.google.com/group/theano-dev/browse_thread/thread/920a5e904e8a8525/4f1b311a28fc27e5[39;49;00m[90m[39;49;00m
                [94mif[39;49;00m arg [95mis[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                    arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
                [94melse[39;49;00m:[90m[39;49;00m
                    [94mtry[39;49;00m:[90m[39;49;00m
                        arg_container.storage[[94m0[39;49;00m] = arg_container.type.filter([90m[39;49;00m
                            arg,[90m[39;49;00m
                            strict=arg_container.strict,[90m[39;49;00m
                            allow_downcast=arg_container.allow_downcast,[90m[39;49;00m
                        )[90m[39;49;00m
    [90m[39;49;00m
                    [94mexcept[39;49;00m [96mException[39;49;00m [94mas[39;49;00m e:[90m[39;49;00m
                        i = input_storage.index(arg_container)[90m[39;49;00m
                        function_name = [33m"[39;49;00m[33mpytensor function[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        argument_name = [33m"[39;49;00m[33margument[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mself[39;49;00m.name:[90m[39;49;00m
                            function_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + [96mself[39;49;00m.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mhasattr[39;49;00m(arg, [33m"[39;49;00m[33mname[39;49;00m[33m"[39;49;00m) [95mand[39;49;00m arg.name:[90m[39;49;00m
                            argument_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + arg.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        where = get_variable_trace_string([96mself[39;49;00m.maker.inputs[i].variable)[90m[39;49;00m
                        [94mif[39;49;00m [96mlen[39;49;00m(e.args) == [94m1[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + e.args[[94m0[39;49;00m],[90m[39;49;00m
                            )[90m[39;49;00m
                        [94melse[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                            ) + e.args[90m[39;49;00m
                        [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                        [94mraise[39;49;00m[90m[39;49;00m
                arg_container.provided += [94m1[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
        [90m# Set keyword arguments[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m kwargs:  [90m# for speed, skip the items for empty kwargs[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m k, arg [95min[39;49;00m kwargs.items():[90m[39;49;00m
                [96mself[39;49;00m[k] = arg[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m [95mnot[39;49;00m trust_input:[90m[39;49;00m
            [90m# Collect aliased inputs among the storage space[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m potential_group [95min[39;49;00m [96mself[39;49;00m._potential_aliased_input_groups:[90m[39;49;00m
                args_share_memory: [96mlist[39;49;00m[[96mlist[39;49;00m[[96mint[39;49;00m]] = [][90m[39;49;00m
                [94mfor[39;49;00m i [95min[39;49;00m potential_group:[90m[39;49;00m
                    i_type = [96mself[39;49;00m.maker.inputs[i].variable.type[90m[39;49;00m
                    i_val = input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
    [90m[39;49;00m
                    [90m# Check if value is aliased with any of the values in one of the groups[39;49;00m[90m[39;49;00m
                    [94mfor[39;49;00m j_group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                        [94mif[39;49;00m [96many[39;49;00m([90m[39;49;00m
                            i_type.may_share_memory(input_storage[j].storage[[94m0[39;49;00m], i_val)[90m[39;49;00m
                            [94mfor[39;49;00m j [95min[39;49;00m j_group[90m[39;49;00m
                        ):[90m[39;49;00m
                            j_group.append(i)[90m[39;49;00m
                            [94mbreak[39;49;00m[90m[39;49;00m
                    [94melse[39;49;00m:  [90m# no break[39;49;00m[90m[39;49;00m
                        [90m# Create a new group[39;49;00m[90m[39;49;00m
                        args_share_memory.append([i])[90m[39;49;00m
    [90m[39;49;00m
                [90m# Check for groups of more than one argument that share memory[39;49;00m[90m[39;49;00m
                [94mfor[39;49;00m group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                    [94mif[39;49;00m [96mlen[39;49;00m(group) > [94m1[39;49;00m:[90m[39;49;00m
                        [90m# copy all but the first[39;49;00m[90m[39;49;00m
                        [94mfor[39;49;00m i [95min[39;49;00m group[[94m1[39;49;00m:]:[90m[39;49;00m
                            input_storage[i].storage[[94m0[39;49;00m] = copy.copy([90m[39;49;00m
                                input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
                            )[90m[39;49;00m
    [90m[39;49;00m
            [90m# Check if inputs are missing, or if inputs were set more than once, or[39;49;00m[90m[39;49;00m
            [90m# if we tried to provide inputs that are supposed to be implicit.[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                [94mif[39;49;00m arg_container.required [95mand[39;49;00m [95mnot[39;49;00m arg_container.provided:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMissing required input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.provided > [94m1[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMultiple values for input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.implicit [95mand[39;49;00m arg_container.provided > [94m0[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mTried to provide value for implicit input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
    [90m[39;49;00m
        [90m# Do the actual work[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0_fn = time.perf_counter()[90m[39;49;00m
        [94mtry[39;49;00m:[90m[39;49;00m
>           outputs = vm() [94mif[39;49;00m output_subset [95mis[39;49;00m [94mNone[39;49;00m [94melse[39;49;00m vm(output_subset=output_subset)[90m[39;49;00m
                      ^^^^[90m[39;49;00m
[1m[31mE           pymc.logprob.utils.ParameterValueError: [0m
[1m[31mE           Apply node that caused the error: Check{}([[[-65.447 ... 4930532]]], False)[0m
[1m[31mE           Toposort index: 0[0m
[1m[31mE           Inputs types: [TensorType(float64, shape=(1, 1, 2)), ScalarType(bool)][0m
[1m[31mE           Inputs shapes: [(1, 1, 2), ()][0m
[1m[31mE           Inputs strides: [(16, 16, 8), ()][0m
[1m[31mE           Inputs values: [array([[[-65.44720059, -63.04930532]]]), np.False_][0m
[1m[31mE           Inputs type_num: [12, 0][0m
[1m[31mE           Outputs clients: [[DeepCopyOp(Check{}.0)]][0m
[1m[31mE           [0m
[1m[31mE           Backtrace when the node is created (use PyTensor flag traceback__limit=N to make it longer):[0m
[1m[31mE             File "/app/pymc/logprob/basic.py", line 193, in logp[0m
[1m[31mE               return _logprob_helper(rv, value, **kwargs)[0m
[1m[31mE             File "/app/pymc/logprob/abstract.py", line 70, in _logprob_helper[0m
[1m[31mE               logprob = _logprob(rv.owner.op, values, *rv.owner.inputs, **kwargs)[0m
[1m[31mE             File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/functools.py", line 982, in wrapper[0m
[1m[31mE               return dispatch(args[0].__class__)(*args, **kw)[0m
[1m[31mE             File "/app/pymc/distributions/distribution.py", line 140, in logp[0m
[1m[31mE               return class_logp(value, *dist_params)[0m
[1m[31mE             File "/app/tests/distributions/test_dist_math.py", line 96, in logp[0m
[1m[31mE               return check_parameters([0m
[1m[31mE             File "/app/pymc/distributions/dist_math.py", line 72, in check_parameters[0m
[1m[31mE               return CheckParameterValue(msg, can_be_replaced_by_ninf)(expr, all_true_scalar)[0m
[1m[31mE             File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/graph/op.py", line 294, in __call__[0m
[1m[31mE               node = self.make_node(*inputs, **kwargs)[0m
[1m[31mE             File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/raise_op.py", line 81, in make_node[0m
[1m[31mE               [value.type()],[0m
[1m[31mE           [0m
[1m[31mE           Debug print of the apply node: [0m
[1m[31mE           Check{} [id A] <Tensor3(float64, shape=(1, 1, 2))>[0m
[1m[31mE            ├─ [[[-65.447 ... 4930532]]] [id B] <Tensor3(float64, shape=(1, 1, 2))>[0m
[1m[31mE            └─ False [id C] <bool>[0m
[1m[31mE           [0m
[1m[31mE           Storage map footprint:[0m
[1m[31mE            - [[[-65.447 ... 4930532]]], Shape: (1, 1, 2), ElemSize: 8 Byte(s), TotalSize: 16 Byte(s)[0m
[1m[31mE            - False, Shape: (), ElemSize: 1 Byte(s), TotalSize: 1.0 Byte(s)[0m
[1m[31mE            TotalSize: 17.0 Byte(s) 0.000 GB[0m
[1m[31mE            TotalSize inputs: 17.0 Byte(s) 0.000 GB[0m

[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/compile/function/types.py[0m:1038: ParameterValueError
[31m[1m_______ TestMatchesScipy.test_multinomial_vectorized[extra_size0-p2-n2] ________[0m

self = <pytensor.compile.function.types.Function object at 0x7f0ba1e72d50>
output_subset = None, args = (), kwargs = {}, trust_input = False
vm = <pytensor.link.c.cvm.CVM object at 0x7f0ba293a990>, profile = None

    [0m[94mdef[39;49;00m[90m [39;49;00m[92m__call__[39;49;00m([96mself[39;49;00m, *args, output_subset=[94mNone[39;49;00m, **kwargs):[90m[39;49;00m
    [90m    [39;49;00m[33m"""[39;49;00m
    [33m    Evaluates value of a function on given arguments.[39;49;00m
    [33m[39;49;00m
    [33m    Parameters[39;49;00m
    [33m    ----------[39;49;00m
    [33m    args : list[39;49;00m
    [33m        List of inputs to the function. All inputs are required, even when[39;49;00m
    [33m        some of them are not necessary to calculate requested subset of[39;49;00m
    [33m        outputs.[39;49;00m
    [33m[39;49;00m
    [33m    kwargs : dict[39;49;00m
    [33m        The function inputs can be passed as keyword argument. For this, use[39;49;00m
    [33m        the name of the input or the input instance as the key.[39;49;00m
    [33m[39;49;00m
    [33m        Keyword argument ``output_subset`` is a list of either indices of the[39;49;00m
    [33m        function's outputs or the keys belonging to the `output_keys` dict[39;49;00m
    [33m        and represent outputs that are requested to be calculated. Regardless[39;49;00m
    [33m        of the presence of ``output_subset``, the updates are always calculated[39;49;00m
    [33m        and processed. To disable the updates, you should use the ``copy``[39;49;00m
    [33m        method with ``delete_updates=True``.[39;49;00m
    [33m[39;49;00m
    [33m    Returns[39;49;00m
    [33m    -------[39;49;00m
    [33m    list[39;49;00m
    [33m        List of outputs on indices/keys from ``output_subset`` or all of them,[39;49;00m
    [33m        if ``output_subset`` is not passed.[39;49;00m
    [33m    """[39;49;00m[90m[39;49;00m
        trust_input = [96mself[39;49;00m.trust_input[90m[39;49;00m
        input_storage = [96mself[39;49;00m.input_storage[90m[39;49;00m
        vm = [96mself[39;49;00m.vm[90m[39;49;00m
        profile = [96mself[39;49;00m.profile[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0 = time.perf_counter()[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m output_subset [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
            warnings.warn([33m"[39;49;00m[33moutput_subset is deprecated.[39;49;00m[33m"[39;49;00m, [96mFutureWarning[39;49;00m)[90m[39;49;00m
            [94mif[39;49;00m [96mself[39;49;00m.output_keys [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                output_subset = [[96mself[39;49;00m.output_keys.index(key) [94mfor[39;49;00m key [95min[39;49;00m output_subset][90m[39;49;00m
    [90m[39;49;00m
        [90m# Reinitialize each container's 'provided' counter[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m trust_input:[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
        [94melse[39;49;00m:[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                arg_container.provided = [94m0[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
            [94mif[39;49;00m [96mlen[39;49;00m(args) + [96mlen[39;49;00m(kwargs) > [96mlen[39;49;00m(input_storage):[90m[39;49;00m
                [94mraise[39;49;00m [96mTypeError[39;49;00m([33m"[39;49;00m[33mToo many parameter passed to pytensor function[39;49;00m[33m"[39;49;00m)[90m[39;49;00m
    [90m[39;49;00m
            [90m# Set positional arguments[39;49;00m[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                [90m# See discussion about None as input[39;49;00m[90m[39;49;00m
                [90m# https://groups.google.com/group/theano-dev/browse_thread/thread/920a5e904e8a8525/4f1b311a28fc27e5[39;49;00m[90m[39;49;00m
                [94mif[39;49;00m arg [95mis[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                    arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
                [94melse[39;49;00m:[90m[39;49;00m
                    [94mtry[39;49;00m:[90m[39;49;00m
                        arg_container.storage[[94m0[39;49;00m] = arg_container.type.filter([90m[39;49;00m
                            arg,[90m[39;49;00m
                            strict=arg_container.strict,[90m[39;49;00m
                            allow_downcast=arg_container.allow_downcast,[90m[39;49;00m
                        )[90m[39;49;00m
    [90m[39;49;00m
                    [94mexcept[39;49;00m [96mException[39;49;00m [94mas[39;49;00m e:[90m[39;49;00m
                        i = input_storage.index(arg_container)[90m[39;49;00m
                        function_name = [33m"[39;49;00m[33mpytensor function[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        argument_name = [33m"[39;49;00m[33margument[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mself[39;49;00m.name:[90m[39;49;00m
                            function_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + [96mself[39;49;00m.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mhasattr[39;49;00m(arg, [33m"[39;49;00m[33mname[39;49;00m[33m"[39;49;00m) [95mand[39;49;00m arg.name:[90m[39;49;00m
                            argument_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + arg.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        where = get_variable_trace_string([96mself[39;49;00m.maker.inputs[i].variable)[90m[39;49;00m
                        [94mif[39;49;00m [96mlen[39;49;00m(e.args) == [94m1[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + e.args[[94m0[39;49;00m],[90m[39;49;00m
                            )[90m[39;49;00m
                        [94melse[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                            ) + e.args[90m[39;49;00m
                        [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                        [94mraise[39;49;00m[90m[39;49;00m
                arg_container.provided += [94m1[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
        [90m# Set keyword arguments[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m kwargs:  [90m# for speed, skip the items for empty kwargs[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m k, arg [95min[39;49;00m kwargs.items():[90m[39;49;00m
                [96mself[39;49;00m[k] = arg[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m [95mnot[39;49;00m trust_input:[90m[39;49;00m
            [90m# Collect aliased inputs among the storage space[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m potential_group [95min[39;49;00m [96mself[39;49;00m._potential_aliased_input_groups:[90m[39;49;00m
                args_share_memory: [96mlist[39;49;00m[[96mlist[39;49;00m[[96mint[39;49;00m]] = [][90m[39;49;00m
                [94mfor[39;49;00m i [95min[39;49;00m potential_group:[90m[39;49;00m
                    i_type = [96mself[39;49;00m.maker.inputs[i].variable.type[90m[39;49;00m
                    i_val = input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
    [90m[39;49;00m
                    [90m# Check if value is aliased with any of the values in one of the groups[39;49;00m[90m[39;49;00m
                    [94mfor[39;49;00m j_group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                        [94mif[39;49;00m [96many[39;49;00m([90m[39;49;00m
                            i_type.may_share_memory(input_storage[j].storage[[94m0[39;49;00m], i_val)[90m[39;49;00m
                            [94mfor[39;49;00m j [95min[39;49;00m j_group[90m[39;49;00m
                        ):[90m[39;49;00m
                            j_group.append(i)[90m[39;49;00m
                            [94mbreak[39;49;00m[90m[39;49;00m
                    [94melse[39;49;00m:  [90m# no break[39;49;00m[90m[39;49;00m
                        [90m# Create a new group[39;49;00m[90m[39;49;00m
                        args_share_memory.append([i])[90m[39;49;00m
    [90m[39;49;00m
                [90m# Check for groups of more than one argument that share memory[39;49;00m[90m[39;49;00m
                [94mfor[39;49;00m group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                    [94mif[39;49;00m [96mlen[39;49;00m(group) > [94m1[39;49;00m:[90m[39;49;00m
                        [90m# copy all but the first[39;49;00m[90m[39;49;00m
                        [94mfor[39;49;00m i [95min[39;49;00m group[[94m1[39;49;00m:]:[90m[39;49;00m
                            input_storage[i].storage[[94m0[39;49;00m] = copy.copy([90m[39;49;00m
                                input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
                            )[90m[39;49;00m
    [90m[39;49;00m
            [90m# Check if inputs are missing, or if inputs were set more than once, or[39;49;00m[90m[39;49;00m
            [90m# if we tried to provide inputs that are supposed to be implicit.[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                [94mif[39;49;00m arg_container.required [95mand[39;49;00m [95mnot[39;49;00m arg_container.provided:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMissing required input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.provided > [94m1[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMultiple values for input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.implicit [95mand[39;49;00m arg_container.provided > [94m0[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mTried to provide value for implicit input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
    [90m[39;49;00m
        [90m# Do the actual work[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0_fn = time.perf_counter()[90m[39;49;00m
        [94mtry[39;49;00m:[90m[39;49;00m
>           outputs = vm() [94mif[39;49;00m output_subset [95mis[39;49;00m [94mNone[39;49;00m [94melse[39;49;00m vm(output_subset=output_subset)[90m[39;49;00m
                      ^^^^[90m[39;49;00m
[1m[31mE           pymc.logprob.utils.ParameterValueError[0m

[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/compile/function/types.py[0m:1038: ParameterValueError

[33mDuring handling of the above exception, another exception occurred:[0m

self = <tests.distributions.test_multivariate.TestMatchesScipy object at 0x7f0bb35c7430>
n = array([[ 5,  6],
       [10, 11]])
p = array([[[0.17876157, 0.39760757, 0.0449895 , 0.37864137],
        [0.06511207, 0.35563681, 0.30921865, 0.27003247]],

       [[0.2899355 , 0.11278839, 0.36678067, 0.23049544],
        [0.13152157, 0.0916917 , 0.25354174, 0.52324499]]])
extra_size = (1,)

    [0m[37m@pytest[39;49;00m.mark.parametrize([33m"[39;49;00m[33mn[39;49;00m[33m"[39;49;00m, [([94m10[39;49;00m), ([[94m10[39;49;00m, [94m11[39;49;00m]), ([[[94m5[39;49;00m, [94m6[39;49;00m], [[94m10[39;49;00m, [94m11[39;49;00m]])])[90m[39;49;00m
    [37m@pytest[39;49;00m.mark.parametrize([90m[39;49;00m
        [33m"[39;49;00m[33mp[39;49;00m[33m"[39;49;00m,[90m[39;49;00m
        [[90m[39;49;00m
            ([[94m0.2[39;49;00m, [94m0.3[39;49;00m, [94m0.5[39;49;00m]),[90m[39;49;00m
            ([[[94m0.2[39;49;00m, [94m0.3[39;49;00m, [94m0.5[39;49;00m], [[94m0.9[39;49;00m, [94m0.09[39;49;00m, [94m0.01[39;49;00m]]),[90m[39;49;00m
            (np.abs(np.random.randn([94m2[39;49;00m, [94m2[39;49;00m, [94m4[39;49;00m))),[90m[39;49;00m
        ],[90m[39;49;00m
    )[90m[39;49;00m
    [37m@pytest[39;49;00m.mark.parametrize([33m"[39;49;00m[33mextra_size[39;49;00m[33m"[39;49;00m, [([94m1[39;49;00m,), ([94m2[39;49;00m,), ([94m2[39;49;00m, [94m3[39;49;00m)])[90m[39;49;00m
    [94mdef[39;49;00m[90m [39;49;00m[92mtest_multinomial_vectorized[39;49;00m([96mself[39;49;00m, n, p, extra_size):[90m[39;49;00m
        n = np.array(n)[90m[39;49;00m
        p = np.array(p)[90m[39;49;00m
        p /= p.sum(axis=-[94m1[39;49;00m, keepdims=[94mTrue[39;49;00m)[90m[39;49;00m
    [90m[39;49;00m
        _, bcast_p = broadcast_params([n, p], ndims_params=[[94m0[39;49;00m, [94m1[39;49;00m])[90m[39;49;00m
        size = extra_size + bcast_p.shape[:-[94m1[39;49;00m][90m[39;49;00m
    [90m[39;49;00m
        mn = pm.Multinomial.dist(n=n, p=p, size=size)[90m[39;49;00m
        vals = mn.eval()[90m[39;49;00m
    [90m[39;49;00m
        npt.assert_almost_equal([90m[39;49;00m
            st.multinomial.logpmf(vals, n, p),[90m[39;49;00m
>           pm.logp(mn, vals).eval(),[90m[39;49;00m
            ^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
            decimal=[94m4[39;49;00m,[90m[39;49;00m
            err_msg=[33mf[39;49;00m[33m"[39;49;00m[33mvals=[39;49;00m[33m{[39;49;00mvals[33m}[39;49;00m[33m"[39;49;00m,[90m[39;49;00m
        )[90m[39;49;00m

[1m[31mtests/distributions/test_multivariate.py[0m:692:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/graph/basic.py[0m:668: in eval
    [0m[94mreturn[39;49;00m fn(*args)[90m[39;49;00m
           ^^^^^^^^^[90m[39;49;00m
[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/compile/function/types.py[0m:1048: in __call__
    [0mraise_with_op([90m[39;49;00m
[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/link/utils.py[0m:526: in raise_with_op
    [0m[94mraise[39;49;00m exc_value.with_traceback(exc_trace)[90m[39;49;00m
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <pytensor.compile.function.types.Function object at 0x7f0ba1e72d50>
output_subset = None, args = (), kwargs = {}, trust_input = False
vm = <pytensor.link.c.cvm.CVM object at 0x7f0ba293a990>, profile = None

    [0m[94mdef[39;49;00m[90m [39;49;00m[92m__call__[39;49;00m([96mself[39;49;00m, *args, output_subset=[94mNone[39;49;00m, **kwargs):[90m[39;49;00m
    [90m    [39;49;00m[33m"""[39;49;00m
    [33m    Evaluates value of a function on given arguments.[39;49;00m
    [33m[39;49;00m
    [33m    Parameters[39;49;00m
    [33m    ----------[39;49;00m
    [33m    args : list[39;49;00m
    [33m        List of inputs to the function. All inputs are required, even when[39;49;00m
    [33m        some of them are not necessary to calculate requested subset of[39;49;00m
    [33m        outputs.[39;49;00m
    [33m[39;49;00m
    [33m    kwargs : dict[39;49;00m
    [33m        The function inputs can be passed as keyword argument. For this, use[39;49;00m
    [33m        the name of the input or the input instance as the key.[39;49;00m
    [33m[39;49;00m
    [33m        Keyword argument ``output_subset`` is a list of either indices of the[39;49;00m
    [33m        function's outputs or the keys belonging to the `output_keys` dict[39;49;00m
    [33m        and represent outputs that are requested to be calculated. Regardless[39;49;00m
    [33m        of the presence of ``output_subset``, the updates are always calculated[39;49;00m
    [33m        and processed. To disable the updates, you should use the ``copy``[39;49;00m
    [33m        method with ``delete_updates=True``.[39;49;00m
    [33m[39;49;00m
    [33m    Returns[39;49;00m
    [33m    -------[39;49;00m
    [33m    list[39;49;00m
    [33m        List of outputs on indices/keys from ``output_subset`` or all of them,[39;49;00m
    [33m        if ``output_subset`` is not passed.[39;49;00m
    [33m    """[39;49;00m[90m[39;49;00m
        trust_input = [96mself[39;49;00m.trust_input[90m[39;49;00m
        input_storage = [96mself[39;49;00m.input_storage[90m[39;49;00m
        vm = [96mself[39;49;00m.vm[90m[39;49;00m
        profile = [96mself[39;49;00m.profile[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0 = time.perf_counter()[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m output_subset [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
            warnings.warn([33m"[39;49;00m[33moutput_subset is deprecated.[39;49;00m[33m"[39;49;00m, [96mFutureWarning[39;49;00m)[90m[39;49;00m
            [94mif[39;49;00m [96mself[39;49;00m.output_keys [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                output_subset = [[96mself[39;49;00m.output_keys.index(key) [94mfor[39;49;00m key [95min[39;49;00m output_subset][90m[39;49;00m
    [90m[39;49;00m
        [90m# Reinitialize each container's 'provided' counter[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m trust_input:[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
        [94melse[39;49;00m:[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                arg_container.provided = [94m0[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
            [94mif[39;49;00m [96mlen[39;49;00m(args) + [96mlen[39;49;00m(kwargs) > [96mlen[39;49;00m(input_storage):[90m[39;49;00m
                [94mraise[39;49;00m [96mTypeError[39;49;00m([33m"[39;49;00m[33mToo many parameter passed to pytensor function[39;49;00m[33m"[39;49;00m)[90m[39;49;00m
    [90m[39;49;00m
            [90m# Set positional arguments[39;49;00m[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                [90m# See discussion about None as input[39;49;00m[90m[39;49;00m
                [90m# https://groups.google.com/group/theano-dev/browse_thread/thread/920a5e904e8a8525/4f1b311a28fc27e5[39;49;00m[90m[39;49;00m
                [94mif[39;49;00m arg [95mis[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                    arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
                [94melse[39;49;00m:[90m[39;49;00m
                    [94mtry[39;49;00m:[90m[39;49;00m
                        arg_container.storage[[94m0[39;49;00m] = arg_container.type.filter([90m[39;49;00m
                            arg,[90m[39;49;00m
                            strict=arg_container.strict,[90m[39;49;00m
                            allow_downcast=arg_container.allow_downcast,[90m[39;49;00m
                        )[90m[39;49;00m
    [90m[39;49;00m
                    [94mexcept[39;49;00m [96mException[39;49;00m [94mas[39;49;00m e:[90m[39;49;00m
                        i = input_storage.index(arg_container)[90m[39;49;00m
                        function_name = [33m"[39;49;00m[33mpytensor function[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        argument_name = [33m"[39;49;00m[33margument[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mself[39;49;00m.name:[90m[39;49;00m
                            function_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + [96mself[39;49;00m.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mhasattr[39;49;00m(arg, [33m"[39;49;00m[33mname[39;49;00m[33m"[39;49;00m) [95mand[39;49;00m arg.name:[90m[39;49;00m
                            argument_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + arg.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        where = get_variable_trace_string([96mself[39;49;00m.maker.inputs[i].variable)[90m[39;49;00m
                        [94mif[39;49;00m [96mlen[39;49;00m(e.args) == [94m1[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + e.args[[94m0[39;49;00m],[90m[39;49;00m
                            )[90m[39;49;00m
                        [94melse[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                            ) + e.args[90m[39;49;00m
                        [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                        [94mraise[39;49;00m[90m[39;49;00m
                arg_container.provided += [94m1[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
        [90m# Set keyword arguments[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m kwargs:  [90m# for speed, skip the items for empty kwargs[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m k, arg [95min[39;49;00m kwargs.items():[90m[39;49;00m
                [96mself[39;49;00m[k] = arg[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m [95mnot[39;49;00m trust_input:[90m[39;49;00m
            [90m# Collect aliased inputs among the storage space[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m potential_group [95min[39;49;00m [96mself[39;49;00m._potential_aliased_input_groups:[90m[39;49;00m
                args_share_memory: [96mlist[39;49;00m[[96mlist[39;49;00m[[96mint[39;49;00m]] = [][90m[39;49;00m
                [94mfor[39;49;00m i [95min[39;49;00m potential_group:[90m[39;49;00m
                    i_type = [96mself[39;49;00m.maker.inputs[i].variable.type[90m[39;49;00m
                    i_val = input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
    [90m[39;49;00m
                    [90m# Check if value is aliased with any of the values in one of the groups[39;49;00m[90m[39;49;00m
                    [94mfor[39;49;00m j_group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                        [94mif[39;49;00m [96many[39;49;00m([90m[39;49;00m
                            i_type.may_share_memory(input_storage[j].storage[[94m0[39;49;00m], i_val)[90m[39;49;00m
                            [94mfor[39;49;00m j [95min[39;49;00m j_group[90m[39;49;00m
                        ):[90m[39;49;00m
                            j_group.append(i)[90m[39;49;00m
                            [94mbreak[39;49;00m[90m[39;49;00m
                    [94melse[39;49;00m:  [90m# no break[39;49;00m[90m[39;49;00m
                        [90m# Create a new group[39;49;00m[90m[39;49;00m
                        args_share_memory.append([i])[90m[39;49;00m
    [90m[39;49;00m
                [90m# Check for groups of more than one argument that share memory[39;49;00m[90m[39;49;00m
                [94mfor[39;49;00m group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                    [94mif[39;49;00m [96mlen[39;49;00m(group) > [94m1[39;49;00m:[90m[39;49;00m
                        [90m# copy all but the first[39;49;00m[90m[39;49;00m
                        [94mfor[39;49;00m i [95min[39;49;00m group[[94m1[39;49;00m:]:[90m[39;49;00m
                            input_storage[i].storage[[94m0[39;49;00m] = copy.copy([90m[39;49;00m
                                input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
                            )[90m[39;49;00m
    [90m[39;49;00m
            [90m# Check if inputs are missing, or if inputs were set more than once, or[39;49;00m[90m[39;49;00m
            [90m# if we tried to provide inputs that are supposed to be implicit.[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                [94mif[39;49;00m arg_container.required [95mand[39;49;00m [95mnot[39;49;00m arg_container.provided:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMissing required input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.provided > [94m1[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMultiple values for input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.implicit [95mand[39;49;00m arg_container.provided > [94m0[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mTried to provide value for implicit input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
    [90m[39;49;00m
        [90m# Do the actual work[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0_fn = time.perf_counter()[90m[39;49;00m
        [94mtry[39;49;00m:[90m[39;49;00m
>           outputs = vm() [94mif[39;49;00m output_subset [95mis[39;49;00m [94mNone[39;49;00m [94melse[39;49;00m vm(output_subset=output_subset)[90m[39;49;00m
                      ^^^^[90m[39;49;00m
[1m[31mE           pymc.logprob.utils.ParameterValueError: [0m
[1m[31mE           Apply node that caused the error: Check{}([[[-53.709 ... 9479654]]], False)[0m
[1m[31mE           Toposort index: 0[0m
[1m[31mE           Inputs types: [TensorType(float64, shape=(1, 2, 2)), ScalarType(bool)][0m
[1m[31mE           Inputs shapes: [(1, 2, 2), ()][0m
[1m[31mE           Inputs strides: [(32, 16, 8), ()][0m
[1m[31mE           Inputs values: [array([[[-53.70961264, -51.91785317],[0m
[1m[31mE                   [-43.39269181, -40.99479654]]]), np.False_][0m
[1m[31mE           Inputs type_num: [12, 0][0m
[1m[31mE           Outputs clients: [[DeepCopyOp(Check{}.0)]][0m
[1m[31mE           [0m
[1m[31mE           Backtrace when the node is created (use PyTensor flag traceback__limit=N to make it longer):[0m
[1m[31mE             File "/app/pymc/logprob/basic.py", line 193, in logp[0m
[1m[31mE               return _logprob_helper(rv, value, **kwargs)[0m
[1m[31mE             File "/app/pymc/logprob/abstract.py", line 70, in _logprob_helper[0m
[1m[31mE               logprob = _logprob(rv.owner.op, values, *rv.owner.inputs, **kwargs)[0m
[1m[31mE             File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/functools.py", line 982, in wrapper[0m
[1m[31mE               return dispatch(args[0].__class__)(*args, **kw)[0m
[1m[31mE             File "/app/pymc/distributions/distribution.py", line 140, in logp[0m
[1m[31mE               return class_logp(value, *dist_params)[0m
[1m[31mE             File "/app/tests/distributions/test_dist_math.py", line 96, in logp[0m
[1m[31mE               return check_parameters([0m
[1m[31mE             File "/app/pymc/distributions/dist_math.py", line 72, in check_parameters[0m
[1m[31mE               return CheckParameterValue(msg, can_be_replaced_by_ninf)(expr, all_true_scalar)[0m
[1m[31mE             File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/graph/op.py", line 294, in __call__[0m
[1m[31mE               node = self.make_node(*inputs, **kwargs)[0m
[1m[31mE             File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/raise_op.py", line 81, in make_node[0m
[1m[31mE               [value.type()],[0m
[1m[31mE           [0m
[1m[31mE           Debug print of the apply node: [0m
[1m[31mE           Check{} [id A] <Tensor3(float64, shape=(1, 2, 2))>[0m
[1m[31mE            ├─ [[[-53.709 ... 9479654]]] [id B] <Tensor3(float64, shape=(1, 2, 2))>[0m
[1m[31mE            └─ False [id C] <bool>[0m
[1m[31mE           [0m
[1m[31mE           Storage map footprint:[0m
[1m[31mE            - [[[-53.709 ... 9479654]]], Shape: (1, 2, 2), ElemSize: 8 Byte(s), TotalSize: 32 Byte(s)[0m
[1m[31mE            - False, Shape: (), ElemSize: 1 Byte(s), TotalSize: 1.0 Byte(s)[0m
[1m[31mE            TotalSize: 33.0 Byte(s) 0.000 GB[0m
[1m[31mE            TotalSize inputs: 33.0 Byte(s) 0.000 GB[0m

[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/compile/function/types.py[0m:1038: ParameterValueError
[31m[1m_______ TestMatchesScipy.test_multinomial_vectorized[extra_size1-p0-10] ________[0m

self = <tests.distributions.test_multivariate.TestMatchesScipy object at 0x7f0bb35c7480>
n = array(10), p = array([0.2, 0.3, 0.5]), extra_size = (2,)

    [0m[37m@pytest[39;49;00m.mark.parametrize([33m"[39;49;00m[33mn[39;49;00m[33m"[39;49;00m, [([94m10[39;49;00m), ([[94m10[39;49;00m, [94m11[39;49;00m]), ([[[94m5[39;49;00m, [94m6[39;49;00m], [[94m10[39;49;00m, [94m11[39;49;00m]])])[90m[39;49;00m
    [37m@pytest[39;49;00m.mark.parametrize([90m[39;49;00m
        [33m"[39;49;00m[33mp[39;49;00m[33m"[39;49;00m,[90m[39;49;00m
        [[90m[39;49;00m
            ([[94m0.2[39;49;00m, [94m0.3[39;49;00m, [94m0.5[39;49;00m]),[90m[39;49;00m
            ([[[94m0.2[39;49;00m, [94m0.3[39;49;00m, [94m0.5[39;49;00m], [[94m0.9[39;49;00m, [94m0.09[39;49;00m, [94m0.01[39;49;00m]]),[90m[39;49;00m
            (np.abs(np.random.randn([94m2[39;49;00m, [94m2[39;49;00m, [94m4[39;49;00m))),[90m[39;49;00m
        ],[90m[39;49;00m
    )[90m[39;49;00m
    [37m@pytest[39;49;00m.mark.parametrize([33m"[39;49;00m[33mextra_size[39;49;00m[33m"[39;49;00m, [([94m1[39;49;00m,), ([94m2[39;49;00m,), ([94m2[39;49;00m, [94m3[39;49;00m)])[90m[39;49;00m
    [94mdef[39;49;00m[90m [39;49;00m[92mtest_multinomial_vectorized[39;49;00m([96mself[39;49;00m, n, p, extra_size):[90m[39;49;00m
        n = np.array(n)[90m[39;49;00m
        p = np.array(p)[90m[39;49;00m
        p /= p.sum(axis=-[94m1[39;49;00m, keepdims=[94mTrue[39;49;00m)[90m[39;49;00m
    [90m[39;49;00m
        _, bcast_p = broadcast_params([n, p], ndims_params=[[94m0[39;49;00m, [94m1[39;49;00m])[90m[39;49;00m
        size = extra_size + bcast_p.shape[:-[94m1[39;49;00m][90m[39;49;00m
    [90m[39;49;00m
        mn = pm.Multinomial.dist(n=n, p=p, size=size)[90m[39;49;00m
        vals = mn.eval()[90m[39;49;00m
    [90m[39;49;00m
>       npt.assert_almost_equal([90m[39;49;00m
            st.multinomial.logpmf(vals, n, p),[90m[39;49;00m
            pm.logp(mn, vals).eval(),[90m[39;49;00m
            decimal=[94m4[39;49;00m,[90m[39;49;00m
            err_msg=[33mf[39;49;00m[33m"[39;49;00m[33mvals=[39;49;00m[33m{[39;49;00mvals[33m}[39;49;00m[33m"[39;49;00m,[90m[39;49;00m
        )[90m[39;49;00m
[1m[31mE       AssertionError: [0m
[1m[31mE       Arrays are not almost equal to 4 decimals[0m
[1m[31mE       vals=[[3 1 6][0m
[1m[31mE        [0 1 9]][0m
[1m[31mE       (shapes (2,), (1,) mismatch)[0m
[1m[31mE        ACTUAL: array([-3.4578, -5.1397])[0m
[1m[31mE        DESIRED: array([-23.7019])[0m

[1m[31mtests/distributions/test_multivariate.py[0m:690: AssertionError
[31m[1m_______ TestMatchesScipy.test_multinomial_vectorized[extra_size1-p0-n1] ________[0m

self = <tests.distributions.test_multivariate.TestMatchesScipy object at 0x7f0bb35c74d0>
n = array([10, 11]), p = array([0.2, 0.3, 0.5]), extra_size = (2,)

    [0m[37m@pytest[39;49;00m.mark.parametrize([33m"[39;49;00m[33mn[39;49;00m[33m"[39;49;00m, [([94m10[39;49;00m), ([[94m10[39;49;00m, [94m11[39;49;00m]), ([[[94m5[39;49;00m, [94m6[39;49;00m], [[94m10[39;49;00m, [94m11[39;49;00m]])])[90m[39;49;00m
    [37m@pytest[39;49;00m.mark.parametrize([90m[39;49;00m
        [33m"[39;49;00m[33mp[39;49;00m[33m"[39;49;00m,[90m[39;49;00m
        [[90m[39;49;00m
            ([[94m0.2[39;49;00m, [94m0.3[39;49;00m, [94m0.5[39;49;00m]),[90m[39;49;00m
            ([[[94m0.2[39;49;00m, [94m0.3[39;49;00m, [94m0.5[39;49;00m], [[94m0.9[39;49;00m, [94m0.09[39;49;00m, [94m0.01[39;49;00m]]),[90m[39;49;00m
            (np.abs(np.random.randn([94m2[39;49;00m, [94m2[39;49;00m, [94m4[39;49;00m))),[90m[39;49;00m
        ],[90m[39;49;00m
    )[90m[39;49;00m
    [37m@pytest[39;49;00m.mark.parametrize([33m"[39;49;00m[33mextra_size[39;49;00m[33m"[39;49;00m, [([94m1[39;49;00m,), ([94m2[39;49;00m,), ([94m2[39;49;00m, [94m3[39;49;00m)])[90m[39;49;00m
    [94mdef[39;49;00m[90m [39;49;00m[92mtest_multinomial_vectorized[39;49;00m([96mself[39;49;00m, n, p, extra_size):[90m[39;49;00m
        n = np.array(n)[90m[39;49;00m
        p = np.array(p)[90m[39;49;00m
        p /= p.sum(axis=-[94m1[39;49;00m, keepdims=[94mTrue[39;49;00m)[90m[39;49;00m
    [90m[39;49;00m
        _, bcast_p = broadcast_params([n, p], ndims_params=[[94m0[39;49;00m, [94m1[39;49;00m])[90m[39;49;00m
        size = extra_size + bcast_p.shape[:-[94m1[39;49;00m][90m[39;49;00m
    [90m[39;49;00m
        mn = pm.Multinomial.dist(n=n, p=p, size=size)[90m[39;49;00m
        vals = mn.eval()[90m[39;49;00m
    [90m[39;49;00m
>       npt.assert_almost_equal([90m[39;49;00m
            st.multinomial.logpmf(vals, n, p),[90m[39;49;00m
            pm.logp(mn, vals).eval(),[90m[39;49;00m
            decimal=[94m4[39;49;00m,[90m[39;49;00m
            err_msg=[33mf[39;49;00m[33m"[39;49;00m[33mvals=[39;49;00m[33m{[39;49;00mvals[33m}[39;49;00m[33m"[39;49;00m,[90m[39;49;00m
        )[90m[39;49;00m
[1m[31mE       AssertionError: [0m
[1m[31mE       Arrays are not almost equal to 4 decimals[0m
[1m[31mE       vals=[[[3 2 5][0m
[1m[31mE         [3 2 6]][0m
[1m[31mE       [0m
[1m[31mE        [[2 3 5][0m
[1m[31mE         [2 4 5]]][0m
[1m[31mE       (shapes (2, 2), (1, 2) mismatch)[0m
[1m[31mE        ACTUAL: array([[-2.87  , -2.957 ],[0m
[1m[31mE              [-2.4645, -2.6569]])[0m
[1m[31mE        DESIRED: array([[-61.0574, -58.6595]])[0m

[1m[31mtests/distributions/test_multivariate.py[0m:690: AssertionError
[31m[1m_______ TestMatchesScipy.test_multinomial_vectorized[extra_size1-p0-n2] ________[0m

self = <tests.distributions.test_multivariate.TestMatchesScipy object at 0x7f0bb35c7520>
n = array([[ 5,  6],
       [10, 11]]), p = array([0.2, 0.3, 0.5])
extra_size = (2,)

    [0m[37m@pytest[39;49;00m.mark.parametrize([33m"[39;49;00m[33mn[39;49;00m[33m"[39;49;00m, [([94m10[39;49;00m), ([[94m10[39;49;00m, [94m11[39;49;00m]), ([[[94m5[39;49;00m, [94m6[39;49;00m], [[94m10[39;49;00m, [94m11[39;49;00m]])])[90m[39;49;00m
    [37m@pytest[39;49;00m.mark.parametrize([90m[39;49;00m
        [33m"[39;49;00m[33mp[39;49;00m[33m"[39;49;00m,[90m[39;49;00m
        [[90m[39;49;00m
            ([[94m0.2[39;49;00m, [94m0.3[39;49;00m, [94m0.5[39;49;00m]),[90m[39;49;00m
            ([[[94m0.2[39;49;00m, [94m0.3[39;49;00m, [94m0.5[39;49;00m], [[94m0.9[39;49;00m, [94m0.09[39;49;00m, [94m0.01[39;49;00m]]),[90m[39;49;00m
            (np.abs(np.random.randn([94m2[39;49;00m, [94m2[39;49;00m, [94m4[39;49;00m))),[90m[39;49;00m
        ],[90m[39;49;00m
    )[90m[39;49;00m
    [37m@pytest[39;49;00m.mark.parametrize([33m"[39;49;00m[33mextra_size[39;49;00m[33m"[39;49;00m, [([94m1[39;49;00m,), ([94m2[39;49;00m,), ([94m2[39;49;00m, [94m3[39;49;00m)])[90m[39;49;00m
    [94mdef[39;49;00m[90m [39;49;00m[92mtest_multinomial_vectorized[39;49;00m([96mself[39;49;00m, n, p, extra_size):[90m[39;49;00m
        n = np.array(n)[90m[39;49;00m
        p = np.array(p)[90m[39;49;00m
        p /= p.sum(axis=-[94m1[39;49;00m, keepdims=[94mTrue[39;49;00m)[90m[39;49;00m
    [90m[39;49;00m
        _, bcast_p = broadcast_params([n, p], ndims_params=[[94m0[39;49;00m, [94m1[39;49;00m])[90m[39;49;00m
        size = extra_size + bcast_p.shape[:-[94m1[39;49;00m][90m[39;49;00m
    [90m[39;49;00m
        mn = pm.Multinomial.dist(n=n, p=p, size=size)[90m[39;49;00m
        vals = mn.eval()[90m[39;49;00m
    [90m[39;49;00m
>       npt.assert_almost_equal([90m[39;49;00m
            st.multinomial.logpmf(vals, n, p),[90m[39;49;00m
            pm.logp(mn, vals).eval(),[90m[39;49;00m
            decimal=[94m4[39;49;00m,[90m[39;49;00m
            err_msg=[33mf[39;49;00m[33m"[39;49;00m[33mvals=[39;49;00m[33m{[39;49;00mvals[33m}[39;49;00m[33m"[39;49;00m,[90m[39;49;00m
        )[90m[39;49;00m
[1m[31mE       AssertionError: [0m
[1m[31mE       Arrays are not almost equal to 4 decimals[0m
[1m[31mE       vals=[[[[3 0 2][0m
[1m[31mE          [2 0 4]][0m
[1m[31mE       [0m
[1m[31mE         [[2 2 6][0m
[1m[31mE          [1 2 8]]][0m
[1m[31mE       [0m
[1m[31mE       [0m
[1m[31mE        [[[2 0 3][0m
[1m[31mE          [4 1 1]][0m
[1m[31mE       [0m
[1m[31mE         [[3 2 5][0m
[1m[31mE          [2 2 7]]]][0m
[1m[31mE       (shapes (2, 2, 2), (1, 2, 2) mismatch)[0m
[1m[31mE        ACTUAL: array([[[-3.912 , -3.2834],[0m
[1m[31mE               [-2.6468, -3.358 ]],[0m
[1m[31mE       ...[0m
[1m[31mE        DESIRED: array([[[-110.0471, -108.2553],[0m
[1m[31mE               [ -99.7302,  -97.3323]]])[0m

[1m[31mtests/distributions/test_multivariate.py[0m:690: AssertionError
[31m[1m_______ TestMatchesScipy.test_multinomial_vectorized[extra_size1-p1-10] ________[0m

self = <pytensor.compile.function.types.Function object at 0x7f0b9aff2330>
output_subset = None, args = (), kwargs = {}, trust_input = False
vm = <pytensor.link.c.cvm.CVM object at 0x7f0ba293be30>, profile = None

    [0m[94mdef[39;49;00m[90m [39;49;00m[92m__call__[39;49;00m([96mself[39;49;00m, *args, output_subset=[94mNone[39;49;00m, **kwargs):[90m[39;49;00m
    [90m    [39;49;00m[33m"""[39;49;00m
    [33m    Evaluates value of a function on given arguments.[39;49;00m
    [33m[39;49;00m
    [33m    Parameters[39;49;00m
    [33m    ----------[39;49;00m
    [33m    args : list[39;49;00m
    [33m        List of inputs to the function. All inputs are required, even when[39;49;00m
    [33m        some of them are not necessary to calculate requested subset of[39;49;00m
    [33m        outputs.[39;49;00m
    [33m[39;49;00m
    [33m    kwargs : dict[39;49;00m
    [33m        The function inputs can be passed as keyword argument. For this, use[39;49;00m
    [33m        the name of the input or the input instance as the key.[39;49;00m
    [33m[39;49;00m
    [33m        Keyword argument ``output_subset`` is a list of either indices of the[39;49;00m
    [33m        function's outputs or the keys belonging to the `output_keys` dict[39;49;00m
    [33m        and represent outputs that are requested to be calculated. Regardless[39;49;00m
    [33m        of the presence of ``output_subset``, the updates are always calculated[39;49;00m
    [33m        and processed. To disable the updates, you should use the ``copy``[39;49;00m
    [33m        method with ``delete_updates=True``.[39;49;00m
    [33m[39;49;00m
    [33m    Returns[39;49;00m
    [33m    -------[39;49;00m
    [33m    list[39;49;00m
    [33m        List of outputs on indices/keys from ``output_subset`` or all of them,[39;49;00m
    [33m        if ``output_subset`` is not passed.[39;49;00m
    [33m    """[39;49;00m[90m[39;49;00m
        trust_input = [96mself[39;49;00m.trust_input[90m[39;49;00m
        input_storage = [96mself[39;49;00m.input_storage[90m[39;49;00m
        vm = [96mself[39;49;00m.vm[90m[39;49;00m
        profile = [96mself[39;49;00m.profile[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0 = time.perf_counter()[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m output_subset [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
            warnings.warn([33m"[39;49;00m[33moutput_subset is deprecated.[39;49;00m[33m"[39;49;00m, [96mFutureWarning[39;49;00m)[90m[39;49;00m
            [94mif[39;49;00m [96mself[39;49;00m.output_keys [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                output_subset = [[96mself[39;49;00m.output_keys.index(key) [94mfor[39;49;00m key [95min[39;49;00m output_subset][90m[39;49;00m
    [90m[39;49;00m
        [90m# Reinitialize each container's 'provided' counter[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m trust_input:[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
        [94melse[39;49;00m:[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                arg_container.provided = [94m0[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
            [94mif[39;49;00m [96mlen[39;49;00m(args) + [96mlen[39;49;00m(kwargs) > [96mlen[39;49;00m(input_storage):[90m[39;49;00m
                [94mraise[39;49;00m [96mTypeError[39;49;00m([33m"[39;49;00m[33mToo many parameter passed to pytensor function[39;49;00m[33m"[39;49;00m)[90m[39;49;00m
    [90m[39;49;00m
            [90m# Set positional arguments[39;49;00m[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                [90m# See discussion about None as input[39;49;00m[90m[39;49;00m
                [90m# https://groups.google.com/group/theano-dev/browse_thread/thread/920a5e904e8a8525/4f1b311a28fc27e5[39;49;00m[90m[39;49;00m
                [94mif[39;49;00m arg [95mis[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                    arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
                [94melse[39;49;00m:[90m[39;49;00m
                    [94mtry[39;49;00m:[90m[39;49;00m
                        arg_container.storage[[94m0[39;49;00m] = arg_container.type.filter([90m[39;49;00m
                            arg,[90m[39;49;00m
                            strict=arg_container.strict,[90m[39;49;00m
                            allow_downcast=arg_container.allow_downcast,[90m[39;49;00m
                        )[90m[39;49;00m
    [90m[39;49;00m
                    [94mexcept[39;49;00m [96mException[39;49;00m [94mas[39;49;00m e:[90m[39;49;00m
                        i = input_storage.index(arg_container)[90m[39;49;00m
                        function_name = [33m"[39;49;00m[33mpytensor function[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        argument_name = [33m"[39;49;00m[33margument[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mself[39;49;00m.name:[90m[39;49;00m
                            function_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + [96mself[39;49;00m.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mhasattr[39;49;00m(arg, [33m"[39;49;00m[33mname[39;49;00m[33m"[39;49;00m) [95mand[39;49;00m arg.name:[90m[39;49;00m
                            argument_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + arg.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        where = get_variable_trace_string([96mself[39;49;00m.maker.inputs[i].variable)[90m[39;49;00m
                        [94mif[39;49;00m [96mlen[39;49;00m(e.args) == [94m1[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + e.args[[94m0[39;49;00m],[90m[39;49;00m
                            )[90m[39;49;00m
                        [94melse[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                            ) + e.args[90m[39;49;00m
                        [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                        [94mraise[39;49;00m[90m[39;49;00m
                arg_container.provided += [94m1[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
        [90m# Set keyword arguments[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m kwargs:  [90m# for speed, skip the items for empty kwargs[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m k, arg [95min[39;49;00m kwargs.items():[90m[39;49;00m
                [96mself[39;49;00m[k] = arg[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m [95mnot[39;49;00m trust_input:[90m[39;49;00m
            [90m# Collect aliased inputs among the storage space[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m potential_group [95min[39;49;00m [96mself[39;49;00m._potential_aliased_input_groups:[90m[39;49;00m
                args_share_memory: [96mlist[39;49;00m[[96mlist[39;49;00m[[96mint[39;49;00m]] = [][90m[39;49;00m
                [94mfor[39;49;00m i [95min[39;49;00m potential_group:[90m[39;49;00m
                    i_type = [96mself[39;49;00m.maker.inputs[i].variable.type[90m[39;49;00m
                    i_val = input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
    [90m[39;49;00m
                    [90m# Check if value is aliased with any of the values in one of the groups[39;49;00m[90m[39;49;00m
                    [94mfor[39;49;00m j_group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                        [94mif[39;49;00m [96many[39;49;00m([90m[39;49;00m
                            i_type.may_share_memory(input_storage[j].storage[[94m0[39;49;00m], i_val)[90m[39;49;00m
                            [94mfor[39;49;00m j [95min[39;49;00m j_group[90m[39;49;00m
                        ):[90m[39;49;00m
                            j_group.append(i)[90m[39;49;00m
                            [94mbreak[39;49;00m[90m[39;49;00m
                    [94melse[39;49;00m:  [90m# no break[39;49;00m[90m[39;49;00m
                        [90m# Create a new group[39;49;00m[90m[39;49;00m
                        args_share_memory.append([i])[90m[39;49;00m
    [90m[39;49;00m
                [90m# Check for groups of more than one argument that share memory[39;49;00m[90m[39;49;00m
                [94mfor[39;49;00m group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                    [94mif[39;49;00m [96mlen[39;49;00m(group) > [94m1[39;49;00m:[90m[39;49;00m
                        [90m# copy all but the first[39;49;00m[90m[39;49;00m
                        [94mfor[39;49;00m i [95min[39;49;00m group[[94m1[39;49;00m:]:[90m[39;49;00m
                            input_storage[i].storage[[94m0[39;49;00m] = copy.copy([90m[39;49;00m
                                input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
                            )[90m[39;49;00m
    [90m[39;49;00m
            [90m# Check if inputs are missing, or if inputs were set more than once, or[39;49;00m[90m[39;49;00m
            [90m# if we tried to provide inputs that are supposed to be implicit.[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                [94mif[39;49;00m arg_container.required [95mand[39;49;00m [95mnot[39;49;00m arg_container.provided:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMissing required input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.provided > [94m1[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMultiple values for input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.implicit [95mand[39;49;00m arg_container.provided > [94m0[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mTried to provide value for implicit input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
    [90m[39;49;00m
        [90m# Do the actual work[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0_fn = time.perf_counter()[90m[39;49;00m
        [94mtry[39;49;00m:[90m[39;49;00m
>           outputs = vm() [94mif[39;49;00m output_subset [95mis[39;49;00m [94mNone[39;49;00m [94melse[39;49;00m vm(output_subset=output_subset)[90m[39;49;00m
                      ^^^^[90m[39;49;00m
[1m[31mE           pymc.logprob.utils.ParameterValueError[0m

[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/compile/function/types.py[0m:1038: ParameterValueError

[33mDuring handling of the above exception, another exception occurred:[0m

self = <tests.distributions.test_multivariate.TestMatchesScipy object at 0x7f0bb35c7570>
n = array(10), p = array([[0.2 , 0.3 , 0.5 ],
       [0.9 , 0.09, 0.01]])
extra_size = (2,)

    [0m[37m@pytest[39;49;00m.mark.parametrize([33m"[39;49;00m[33mn[39;49;00m[33m"[39;49;00m, [([94m10[39;49;00m), ([[94m10[39;49;00m, [94m11[39;49;00m]), ([[[94m5[39;49;00m, [94m6[39;49;00m], [[94m10[39;49;00m, [94m11[39;49;00m]])])[90m[39;49;00m
    [37m@pytest[39;49;00m.mark.parametrize([90m[39;49;00m
        [33m"[39;49;00m[33mp[39;49;00m[33m"[39;49;00m,[90m[39;49;00m
        [[90m[39;49;00m
            ([[94m0.2[39;49;00m, [94m0.3[39;49;00m, [94m0.5[39;49;00m]),[90m[39;49;00m
            ([[[94m0.2[39;49;00m, [94m0.3[39;49;00m, [94m0.5[39;49;00m], [[94m0.9[39;49;00m, [94m0.09[39;49;00m, [94m0.01[39;49;00m]]),[90m[39;49;00m
            (np.abs(np.random.randn([94m2[39;49;00m, [94m2[39;49;00m, [94m4[39;49;00m))),[90m[39;49;00m
        ],[90m[39;49;00m
    )[90m[39;49;00m
    [37m@pytest[39;49;00m.mark.parametrize([33m"[39;49;00m[33mextra_size[39;49;00m[33m"[39;49;00m, [([94m1[39;49;00m,), ([94m2[39;49;00m,), ([94m2[39;49;00m, [94m3[39;49;00m)])[90m[39;49;00m
    [94mdef[39;49;00m[90m [39;49;00m[92mtest_multinomial_vectorized[39;49;00m([96mself[39;49;00m, n, p, extra_size):[90m[39;49;00m
        n = np.array(n)[90m[39;49;00m
        p = np.array(p)[90m[39;49;00m
        p /= p.sum(axis=-[94m1[39;49;00m, keepdims=[94mTrue[39;49;00m)[90m[39;49;00m
    [90m[39;49;00m
        _, bcast_p = broadcast_params([n, p], ndims_params=[[94m0[39;49;00m, [94m1[39;49;00m])[90m[39;49;00m
        size = extra_size + bcast_p.shape[:-[94m1[39;49;00m][90m[39;49;00m
    [90m[39;49;00m
        mn = pm.Multinomial.dist(n=n, p=p, size=size)[90m[39;49;00m
        vals = mn.eval()[90m[39;49;00m
    [90m[39;49;00m
        npt.assert_almost_equal([90m[39;49;00m
            st.multinomial.logpmf(vals, n, p),[90m[39;49;00m
>           pm.logp(mn, vals).eval(),[90m[39;49;00m
            ^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
            decimal=[94m4[39;49;00m,[90m[39;49;00m
            err_msg=[33mf[39;49;00m[33m"[39;49;00m[33mvals=[39;49;00m[33m{[39;49;00mvals[33m}[39;49;00m[33m"[39;49;00m,[90m[39;49;00m
        )[90m[39;49;00m

[1m[31mtests/distributions/test_multivariate.py[0m:692:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/graph/basic.py[0m:668: in eval
    [0m[94mreturn[39;49;00m fn(*args)[90m[39;49;00m
           ^^^^^^^^^[90m[39;49;00m
[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/compile/function/types.py[0m:1048: in __call__
    [0mraise_with_op([90m[39;49;00m
[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/link/utils.py[0m:526: in raise_with_op
    [0m[94mraise[39;49;00m exc_value.with_traceback(exc_trace)[90m[39;49;00m
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <pytensor.compile.function.types.Function object at 0x7f0b9aff2330>
output_subset = None, args = (), kwargs = {}, trust_input = False
vm = <pytensor.link.c.cvm.CVM object at 0x7f0ba293be30>, profile = None

    [0m[94mdef[39;49;00m[90m [39;49;00m[92m__call__[39;49;00m([96mself[39;49;00m, *args, output_subset=[94mNone[39;49;00m, **kwargs):[90m[39;49;00m
    [90m    [39;49;00m[33m"""[39;49;00m
    [33m    Evaluates value of a function on given arguments.[39;49;00m
    [33m[39;49;00m
    [33m    Parameters[39;49;00m
    [33m    ----------[39;49;00m
    [33m    args : list[39;49;00m
    [33m        List of inputs to the function. All inputs are required, even when[39;49;00m
    [33m        some of them are not necessary to calculate requested subset of[39;49;00m
    [33m        outputs.[39;49;00m
    [33m[39;49;00m
    [33m    kwargs : dict[39;49;00m
    [33m        The function inputs can be passed as keyword argument. For this, use[39;49;00m
    [33m        the name of the input or the input instance as the key.[39;49;00m
    [33m[39;49;00m
    [33m        Keyword argument ``output_subset`` is a list of either indices of the[39;49;00m
    [33m        function's outputs or the keys belonging to the `output_keys` dict[39;49;00m
    [33m        and represent outputs that are requested to be calculated. Regardless[39;49;00m
    [33m        of the presence of ``output_subset``, the updates are always calculated[39;49;00m
    [33m        and processed. To disable the updates, you should use the ``copy``[39;49;00m
    [33m        method with ``delete_updates=True``.[39;49;00m
    [33m[39;49;00m
    [33m    Returns[39;49;00m
    [33m    -------[39;49;00m
    [33m    list[39;49;00m
    [33m        List of outputs on indices/keys from ``output_subset`` or all of them,[39;49;00m
    [33m        if ``output_subset`` is not passed.[39;49;00m
    [33m    """[39;49;00m[90m[39;49;00m
        trust_input = [96mself[39;49;00m.trust_input[90m[39;49;00m
        input_storage = [96mself[39;49;00m.input_storage[90m[39;49;00m
        vm = [96mself[39;49;00m.vm[90m[39;49;00m
        profile = [96mself[39;49;00m.profile[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0 = time.perf_counter()[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m output_subset [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
            warnings.warn([33m"[39;49;00m[33moutput_subset is deprecated.[39;49;00m[33m"[39;49;00m, [96mFutureWarning[39;49;00m)[90m[39;49;00m
            [94mif[39;49;00m [96mself[39;49;00m.output_keys [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                output_subset = [[96mself[39;49;00m.output_keys.index(key) [94mfor[39;49;00m key [95min[39;49;00m output_subset][90m[39;49;00m
    [90m[39;49;00m
        [90m# Reinitialize each container's 'provided' counter[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m trust_input:[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
        [94melse[39;49;00m:[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                arg_container.provided = [94m0[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
            [94mif[39;49;00m [96mlen[39;49;00m(args) + [96mlen[39;49;00m(kwargs) > [96mlen[39;49;00m(input_storage):[90m[39;49;00m
                [94mraise[39;49;00m [96mTypeError[39;49;00m([33m"[39;49;00m[33mToo many parameter passed to pytensor function[39;49;00m[33m"[39;49;00m)[90m[39;49;00m
    [90m[39;49;00m
            [90m# Set positional arguments[39;49;00m[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                [90m# See discussion about None as input[39;49;00m[90m[39;49;00m
                [90m# https://groups.google.com/group/theano-dev/browse_thread/thread/920a5e904e8a8525/4f1b311a28fc27e5[39;49;00m[90m[39;49;00m
                [94mif[39;49;00m arg [95mis[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                    arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
                [94melse[39;49;00m:[90m[39;49;00m
                    [94mtry[39;49;00m:[90m[39;49;00m
                        arg_container.storage[[94m0[39;49;00m] = arg_container.type.filter([90m[39;49;00m
                            arg,[90m[39;49;00m
                            strict=arg_container.strict,[90m[39;49;00m
                            allow_downcast=arg_container.allow_downcast,[90m[39;49;00m
                        )[90m[39;49;00m
    [90m[39;49;00m
                    [94mexcept[39;49;00m [96mException[39;49;00m [94mas[39;49;00m e:[90m[39;49;00m
                        i = input_storage.index(arg_container)[90m[39;49;00m
                        function_name = [33m"[39;49;00m[33mpytensor function[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        argument_name = [33m"[39;49;00m[33margument[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mself[39;49;00m.name:[90m[39;49;00m
                            function_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + [96mself[39;49;00m.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mhasattr[39;49;00m(arg, [33m"[39;49;00m[33mname[39;49;00m[33m"[39;49;00m) [95mand[39;49;00m arg.name:[90m[39;49;00m
                            argument_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + arg.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        where = get_variable_trace_string([96mself[39;49;00m.maker.inputs[i].variable)[90m[39;49;00m
                        [94mif[39;49;00m [96mlen[39;49;00m(e.args) == [94m1[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + e.args[[94m0[39;49;00m],[90m[39;49;00m
                            )[90m[39;49;00m
                        [94melse[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                            ) + e.args[90m[39;49;00m
                        [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                        [94mraise[39;49;00m[90m[39;49;00m
                arg_container.provided += [94m1[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
        [90m# Set keyword arguments[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m kwargs:  [90m# for speed, skip the items for empty kwargs[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m k, arg [95min[39;49;00m kwargs.items():[90m[39;49;00m
                [96mself[39;49;00m[k] = arg[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m [95mnot[39;49;00m trust_input:[90m[39;49;00m
            [90m# Collect aliased inputs among the storage space[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m potential_group [95min[39;49;00m [96mself[39;49;00m._potential_aliased_input_groups:[90m[39;49;00m
                args_share_memory: [96mlist[39;49;00m[[96mlist[39;49;00m[[96mint[39;49;00m]] = [][90m[39;49;00m
                [94mfor[39;49;00m i [95min[39;49;00m potential_group:[90m[39;49;00m
                    i_type = [96mself[39;49;00m.maker.inputs[i].variable.type[90m[39;49;00m
                    i_val = input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
    [90m[39;49;00m
                    [90m# Check if value is aliased with any of the values in one of the groups[39;49;00m[90m[39;49;00m
                    [94mfor[39;49;00m j_group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                        [94mif[39;49;00m [96many[39;49;00m([90m[39;49;00m
                            i_type.may_share_memory(input_storage[j].storage[[94m0[39;49;00m], i_val)[90m[39;49;00m
                            [94mfor[39;49;00m j [95min[39;49;00m j_group[90m[39;49;00m
                        ):[90m[39;49;00m
                            j_group.append(i)[90m[39;49;00m
                            [94mbreak[39;49;00m[90m[39;49;00m
                    [94melse[39;49;00m:  [90m# no break[39;49;00m[90m[39;49;00m
                        [90m# Create a new group[39;49;00m[90m[39;49;00m
                        args_share_memory.append([i])[90m[39;49;00m
    [90m[39;49;00m
                [90m# Check for groups of more than one argument that share memory[39;49;00m[90m[39;49;00m
                [94mfor[39;49;00m group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                    [94mif[39;49;00m [96mlen[39;49;00m(group) > [94m1[39;49;00m:[90m[39;49;00m
                        [90m# copy all but the first[39;49;00m[90m[39;49;00m
                        [94mfor[39;49;00m i [95min[39;49;00m group[[94m1[39;49;00m:]:[90m[39;49;00m
                            input_storage[i].storage[[94m0[39;49;00m] = copy.copy([90m[39;49;00m
                                input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
                            )[90m[39;49;00m
    [90m[39;49;00m
            [90m# Check if inputs are missing, or if inputs were set more than once, or[39;49;00m[90m[39;49;00m
            [90m# if we tried to provide inputs that are supposed to be implicit.[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                [94mif[39;49;00m arg_container.required [95mand[39;49;00m [95mnot[39;49;00m arg_container.provided:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMissing required input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.provided > [94m1[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMultiple values for input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.implicit [95mand[39;49;00m arg_container.provided > [94m0[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mTried to provide value for implicit input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
    [90m[39;49;00m
        [90m# Do the actual work[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0_fn = time.perf_counter()[90m[39;49;00m
        [94mtry[39;49;00m:[90m[39;49;00m
>           outputs = vm() [94mif[39;49;00m output_subset [95mis[39;49;00m [94mNone[39;49;00m [94melse[39;49;00m vm(output_subset=output_subset)[90m[39;49;00m
                      ^^^^[90m[39;49;00m
[1m[31mE           pymc.logprob.utils.ParameterValueError: [0m
[1m[31mE           Apply node that caused the error: Check{}([[-54.71660357]], False)[0m
[1m[31mE           Toposort index: 0[0m
[1m[31mE           Inputs types: [TensorType(float64, shape=(1, 1)), ScalarType(bool)][0m
[1m[31mE           Inputs shapes: [(1, 1), ()][0m
[1m[31mE           Inputs strides: [(8, 8), ()][0m
[1m[31mE           Inputs values: [array([[-54.71660357]]), np.False_][0m
[1m[31mE           Inputs type_num: [12, 0][0m
[1m[31mE           Outputs clients: [[DeepCopyOp(Check{}.0)]][0m
[1m[31mE           [0m
[1m[31mE           Backtrace when the node is created (use PyTensor flag traceback__limit=N to make it longer):[0m
[1m[31mE             File "/app/pymc/logprob/basic.py", line 193, in logp[0m
[1m[31mE               return _logprob_helper(rv, value, **kwargs)[0m
[1m[31mE             File "/app/pymc/logprob/abstract.py", line 70, in _logprob_helper[0m
[1m[31mE               logprob = _logprob(rv.owner.op, values, *rv.owner.inputs, **kwargs)[0m
[1m[31mE             File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/functools.py", line 982, in wrapper[0m
[1m[31mE               return dispatch(args[0].__class__)(*args, **kw)[0m
[1m[31mE             File "/app/pymc/distributions/distribution.py", line 140, in logp[0m
[1m[31mE               return class_logp(value, *dist_params)[0m
[1m[31mE             File "/app/tests/distributions/test_dist_math.py", line 96, in logp[0m
[1m[31mE               return check_parameters([0m
[1m[31mE             File "/app/pymc/distributions/dist_math.py", line 72, in check_parameters[0m
[1m[31mE               return CheckParameterValue(msg, can_be_replaced_by_ninf)(expr, all_true_scalar)[0m
[1m[31mE             File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/graph/op.py", line 294, in __call__[0m
[1m[31mE               node = self.make_node(*inputs, **kwargs)[0m
[1m[31mE             File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/raise_op.py", line 81, in make_node[0m
[1m[31mE               [value.type()],[0m
[1m[31mE           [0m
[1m[31mE           Debug print of the apply node: [0m
[1m[31mE           Check{} [id A] <Matrix(float64, shape=(1, 1))>[0m
[1m[31mE            ├─ [[-54.71660357]] [id B] <Matrix(float64, shape=(1, 1))>[0m
[1m[31mE            └─ False [id C] <bool>[0m
[1m[31mE           [0m
[1m[31mE           Storage map footprint:[0m
[1m[31mE            - [[-54.71660357]], Shape: (1, 1), ElemSize: 8 Byte(s), TotalSize: 8 Byte(s)[0m
[1m[31mE            - False, Shape: (), ElemSize: 1 Byte(s), TotalSize: 1.0 Byte(s)[0m
[1m[31mE            TotalSize: 9.0 Byte(s) 0.000 GB[0m
[1m[31mE            TotalSize inputs: 9.0 Byte(s) 0.000 GB[0m

[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/compile/function/types.py[0m:1038: ParameterValueError
[31m[1m_______ TestMatchesScipy.test_multinomial_vectorized[extra_size1-p1-n1] ________[0m

self = <pytensor.compile.function.types.Function object at 0x7f0b9d5af0b0>
output_subset = None, args = (), kwargs = {}, trust_input = False
vm = <pytensor.link.c.cvm.CVM object at 0x7f0ba2938310>, profile = None

    [0m[94mdef[39;49;00m[90m [39;49;00m[92m__call__[39;49;00m([96mself[39;49;00m, *args, output_subset=[94mNone[39;49;00m, **kwargs):[90m[39;49;00m
    [90m    [39;49;00m[33m"""[39;49;00m
    [33m    Evaluates value of a function on given arguments.[39;49;00m
    [33m[39;49;00m
    [33m    Parameters[39;49;00m
    [33m    ----------[39;49;00m
    [33m    args : list[39;49;00m
    [33m        List of inputs to the function. All inputs are required, even when[39;49;00m
    [33m        some of them are not necessary to calculate requested subset of[39;49;00m
    [33m        outputs.[39;49;00m
    [33m[39;49;00m
    [33m    kwargs : dict[39;49;00m
    [33m        The function inputs can be passed as keyword argument. For this, use[39;49;00m
    [33m        the name of the input or the input instance as the key.[39;49;00m
    [33m[39;49;00m
    [33m        Keyword argument ``output_subset`` is a list of either indices of the[39;49;00m
    [33m        function's outputs or the keys belonging to the `output_keys` dict[39;49;00m
    [33m        and represent outputs that are requested to be calculated. Regardless[39;49;00m
    [33m        of the presence of ``output_subset``, the updates are always calculated[39;49;00m
    [33m        and processed. To disable the updates, you should use the ``copy``[39;49;00m
    [33m        method with ``delete_updates=True``.[39;49;00m
    [33m[39;49;00m
    [33m    Returns[39;49;00m
    [33m    -------[39;49;00m
    [33m    list[39;49;00m
    [33m        List of outputs on indices/keys from ``output_subset`` or all of them,[39;49;00m
    [33m        if ``output_subset`` is not passed.[39;49;00m
    [33m    """[39;49;00m[90m[39;49;00m
        trust_input = [96mself[39;49;00m.trust_input[90m[39;49;00m
        input_storage = [96mself[39;49;00m.input_storage[90m[39;49;00m
        vm = [96mself[39;49;00m.vm[90m[39;49;00m
        profile = [96mself[39;49;00m.profile[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0 = time.perf_counter()[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m output_subset [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
            warnings.warn([33m"[39;49;00m[33moutput_subset is deprecated.[39;49;00m[33m"[39;49;00m, [96mFutureWarning[39;49;00m)[90m[39;49;00m
            [94mif[39;49;00m [96mself[39;49;00m.output_keys [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                output_subset = [[96mself[39;49;00m.output_keys.index(key) [94mfor[39;49;00m key [95min[39;49;00m output_subset][90m[39;49;00m
    [90m[39;49;00m
        [90m# Reinitialize each container's 'provided' counter[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m trust_input:[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
        [94melse[39;49;00m:[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                arg_container.provided = [94m0[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
            [94mif[39;49;00m [96mlen[39;49;00m(args) + [96mlen[39;49;00m(kwargs) > [96mlen[39;49;00m(input_storage):[90m[39;49;00m
                [94mraise[39;49;00m [96mTypeError[39;49;00m([33m"[39;49;00m[33mToo many parameter passed to pytensor function[39;49;00m[33m"[39;49;00m)[90m[39;49;00m
    [90m[39;49;00m
            [90m# Set positional arguments[39;49;00m[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                [90m# See discussion about None as input[39;49;00m[90m[39;49;00m
                [90m# https://groups.google.com/group/theano-dev/browse_thread/thread/920a5e904e8a8525/4f1b311a28fc27e5[39;49;00m[90m[39;49;00m
                [94mif[39;49;00m arg [95mis[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                    arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
                [94melse[39;49;00m:[90m[39;49;00m
                    [94mtry[39;49;00m:[90m[39;49;00m
                        arg_container.storage[[94m0[39;49;00m] = arg_container.type.filter([90m[39;49;00m
                            arg,[90m[39;49;00m
                            strict=arg_container.strict,[90m[39;49;00m
                            allow_downcast=arg_container.allow_downcast,[90m[39;49;00m
                        )[90m[39;49;00m
    [90m[39;49;00m
                    [94mexcept[39;49;00m [96mException[39;49;00m [94mas[39;49;00m e:[90m[39;49;00m
                        i = input_storage.index(arg_container)[90m[39;49;00m
                        function_name = [33m"[39;49;00m[33mpytensor function[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        argument_name = [33m"[39;49;00m[33margument[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mself[39;49;00m.name:[90m[39;49;00m
                            function_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + [96mself[39;49;00m.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mhasattr[39;49;00m(arg, [33m"[39;49;00m[33mname[39;49;00m[33m"[39;49;00m) [95mand[39;49;00m arg.name:[90m[39;49;00m
                            argument_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + arg.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        where = get_variable_trace_string([96mself[39;49;00m.maker.inputs[i].variable)[90m[39;49;00m
                        [94mif[39;49;00m [96mlen[39;49;00m(e.args) == [94m1[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + e.args[[94m0[39;49;00m],[90m[39;49;00m
                            )[90m[39;49;00m
                        [94melse[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                            ) + e.args[90m[39;49;00m
                        [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                        [94mraise[39;49;00m[90m[39;49;00m
                arg_container.provided += [94m1[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
        [90m# Set keyword arguments[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m kwargs:  [90m# for speed, skip the items for empty kwargs[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m k, arg [95min[39;49;00m kwargs.items():[90m[39;49;00m
                [96mself[39;49;00m[k] = arg[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m [95mnot[39;49;00m trust_input:[90m[39;49;00m
            [90m# Collect aliased inputs among the storage space[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m potential_group [95min[39;49;00m [96mself[39;49;00m._potential_aliased_input_groups:[90m[39;49;00m
                args_share_memory: [96mlist[39;49;00m[[96mlist[39;49;00m[[96mint[39;49;00m]] = [][90m[39;49;00m
                [94mfor[39;49;00m i [95min[39;49;00m potential_group:[90m[39;49;00m
                    i_type = [96mself[39;49;00m.maker.inputs[i].variable.type[90m[39;49;00m
                    i_val = input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
    [90m[39;49;00m
                    [90m# Check if value is aliased with any of the values in one of the groups[39;49;00m[90m[39;49;00m
                    [94mfor[39;49;00m j_group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                        [94mif[39;49;00m [96many[39;49;00m([90m[39;49;00m
                            i_type.may_share_memory(input_storage[j].storage[[94m0[39;49;00m], i_val)[90m[39;49;00m
                            [94mfor[39;49;00m j [95min[39;49;00m j_group[90m[39;49;00m
                        ):[90m[39;49;00m
                            j_group.append(i)[90m[39;49;00m
                            [94mbreak[39;49;00m[90m[39;49;00m
                    [94melse[39;49;00m:  [90m# no break[39;49;00m[90m[39;49;00m
                        [90m# Create a new group[39;49;00m[90m[39;49;00m
                        args_share_memory.append([i])[90m[39;49;00m
    [90m[39;49;00m
                [90m# Check for groups of more than one argument that share memory[39;49;00m[90m[39;49;00m
                [94mfor[39;49;00m group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                    [94mif[39;49;00m [96mlen[39;49;00m(group) > [94m1[39;49;00m:[90m[39;49;00m
                        [90m# copy all but the first[39;49;00m[90m[39;49;00m
                        [94mfor[39;49;00m i [95min[39;49;00m group[[94m1[39;49;00m:]:[90m[39;49;00m
                            input_storage[i].storage[[94m0[39;49;00m] = copy.copy([90m[39;49;00m
                                input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
                            )[90m[39;49;00m
    [90m[39;49;00m
            [90m# Check if inputs are missing, or if inputs were set more than once, or[39;49;00m[90m[39;49;00m
            [90m# if we tried to provide inputs that are supposed to be implicit.[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                [94mif[39;49;00m arg_container.required [95mand[39;49;00m [95mnot[39;49;00m arg_container.provided:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMissing required input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.provided > [94m1[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMultiple values for input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.implicit [95mand[39;49;00m arg_container.provided > [94m0[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mTried to provide value for implicit input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
    [90m[39;49;00m
        [90m# Do the actual work[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0_fn = time.perf_counter()[90m[39;49;00m
        [94mtry[39;49;00m:[90m[39;49;00m
>           outputs = vm() [94mif[39;49;00m output_subset [95mis[39;49;00m [94mNone[39;49;00m [94melse[39;49;00m vm(output_subset=output_subset)[90m[39;49;00m
                      ^^^^[90m[39;49;00m
[1m[31mE           pymc.logprob.utils.ParameterValueError[0m

[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/compile/function/types.py[0m:1038: ParameterValueError

[33mDuring handling of the above exception, another exception occurred:[0m

self = <tests.distributions.test_multivariate.TestMatchesScipy object at 0x7f0bb35c75c0>
n = array([10, 11]), p = array([[0.2 , 0.3 , 0.5 ],
       [0.9 , 0.09, 0.01]])
extra_size = (2,)

    [0m[37m@pytest[39;49;00m.mark.parametrize([33m"[39;49;00m[33mn[39;49;00m[33m"[39;49;00m, [([94m10[39;49;00m), ([[94m10[39;49;00m, [94m11[39;49;00m]), ([[[94m5[39;49;00m, [94m6[39;49;00m], [[94m10[39;49;00m, [94m11[39;49;00m]])])[90m[39;49;00m
    [37m@pytest[39;49;00m.mark.parametrize([90m[39;49;00m
        [33m"[39;49;00m[33mp[39;49;00m[33m"[39;49;00m,[90m[39;49;00m
        [[90m[39;49;00m
            ([[94m0.2[39;49;00m, [94m0.3[39;49;00m, [94m0.5[39;49;00m]),[90m[39;49;00m
            ([[[94m0.2[39;49;00m, [94m0.3[39;49;00m, [94m0.5[39;49;00m], [[94m0.9[39;49;00m, [94m0.09[39;49;00m, [94m0.01[39;49;00m]]),[90m[39;49;00m
            (np.abs(np.random.randn([94m2[39;49;00m, [94m2[39;49;00m, [94m4[39;49;00m))),[90m[39;49;00m
        ],[90m[39;49;00m
    )[90m[39;49;00m
    [37m@pytest[39;49;00m.mark.parametrize([33m"[39;49;00m[33mextra_size[39;49;00m[33m"[39;49;00m, [([94m1[39;49;00m,), ([94m2[39;49;00m,), ([94m2[39;49;00m, [94m3[39;49;00m)])[90m[39;49;00m
    [94mdef[39;49;00m[90m [39;49;00m[92mtest_multinomial_vectorized[39;49;00m([96mself[39;49;00m, n, p, extra_size):[90m[39;49;00m
        n = np.array(n)[90m[39;49;00m
        p = np.array(p)[90m[39;49;00m
        p /= p.sum(axis=-[94m1[39;49;00m, keepdims=[94mTrue[39;49;00m)[90m[39;49;00m
    [90m[39;49;00m
        _, bcast_p = broadcast_params([n, p], ndims_params=[[94m0[39;49;00m, [94m1[39;49;00m])[90m[39;49;00m
        size = extra_size + bcast_p.shape[:-[94m1[39;49;00m][90m[39;49;00m
    [90m[39;49;00m
        mn = pm.Multinomial.dist(n=n, p=p, size=size)[90m[39;49;00m
        vals = mn.eval()[90m[39;49;00m
    [90m[39;49;00m
        npt.assert_almost_equal([90m[39;49;00m
            st.multinomial.logpmf(vals, n, p),[90m[39;49;00m
>           pm.logp(mn, vals).eval(),[90m[39;49;00m
            ^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
            decimal=[94m4[39;49;00m,[90m[39;49;00m
            err_msg=[33mf[39;49;00m[33m"[39;49;00m[33mvals=[39;49;00m[33m{[39;49;00mvals[33m}[39;49;00m[33m"[39;49;00m,[90m[39;49;00m
        )[90m[39;49;00m

[1m[31mtests/distributions/test_multivariate.py[0m:692:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/graph/basic.py[0m:668: in eval
    [0m[94mreturn[39;49;00m fn(*args)[90m[39;49;00m
           ^^^^^^^^^[90m[39;49;00m
[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/compile/function/types.py[0m:1048: in __call__
    [0mraise_with_op([90m[39;49;00m
[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/link/utils.py[0m:526: in raise_with_op
    [0m[94mraise[39;49;00m exc_value.with_traceback(exc_trace)[90m[39;49;00m
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <pytensor.compile.function.types.Function object at 0x7f0b9d5af0b0>
output_subset = None, args = (), kwargs = {}, trust_input = False
vm = <pytensor.link.c.cvm.CVM object at 0x7f0ba2938310>, profile = None

    [0m[94mdef[39;49;00m[90m [39;49;00m[92m__call__[39;49;00m([96mself[39;49;00m, *args, output_subset=[94mNone[39;49;00m, **kwargs):[90m[39;49;00m
    [90m    [39;49;00m[33m"""[39;49;00m
    [33m    Evaluates value of a function on given arguments.[39;49;00m
    [33m[39;49;00m
    [33m    Parameters[39;49;00m
    [33m    ----------[39;49;00m
    [33m    args : list[39;49;00m
    [33m        List of inputs to the function. All inputs are required, even when[39;49;00m
    [33m        some of them are not necessary to calculate requested subset of[39;49;00m
    [33m        outputs.[39;49;00m
    [33m[39;49;00m
    [33m    kwargs : dict[39;49;00m
    [33m        The function inputs can be passed as keyword argument. For this, use[39;49;00m
    [33m        the name of the input or the input instance as the key.[39;49;00m
    [33m[39;49;00m
    [33m        Keyword argument ``output_subset`` is a list of either indices of the[39;49;00m
    [33m        function's outputs or the keys belonging to the `output_keys` dict[39;49;00m
    [33m        and represent outputs that are requested to be calculated. Regardless[39;49;00m
    [33m        of the presence of ``output_subset``, the updates are always calculated[39;49;00m
    [33m        and processed. To disable the updates, you should use the ``copy``[39;49;00m
    [33m        method with ``delete_updates=True``.[39;49;00m
    [33m[39;49;00m
    [33m    Returns[39;49;00m
    [33m    -------[39;49;00m
    [33m    list[39;49;00m
    [33m        List of outputs on indices/keys from ``output_subset`` or all of them,[39;49;00m
    [33m        if ``output_subset`` is not passed.[39;49;00m
    [33m    """[39;49;00m[90m[39;49;00m
        trust_input = [96mself[39;49;00m.trust_input[90m[39;49;00m
        input_storage = [96mself[39;49;00m.input_storage[90m[39;49;00m
        vm = [96mself[39;49;00m.vm[90m[39;49;00m
        profile = [96mself[39;49;00m.profile[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0 = time.perf_counter()[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m output_subset [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
            warnings.warn([33m"[39;49;00m[33moutput_subset is deprecated.[39;49;00m[33m"[39;49;00m, [96mFutureWarning[39;49;00m)[90m[39;49;00m
            [94mif[39;49;00m [96mself[39;49;00m.output_keys [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                output_subset = [[96mself[39;49;00m.output_keys.index(key) [94mfor[39;49;00m key [95min[39;49;00m output_subset][90m[39;49;00m
    [90m[39;49;00m
        [90m# Reinitialize each container's 'provided' counter[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m trust_input:[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
        [94melse[39;49;00m:[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                arg_container.provided = [94m0[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
            [94mif[39;49;00m [96mlen[39;49;00m(args) + [96mlen[39;49;00m(kwargs) > [96mlen[39;49;00m(input_storage):[90m[39;49;00m
                [94mraise[39;49;00m [96mTypeError[39;49;00m([33m"[39;49;00m[33mToo many parameter passed to pytensor function[39;49;00m[33m"[39;49;00m)[90m[39;49;00m
    [90m[39;49;00m
            [90m# Set positional arguments[39;49;00m[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                [90m# See discussion about None as input[39;49;00m[90m[39;49;00m
                [90m# https://groups.google.com/group/theano-dev/browse_thread/thread/920a5e904e8a8525/4f1b311a28fc27e5[39;49;00m[90m[39;49;00m
                [94mif[39;49;00m arg [95mis[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                    arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
                [94melse[39;49;00m:[90m[39;49;00m
                    [94mtry[39;49;00m:[90m[39;49;00m
                        arg_container.storage[[94m0[39;49;00m] = arg_container.type.filter([90m[39;49;00m
                            arg,[90m[39;49;00m
                            strict=arg_container.strict,[90m[39;49;00m
                            allow_downcast=arg_container.allow_downcast,[90m[39;49;00m
                        )[90m[39;49;00m
    [90m[39;49;00m
                    [94mexcept[39;49;00m [96mException[39;49;00m [94mas[39;49;00m e:[90m[39;49;00m
                        i = input_storage.index(arg_container)[90m[39;49;00m
                        function_name = [33m"[39;49;00m[33mpytensor function[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        argument_name = [33m"[39;49;00m[33margument[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mself[39;49;00m.name:[90m[39;49;00m
                            function_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + [96mself[39;49;00m.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mhasattr[39;49;00m(arg, [33m"[39;49;00m[33mname[39;49;00m[33m"[39;49;00m) [95mand[39;49;00m arg.name:[90m[39;49;00m
                            argument_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + arg.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        where = get_variable_trace_string([96mself[39;49;00m.maker.inputs[i].variable)[90m[39;49;00m
                        [94mif[39;49;00m [96mlen[39;49;00m(e.args) == [94m1[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + e.args[[94m0[39;49;00m],[90m[39;49;00m
                            )[90m[39;49;00m
                        [94melse[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                            ) + e.args[90m[39;49;00m
                        [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                        [94mraise[39;49;00m[90m[39;49;00m
                arg_container.provided += [94m1[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
        [90m# Set keyword arguments[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m kwargs:  [90m# for speed, skip the items for empty kwargs[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m k, arg [95min[39;49;00m kwargs.items():[90m[39;49;00m
                [96mself[39;49;00m[k] = arg[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m [95mnot[39;49;00m trust_input:[90m[39;49;00m
            [90m# Collect aliased inputs among the storage space[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m potential_group [95min[39;49;00m [96mself[39;49;00m._potential_aliased_input_groups:[90m[39;49;00m
                args_share_memory: [96mlist[39;49;00m[[96mlist[39;49;00m[[96mint[39;49;00m]] = [][90m[39;49;00m
                [94mfor[39;49;00m i [95min[39;49;00m potential_group:[90m[39;49;00m
                    i_type = [96mself[39;49;00m.maker.inputs[i].variable.type[90m[39;49;00m
                    i_val = input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
    [90m[39;49;00m
                    [90m# Check if value is aliased with any of the values in one of the groups[39;49;00m[90m[39;49;00m
                    [94mfor[39;49;00m j_group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                        [94mif[39;49;00m [96many[39;49;00m([90m[39;49;00m
                            i_type.may_share_memory(input_storage[j].storage[[94m0[39;49;00m], i_val)[90m[39;49;00m
                            [94mfor[39;49;00m j [95min[39;49;00m j_group[90m[39;49;00m
                        ):[90m[39;49;00m
                            j_group.append(i)[90m[39;49;00m
                            [94mbreak[39;49;00m[90m[39;49;00m
                    [94melse[39;49;00m:  [90m# no break[39;49;00m[90m[39;49;00m
                        [90m# Create a new group[39;49;00m[90m[39;49;00m
                        args_share_memory.append([i])[90m[39;49;00m
    [90m[39;49;00m
                [90m# Check for groups of more than one argument that share memory[39;49;00m[90m[39;49;00m
                [94mfor[39;49;00m group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                    [94mif[39;49;00m [96mlen[39;49;00m(group) > [94m1[39;49;00m:[90m[39;49;00m
                        [90m# copy all but the first[39;49;00m[90m[39;49;00m
                        [94mfor[39;49;00m i [95min[39;49;00m group[[94m1[39;49;00m:]:[90m[39;49;00m
                            input_storage[i].storage[[94m0[39;49;00m] = copy.copy([90m[39;49;00m
                                input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
                            )[90m[39;49;00m
    [90m[39;49;00m
            [90m# Check if inputs are missing, or if inputs were set more than once, or[39;49;00m[90m[39;49;00m
            [90m# if we tried to provide inputs that are supposed to be implicit.[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                [94mif[39;49;00m arg_container.required [95mand[39;49;00m [95mnot[39;49;00m arg_container.provided:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMissing required input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.provided > [94m1[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMultiple values for input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.implicit [95mand[39;49;00m arg_container.provided > [94m0[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mTried to provide value for implicit input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
    [90m[39;49;00m
        [90m# Do the actual work[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0_fn = time.perf_counter()[90m[39;49;00m
        [94mtry[39;49;00m:[90m[39;49;00m
>           outputs = vm() [94mif[39;49;00m output_subset [95mis[39;49;00m [94mNone[39;49;00m [94melse[39;49;00m vm(output_subset=output_subset)[90m[39;49;00m
                      ^^^^[90m[39;49;00m
[1m[31mE           pymc.logprob.utils.ParameterValueError: [0m
[1m[31mE           Apply node that caused the error: Check{}([[-58.8476 ... 44975113]], False)[0m
[1m[31mE           Toposort index: 0[0m
[1m[31mE           Inputs types: [TensorType(float64, shape=(1, 2)), ScalarType(bool)][0m
[1m[31mE           Inputs shapes: [(1, 2), ()][0m
[1m[31mE           Inputs strides: [(16, 8), ()][0m
[1m[31mE           Inputs values: [array([[-58.84764641, -56.44975113]]), np.False_][0m
[1m[31mE           Inputs type_num: [12, 0][0m
[1m[31mE           Outputs clients: [[DeepCopyOp(Check{}.0)]][0m
[1m[31mE           [0m
[1m[31mE           Backtrace when the node is created (use PyTensor flag traceback__limit=N to make it longer):[0m
[1m[31mE             File "/app/pymc/logprob/basic.py", line 193, in logp[0m
[1m[31mE               return _logprob_helper(rv, value, **kwargs)[0m
[1m[31mE             File "/app/pymc/logprob/abstract.py", line 70, in _logprob_helper[0m
[1m[31mE               logprob = _logprob(rv.owner.op, values, *rv.owner.inputs, **kwargs)[0m
[1m[31mE             File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/functools.py", line 982, in wrapper[0m
[1m[31mE               return dispatch(args[0].__class__)(*args, **kw)[0m
[1m[31mE             File "/app/pymc/distributions/distribution.py", line 140, in logp[0m
[1m[31mE               return class_logp(value, *dist_params)[0m
[1m[31mE             File "/app/tests/distributions/test_dist_math.py", line 96, in logp[0m
[1m[31mE               return check_parameters([0m
[1m[31mE             File "/app/pymc/distributions/dist_math.py", line 72, in check_parameters[0m
[1m[31mE               return CheckParameterValue(msg, can_be_replaced_by_ninf)(expr, all_true_scalar)[0m
[1m[31mE             File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/graph/op.py", line 294, in __call__[0m
[1m[31mE               node = self.make_node(*inputs, **kwargs)[0m
[1m[31mE             File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/raise_op.py", line 81, in make_node[0m
[1m[31mE               [value.type()],[0m
[1m[31mE           [0m
[1m[31mE           Debug print of the apply node: [0m
[1m[31mE           Check{} [id A] <Matrix(float64, shape=(1, 2))>[0m
[1m[31mE            ├─ [[-58.8476 ... 44975113]] [id B] <Matrix(float64, shape=(1, 2))>[0m
[1m[31mE            └─ False [id C] <bool>[0m
[1m[31mE           [0m
[1m[31mE           Storage map footprint:[0m
[1m[31mE            - [[-58.8476 ... 44975113]], Shape: (1, 2), ElemSize: 8 Byte(s), TotalSize: 16 Byte(s)[0m
[1m[31mE            - False, Shape: (), ElemSize: 1 Byte(s), TotalSize: 1.0 Byte(s)[0m
[1m[31mE            TotalSize: 17.0 Byte(s) 0.000 GB[0m
[1m[31mE            TotalSize inputs: 17.0 Byte(s) 0.000 GB[0m

[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/compile/function/types.py[0m:1038: ParameterValueError
[31m[1m_______ TestMatchesScipy.test_multinomial_vectorized[extra_size1-p1-n2] ________[0m

self = <pytensor.compile.function.types.Function object at 0x7f0b9eb11370>
output_subset = None, args = (), kwargs = {}, trust_input = False
vm = <pytensor.link.c.cvm.CVM object at 0x7f0ba2938e10>, profile = None

    [0m[94mdef[39;49;00m[90m [39;49;00m[92m__call__[39;49;00m([96mself[39;49;00m, *args, output_subset=[94mNone[39;49;00m, **kwargs):[90m[39;49;00m
    [90m    [39;49;00m[33m"""[39;49;00m
    [33m    Evaluates value of a function on given arguments.[39;49;00m
    [33m[39;49;00m
    [33m    Parameters[39;49;00m
    [33m    ----------[39;49;00m
    [33m    args : list[39;49;00m
    [33m        List of inputs to the function. All inputs are required, even when[39;49;00m
    [33m        some of them are not necessary to calculate requested subset of[39;49;00m
    [33m        outputs.[39;49;00m
    [33m[39;49;00m
    [33m    kwargs : dict[39;49;00m
    [33m        The function inputs can be passed as keyword argument. For this, use[39;49;00m
    [33m        the name of the input or the input instance as the key.[39;49;00m
    [33m[39;49;00m
    [33m        Keyword argument ``output_subset`` is a list of either indices of the[39;49;00m
    [33m        function's outputs or the keys belonging to the `output_keys` dict[39;49;00m
    [33m        and represent outputs that are requested to be calculated. Regardless[39;49;00m
    [33m        of the presence of ``output_subset``, the updates are always calculated[39;49;00m
    [33m        and processed. To disable the updates, you should use the ``copy``[39;49;00m
    [33m        method with ``delete_updates=True``.[39;49;00m
    [33m[39;49;00m
    [33m    Returns[39;49;00m
    [33m    -------[39;49;00m
    [33m    list[39;49;00m
    [33m        List of outputs on indices/keys from ``output_subset`` or all of them,[39;49;00m
    [33m        if ``output_subset`` is not passed.[39;49;00m
    [33m    """[39;49;00m[90m[39;49;00m
        trust_input = [96mself[39;49;00m.trust_input[90m[39;49;00m
        input_storage = [96mself[39;49;00m.input_storage[90m[39;49;00m
        vm = [96mself[39;49;00m.vm[90m[39;49;00m
        profile = [96mself[39;49;00m.profile[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0 = time.perf_counter()[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m output_subset [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
            warnings.warn([33m"[39;49;00m[33moutput_subset is deprecated.[39;49;00m[33m"[39;49;00m, [96mFutureWarning[39;49;00m)[90m[39;49;00m
            [94mif[39;49;00m [96mself[39;49;00m.output_keys [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                output_subset = [[96mself[39;49;00m.output_keys.index(key) [94mfor[39;49;00m key [95min[39;49;00m output_subset][90m[39;49;00m
    [90m[39;49;00m
        [90m# Reinitialize each container's 'provided' counter[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m trust_input:[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
        [94melse[39;49;00m:[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                arg_container.provided = [94m0[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
            [94mif[39;49;00m [96mlen[39;49;00m(args) + [96mlen[39;49;00m(kwargs) > [96mlen[39;49;00m(input_storage):[90m[39;49;00m
                [94mraise[39;49;00m [96mTypeError[39;49;00m([33m"[39;49;00m[33mToo many parameter passed to pytensor function[39;49;00m[33m"[39;49;00m)[90m[39;49;00m
    [90m[39;49;00m
            [90m# Set positional arguments[39;49;00m[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                [90m# See discussion about None as input[39;49;00m[90m[39;49;00m
                [90m# https://groups.google.com/group/theano-dev/browse_thread/thread/920a5e904e8a8525/4f1b311a28fc27e5[39;49;00m[90m[39;49;00m
                [94mif[39;49;00m arg [95mis[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                    arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
                [94melse[39;49;00m:[90m[39;49;00m
                    [94mtry[39;49;00m:[90m[39;49;00m
                        arg_container.storage[[94m0[39;49;00m] = arg_container.type.filter([90m[39;49;00m
                            arg,[90m[39;49;00m
                            strict=arg_container.strict,[90m[39;49;00m
                            allow_downcast=arg_container.allow_downcast,[90m[39;49;00m
                        )[90m[39;49;00m
    [90m[39;49;00m
                    [94mexcept[39;49;00m [96mException[39;49;00m [94mas[39;49;00m e:[90m[39;49;00m
                        i = input_storage.index(arg_container)[90m[39;49;00m
                        function_name = [33m"[39;49;00m[33mpytensor function[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        argument_name = [33m"[39;49;00m[33margument[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mself[39;49;00m.name:[90m[39;49;00m
                            function_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + [96mself[39;49;00m.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mhasattr[39;49;00m(arg, [33m"[39;49;00m[33mname[39;49;00m[33m"[39;49;00m) [95mand[39;49;00m arg.name:[90m[39;49;00m
                            argument_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + arg.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        where = get_variable_trace_string([96mself[39;49;00m.maker.inputs[i].variable)[90m[39;49;00m
                        [94mif[39;49;00m [96mlen[39;49;00m(e.args) == [94m1[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + e.args[[94m0[39;49;00m],[90m[39;49;00m
                            )[90m[39;49;00m
                        [94melse[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                            ) + e.args[90m[39;49;00m
                        [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                        [94mraise[39;49;00m[90m[39;49;00m
                arg_container.provided += [94m1[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
        [90m# Set keyword arguments[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m kwargs:  [90m# for speed, skip the items for empty kwargs[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m k, arg [95min[39;49;00m kwargs.items():[90m[39;49;00m
                [96mself[39;49;00m[k] = arg[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m [95mnot[39;49;00m trust_input:[90m[39;49;00m
            [90m# Collect aliased inputs among the storage space[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m potential_group [95min[39;49;00m [96mself[39;49;00m._potential_aliased_input_groups:[90m[39;49;00m
                args_share_memory: [96mlist[39;49;00m[[96mlist[39;49;00m[[96mint[39;49;00m]] = [][90m[39;49;00m
                [94mfor[39;49;00m i [95min[39;49;00m potential_group:[90m[39;49;00m
                    i_type = [96mself[39;49;00m.maker.inputs[i].variable.type[90m[39;49;00m
                    i_val = input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
    [90m[39;49;00m
                    [90m# Check if value is aliased with any of the values in one of the groups[39;49;00m[90m[39;49;00m
                    [94mfor[39;49;00m j_group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                        [94mif[39;49;00m [96many[39;49;00m([90m[39;49;00m
                            i_type.may_share_memory(input_storage[j].storage[[94m0[39;49;00m], i_val)[90m[39;49;00m
                            [94mfor[39;49;00m j [95min[39;49;00m j_group[90m[39;49;00m
                        ):[90m[39;49;00m
                            j_group.append(i)[90m[39;49;00m
                            [94mbreak[39;49;00m[90m[39;49;00m
                    [94melse[39;49;00m:  [90m# no break[39;49;00m[90m[39;49;00m
                        [90m# Create a new group[39;49;00m[90m[39;49;00m
                        args_share_memory.append([i])[90m[39;49;00m
    [90m[39;49;00m
                [90m# Check for groups of more than one argument that share memory[39;49;00m[90m[39;49;00m
                [94mfor[39;49;00m group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                    [94mif[39;49;00m [96mlen[39;49;00m(group) > [94m1[39;49;00m:[90m[39;49;00m
                        [90m# copy all but the first[39;49;00m[90m[39;49;00m
                        [94mfor[39;49;00m i [95min[39;49;00m group[[94m1[39;49;00m:]:[90m[39;49;00m
                            input_storage[i].storage[[94m0[39;49;00m] = copy.copy([90m[39;49;00m
                                input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
                            )[90m[39;49;00m
    [90m[39;49;00m
            [90m# Check if inputs are missing, or if inputs were set more than once, or[39;49;00m[90m[39;49;00m
            [90m# if we tried to provide inputs that are supposed to be implicit.[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                [94mif[39;49;00m arg_container.required [95mand[39;49;00m [95mnot[39;49;00m arg_container.provided:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMissing required input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.provided > [94m1[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMultiple values for input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.implicit [95mand[39;49;00m arg_container.provided > [94m0[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mTried to provide value for implicit input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
    [90m[39;49;00m
        [90m# Do the actual work[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0_fn = time.perf_counter()[90m[39;49;00m
        [94mtry[39;49;00m:[90m[39;49;00m
>           outputs = vm() [94mif[39;49;00m output_subset [95mis[39;49;00m [94mNone[39;49;00m [94melse[39;49;00m vm(output_subset=output_subset)[90m[39;49;00m
                      ^^^^[90m[39;49;00m
[1m[31mE           pymc.logprob.utils.ParameterValueError[0m

[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/compile/function/types.py[0m:1038: ParameterValueError

[33mDuring handling of the above exception, another exception occurred:[0m

self = <tests.distributions.test_multivariate.TestMatchesScipy object at 0x7f0bb35c7610>
n = array([[ 5,  6],
       [10, 11]])
p = array([[0.2 , 0.3 , 0.5 ],
       [0.9 , 0.09, 0.01]]), extra_size = (2,)

    [0m[37m@pytest[39;49;00m.mark.parametrize([33m"[39;49;00m[33mn[39;49;00m[33m"[39;49;00m, [([94m10[39;49;00m), ([[94m10[39;49;00m, [94m11[39;49;00m]), ([[[94m5[39;49;00m, [94m6[39;49;00m], [[94m10[39;49;00m, [94m11[39;49;00m]])])[90m[39;49;00m
    [37m@pytest[39;49;00m.mark.parametrize([90m[39;49;00m
        [33m"[39;49;00m[33mp[39;49;00m[33m"[39;49;00m,[90m[39;49;00m
        [[90m[39;49;00m
            ([[94m0.2[39;49;00m, [94m0.3[39;49;00m, [94m0.5[39;49;00m]),[90m[39;49;00m
            ([[[94m0.2[39;49;00m, [94m0.3[39;49;00m, [94m0.5[39;49;00m], [[94m0.9[39;49;00m, [94m0.09[39;49;00m, [94m0.01[39;49;00m]]),[90m[39;49;00m
            (np.abs(np.random.randn([94m2[39;49;00m, [94m2[39;49;00m, [94m4[39;49;00m))),[90m[39;49;00m
        ],[90m[39;49;00m
    )[90m[39;49;00m
    [37m@pytest[39;49;00m.mark.parametrize([33m"[39;49;00m[33mextra_size[39;49;00m[33m"[39;49;00m, [([94m1[39;49;00m,), ([94m2[39;49;00m,), ([94m2[39;49;00m, [94m3[39;49;00m)])[90m[39;49;00m
    [94mdef[39;49;00m[90m [39;49;00m[92mtest_multinomial_vectorized[39;49;00m([96mself[39;49;00m, n, p, extra_size):[90m[39;49;00m
        n = np.array(n)[90m[39;49;00m
        p = np.array(p)[90m[39;49;00m
        p /= p.sum(axis=-[94m1[39;49;00m, keepdims=[94mTrue[39;49;00m)[90m[39;49;00m
    [90m[39;49;00m
        _, bcast_p = broadcast_params([n, p], ndims_params=[[94m0[39;49;00m, [94m1[39;49;00m])[90m[39;49;00m
        size = extra_size + bcast_p.shape[:-[94m1[39;49;00m][90m[39;49;00m
    [90m[39;49;00m
        mn = pm.Multinomial.dist(n=n, p=p, size=size)[90m[39;49;00m
        vals = mn.eval()[90m[39;49;00m
    [90m[39;49;00m
        npt.assert_almost_equal([90m[39;49;00m
            st.multinomial.logpmf(vals, n, p),[90m[39;49;00m
>           pm.logp(mn, vals).eval(),[90m[39;49;00m
            ^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
            decimal=[94m4[39;49;00m,[90m[39;49;00m
            err_msg=[33mf[39;49;00m[33m"[39;49;00m[33mvals=[39;49;00m[33m{[39;49;00mvals[33m}[39;49;00m[33m"[39;49;00m,[90m[39;49;00m
        )[90m[39;49;00m

[1m[31mtests/distributions/test_multivariate.py[0m:692:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/graph/basic.py[0m:668: in eval
    [0m[94mreturn[39;49;00m fn(*args)[90m[39;49;00m
           ^^^^^^^^^[90m[39;49;00m
[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/compile/function/types.py[0m:1048: in __call__
    [0mraise_with_op([90m[39;49;00m
[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/link/utils.py[0m:526: in raise_with_op
    [0m[94mraise[39;49;00m exc_value.with_traceback(exc_trace)[90m[39;49;00m
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <pytensor.compile.function.types.Function object at 0x7f0b9eb11370>
output_subset = None, args = (), kwargs = {}, trust_input = False
vm = <pytensor.link.c.cvm.CVM object at 0x7f0ba2938e10>, profile = None

    [0m[94mdef[39;49;00m[90m [39;49;00m[92m__call__[39;49;00m([96mself[39;49;00m, *args, output_subset=[94mNone[39;49;00m, **kwargs):[90m[39;49;00m
    [90m    [39;49;00m[33m"""[39;49;00m
    [33m    Evaluates value of a function on given arguments.[39;49;00m
    [33m[39;49;00m
    [33m    Parameters[39;49;00m
    [33m    ----------[39;49;00m
    [33m    args : list[39;49;00m
    [33m        List of inputs to the function. All inputs are required, even when[39;49;00m
    [33m        some of them are not necessary to calculate requested subset of[39;49;00m
    [33m        outputs.[39;49;00m
    [33m[39;49;00m
    [33m    kwargs : dict[39;49;00m
    [33m        The function inputs can be passed as keyword argument. For this, use[39;49;00m
    [33m        the name of the input or the input instance as the key.[39;49;00m
    [33m[39;49;00m
    [33m        Keyword argument ``output_subset`` is a list of either indices of the[39;49;00m
    [33m        function's outputs or the keys belonging to the `output_keys` dict[39;49;00m
    [33m        and represent outputs that are requested to be calculated. Regardless[39;49;00m
    [33m        of the presence of ``output_subset``, the updates are always calculated[39;49;00m
    [33m        and processed. To disable the updates, you should use the ``copy``[39;49;00m
    [33m        method with ``delete_updates=True``.[39;49;00m
    [33m[39;49;00m
    [33m    Returns[39;49;00m
    [33m    -------[39;49;00m
    [33m    list[39;49;00m
    [33m        List of outputs on indices/keys from ``output_subset`` or all of them,[39;49;00m
    [33m        if ``output_subset`` is not passed.[39;49;00m
    [33m    """[39;49;00m[90m[39;49;00m
        trust_input = [96mself[39;49;00m.trust_input[90m[39;49;00m
        input_storage = [96mself[39;49;00m.input_storage[90m[39;49;00m
        vm = [96mself[39;49;00m.vm[90m[39;49;00m
        profile = [96mself[39;49;00m.profile[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0 = time.perf_counter()[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m output_subset [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
            warnings.warn([33m"[39;49;00m[33moutput_subset is deprecated.[39;49;00m[33m"[39;49;00m, [96mFutureWarning[39;49;00m)[90m[39;49;00m
            [94mif[39;49;00m [96mself[39;49;00m.output_keys [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                output_subset = [[96mself[39;49;00m.output_keys.index(key) [94mfor[39;49;00m key [95min[39;49;00m output_subset][90m[39;49;00m
    [90m[39;49;00m
        [90m# Reinitialize each container's 'provided' counter[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m trust_input:[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
        [94melse[39;49;00m:[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                arg_container.provided = [94m0[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
            [94mif[39;49;00m [96mlen[39;49;00m(args) + [96mlen[39;49;00m(kwargs) > [96mlen[39;49;00m(input_storage):[90m[39;49;00m
                [94mraise[39;49;00m [96mTypeError[39;49;00m([33m"[39;49;00m[33mToo many parameter passed to pytensor function[39;49;00m[33m"[39;49;00m)[90m[39;49;00m
    [90m[39;49;00m
            [90m# Set positional arguments[39;49;00m[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                [90m# See discussion about None as input[39;49;00m[90m[39;49;00m
                [90m# https://groups.google.com/group/theano-dev/browse_thread/thread/920a5e904e8a8525/4f1b311a28fc27e5[39;49;00m[90m[39;49;00m
                [94mif[39;49;00m arg [95mis[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                    arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
                [94melse[39;49;00m:[90m[39;49;00m
                    [94mtry[39;49;00m:[90m[39;49;00m
                        arg_container.storage[[94m0[39;49;00m] = arg_container.type.filter([90m[39;49;00m
                            arg,[90m[39;49;00m
                            strict=arg_container.strict,[90m[39;49;00m
                            allow_downcast=arg_container.allow_downcast,[90m[39;49;00m
                        )[90m[39;49;00m
    [90m[39;49;00m
                    [94mexcept[39;49;00m [96mException[39;49;00m [94mas[39;49;00m e:[90m[39;49;00m
                        i = input_storage.index(arg_container)[90m[39;49;00m
                        function_name = [33m"[39;49;00m[33mpytensor function[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        argument_name = [33m"[39;49;00m[33margument[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mself[39;49;00m.name:[90m[39;49;00m
                            function_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + [96mself[39;49;00m.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mhasattr[39;49;00m(arg, [33m"[39;49;00m[33mname[39;49;00m[33m"[39;49;00m) [95mand[39;49;00m arg.name:[90m[39;49;00m
                            argument_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + arg.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        where = get_variable_trace_string([96mself[39;49;00m.maker.inputs[i].variable)[90m[39;49;00m
                        [94mif[39;49;00m [96mlen[39;49;00m(e.args) == [94m1[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + e.args[[94m0[39;49;00m],[90m[39;49;00m
                            )[90m[39;49;00m
                        [94melse[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                            ) + e.args[90m[39;49;00m
                        [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                        [94mraise[39;49;00m[90m[39;49;00m
                arg_container.provided += [94m1[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
        [90m# Set keyword arguments[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m kwargs:  [90m# for speed, skip the items for empty kwargs[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m k, arg [95min[39;49;00m kwargs.items():[90m[39;49;00m
                [96mself[39;49;00m[k] = arg[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m [95mnot[39;49;00m trust_input:[90m[39;49;00m
            [90m# Collect aliased inputs among the storage space[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m potential_group [95min[39;49;00m [96mself[39;49;00m._potential_aliased_input_groups:[90m[39;49;00m
                args_share_memory: [96mlist[39;49;00m[[96mlist[39;49;00m[[96mint[39;49;00m]] = [][90m[39;49;00m
                [94mfor[39;49;00m i [95min[39;49;00m potential_group:[90m[39;49;00m
                    i_type = [96mself[39;49;00m.maker.inputs[i].variable.type[90m[39;49;00m
                    i_val = input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
    [90m[39;49;00m
                    [90m# Check if value is aliased with any of the values in one of the groups[39;49;00m[90m[39;49;00m
                    [94mfor[39;49;00m j_group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                        [94mif[39;49;00m [96many[39;49;00m([90m[39;49;00m
                            i_type.may_share_memory(input_storage[j].storage[[94m0[39;49;00m], i_val)[90m[39;49;00m
                            [94mfor[39;49;00m j [95min[39;49;00m j_group[90m[39;49;00m
                        ):[90m[39;49;00m
                            j_group.append(i)[90m[39;49;00m
                            [94mbreak[39;49;00m[90m[39;49;00m
                    [94melse[39;49;00m:  [90m# no break[39;49;00m[90m[39;49;00m
                        [90m# Create a new group[39;49;00m[90m[39;49;00m
                        args_share_memory.append([i])[90m[39;49;00m
    [90m[39;49;00m
                [90m# Check for groups of more than one argument that share memory[39;49;00m[90m[39;49;00m
                [94mfor[39;49;00m group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                    [94mif[39;49;00m [96mlen[39;49;00m(group) > [94m1[39;49;00m:[90m[39;49;00m
                        [90m# copy all but the first[39;49;00m[90m[39;49;00m
                        [94mfor[39;49;00m i [95min[39;49;00m group[[94m1[39;49;00m:]:[90m[39;49;00m
                            input_storage[i].storage[[94m0[39;49;00m] = copy.copy([90m[39;49;00m
                                input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
                            )[90m[39;49;00m
    [90m[39;49;00m
            [90m# Check if inputs are missing, or if inputs were set more than once, or[39;49;00m[90m[39;49;00m
            [90m# if we tried to provide inputs that are supposed to be implicit.[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                [94mif[39;49;00m arg_container.required [95mand[39;49;00m [95mnot[39;49;00m arg_container.provided:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMissing required input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.provided > [94m1[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMultiple values for input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.implicit [95mand[39;49;00m arg_container.provided > [94m0[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mTried to provide value for implicit input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
    [90m[39;49;00m
        [90m# Do the actual work[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0_fn = time.perf_counter()[90m[39;49;00m
        [94mtry[39;49;00m:[90m[39;49;00m
>           outputs = vm() [94mif[39;49;00m output_subset [95mis[39;49;00m [94mNone[39;49;00m [94melse[39;49;00m vm(output_subset=output_subset)[90m[39;49;00m
                      ^^^^[90m[39;49;00m
[1m[31mE           pymc.logprob.utils.ParameterValueError: [0m
[1m[31mE           Apply node that caused the error: Check{}([[[-99.471 ... 5715088]]], False)[0m
[1m[31mE           Toposort index: 0[0m
[1m[31mE           Inputs types: [TensorType(float64, shape=(1, 2, 2)), ScalarType(bool)][0m
[1m[31mE           Inputs shapes: [(1, 2, 2), ()][0m
[1m[31mE           Inputs strides: [(32, 16, 8), ()][0m
[1m[31mE           Inputs values: [array([[[-99.47196698, -97.68020751],[0m
[1m[31mE                   [-89.15504615, -86.75715088]]]), np.False_][0m
[1m[31mE           Inputs type_num: [12, 0][0m
[1m[31mE           Outputs clients: [[DeepCopyOp(Check{}.0)]][0m
[1m[31mE           [0m
[1m[31mE           Backtrace when the node is created (use PyTensor flag traceback__limit=N to make it longer):[0m
[1m[31mE             File "/app/pymc/logprob/basic.py", line 193, in logp[0m
[1m[31mE               return _logprob_helper(rv, value, **kwargs)[0m
[1m[31mE             File "/app/pymc/logprob/abstract.py", line 70, in _logprob_helper[0m
[1m[31mE               logprob = _logprob(rv.owner.op, values, *rv.owner.inputs, **kwargs)[0m
[1m[31mE             File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/functools.py", line 982, in wrapper[0m
[1m[31mE               return dispatch(args[0].__class__)(*args, **kw)[0m
[1m[31mE             File "/app/pymc/distributions/distribution.py", line 140, in logp[0m
[1m[31mE               return class_logp(value, *dist_params)[0m
[1m[31mE             File "/app/tests/distributions/test_dist_math.py", line 96, in logp[0m
[1m[31mE               return check_parameters([0m
[1m[31mE             File "/app/pymc/distributions/dist_math.py", line 72, in check_parameters[0m
[1m[31mE               return CheckParameterValue(msg, can_be_replaced_by_ninf)(expr, all_true_scalar)[0m
[1m[31mE             File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/graph/op.py", line 294, in __call__[0m
[1m[31mE               node = self.make_node(*inputs, **kwargs)[0m
[1m[31mE             File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/raise_op.py", line 81, in make_node[0m
[1m[31mE               [value.type()],[0m
[1m[31mE           [0m
[1m[31mE           Debug print of the apply node: [0m
[1m[31mE           Check{} [id A] <Tensor3(float64, shape=(1, 2, 2))>[0m
[1m[31mE            ├─ [[[-99.471 ... 5715088]]] [id B] <Tensor3(float64, shape=(1, 2, 2))>[0m
[1m[31mE            └─ False [id C] <bool>[0m
[1m[31mE           [0m
[1m[31mE           Storage map footprint:[0m
[1m[31mE            - [[[-99.471 ... 5715088]]], Shape: (1, 2, 2), ElemSize: 8 Byte(s), TotalSize: 32 Byte(s)[0m
[1m[31mE            - False, Shape: (), ElemSize: 1 Byte(s), TotalSize: 1.0 Byte(s)[0m
[1m[31mE            TotalSize: 33.0 Byte(s) 0.000 GB[0m
[1m[31mE            TotalSize inputs: 33.0 Byte(s) 0.000 GB[0m

[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/compile/function/types.py[0m:1038: ParameterValueError
[31m[1m_______ TestMatchesScipy.test_multinomial_vectorized[extra_size1-p2-10] ________[0m

self = <pytensor.compile.function.types.Function object at 0x7f0b9eb13650>
output_subset = None, args = (), kwargs = {}, trust_input = False
vm = <pytensor.link.c.cvm.CVM object at 0x7f0ba2938730>, profile = None

    [0m[94mdef[39;49;00m[90m [39;49;00m[92m__call__[39;49;00m([96mself[39;49;00m, *args, output_subset=[94mNone[39;49;00m, **kwargs):[90m[39;49;00m
    [90m    [39;49;00m[33m"""[39;49;00m
    [33m    Evaluates value of a function on given arguments.[39;49;00m
    [33m[39;49;00m
    [33m    Parameters[39;49;00m
    [33m    ----------[39;49;00m
    [33m    args : list[39;49;00m
    [33m        List of inputs to the function. All inputs are required, even when[39;49;00m
    [33m        some of them are not necessary to calculate requested subset of[39;49;00m
    [33m        outputs.[39;49;00m
    [33m[39;49;00m
    [33m    kwargs : dict[39;49;00m
    [33m        The function inputs can be passed as keyword argument. For this, use[39;49;00m
    [33m        the name of the input or the input instance as the key.[39;49;00m
    [33m[39;49;00m
    [33m        Keyword argument ``output_subset`` is a list of either indices of the[39;49;00m
    [33m        function's outputs or the keys belonging to the `output_keys` dict[39;49;00m
    [33m        and represent outputs that are requested to be calculated. Regardless[39;49;00m
    [33m        of the presence of ``output_subset``, the updates are always calculated[39;49;00m
    [33m        and processed. To disable the updates, you should use the ``copy``[39;49;00m
    [33m        method with ``delete_updates=True``.[39;49;00m
    [33m[39;49;00m
    [33m    Returns[39;49;00m
    [33m    -------[39;49;00m
    [33m    list[39;49;00m
    [33m        List of outputs on indices/keys from ``output_subset`` or all of them,[39;49;00m
    [33m        if ``output_subset`` is not passed.[39;49;00m
    [33m    """[39;49;00m[90m[39;49;00m
        trust_input = [96mself[39;49;00m.trust_input[90m[39;49;00m
        input_storage = [96mself[39;49;00m.input_storage[90m[39;49;00m
        vm = [96mself[39;49;00m.vm[90m[39;49;00m
        profile = [96mself[39;49;00m.profile[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0 = time.perf_counter()[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m output_subset [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
            warnings.warn([33m"[39;49;00m[33moutput_subset is deprecated.[39;49;00m[33m"[39;49;00m, [96mFutureWarning[39;49;00m)[90m[39;49;00m
            [94mif[39;49;00m [96mself[39;49;00m.output_keys [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                output_subset = [[96mself[39;49;00m.output_keys.index(key) [94mfor[39;49;00m key [95min[39;49;00m output_subset][90m[39;49;00m
    [90m[39;49;00m
        [90m# Reinitialize each container's 'provided' counter[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m trust_input:[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
        [94melse[39;49;00m:[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                arg_container.provided = [94m0[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
            [94mif[39;49;00m [96mlen[39;49;00m(args) + [96mlen[39;49;00m(kwargs) > [96mlen[39;49;00m(input_storage):[90m[39;49;00m
                [94mraise[39;49;00m [96mTypeError[39;49;00m([33m"[39;49;00m[33mToo many parameter passed to pytensor function[39;49;00m[33m"[39;49;00m)[90m[39;49;00m
    [90m[39;49;00m
            [90m# Set positional arguments[39;49;00m[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                [90m# See discussion about None as input[39;49;00m[90m[39;49;00m
                [90m# https://groups.google.com/group/theano-dev/browse_thread/thread/920a5e904e8a8525/4f1b311a28fc27e5[39;49;00m[90m[39;49;00m
                [94mif[39;49;00m arg [95mis[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                    arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
                [94melse[39;49;00m:[90m[39;49;00m
                    [94mtry[39;49;00m:[90m[39;49;00m
                        arg_container.storage[[94m0[39;49;00m] = arg_container.type.filter([90m[39;49;00m
                            arg,[90m[39;49;00m
                            strict=arg_container.strict,[90m[39;49;00m
                            allow_downcast=arg_container.allow_downcast,[90m[39;49;00m
                        )[90m[39;49;00m
    [90m[39;49;00m
                    [94mexcept[39;49;00m [96mException[39;49;00m [94mas[39;49;00m e:[90m[39;49;00m
                        i = input_storage.index(arg_container)[90m[39;49;00m
                        function_name = [33m"[39;49;00m[33mpytensor function[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        argument_name = [33m"[39;49;00m[33margument[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mself[39;49;00m.name:[90m[39;49;00m
                            function_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + [96mself[39;49;00m.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mhasattr[39;49;00m(arg, [33m"[39;49;00m[33mname[39;49;00m[33m"[39;49;00m) [95mand[39;49;00m arg.name:[90m[39;49;00m
                            argument_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + arg.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        where = get_variable_trace_string([96mself[39;49;00m.maker.inputs[i].variable)[90m[39;49;00m
                        [94mif[39;49;00m [96mlen[39;49;00m(e.args) == [94m1[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + e.args[[94m0[39;49;00m],[90m[39;49;00m
                            )[90m[39;49;00m
                        [94melse[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                            ) + e.args[90m[39;49;00m
                        [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                        [94mraise[39;49;00m[90m[39;49;00m
                arg_container.provided += [94m1[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
        [90m# Set keyword arguments[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m kwargs:  [90m# for speed, skip the items for empty kwargs[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m k, arg [95min[39;49;00m kwargs.items():[90m[39;49;00m
                [96mself[39;49;00m[k] = arg[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m [95mnot[39;49;00m trust_input:[90m[39;49;00m
            [90m# Collect aliased inputs among the storage space[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m potential_group [95min[39;49;00m [96mself[39;49;00m._potential_aliased_input_groups:[90m[39;49;00m
                args_share_memory: [96mlist[39;49;00m[[96mlist[39;49;00m[[96mint[39;49;00m]] = [][90m[39;49;00m
                [94mfor[39;49;00m i [95min[39;49;00m potential_group:[90m[39;49;00m
                    i_type = [96mself[39;49;00m.maker.inputs[i].variable.type[90m[39;49;00m
                    i_val = input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
    [90m[39;49;00m
                    [90m# Check if value is aliased with any of the values in one of the groups[39;49;00m[90m[39;49;00m
                    [94mfor[39;49;00m j_group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                        [94mif[39;49;00m [96many[39;49;00m([90m[39;49;00m
                            i_type.may_share_memory(input_storage[j].storage[[94m0[39;49;00m], i_val)[90m[39;49;00m
                            [94mfor[39;49;00m j [95min[39;49;00m j_group[90m[39;49;00m
                        ):[90m[39;49;00m
                            j_group.append(i)[90m[39;49;00m
                            [94mbreak[39;49;00m[90m[39;49;00m
                    [94melse[39;49;00m:  [90m# no break[39;49;00m[90m[39;49;00m
                        [90m# Create a new group[39;49;00m[90m[39;49;00m
                        args_share_memory.append([i])[90m[39;49;00m
    [90m[39;49;00m
                [90m# Check for groups of more than one argument that share memory[39;49;00m[90m[39;49;00m
                [94mfor[39;49;00m group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                    [94mif[39;49;00m [96mlen[39;49;00m(group) > [94m1[39;49;00m:[90m[39;49;00m
                        [90m# copy all but the first[39;49;00m[90m[39;49;00m
                        [94mfor[39;49;00m i [95min[39;49;00m group[[94m1[39;49;00m:]:[90m[39;49;00m
                            input_storage[i].storage[[94m0[39;49;00m] = copy.copy([90m[39;49;00m
                                input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
                            )[90m[39;49;00m
    [90m[39;49;00m
            [90m# Check if inputs are missing, or if inputs were set more than once, or[39;49;00m[90m[39;49;00m
            [90m# if we tried to provide inputs that are supposed to be implicit.[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                [94mif[39;49;00m arg_container.required [95mand[39;49;00m [95mnot[39;49;00m arg_container.provided:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMissing required input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.provided > [94m1[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMultiple values for input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.implicit [95mand[39;49;00m arg_container.provided > [94m0[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mTried to provide value for implicit input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
    [90m[39;49;00m
        [90m# Do the actual work[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0_fn = time.perf_counter()[90m[39;49;00m
        [94mtry[39;49;00m:[90m[39;49;00m
>           outputs = vm() [94mif[39;49;00m output_subset [95mis[39;49;00m [94mNone[39;49;00m [94melse[39;49;00m vm(output_subset=output_subset)[90m[39;49;00m
                      ^^^^[90m[39;49;00m
[1m[31mE           pymc.logprob.utils.ParameterValueError[0m

[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/compile/function/types.py[0m:1038: ParameterValueError

[33mDuring handling of the above exception, another exception occurred:[0m

self = <tests.distributions.test_multivariate.TestMatchesScipy object at 0x7f0bb35c7660>
n = array(10)
p = array([[[0.17876157, 0.39760757, 0.0449895 , 0.37864137],
        [0.06511207, 0.35563681, 0.30921865, 0.27003247]],

       [[0.2899355 , 0.11278839, 0.36678067, 0.23049544],
        [0.13152157, 0.0916917 , 0.25354174, 0.52324499]]])
extra_size = (2,)

    [0m[37m@pytest[39;49;00m.mark.parametrize([33m"[39;49;00m[33mn[39;49;00m[33m"[39;49;00m, [([94m10[39;49;00m), ([[94m10[39;49;00m, [94m11[39;49;00m]), ([[[94m5[39;49;00m, [94m6[39;49;00m], [[94m10[39;49;00m, [94m11[39;49;00m]])])[90m[39;49;00m
    [37m@pytest[39;49;00m.mark.parametrize([90m[39;49;00m
        [33m"[39;49;00m[33mp[39;49;00m[33m"[39;49;00m,[90m[39;49;00m
        [[90m[39;49;00m
            ([[94m0.2[39;49;00m, [94m0.3[39;49;00m, [94m0.5[39;49;00m]),[90m[39;49;00m
            ([[[94m0.2[39;49;00m, [94m0.3[39;49;00m, [94m0.5[39;49;00m], [[94m0.9[39;49;00m, [94m0.09[39;49;00m, [94m0.01[39;49;00m]]),[90m[39;49;00m
            (np.abs(np.random.randn([94m2[39;49;00m, [94m2[39;49;00m, [94m4[39;49;00m))),[90m[39;49;00m
        ],[90m[39;49;00m
    )[90m[39;49;00m
    [37m@pytest[39;49;00m.mark.parametrize([33m"[39;49;00m[33mextra_size[39;49;00m[33m"[39;49;00m, [([94m1[39;49;00m,), ([94m2[39;49;00m,), ([94m2[39;49;00m, [94m3[39;49;00m)])[90m[39;49;00m
    [94mdef[39;49;00m[90m [39;49;00m[92mtest_multinomial_vectorized[39;49;00m([96mself[39;49;00m, n, p, extra_size):[90m[39;49;00m
        n = np.array(n)[90m[39;49;00m
        p = np.array(p)[90m[39;49;00m
        p /= p.sum(axis=-[94m1[39;49;00m, keepdims=[94mTrue[39;49;00m)[90m[39;49;00m
    [90m[39;49;00m
        _, bcast_p = broadcast_params([n, p], ndims_params=[[94m0[39;49;00m, [94m1[39;49;00m])[90m[39;49;00m
        size = extra_size + bcast_p.shape[:-[94m1[39;49;00m][90m[39;49;00m
    [90m[39;49;00m
        mn = pm.Multinomial.dist(n=n, p=p, size=size)[90m[39;49;00m
        vals = mn.eval()[90m[39;49;00m
    [90m[39;49;00m
        npt.assert_almost_equal([90m[39;49;00m
            st.multinomial.logpmf(vals, n, p),[90m[39;49;00m
>           pm.logp(mn, vals).eval(),[90m[39;49;00m
            ^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
            decimal=[94m4[39;49;00m,[90m[39;49;00m
            err_msg=[33mf[39;49;00m[33m"[39;49;00m[33mvals=[39;49;00m[33m{[39;49;00mvals[33m}[39;49;00m[33m"[39;49;00m,[90m[39;49;00m
        )[90m[39;49;00m

[1m[31mtests/distributions/test_multivariate.py[0m:692:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/graph/basic.py[0m:668: in eval
    [0m[94mreturn[39;49;00m fn(*args)[90m[39;49;00m
           ^^^^^^^^^[90m[39;49;00m
[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/compile/function/types.py[0m:1048: in __call__
    [0mraise_with_op([90m[39;49;00m
[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/link/utils.py[0m:526: in raise_with_op
    [0m[94mraise[39;49;00m exc_value.with_traceback(exc_trace)[90m[39;49;00m
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <pytensor.compile.function.types.Function object at 0x7f0b9eb13650>
output_subset = None, args = (), kwargs = {}, trust_input = False
vm = <pytensor.link.c.cvm.CVM object at 0x7f0ba2938730>, profile = None

    [0m[94mdef[39;49;00m[90m [39;49;00m[92m__call__[39;49;00m([96mself[39;49;00m, *args, output_subset=[94mNone[39;49;00m, **kwargs):[90m[39;49;00m
    [90m    [39;49;00m[33m"""[39;49;00m
    [33m    Evaluates value of a function on given arguments.[39;49;00m
    [33m[39;49;00m
    [33m    Parameters[39;49;00m
    [33m    ----------[39;49;00m
    [33m    args : list[39;49;00m
    [33m        List of inputs to the function. All inputs are required, even when[39;49;00m
    [33m        some of them are not necessary to calculate requested subset of[39;49;00m
    [33m        outputs.[39;49;00m
    [33m[39;49;00m
    [33m    kwargs : dict[39;49;00m
    [33m        The function inputs can be passed as keyword argument. For this, use[39;49;00m
    [33m        the name of the input or the input instance as the key.[39;49;00m
    [33m[39;49;00m
    [33m        Keyword argument ``output_subset`` is a list of either indices of the[39;49;00m
    [33m        function's outputs or the keys belonging to the `output_keys` dict[39;49;00m
    [33m        and represent outputs that are requested to be calculated. Regardless[39;49;00m
    [33m        of the presence of ``output_subset``, the updates are always calculated[39;49;00m
    [33m        and processed. To disable the updates, you should use the ``copy``[39;49;00m
    [33m        method with ``delete_updates=True``.[39;49;00m
    [33m[39;49;00m
    [33m    Returns[39;49;00m
    [33m    -------[39;49;00m
    [33m    list[39;49;00m
    [33m        List of outputs on indices/keys from ``output_subset`` or all of them,[39;49;00m
    [33m        if ``output_subset`` is not passed.[39;49;00m
    [33m    """[39;49;00m[90m[39;49;00m
        trust_input = [96mself[39;49;00m.trust_input[90m[39;49;00m
        input_storage = [96mself[39;49;00m.input_storage[90m[39;49;00m
        vm = [96mself[39;49;00m.vm[90m[39;49;00m
        profile = [96mself[39;49;00m.profile[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0 = time.perf_counter()[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m output_subset [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
            warnings.warn([33m"[39;49;00m[33moutput_subset is deprecated.[39;49;00m[33m"[39;49;00m, [96mFutureWarning[39;49;00m)[90m[39;49;00m
            [94mif[39;49;00m [96mself[39;49;00m.output_keys [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                output_subset = [[96mself[39;49;00m.output_keys.index(key) [94mfor[39;49;00m key [95min[39;49;00m output_subset][90m[39;49;00m
    [90m[39;49;00m
        [90m# Reinitialize each container's 'provided' counter[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m trust_input:[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
        [94melse[39;49;00m:[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                arg_container.provided = [94m0[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
            [94mif[39;49;00m [96mlen[39;49;00m(args) + [96mlen[39;49;00m(kwargs) > [96mlen[39;49;00m(input_storage):[90m[39;49;00m
                [94mraise[39;49;00m [96mTypeError[39;49;00m([33m"[39;49;00m[33mToo many parameter passed to pytensor function[39;49;00m[33m"[39;49;00m)[90m[39;49;00m
    [90m[39;49;00m
            [90m# Set positional arguments[39;49;00m[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                [90m# See discussion about None as input[39;49;00m[90m[39;49;00m
                [90m# https://groups.google.com/group/theano-dev/browse_thread/thread/920a5e904e8a8525/4f1b311a28fc27e5[39;49;00m[90m[39;49;00m
                [94mif[39;49;00m arg [95mis[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                    arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
                [94melse[39;49;00m:[90m[39;49;00m
                    [94mtry[39;49;00m:[90m[39;49;00m
                        arg_container.storage[[94m0[39;49;00m] = arg_container.type.filter([90m[39;49;00m
                            arg,[90m[39;49;00m
                            strict=arg_container.strict,[90m[39;49;00m
                            allow_downcast=arg_container.allow_downcast,[90m[39;49;00m
                        )[90m[39;49;00m
    [90m[39;49;00m
                    [94mexcept[39;49;00m [96mException[39;49;00m [94mas[39;49;00m e:[90m[39;49;00m
                        i = input_storage.index(arg_container)[90m[39;49;00m
                        function_name = [33m"[39;49;00m[33mpytensor function[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        argument_name = [33m"[39;49;00m[33margument[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mself[39;49;00m.name:[90m[39;49;00m
                            function_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + [96mself[39;49;00m.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mhasattr[39;49;00m(arg, [33m"[39;49;00m[33mname[39;49;00m[33m"[39;49;00m) [95mand[39;49;00m arg.name:[90m[39;49;00m
                            argument_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + arg.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        where = get_variable_trace_string([96mself[39;49;00m.maker.inputs[i].variable)[90m[39;49;00m
                        [94mif[39;49;00m [96mlen[39;49;00m(e.args) == [94m1[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + e.args[[94m0[39;49;00m],[90m[39;49;00m
                            )[90m[39;49;00m
                        [94melse[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                            ) + e.args[90m[39;49;00m
                        [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                        [94mraise[39;49;00m[90m[39;49;00m
                arg_container.provided += [94m1[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
        [90m# Set keyword arguments[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m kwargs:  [90m# for speed, skip the items for empty kwargs[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m k, arg [95min[39;49;00m kwargs.items():[90m[39;49;00m
                [96mself[39;49;00m[k] = arg[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m [95mnot[39;49;00m trust_input:[90m[39;49;00m
            [90m# Collect aliased inputs among the storage space[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m potential_group [95min[39;49;00m [96mself[39;49;00m._potential_aliased_input_groups:[90m[39;49;00m
                args_share_memory: [96mlist[39;49;00m[[96mlist[39;49;00m[[96mint[39;49;00m]] = [][90m[39;49;00m
                [94mfor[39;49;00m i [95min[39;49;00m potential_group:[90m[39;49;00m
                    i_type = [96mself[39;49;00m.maker.inputs[i].variable.type[90m[39;49;00m
                    i_val = input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
    [90m[39;49;00m
                    [90m# Check if value is aliased with any of the values in one of the groups[39;49;00m[90m[39;49;00m
                    [94mfor[39;49;00m j_group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                        [94mif[39;49;00m [96many[39;49;00m([90m[39;49;00m
                            i_type.may_share_memory(input_storage[j].storage[[94m0[39;49;00m], i_val)[90m[39;49;00m
                            [94mfor[39;49;00m j [95min[39;49;00m j_group[90m[39;49;00m
                        ):[90m[39;49;00m
                            j_group.append(i)[90m[39;49;00m
                            [94mbreak[39;49;00m[90m[39;49;00m
                    [94melse[39;49;00m:  [90m# no break[39;49;00m[90m[39;49;00m
                        [90m# Create a new group[39;49;00m[90m[39;49;00m
                        args_share_memory.append([i])[90m[39;49;00m
    [90m[39;49;00m
                [90m# Check for groups of more than one argument that share memory[39;49;00m[90m[39;49;00m
                [94mfor[39;49;00m group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                    [94mif[39;49;00m [96mlen[39;49;00m(group) > [94m1[39;49;00m:[90m[39;49;00m
                        [90m# copy all but the first[39;49;00m[90m[39;49;00m
                        [94mfor[39;49;00m i [95min[39;49;00m group[[94m1[39;49;00m:]:[90m[39;49;00m
                            input_storage[i].storage[[94m0[39;49;00m] = copy.copy([90m[39;49;00m
                                input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
                            )[90m[39;49;00m
    [90m[39;49;00m
            [90m# Check if inputs are missing, or if inputs were set more than once, or[39;49;00m[90m[39;49;00m
            [90m# if we tried to provide inputs that are supposed to be implicit.[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                [94mif[39;49;00m arg_container.required [95mand[39;49;00m [95mnot[39;49;00m arg_container.provided:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMissing required input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.provided > [94m1[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMultiple values for input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.implicit [95mand[39;49;00m arg_container.provided > [94m0[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mTried to provide value for implicit input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
    [90m[39;49;00m
        [90m# Do the actual work[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0_fn = time.perf_counter()[90m[39;49;00m
        [94mtry[39;49;00m:[90m[39;49;00m
>           outputs = vm() [94mif[39;49;00m output_subset [95mis[39;49;00m [94mNone[39;49;00m [94melse[39;49;00m vm(output_subset=output_subset)[90m[39;49;00m
                      ^^^^[90m[39;49;00m
[1m[31mE           pymc.logprob.utils.ParameterValueError: [0m
[1m[31mE           Apply node that caused the error: Check{}([[[-139.82760311]]], False)[0m
[1m[31mE           Toposort index: 0[0m
[1m[31mE           Inputs types: [TensorType(float64, shape=(1, 1, 1)), ScalarType(bool)][0m
[1m[31mE           Inputs shapes: [(1, 1, 1), ()][0m
[1m[31mE           Inputs strides: [(8, 8, 8), ()][0m
[1m[31mE           Inputs values: [array([[[-139.82760311]]]), np.False_][0m
[1m[31mE           Inputs type_num: [12, 0][0m
[1m[31mE           Outputs clients: [[DeepCopyOp(Check{}.0)]][0m
[1m[31mE           [0m
[1m[31mE           Backtrace when the node is created (use PyTensor flag traceback__limit=N to make it longer):[0m
[1m[31mE             File "/app/pymc/logprob/basic.py", line 193, in logp[0m
[1m[31mE               return _logprob_helper(rv, value, **kwargs)[0m
[1m[31mE             File "/app/pymc/logprob/abstract.py", line 70, in _logprob_helper[0m
[1m[31mE               logprob = _logprob(rv.owner.op, values, *rv.owner.inputs, **kwargs)[0m
[1m[31mE             File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/functools.py", line 982, in wrapper[0m
[1m[31mE               return dispatch(args[0].__class__)(*args, **kw)[0m
[1m[31mE             File "/app/pymc/distributions/distribution.py", line 140, in logp[0m
[1m[31mE               return class_logp(value, *dist_params)[0m
[1m[31mE             File "/app/tests/distributions/test_dist_math.py", line 96, in logp[0m
[1m[31mE               return check_parameters([0m
[1m[31mE             File "/app/pymc/distributions/dist_math.py", line 72, in check_parameters[0m
[1m[31mE               return CheckParameterValue(msg, can_be_replaced_by_ninf)(expr, all_true_scalar)[0m
[1m[31mE             File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/graph/op.py", line 294, in __call__[0m
[1m[31mE               node = self.make_node(*inputs, **kwargs)[0m
[1m[31mE             File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/raise_op.py", line 81, in make_node[0m
[1m[31mE               [value.type()],[0m
[1m[31mE           [0m
[1m[31mE           Debug print of the apply node: [0m
[1m[31mE           Check{} [id A] <Tensor3(float64, shape=(1, 1, 1))>[0m
[1m[31mE            ├─ [[[-139.82760311]]] [id B] <Tensor3(float64, shape=(1, 1, 1))>[0m
[1m[31mE            └─ False [id C] <bool>[0m
[1m[31mE           [0m
[1m[31mE           Storage map footprint:[0m
[1m[31mE            - [[[-139.82760311]]], Shape: (1, 1, 1), ElemSize: 8 Byte(s), TotalSize: 8 Byte(s)[0m
[1m[31mE            - False, Shape: (), ElemSize: 1 Byte(s), TotalSize: 1.0 Byte(s)[0m
[1m[31mE            TotalSize: 9.0 Byte(s) 0.000 GB[0m
[1m[31mE            TotalSize inputs: 9.0 Byte(s) 0.000 GB[0m

[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/compile/function/types.py[0m:1038: ParameterValueError
[31m[1m_______ TestMatchesScipy.test_multinomial_vectorized[extra_size1-p2-n1] ________[0m

self = <pytensor.compile.function.types.Function object at 0x7f0b9fa8e570>
output_subset = None, args = (), kwargs = {}, trust_input = False
vm = <pytensor.link.c.cvm.CVM object at 0x7f0ba2939230>, profile = None

    [0m[94mdef[39;49;00m[90m [39;49;00m[92m__call__[39;49;00m([96mself[39;49;00m, *args, output_subset=[94mNone[39;49;00m, **kwargs):[90m[39;49;00m
    [90m    [39;49;00m[33m"""[39;49;00m
    [33m    Evaluates value of a function on given arguments.[39;49;00m
    [33m[39;49;00m
    [33m    Parameters[39;49;00m
    [33m    ----------[39;49;00m
    [33m    args : list[39;49;00m
    [33m        List of inputs to the function. All inputs are required, even when[39;49;00m
    [33m        some of them are not necessary to calculate requested subset of[39;49;00m
    [33m        outputs.[39;49;00m
    [33m[39;49;00m
    [33m    kwargs : dict[39;49;00m
    [33m        The function inputs can be passed as keyword argument. For this, use[39;49;00m
    [33m        the name of the input or the input instance as the key.[39;49;00m
    [33m[39;49;00m
    [33m        Keyword argument ``output_subset`` is a list of either indices of the[39;49;00m
    [33m        function's outputs or the keys belonging to the `output_keys` dict[39;49;00m
    [33m        and represent outputs that are requested to be calculated. Regardless[39;49;00m
    [33m        of the presence of ``output_subset``, the updates are always calculated[39;49;00m
    [33m        and processed. To disable the updates, you should use the ``copy``[39;49;00m
    [33m        method with ``delete_updates=True``.[39;49;00m
    [33m[39;49;00m
    [33m    Returns[39;49;00m
    [33m    -------[39;49;00m
    [33m    list[39;49;00m
    [33m        List of outputs on indices/keys from ``output_subset`` or all of them,[39;49;00m
    [33m        if ``output_subset`` is not passed.[39;49;00m
    [33m    """[39;49;00m[90m[39;49;00m
        trust_input = [96mself[39;49;00m.trust_input[90m[39;49;00m
        input_storage = [96mself[39;49;00m.input_storage[90m[39;49;00m
        vm = [96mself[39;49;00m.vm[90m[39;49;00m
        profile = [96mself[39;49;00m.profile[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0 = time.perf_counter()[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m output_subset [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
            warnings.warn([33m"[39;49;00m[33moutput_subset is deprecated.[39;49;00m[33m"[39;49;00m, [96mFutureWarning[39;49;00m)[90m[39;49;00m
            [94mif[39;49;00m [96mself[39;49;00m.output_keys [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                output_subset = [[96mself[39;49;00m.output_keys.index(key) [94mfor[39;49;00m key [95min[39;49;00m output_subset][90m[39;49;00m
    [90m[39;49;00m
        [90m# Reinitialize each container's 'provided' counter[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m trust_input:[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
        [94melse[39;49;00m:[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                arg_container.provided = [94m0[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
            [94mif[39;49;00m [96mlen[39;49;00m(args) + [96mlen[39;49;00m(kwargs) > [96mlen[39;49;00m(input_storage):[90m[39;49;00m
                [94mraise[39;49;00m [96mTypeError[39;49;00m([33m"[39;49;00m[33mToo many parameter passed to pytensor function[39;49;00m[33m"[39;49;00m)[90m[39;49;00m
    [90m[39;49;00m
            [90m# Set positional arguments[39;49;00m[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                [90m# See discussion about None as input[39;49;00m[90m[39;49;00m
                [90m# https://groups.google.com/group/theano-dev/browse_thread/thread/920a5e904e8a8525/4f1b311a28fc27e5[39;49;00m[90m[39;49;00m
                [94mif[39;49;00m arg [95mis[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                    arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
                [94melse[39;49;00m:[90m[39;49;00m
                    [94mtry[39;49;00m:[90m[39;49;00m
                        arg_container.storage[[94m0[39;49;00m] = arg_container.type.filter([90m[39;49;00m
                            arg,[90m[39;49;00m
                            strict=arg_container.strict,[90m[39;49;00m
                            allow_downcast=arg_container.allow_downcast,[90m[39;49;00m
                        )[90m[39;49;00m
    [90m[39;49;00m
                    [94mexcept[39;49;00m [96mException[39;49;00m [94mas[39;49;00m e:[90m[39;49;00m
                        i = input_storage.index(arg_container)[90m[39;49;00m
                        function_name = [33m"[39;49;00m[33mpytensor function[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        argument_name = [33m"[39;49;00m[33margument[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mself[39;49;00m.name:[90m[39;49;00m
                            function_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + [96mself[39;49;00m.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mhasattr[39;49;00m(arg, [33m"[39;49;00m[33mname[39;49;00m[33m"[39;49;00m) [95mand[39;49;00m arg.name:[90m[39;49;00m
                            argument_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + arg.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        where = get_variable_trace_string([96mself[39;49;00m.maker.inputs[i].variable)[90m[39;49;00m
                        [94mif[39;49;00m [96mlen[39;49;00m(e.args) == [94m1[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + e.args[[94m0[39;49;00m],[90m[39;49;00m
                            )[90m[39;49;00m
                        [94melse[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                            ) + e.args[90m[39;49;00m
                        [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                        [94mraise[39;49;00m[90m[39;49;00m
                arg_container.provided += [94m1[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
        [90m# Set keyword arguments[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m kwargs:  [90m# for speed, skip the items for empty kwargs[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m k, arg [95min[39;49;00m kwargs.items():[90m[39;49;00m
                [96mself[39;49;00m[k] = arg[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m [95mnot[39;49;00m trust_input:[90m[39;49;00m
            [90m# Collect aliased inputs among the storage space[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m potential_group [95min[39;49;00m [96mself[39;49;00m._potential_aliased_input_groups:[90m[39;49;00m
                args_share_memory: [96mlist[39;49;00m[[96mlist[39;49;00m[[96mint[39;49;00m]] = [][90m[39;49;00m
                [94mfor[39;49;00m i [95min[39;49;00m potential_group:[90m[39;49;00m
                    i_type = [96mself[39;49;00m.maker.inputs[i].variable.type[90m[39;49;00m
                    i_val = input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
    [90m[39;49;00m
                    [90m# Check if value is aliased with any of the values in one of the groups[39;49;00m[90m[39;49;00m
                    [94mfor[39;49;00m j_group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                        [94mif[39;49;00m [96many[39;49;00m([90m[39;49;00m
                            i_type.may_share_memory(input_storage[j].storage[[94m0[39;49;00m], i_val)[90m[39;49;00m
                            [94mfor[39;49;00m j [95min[39;49;00m j_group[90m[39;49;00m
                        ):[90m[39;49;00m
                            j_group.append(i)[90m[39;49;00m
                            [94mbreak[39;49;00m[90m[39;49;00m
                    [94melse[39;49;00m:  [90m# no break[39;49;00m[90m[39;49;00m
                        [90m# Create a new group[39;49;00m[90m[39;49;00m
                        args_share_memory.append([i])[90m[39;49;00m
    [90m[39;49;00m
                [90m# Check for groups of more than one argument that share memory[39;49;00m[90m[39;49;00m
                [94mfor[39;49;00m group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                    [94mif[39;49;00m [96mlen[39;49;00m(group) > [94m1[39;49;00m:[90m[39;49;00m
                        [90m# copy all but the first[39;49;00m[90m[39;49;00m
                        [94mfor[39;49;00m i [95min[39;49;00m group[[94m1[39;49;00m:]:[90m[39;49;00m
                            input_storage[i].storage[[94m0[39;49;00m] = copy.copy([90m[39;49;00m
                                input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
                            )[90m[39;49;00m
    [90m[39;49;00m
            [90m# Check if inputs are missing, or if inputs were set more than once, or[39;49;00m[90m[39;49;00m
            [90m# if we tried to provide inputs that are supposed to be implicit.[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                [94mif[39;49;00m arg_container.required [95mand[39;49;00m [95mnot[39;49;00m arg_container.provided:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMissing required input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.provided > [94m1[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMultiple values for input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.implicit [95mand[39;49;00m arg_container.provided > [94m0[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mTried to provide value for implicit input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
    [90m[39;49;00m
        [90m# Do the actual work[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0_fn = time.perf_counter()[90m[39;49;00m
        [94mtry[39;49;00m:[90m[39;49;00m
>           outputs = vm() [94mif[39;49;00m output_subset [95mis[39;49;00m [94mNone[39;49;00m [94melse[39;49;00m vm(output_subset=output_subset)[90m[39;49;00m
                      ^^^^[90m[39;49;00m
[1m[31mE           pymc.logprob.utils.ParameterValueError[0m

[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/compile/function/types.py[0m:1038: ParameterValueError

[33mDuring handling of the above exception, another exception occurred:[0m

self = <tests.distributions.test_multivariate.TestMatchesScipy object at 0x7f0bb35c76b0>
n = array([10, 11])
p = array([[[0.17876157, 0.39760757, 0.0449895 , 0.37864137],
        [0.06511207, 0.35563681, 0.30921865, 0.27003247]],

       [[0.2899355 , 0.11278839, 0.36678067, 0.23049544],
        [0.13152157, 0.0916917 , 0.25354174, 0.52324499]]])
extra_size = (2,)

    [0m[37m@pytest[39;49;00m.mark.parametrize([33m"[39;49;00m[33mn[39;49;00m[33m"[39;49;00m, [([94m10[39;49;00m), ([[94m10[39;49;00m, [94m11[39;49;00m]), ([[[94m5[39;49;00m, [94m6[39;49;00m], [[94m10[39;49;00m, [94m11[39;49;00m]])])[90m[39;49;00m
    [37m@pytest[39;49;00m.mark.parametrize([90m[39;49;00m
        [33m"[39;49;00m[33mp[39;49;00m[33m"[39;49;00m,[90m[39;49;00m
        [[90m[39;49;00m
            ([[94m0.2[39;49;00m, [94m0.3[39;49;00m, [94m0.5[39;49;00m]),[90m[39;49;00m
            ([[[94m0.2[39;49;00m, [94m0.3[39;49;00m, [94m0.5[39;49;00m], [[94m0.9[39;49;00m, [94m0.09[39;49;00m, [94m0.01[39;49;00m]]),[90m[39;49;00m
            (np.abs(np.random.randn([94m2[39;49;00m, [94m2[39;49;00m, [94m4[39;49;00m))),[90m[39;49;00m
        ],[90m[39;49;00m
    )[90m[39;49;00m
    [37m@pytest[39;49;00m.mark.parametrize([33m"[39;49;00m[33mextra_size[39;49;00m[33m"[39;49;00m, [([94m1[39;49;00m,), ([94m2[39;49;00m,), ([94m2[39;49;00m, [94m3[39;49;00m)])[90m[39;49;00m
    [94mdef[39;49;00m[90m [39;49;00m[92mtest_multinomial_vectorized[39;49;00m([96mself[39;49;00m, n, p, extra_size):[90m[39;49;00m
        n = np.array(n)[90m[39;49;00m
        p = np.array(p)[90m[39;49;00m
        p /= p.sum(axis=-[94m1[39;49;00m, keepdims=[94mTrue[39;49;00m)[90m[39;49;00m
    [90m[39;49;00m
        _, bcast_p = broadcast_params([n, p], ndims_params=[[94m0[39;49;00m, [94m1[39;49;00m])[90m[39;49;00m
        size = extra_size + bcast_p.shape[:-[94m1[39;49;00m][90m[39;49;00m
    [90m[39;49;00m
        mn = pm.Multinomial.dist(n=n, p=p, size=size)[90m[39;49;00m
        vals = mn.eval()[90m[39;49;00m
    [90m[39;49;00m
        npt.assert_almost_equal([90m[39;49;00m
            st.multinomial.logpmf(vals, n, p),[90m[39;49;00m
>           pm.logp(mn, vals).eval(),[90m[39;49;00m
            ^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
            decimal=[94m4[39;49;00m,[90m[39;49;00m
            err_msg=[33mf[39;49;00m[33m"[39;49;00m[33mvals=[39;49;00m[33m{[39;49;00mvals[33m}[39;49;00m[33m"[39;49;00m,[90m[39;49;00m
        )[90m[39;49;00m

[1m[31mtests/distributions/test_multivariate.py[0m:692:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/graph/basic.py[0m:668: in eval
    [0m[94mreturn[39;49;00m fn(*args)[90m[39;49;00m
           ^^^^^^^^^[90m[39;49;00m
[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/compile/function/types.py[0m:1048: in __call__
    [0mraise_with_op([90m[39;49;00m
[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/link/utils.py[0m:526: in raise_with_op
    [0m[94mraise[39;49;00m exc_value.with_traceback(exc_trace)[90m[39;49;00m
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <pytensor.compile.function.types.Function object at 0x7f0b9fa8e570>
output_subset = None, args = (), kwargs = {}, trust_input = False
vm = <pytensor.link.c.cvm.CVM object at 0x7f0ba2939230>, profile = None

    [0m[94mdef[39;49;00m[90m [39;49;00m[92m__call__[39;49;00m([96mself[39;49;00m, *args, output_subset=[94mNone[39;49;00m, **kwargs):[90m[39;49;00m
    [90m    [39;49;00m[33m"""[39;49;00m
    [33m    Evaluates value of a function on given arguments.[39;49;00m
    [33m[39;49;00m
    [33m    Parameters[39;49;00m
    [33m    ----------[39;49;00m
    [33m    args : list[39;49;00m
    [33m        List of inputs to the function. All inputs are required, even when[39;49;00m
    [33m        some of them are not necessary to calculate requested subset of[39;49;00m
    [33m        outputs.[39;49;00m
    [33m[39;49;00m
    [33m    kwargs : dict[39;49;00m
    [33m        The function inputs can be passed as keyword argument. For this, use[39;49;00m
    [33m        the name of the input or the input instance as the key.[39;49;00m
    [33m[39;49;00m
    [33m        Keyword argument ``output_subset`` is a list of either indices of the[39;49;00m
    [33m        function's outputs or the keys belonging to the `output_keys` dict[39;49;00m
    [33m        and represent outputs that are requested to be calculated. Regardless[39;49;00m
    [33m        of the presence of ``output_subset``, the updates are always calculated[39;49;00m
    [33m        and processed. To disable the updates, you should use the ``copy``[39;49;00m
    [33m        method with ``delete_updates=True``.[39;49;00m
    [33m[39;49;00m
    [33m    Returns[39;49;00m
    [33m    -------[39;49;00m
    [33m    list[39;49;00m
    [33m        List of outputs on indices/keys from ``output_subset`` or all of them,[39;49;00m
    [33m        if ``output_subset`` is not passed.[39;49;00m
    [33m    """[39;49;00m[90m[39;49;00m
        trust_input = [96mself[39;49;00m.trust_input[90m[39;49;00m
        input_storage = [96mself[39;49;00m.input_storage[90m[39;49;00m
        vm = [96mself[39;49;00m.vm[90m[39;49;00m
        profile = [96mself[39;49;00m.profile[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0 = time.perf_counter()[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m output_subset [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
            warnings.warn([33m"[39;49;00m[33moutput_subset is deprecated.[39;49;00m[33m"[39;49;00m, [96mFutureWarning[39;49;00m)[90m[39;49;00m
            [94mif[39;49;00m [96mself[39;49;00m.output_keys [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                output_subset = [[96mself[39;49;00m.output_keys.index(key) [94mfor[39;49;00m key [95min[39;49;00m output_subset][90m[39;49;00m
    [90m[39;49;00m
        [90m# Reinitialize each container's 'provided' counter[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m trust_input:[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
        [94melse[39;49;00m:[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                arg_container.provided = [94m0[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
            [94mif[39;49;00m [96mlen[39;49;00m(args) + [96mlen[39;49;00m(kwargs) > [96mlen[39;49;00m(input_storage):[90m[39;49;00m
                [94mraise[39;49;00m [96mTypeError[39;49;00m([33m"[39;49;00m[33mToo many parameter passed to pytensor function[39;49;00m[33m"[39;49;00m)[90m[39;49;00m
    [90m[39;49;00m
            [90m# Set positional arguments[39;49;00m[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                [90m# See discussion about None as input[39;49;00m[90m[39;49;00m
                [90m# https://groups.google.com/group/theano-dev/browse_thread/thread/920a5e904e8a8525/4f1b311a28fc27e5[39;49;00m[90m[39;49;00m
                [94mif[39;49;00m arg [95mis[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                    arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
                [94melse[39;49;00m:[90m[39;49;00m
                    [94mtry[39;49;00m:[90m[39;49;00m
                        arg_container.storage[[94m0[39;49;00m] = arg_container.type.filter([90m[39;49;00m
                            arg,[90m[39;49;00m
                            strict=arg_container.strict,[90m[39;49;00m
                            allow_downcast=arg_container.allow_downcast,[90m[39;49;00m
                        )[90m[39;49;00m
    [90m[39;49;00m
                    [94mexcept[39;49;00m [96mException[39;49;00m [94mas[39;49;00m e:[90m[39;49;00m
                        i = input_storage.index(arg_container)[90m[39;49;00m
                        function_name = [33m"[39;49;00m[33mpytensor function[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        argument_name = [33m"[39;49;00m[33margument[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mself[39;49;00m.name:[90m[39;49;00m
                            function_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + [96mself[39;49;00m.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mhasattr[39;49;00m(arg, [33m"[39;49;00m[33mname[39;49;00m[33m"[39;49;00m) [95mand[39;49;00m arg.name:[90m[39;49;00m
                            argument_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + arg.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        where = get_variable_trace_string([96mself[39;49;00m.maker.inputs[i].variable)[90m[39;49;00m
                        [94mif[39;49;00m [96mlen[39;49;00m(e.args) == [94m1[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + e.args[[94m0[39;49;00m],[90m[39;49;00m
                            )[90m[39;49;00m
                        [94melse[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                            ) + e.args[90m[39;49;00m
                        [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                        [94mraise[39;49;00m[90m[39;49;00m
                arg_container.provided += [94m1[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
        [90m# Set keyword arguments[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m kwargs:  [90m# for speed, skip the items for empty kwargs[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m k, arg [95min[39;49;00m kwargs.items():[90m[39;49;00m
                [96mself[39;49;00m[k] = arg[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m [95mnot[39;49;00m trust_input:[90m[39;49;00m
            [90m# Collect aliased inputs among the storage space[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m potential_group [95min[39;49;00m [96mself[39;49;00m._potential_aliased_input_groups:[90m[39;49;00m
                args_share_memory: [96mlist[39;49;00m[[96mlist[39;49;00m[[96mint[39;49;00m]] = [][90m[39;49;00m
                [94mfor[39;49;00m i [95min[39;49;00m potential_group:[90m[39;49;00m
                    i_type = [96mself[39;49;00m.maker.inputs[i].variable.type[90m[39;49;00m
                    i_val = input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
    [90m[39;49;00m
                    [90m# Check if value is aliased with any of the values in one of the groups[39;49;00m[90m[39;49;00m
                    [94mfor[39;49;00m j_group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                        [94mif[39;49;00m [96many[39;49;00m([90m[39;49;00m
                            i_type.may_share_memory(input_storage[j].storage[[94m0[39;49;00m], i_val)[90m[39;49;00m
                            [94mfor[39;49;00m j [95min[39;49;00m j_group[90m[39;49;00m
                        ):[90m[39;49;00m
                            j_group.append(i)[90m[39;49;00m
                            [94mbreak[39;49;00m[90m[39;49;00m
                    [94melse[39;49;00m:  [90m# no break[39;49;00m[90m[39;49;00m
                        [90m# Create a new group[39;49;00m[90m[39;49;00m
                        args_share_memory.append([i])[90m[39;49;00m
    [90m[39;49;00m
                [90m# Check for groups of more than one argument that share memory[39;49;00m[90m[39;49;00m
                [94mfor[39;49;00m group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                    [94mif[39;49;00m [96mlen[39;49;00m(group) > [94m1[39;49;00m:[90m[39;49;00m
                        [90m# copy all but the first[39;49;00m[90m[39;49;00m
                        [94mfor[39;49;00m i [95min[39;49;00m group[[94m1[39;49;00m:]:[90m[39;49;00m
                            input_storage[i].storage[[94m0[39;49;00m] = copy.copy([90m[39;49;00m
                                input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
                            )[90m[39;49;00m
    [90m[39;49;00m
            [90m# Check if inputs are missing, or if inputs were set more than once, or[39;49;00m[90m[39;49;00m
            [90m# if we tried to provide inputs that are supposed to be implicit.[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                [94mif[39;49;00m arg_container.required [95mand[39;49;00m [95mnot[39;49;00m arg_container.provided:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMissing required input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.provided > [94m1[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMultiple values for input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.implicit [95mand[39;49;00m arg_container.provided > [94m0[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mTried to provide value for implicit input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
    [90m[39;49;00m
        [90m# Do the actual work[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0_fn = time.perf_counter()[90m[39;49;00m
        [94mtry[39;49;00m:[90m[39;49;00m
>           outputs = vm() [94mif[39;49;00m output_subset [95mis[39;49;00m [94mNone[39;49;00m [94melse[39;49;00m vm(output_subset=output_subset)[90m[39;49;00m
                      ^^^^[90m[39;49;00m
[1m[31mE           pymc.logprob.utils.ParameterValueError: [0m
[1m[31mE           Apply node that caused the error: Check{}([[[-151.84 ... 4390183]]], False)[0m
[1m[31mE           Toposort index: 0[0m
[1m[31mE           Inputs types: [TensorType(float64, shape=(1, 1, 2)), ScalarType(bool)][0m
[1m[31mE           Inputs shapes: [(1, 1, 2), ()][0m
[1m[31mE           Inputs strides: [(16, 16, 8), ()][0m
[1m[31mE           Inputs values: [array([[[-151.8417971 , -149.44390183]]]), np.False_][0m
[1m[31mE           Inputs type_num: [12, 0][0m
[1m[31mE           Outputs clients: [[DeepCopyOp(Check{}.0)]][0m
[1m[31mE           [0m
[1m[31mE           Backtrace when the node is created (use PyTensor flag traceback__limit=N to make it longer):[0m
[1m[31mE             File "/app/pymc/logprob/basic.py", line 193, in logp[0m
[1m[31mE               return _logprob_helper(rv, value, **kwargs)[0m
[1m[31mE             File "/app/pymc/logprob/abstract.py", line 70, in _logprob_helper[0m
[1m[31mE               logprob = _logprob(rv.owner.op, values, *rv.owner.inputs, **kwargs)[0m
[1m[31mE             File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/functools.py", line 982, in wrapper[0m
[1m[31mE               return dispatch(args[0].__class__)(*args, **kw)[0m
[1m[31mE             File "/app/pymc/distributions/distribution.py", line 140, in logp[0m
[1m[31mE               return class_logp(value, *dist_params)[0m
[1m[31mE             File "/app/tests/distributions/test_dist_math.py", line 96, in logp[0m
[1m[31mE               return check_parameters([0m
[1m[31mE             File "/app/pymc/distributions/dist_math.py", line 72, in check_parameters[0m
[1m[31mE               return CheckParameterValue(msg, can_be_replaced_by_ninf)(expr, all_true_scalar)[0m
[1m[31mE             File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/graph/op.py", line 294, in __call__[0m
[1m[31mE               node = self.make_node(*inputs, **kwargs)[0m
[1m[31mE             File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/raise_op.py", line 81, in make_node[0m
[1m[31mE               [value.type()],[0m
[1m[31mE           [0m
[1m[31mE           Debug print of the apply node: [0m
[1m[31mE           Check{} [id A] <Tensor3(float64, shape=(1, 1, 2))>[0m
[1m[31mE            ├─ [[[-151.84 ... 4390183]]] [id B] <Tensor3(float64, shape=(1, 1, 2))>[0m
[1m[31mE            └─ False [id C] <bool>[0m
[1m[31mE           [0m
[1m[31mE           Storage map footprint:[0m
[1m[31mE            - [[[-151.84 ... 4390183]]], Shape: (1, 1, 2), ElemSize: 8 Byte(s), TotalSize: 16 Byte(s)[0m
[1m[31mE            - False, Shape: (), ElemSize: 1 Byte(s), TotalSize: 1.0 Byte(s)[0m
[1m[31mE            TotalSize: 17.0 Byte(s) 0.000 GB[0m
[1m[31mE            TotalSize inputs: 17.0 Byte(s) 0.000 GB[0m

[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/compile/function/types.py[0m:1038: ParameterValueError
[31m[1m_______ TestMatchesScipy.test_multinomial_vectorized[extra_size1-p2-n2] ________[0m

self = <pytensor.compile.function.types.Function object at 0x7f0b9eb127b0>
output_subset = None, args = (), kwargs = {}, trust_input = False
vm = <pytensor.link.c.cvm.CVM object at 0x7f0ba2938730>, profile = None

    [0m[94mdef[39;49;00m[90m [39;49;00m[92m__call__[39;49;00m([96mself[39;49;00m, *args, output_subset=[94mNone[39;49;00m, **kwargs):[90m[39;49;00m
    [90m    [39;49;00m[33m"""[39;49;00m
    [33m    Evaluates value of a function on given arguments.[39;49;00m
    [33m[39;49;00m
    [33m    Parameters[39;49;00m
    [33m    ----------[39;49;00m
    [33m    args : list[39;49;00m
    [33m        List of inputs to the function. All inputs are required, even when[39;49;00m
    [33m        some of them are not necessary to calculate requested subset of[39;49;00m
    [33m        outputs.[39;49;00m
    [33m[39;49;00m
    [33m    kwargs : dict[39;49;00m
    [33m        The function inputs can be passed as keyword argument. For this, use[39;49;00m
    [33m        the name of the input or the input instance as the key.[39;49;00m
    [33m[39;49;00m
    [33m        Keyword argument ``output_subset`` is a list of either indices of the[39;49;00m
    [33m        function's outputs or the keys belonging to the `output_keys` dict[39;49;00m
    [33m        and represent outputs that are requested to be calculated. Regardless[39;49;00m
    [33m        of the presence of ``output_subset``, the updates are always calculated[39;49;00m
    [33m        and processed. To disable the updates, you should use the ``copy``[39;49;00m
    [33m        method with ``delete_updates=True``.[39;49;00m
    [33m[39;49;00m
    [33m    Returns[39;49;00m
    [33m    -------[39;49;00m
    [33m    list[39;49;00m
    [33m        List of outputs on indices/keys from ``output_subset`` or all of them,[39;49;00m
    [33m        if ``output_subset`` is not passed.[39;49;00m
    [33m    """[39;49;00m[90m[39;49;00m
        trust_input = [96mself[39;49;00m.trust_input[90m[39;49;00m
        input_storage = [96mself[39;49;00m.input_storage[90m[39;49;00m
        vm = [96mself[39;49;00m.vm[90m[39;49;00m
        profile = [96mself[39;49;00m.profile[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0 = time.perf_counter()[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m output_subset [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
            warnings.warn([33m"[39;49;00m[33moutput_subset is deprecated.[39;49;00m[33m"[39;49;00m, [96mFutureWarning[39;49;00m)[90m[39;49;00m
            [94mif[39;49;00m [96mself[39;49;00m.output_keys [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                output_subset = [[96mself[39;49;00m.output_keys.index(key) [94mfor[39;49;00m key [95min[39;49;00m output_subset][90m[39;49;00m
    [90m[39;49;00m
        [90m# Reinitialize each container's 'provided' counter[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m trust_input:[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
        [94melse[39;49;00m:[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                arg_container.provided = [94m0[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
            [94mif[39;49;00m [96mlen[39;49;00m(args) + [96mlen[39;49;00m(kwargs) > [96mlen[39;49;00m(input_storage):[90m[39;49;00m
                [94mraise[39;49;00m [96mTypeError[39;49;00m([33m"[39;49;00m[33mToo many parameter passed to pytensor function[39;49;00m[33m"[39;49;00m)[90m[39;49;00m
    [90m[39;49;00m
            [90m# Set positional arguments[39;49;00m[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                [90m# See discussion about None as input[39;49;00m[90m[39;49;00m
                [90m# https://groups.google.com/group/theano-dev/browse_thread/thread/920a5e904e8a8525/4f1b311a28fc27e5[39;49;00m[90m[39;49;00m
                [94mif[39;49;00m arg [95mis[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                    arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
                [94melse[39;49;00m:[90m[39;49;00m
                    [94mtry[39;49;00m:[90m[39;49;00m
                        arg_container.storage[[94m0[39;49;00m] = arg_container.type.filter([90m[39;49;00m
                            arg,[90m[39;49;00m
                            strict=arg_container.strict,[90m[39;49;00m
                            allow_downcast=arg_container.allow_downcast,[90m[39;49;00m
                        )[90m[39;49;00m
    [90m[39;49;00m
                    [94mexcept[39;49;00m [96mException[39;49;00m [94mas[39;49;00m e:[90m[39;49;00m
                        i = input_storage.index(arg_container)[90m[39;49;00m
                        function_name = [33m"[39;49;00m[33mpytensor function[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        argument_name = [33m"[39;49;00m[33margument[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mself[39;49;00m.name:[90m[39;49;00m
                            function_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + [96mself[39;49;00m.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mhasattr[39;49;00m(arg, [33m"[39;49;00m[33mname[39;49;00m[33m"[39;49;00m) [95mand[39;49;00m arg.name:[90m[39;49;00m
                            argument_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + arg.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        where = get_variable_trace_string([96mself[39;49;00m.maker.inputs[i].variable)[90m[39;49;00m
                        [94mif[39;49;00m [96mlen[39;49;00m(e.args) == [94m1[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + e.args[[94m0[39;49;00m],[90m[39;49;00m
                            )[90m[39;49;00m
                        [94melse[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                            ) + e.args[90m[39;49;00m
                        [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                        [94mraise[39;49;00m[90m[39;49;00m
                arg_container.provided += [94m1[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
        [90m# Set keyword arguments[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m kwargs:  [90m# for speed, skip the items for empty kwargs[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m k, arg [95min[39;49;00m kwargs.items():[90m[39;49;00m
                [96mself[39;49;00m[k] = arg[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m [95mnot[39;49;00m trust_input:[90m[39;49;00m
            [90m# Collect aliased inputs among the storage space[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m potential_group [95min[39;49;00m [96mself[39;49;00m._potential_aliased_input_groups:[90m[39;49;00m
                args_share_memory: [96mlist[39;49;00m[[96mlist[39;49;00m[[96mint[39;49;00m]] = [][90m[39;49;00m
                [94mfor[39;49;00m i [95min[39;49;00m potential_group:[90m[39;49;00m
                    i_type = [96mself[39;49;00m.maker.inputs[i].variable.type[90m[39;49;00m
                    i_val = input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
    [90m[39;49;00m
                    [90m# Check if value is aliased with any of the values in one of the groups[39;49;00m[90m[39;49;00m
                    [94mfor[39;49;00m j_group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                        [94mif[39;49;00m [96many[39;49;00m([90m[39;49;00m
                            i_type.may_share_memory(input_storage[j].storage[[94m0[39;49;00m], i_val)[90m[39;49;00m
                            [94mfor[39;49;00m j [95min[39;49;00m j_group[90m[39;49;00m
                        ):[90m[39;49;00m
                            j_group.append(i)[90m[39;49;00m
                            [94mbreak[39;49;00m[90m[39;49;00m
                    [94melse[39;49;00m:  [90m# no break[39;49;00m[90m[39;49;00m
                        [90m# Create a new group[39;49;00m[90m[39;49;00m
                        args_share_memory.append([i])[90m[39;49;00m
    [90m[39;49;00m
                [90m# Check for groups of more than one argument that share memory[39;49;00m[90m[39;49;00m
                [94mfor[39;49;00m group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                    [94mif[39;49;00m [96mlen[39;49;00m(group) > [94m1[39;49;00m:[90m[39;49;00m
                        [90m# copy all but the first[39;49;00m[90m[39;49;00m
                        [94mfor[39;49;00m i [95min[39;49;00m group[[94m1[39;49;00m:]:[90m[39;49;00m
                            input_storage[i].storage[[94m0[39;49;00m] = copy.copy([90m[39;49;00m
                                input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
                            )[90m[39;49;00m
    [90m[39;49;00m
            [90m# Check if inputs are missing, or if inputs were set more than once, or[39;49;00m[90m[39;49;00m
            [90m# if we tried to provide inputs that are supposed to be implicit.[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                [94mif[39;49;00m arg_container.required [95mand[39;49;00m [95mnot[39;49;00m arg_container.provided:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMissing required input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.provided > [94m1[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMultiple values for input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.implicit [95mand[39;49;00m arg_container.provided > [94m0[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mTried to provide value for implicit input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
    [90m[39;49;00m
        [90m# Do the actual work[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0_fn = time.perf_counter()[90m[39;49;00m
        [94mtry[39;49;00m:[90m[39;49;00m
>           outputs = vm() [94mif[39;49;00m output_subset [95mis[39;49;00m [94mNone[39;49;00m [94melse[39;49;00m vm(output_subset=output_subset)[90m[39;49;00m
                      ^^^^[90m[39;49;00m
[1m[31mE           pymc.logprob.utils.ParameterValueError[0m

[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/compile/function/types.py[0m:1038: ParameterValueError

[33mDuring handling of the above exception, another exception occurred:[0m

self = <tests.distributions.test_multivariate.TestMatchesScipy object at 0x7f0bb35c7700>
n = array([[ 5,  6],
       [10, 11]])
p = array([[[0.17876157, 0.39760757, 0.0449895 , 0.37864137],
        [0.06511207, 0.35563681, 0.30921865, 0.27003247]],

       [[0.2899355 , 0.11278839, 0.36678067, 0.23049544],
        [0.13152157, 0.0916917 , 0.25354174, 0.52324499]]])
extra_size = (2,)

    [0m[37m@pytest[39;49;00m.mark.parametrize([33m"[39;49;00m[33mn[39;49;00m[33m"[39;49;00m, [([94m10[39;49;00m), ([[94m10[39;49;00m, [94m11[39;49;00m]), ([[[94m5[39;49;00m, [94m6[39;49;00m], [[94m10[39;49;00m, [94m11[39;49;00m]])])[90m[39;49;00m
    [37m@pytest[39;49;00m.mark.parametrize([90m[39;49;00m
        [33m"[39;49;00m[33mp[39;49;00m[33m"[39;49;00m,[90m[39;49;00m
        [[90m[39;49;00m
            ([[94m0.2[39;49;00m, [94m0.3[39;49;00m, [94m0.5[39;49;00m]),[90m[39;49;00m
            ([[[94m0.2[39;49;00m, [94m0.3[39;49;00m, [94m0.5[39;49;00m], [[94m0.9[39;49;00m, [94m0.09[39;49;00m, [94m0.01[39;49;00m]]),[90m[39;49;00m
            (np.abs(np.random.randn([94m2[39;49;00m, [94m2[39;49;00m, [94m4[39;49;00m))),[90m[39;49;00m
        ],[90m[39;49;00m
    )[90m[39;49;00m
    [37m@pytest[39;49;00m.mark.parametrize([33m"[39;49;00m[33mextra_size[39;49;00m[33m"[39;49;00m, [([94m1[39;49;00m,), ([94m2[39;49;00m,), ([94m2[39;49;00m, [94m3[39;49;00m)])[90m[39;49;00m
    [94mdef[39;49;00m[90m [39;49;00m[92mtest_multinomial_vectorized[39;49;00m([96mself[39;49;00m, n, p, extra_size):[90m[39;49;00m
        n = np.array(n)[90m[39;49;00m
        p = np.array(p)[90m[39;49;00m
        p /= p.sum(axis=-[94m1[39;49;00m, keepdims=[94mTrue[39;49;00m)[90m[39;49;00m
    [90m[39;49;00m
        _, bcast_p = broadcast_params([n, p], ndims_params=[[94m0[39;49;00m, [94m1[39;49;00m])[90m[39;49;00m
        size = extra_size + bcast_p.shape[:-[94m1[39;49;00m][90m[39;49;00m
    [90m[39;49;00m
        mn = pm.Multinomial.dist(n=n, p=p, size=size)[90m[39;49;00m
        vals = mn.eval()[90m[39;49;00m
    [90m[39;49;00m
        npt.assert_almost_equal([90m[39;49;00m
            st.multinomial.logpmf(vals, n, p),[90m[39;49;00m
>           pm.logp(mn, vals).eval(),[90m[39;49;00m
            ^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
            decimal=[94m4[39;49;00m,[90m[39;49;00m
            err_msg=[33mf[39;49;00m[33m"[39;49;00m[33mvals=[39;49;00m[33m{[39;49;00mvals[33m}[39;49;00m[33m"[39;49;00m,[90m[39;49;00m
        )[90m[39;49;00m

[1m[31mtests/distributions/test_multivariate.py[0m:692:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/graph/basic.py[0m:668: in eval
    [0m[94mreturn[39;49;00m fn(*args)[90m[39;49;00m
           ^^^^^^^^^[90m[39;49;00m
[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/compile/function/types.py[0m:1048: in __call__
    [0mraise_with_op([90m[39;49;00m
[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/link/utils.py[0m:526: in raise_with_op
    [0m[94mraise[39;49;00m exc_value.with_traceback(exc_trace)[90m[39;49;00m
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <pytensor.compile.function.types.Function object at 0x7f0b9eb127b0>
output_subset = None, args = (), kwargs = {}, trust_input = False
vm = <pytensor.link.c.cvm.CVM object at 0x7f0ba2938730>, profile = None

    [0m[94mdef[39;49;00m[90m [39;49;00m[92m__call__[39;49;00m([96mself[39;49;00m, *args, output_subset=[94mNone[39;49;00m, **kwargs):[90m[39;49;00m
    [90m    [39;49;00m[33m"""[39;49;00m
    [33m    Evaluates value of a function on given arguments.[39;49;00m
    [33m[39;49;00m
    [33m    Parameters[39;49;00m
    [33m    ----------[39;49;00m
    [33m    args : list[39;49;00m
    [33m        List of inputs to the function. All inputs are required, even when[39;49;00m
    [33m        some of them are not necessary to calculate requested subset of[39;49;00m
    [33m        outputs.[39;49;00m
    [33m[39;49;00m
    [33m    kwargs : dict[39;49;00m
    [33m        The function inputs can be passed as keyword argument. For this, use[39;49;00m
    [33m        the name of the input or the input instance as the key.[39;49;00m
    [33m[39;49;00m
    [33m        Keyword argument ``output_subset`` is a list of either indices of the[39;49;00m
    [33m        function's outputs or the keys belonging to the `output_keys` dict[39;49;00m
    [33m        and represent outputs that are requested to be calculated. Regardless[39;49;00m
    [33m        of the presence of ``output_subset``, the updates are always calculated[39;49;00m
    [33m        and processed. To disable the updates, you should use the ``copy``[39;49;00m
    [33m        method with ``delete_updates=True``.[39;49;00m
    [33m[39;49;00m
    [33m    Returns[39;49;00m
    [33m    -------[39;49;00m
    [33m    list[39;49;00m
    [33m        List of outputs on indices/keys from ``output_subset`` or all of them,[39;49;00m
    [33m        if ``output_subset`` is not passed.[39;49;00m
    [33m    """[39;49;00m[90m[39;49;00m
        trust_input = [96mself[39;49;00m.trust_input[90m[39;49;00m
        input_storage = [96mself[39;49;00m.input_storage[90m[39;49;00m
        vm = [96mself[39;49;00m.vm[90m[39;49;00m
        profile = [96mself[39;49;00m.profile[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0 = time.perf_counter()[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m output_subset [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
            warnings.warn([33m"[39;49;00m[33moutput_subset is deprecated.[39;49;00m[33m"[39;49;00m, [96mFutureWarning[39;49;00m)[90m[39;49;00m
            [94mif[39;49;00m [96mself[39;49;00m.output_keys [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                output_subset = [[96mself[39;49;00m.output_keys.index(key) [94mfor[39;49;00m key [95min[39;49;00m output_subset][90m[39;49;00m
    [90m[39;49;00m
        [90m# Reinitialize each container's 'provided' counter[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m trust_input:[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
        [94melse[39;49;00m:[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                arg_container.provided = [94m0[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
            [94mif[39;49;00m [96mlen[39;49;00m(args) + [96mlen[39;49;00m(kwargs) > [96mlen[39;49;00m(input_storage):[90m[39;49;00m
                [94mraise[39;49;00m [96mTypeError[39;49;00m([33m"[39;49;00m[33mToo many parameter passed to pytensor function[39;49;00m[33m"[39;49;00m)[90m[39;49;00m
    [90m[39;49;00m
            [90m# Set positional arguments[39;49;00m[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                [90m# See discussion about None as input[39;49;00m[90m[39;49;00m
                [90m# https://groups.google.com/group/theano-dev/browse_thread/thread/920a5e904e8a8525/4f1b311a28fc27e5[39;49;00m[90m[39;49;00m
                [94mif[39;49;00m arg [95mis[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                    arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
                [94melse[39;49;00m:[90m[39;49;00m
                    [94mtry[39;49;00m:[90m[39;49;00m
                        arg_container.storage[[94m0[39;49;00m] = arg_container.type.filter([90m[39;49;00m
                            arg,[90m[39;49;00m
                            strict=arg_container.strict,[90m[39;49;00m
                            allow_downcast=arg_container.allow_downcast,[90m[39;49;00m
                        )[90m[39;49;00m
    [90m[39;49;00m
                    [94mexcept[39;49;00m [96mException[39;49;00m [94mas[39;49;00m e:[90m[39;49;00m
                        i = input_storage.index(arg_container)[90m[39;49;00m
                        function_name = [33m"[39;49;00m[33mpytensor function[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        argument_name = [33m"[39;49;00m[33margument[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mself[39;49;00m.name:[90m[39;49;00m
                            function_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + [96mself[39;49;00m.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mhasattr[39;49;00m(arg, [33m"[39;49;00m[33mname[39;49;00m[33m"[39;49;00m) [95mand[39;49;00m arg.name:[90m[39;49;00m
                            argument_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + arg.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        where = get_variable_trace_string([96mself[39;49;00m.maker.inputs[i].variable)[90m[39;49;00m
                        [94mif[39;49;00m [96mlen[39;49;00m(e.args) == [94m1[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + e.args[[94m0[39;49;00m],[90m[39;49;00m
                            )[90m[39;49;00m
                        [94melse[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                            ) + e.args[90m[39;49;00m
                        [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                        [94mraise[39;49;00m[90m[39;49;00m
                arg_container.provided += [94m1[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
        [90m# Set keyword arguments[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m kwargs:  [90m# for speed, skip the items for empty kwargs[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m k, arg [95min[39;49;00m kwargs.items():[90m[39;49;00m
                [96mself[39;49;00m[k] = arg[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m [95mnot[39;49;00m trust_input:[90m[39;49;00m
            [90m# Collect aliased inputs among the storage space[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m potential_group [95min[39;49;00m [96mself[39;49;00m._potential_aliased_input_groups:[90m[39;49;00m
                args_share_memory: [96mlist[39;49;00m[[96mlist[39;49;00m[[96mint[39;49;00m]] = [][90m[39;49;00m
                [94mfor[39;49;00m i [95min[39;49;00m potential_group:[90m[39;49;00m
                    i_type = [96mself[39;49;00m.maker.inputs[i].variable.type[90m[39;49;00m
                    i_val = input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
    [90m[39;49;00m
                    [90m# Check if value is aliased with any of the values in one of the groups[39;49;00m[90m[39;49;00m
                    [94mfor[39;49;00m j_group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                        [94mif[39;49;00m [96many[39;49;00m([90m[39;49;00m
                            i_type.may_share_memory(input_storage[j].storage[[94m0[39;49;00m], i_val)[90m[39;49;00m
                            [94mfor[39;49;00m j [95min[39;49;00m j_group[90m[39;49;00m
                        ):[90m[39;49;00m
                            j_group.append(i)[90m[39;49;00m
                            [94mbreak[39;49;00m[90m[39;49;00m
                    [94melse[39;49;00m:  [90m# no break[39;49;00m[90m[39;49;00m
                        [90m# Create a new group[39;49;00m[90m[39;49;00m
                        args_share_memory.append([i])[90m[39;49;00m
    [90m[39;49;00m
                [90m# Check for groups of more than one argument that share memory[39;49;00m[90m[39;49;00m
                [94mfor[39;49;00m group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                    [94mif[39;49;00m [96mlen[39;49;00m(group) > [94m1[39;49;00m:[90m[39;49;00m
                        [90m# copy all but the first[39;49;00m[90m[39;49;00m
                        [94mfor[39;49;00m i [95min[39;49;00m group[[94m1[39;49;00m:]:[90m[39;49;00m
                            input_storage[i].storage[[94m0[39;49;00m] = copy.copy([90m[39;49;00m
                                input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
                            )[90m[39;49;00m
    [90m[39;49;00m
            [90m# Check if inputs are missing, or if inputs were set more than once, or[39;49;00m[90m[39;49;00m
            [90m# if we tried to provide inputs that are supposed to be implicit.[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                [94mif[39;49;00m arg_container.required [95mand[39;49;00m [95mnot[39;49;00m arg_container.provided:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMissing required input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.provided > [94m1[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMultiple values for input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.implicit [95mand[39;49;00m arg_container.provided > [94m0[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mTried to provide value for implicit input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
    [90m[39;49;00m
        [90m# Do the actual work[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0_fn = time.perf_counter()[90m[39;49;00m
        [94mtry[39;49;00m:[90m[39;49;00m
>           outputs = vm() [94mif[39;49;00m output_subset [95mis[39;49;00m [94mNone[39;49;00m [94melse[39;49;00m vm(output_subset=output_subset)[90m[39;49;00m
                      ^^^^[90m[39;49;00m
[1m[31mE           pymc.logprob.utils.ParameterValueError: [0m
[1m[31mE           Apply node that caused the error: Check{}([[[-116.77 ... 5722299]]], False)[0m
[1m[31mE           Toposort index: 0[0m
[1m[31mE           Inputs types: [TensorType(float64, shape=(1, 2, 2)), ScalarType(bool)][0m
[1m[31mE           Inputs shapes: [(1, 2, 2), ()][0m
[1m[31mE           Inputs strides: [(32, 16, 8), ()][0m
[1m[31mE           Inputs values: [array([[[-116.7720391 , -114.98027963],[0m
[1m[31mE                   [-106.45511827, -104.05722299]]]), np.False_][0m
[1m[31mE           Inputs type_num: [12, 0][0m
[1m[31mE           Outputs clients: [[DeepCopyOp(Check{}.0)]][0m
[1m[31mE           [0m
[1m[31mE           Backtrace when the node is created (use PyTensor flag traceback__limit=N to make it longer):[0m
[1m[31mE             File "/app/pymc/logprob/basic.py", line 193, in logp[0m
[1m[31mE               return _logprob_helper(rv, value, **kwargs)[0m
[1m[31mE             File "/app/pymc/logprob/abstract.py", line 70, in _logprob_helper[0m
[1m[31mE               logprob = _logprob(rv.owner.op, values, *rv.owner.inputs, **kwargs)[0m
[1m[31mE             File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/functools.py", line 982, in wrapper[0m
[1m[31mE               return dispatch(args[0].__class__)(*args, **kw)[0m
[1m[31mE             File "/app/pymc/distributions/distribution.py", line 140, in logp[0m
[1m[31mE               return class_logp(value, *dist_params)[0m
[1m[31mE             File "/app/tests/distributions/test_dist_math.py", line 96, in logp[0m
[1m[31mE               return check_parameters([0m
[1m[31mE             File "/app/pymc/distributions/dist_math.py", line 72, in check_parameters[0m
[1m[31mE               return CheckParameterValue(msg, can_be_replaced_by_ninf)(expr, all_true_scalar)[0m
[1m[31mE             File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/graph/op.py", line 294, in __call__[0m
[1m[31mE               node = self.make_node(*inputs, **kwargs)[0m
[1m[31mE             File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/raise_op.py", line 81, in make_node[0m
[1m[31mE               [value.type()],[0m
[1m[31mE           [0m
[1m[31mE           Debug print of the apply node: [0m
[1m[31mE           Check{} [id A] <Tensor3(float64, shape=(1, 2, 2))>[0m
[1m[31mE            ├─ [[[-116.77 ... 5722299]]] [id B] <Tensor3(float64, shape=(1, 2, 2))>[0m
[1m[31mE            └─ False [id C] <bool>[0m
[1m[31mE           [0m
[1m[31mE           Storage map footprint:[0m
[1m[31mE            - [[[-116.77 ... 5722299]]], Shape: (1, 2, 2), ElemSize: 8 Byte(s), TotalSize: 32 Byte(s)[0m
[1m[31mE            - False, Shape: (), ElemSize: 1 Byte(s), TotalSize: 1.0 Byte(s)[0m
[1m[31mE            TotalSize: 33.0 Byte(s) 0.000 GB[0m
[1m[31mE            TotalSize inputs: 33.0 Byte(s) 0.000 GB[0m

[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/compile/function/types.py[0m:1038: ParameterValueError
[31m[1m_______ TestMatchesScipy.test_multinomial_vectorized[extra_size2-p0-10] ________[0m

self = <tests.distributions.test_multivariate.TestMatchesScipy object at 0x7f0bb35c7750>
n = array(10), p = array([0.2, 0.3, 0.5]), extra_size = (2, 3)

    [0m[37m@pytest[39;49;00m.mark.parametrize([33m"[39;49;00m[33mn[39;49;00m[33m"[39;49;00m, [([94m10[39;49;00m), ([[94m10[39;49;00m, [94m11[39;49;00m]), ([[[94m5[39;49;00m, [94m6[39;49;00m], [[94m10[39;49;00m, [94m11[39;49;00m]])])[90m[39;49;00m
    [37m@pytest[39;49;00m.mark.parametrize([90m[39;49;00m
        [33m"[39;49;00m[33mp[39;49;00m[33m"[39;49;00m,[90m[39;49;00m
        [[90m[39;49;00m
            ([[94m0.2[39;49;00m, [94m0.3[39;49;00m, [94m0.5[39;49;00m]),[90m[39;49;00m
            ([[[94m0.2[39;49;00m, [94m0.3[39;49;00m, [94m0.5[39;49;00m], [[94m0.9[39;49;00m, [94m0.09[39;49;00m, [94m0.01[39;49;00m]]),[90m[39;49;00m
            (np.abs(np.random.randn([94m2[39;49;00m, [94m2[39;49;00m, [94m4[39;49;00m))),[90m[39;49;00m
        ],[90m[39;49;00m
    )[90m[39;49;00m
    [37m@pytest[39;49;00m.mark.parametrize([33m"[39;49;00m[33mextra_size[39;49;00m[33m"[39;49;00m, [([94m1[39;49;00m,), ([94m2[39;49;00m,), ([94m2[39;49;00m, [94m3[39;49;00m)])[90m[39;49;00m
    [94mdef[39;49;00m[90m [39;49;00m[92mtest_multinomial_vectorized[39;49;00m([96mself[39;49;00m, n, p, extra_size):[90m[39;49;00m
        n = np.array(n)[90m[39;49;00m
        p = np.array(p)[90m[39;49;00m
        p /= p.sum(axis=-[94m1[39;49;00m, keepdims=[94mTrue[39;49;00m)[90m[39;49;00m
    [90m[39;49;00m
        _, bcast_p = broadcast_params([n, p], ndims_params=[[94m0[39;49;00m, [94m1[39;49;00m])[90m[39;49;00m
        size = extra_size + bcast_p.shape[:-[94m1[39;49;00m][90m[39;49;00m
    [90m[39;49;00m
        mn = pm.Multinomial.dist(n=n, p=p, size=size)[90m[39;49;00m
        vals = mn.eval()[90m[39;49;00m
    [90m[39;49;00m
>       npt.assert_almost_equal([90m[39;49;00m
            st.multinomial.logpmf(vals, n, p),[90m[39;49;00m
            pm.logp(mn, vals).eval(),[90m[39;49;00m
            decimal=[94m4[39;49;00m,[90m[39;49;00m
            err_msg=[33mf[39;49;00m[33m"[39;49;00m[33mvals=[39;49;00m[33m{[39;49;00mvals[33m}[39;49;00m[33m"[39;49;00m,[90m[39;49;00m
        )[90m[39;49;00m
[1m[31mE       AssertionError: [0m
[1m[31mE       Arrays are not almost equal to 4 decimals[0m
[1m[31mE       vals=[[[3 3 4][0m
[1m[31mE         [3 2 5][0m
[1m[31mE         [1 2 7]][0m
[1m[31mE       [0m
[1m[31mE        [[3 4 3][0m
[1m[31mE         [2 3 5][0m
[1m[31mE         [0 6 4]]][0m
[1m[31mE       (shapes (2, 3), (1, 1) mismatch)[0m
[1m[31mE        ACTUAL: array([[-2.87  , -2.87  , -2.9833],[0m
[1m[31mE              [-3.3808, -2.4645, -4.6493]])[0m
[1m[31mE        DESIRED: array([[-94.74]])[0m

[1m[31mtests/distributions/test_multivariate.py[0m:690: AssertionError
[31m[1m_______ TestMatchesScipy.test_multinomial_vectorized[extra_size2-p0-n1] ________[0m

self = <tests.distributions.test_multivariate.TestMatchesScipy object at 0x7f0bb35c77a0>
n = array([10, 11]), p = array([0.2, 0.3, 0.5]), extra_size = (2, 3)

    [0m[37m@pytest[39;49;00m.mark.parametrize([33m"[39;49;00m[33mn[39;49;00m[33m"[39;49;00m, [([94m10[39;49;00m), ([[94m10[39;49;00m, [94m11[39;49;00m]), ([[[94m5[39;49;00m, [94m6[39;49;00m], [[94m10[39;49;00m, [94m11[39;49;00m]])])[90m[39;49;00m
    [37m@pytest[39;49;00m.mark.parametrize([90m[39;49;00m
        [33m"[39;49;00m[33mp[39;49;00m[33m"[39;49;00m,[90m[39;49;00m
        [[90m[39;49;00m
            ([[94m0.2[39;49;00m, [94m0.3[39;49;00m, [94m0.5[39;49;00m]),[90m[39;49;00m
            ([[[94m0.2[39;49;00m, [94m0.3[39;49;00m, [94m0.5[39;49;00m], [[94m0.9[39;49;00m, [94m0.09[39;49;00m, [94m0.01[39;49;00m]]),[90m[39;49;00m
            (np.abs(np.random.randn([94m2[39;49;00m, [94m2[39;49;00m, [94m4[39;49;00m))),[90m[39;49;00m
        ],[90m[39;49;00m
    )[90m[39;49;00m
    [37m@pytest[39;49;00m.mark.parametrize([33m"[39;49;00m[33mextra_size[39;49;00m[33m"[39;49;00m, [([94m1[39;49;00m,), ([94m2[39;49;00m,), ([94m2[39;49;00m, [94m3[39;49;00m)])[90m[39;49;00m
    [94mdef[39;49;00m[90m [39;49;00m[92mtest_multinomial_vectorized[39;49;00m([96mself[39;49;00m, n, p, extra_size):[90m[39;49;00m
        n = np.array(n)[90m[39;49;00m
        p = np.array(p)[90m[39;49;00m
        p /= p.sum(axis=-[94m1[39;49;00m, keepdims=[94mTrue[39;49;00m)[90m[39;49;00m
    [90m[39;49;00m
        _, bcast_p = broadcast_params([n, p], ndims_params=[[94m0[39;49;00m, [94m1[39;49;00m])[90m[39;49;00m
        size = extra_size + bcast_p.shape[:-[94m1[39;49;00m][90m[39;49;00m
    [90m[39;49;00m
        mn = pm.Multinomial.dist(n=n, p=p, size=size)[90m[39;49;00m
        vals = mn.eval()[90m[39;49;00m
    [90m[39;49;00m
>       npt.assert_almost_equal([90m[39;49;00m
            st.multinomial.logpmf(vals, n, p),[90m[39;49;00m
            pm.logp(mn, vals).eval(),[90m[39;49;00m
            decimal=[94m4[39;49;00m,[90m[39;49;00m
            err_msg=[33mf[39;49;00m[33m"[39;49;00m[33mvals=[39;49;00m[33m{[39;49;00mvals[33m}[39;49;00m[33m"[39;49;00m,[90m[39;49;00m
        )[90m[39;49;00m
[1m[31mE       AssertionError: [0m
[1m[31mE       Arrays are not almost equal to 4 decimals[0m
[1m[31mE       vals=[[[[3 4 3][0m
[1m[31mE          [0 4 7]][0m
[1m[31mE       [0m
[1m[31mE         [[2 4 4][0m
[1m[31mE          [1 4 6]][0m
[1m[31mE       [0m
[1m[31mE         [[1 5 4][0m
[1m[31mE          [4 4 3]]][0m
[1m[31mE       [0m
[1m[31mE       [0m
[1m[31mE        [[[1 1 8][0m
[1m[31mE          [4 3 4]][0m
[1m[31mE       [0m
[1m[31mE         [[5 1 4][0m
[1m[31mE          [1 5 5]][0m
[1m[31mE       [0m
[1m[31mE         [[4 3 3][0m
[1m[31mE          [2 3 6]]]][0m
[1m[31mE       (shapes (2, 3, 2), (1, 1, 2) mismatch)[0m
[1m[31mE        ACTUAL: array([[[-3.3808, -3.8688],[0m
[1m[31mE               [-2.7522, -2.8392],[0m
[1m[31mE               [-3.263 , -3.9786]],...[0m
[1m[31mE        DESIRED: array([[[-222.3356, -219.9377]]])[0m

[1m[31mtests/distributions/test_multivariate.py[0m:690: AssertionError
[31m[1m_______ TestMatchesScipy.test_multinomial_vectorized[extra_size2-p0-n2] ________[0m

self = <tests.distributions.test_multivariate.TestMatchesScipy object at 0x7f0bb35c77f0>
n = array([[ 5,  6],
       [10, 11]]), p = array([0.2, 0.3, 0.5])
extra_size = (2, 3)

    [0m[37m@pytest[39;49;00m.mark.parametrize([33m"[39;49;00m[33mn[39;49;00m[33m"[39;49;00m, [([94m10[39;49;00m), ([[94m10[39;49;00m, [94m11[39;49;00m]), ([[[94m5[39;49;00m, [94m6[39;49;00m], [[94m10[39;49;00m, [94m11[39;49;00m]])])[90m[39;49;00m
    [37m@pytest[39;49;00m.mark.parametrize([90m[39;49;00m
        [33m"[39;49;00m[33mp[39;49;00m[33m"[39;49;00m,[90m[39;49;00m
        [[90m[39;49;00m
            ([[94m0.2[39;49;00m, [94m0.3[39;49;00m, [94m0.5[39;49;00m]),[90m[39;49;00m
            ([[[94m0.2[39;49;00m, [94m0.3[39;49;00m, [94m0.5[39;49;00m], [[94m0.9[39;49;00m, [94m0.09[39;49;00m, [94m0.01[39;49;00m]]),[90m[39;49;00m
            (np.abs(np.random.randn([94m2[39;49;00m, [94m2[39;49;00m, [94m4[39;49;00m))),[90m[39;49;00m
        ],[90m[39;49;00m
    )[90m[39;49;00m
    [37m@pytest[39;49;00m.mark.parametrize([33m"[39;49;00m[33mextra_size[39;49;00m[33m"[39;49;00m, [([94m1[39;49;00m,), ([94m2[39;49;00m,), ([94m2[39;49;00m, [94m3[39;49;00m)])[90m[39;49;00m
    [94mdef[39;49;00m[90m [39;49;00m[92mtest_multinomial_vectorized[39;49;00m([96mself[39;49;00m, n, p, extra_size):[90m[39;49;00m
        n = np.array(n)[90m[39;49;00m
        p = np.array(p)[90m[39;49;00m
        p /= p.sum(axis=-[94m1[39;49;00m, keepdims=[94mTrue[39;49;00m)[90m[39;49;00m
    [90m[39;49;00m
        _, bcast_p = broadcast_params([n, p], ndims_params=[[94m0[39;49;00m, [94m1[39;49;00m])[90m[39;49;00m
        size = extra_size + bcast_p.shape[:-[94m1[39;49;00m][90m[39;49;00m
    [90m[39;49;00m
        mn = pm.Multinomial.dist(n=n, p=p, size=size)[90m[39;49;00m
        vals = mn.eval()[90m[39;49;00m
    [90m[39;49;00m
>       npt.assert_almost_equal([90m[39;49;00m
            st.multinomial.logpmf(vals, n, p),[90m[39;49;00m
            pm.logp(mn, vals).eval(),[90m[39;49;00m
            decimal=[94m4[39;49;00m,[90m[39;49;00m
            err_msg=[33mf[39;49;00m[33m"[39;49;00m[33mvals=[39;49;00m[33m{[39;49;00mvals[33m}[39;49;00m[33m"[39;49;00m,[90m[39;49;00m
        )[90m[39;49;00m
[1m[31mE       AssertionError: [0m
[1m[31mE       Arrays are not almost equal to 4 decimals[0m
[1m[31mE       vals=[[[[[3 1 1][0m
[1m[31mE           [1 1 4]][0m
[1m[31mE       [0m
[1m[31mE          [[0 2 8][0m
[1m[31mE           [1 6 4]]][0m
[1m[31mE       [0m
[1m[31mE       [0m
[1m[31mE         [[[1 1 3][0m
[1m[31mE           [1 1 4]][0m
[1m[31mE       [0m
[1m[31mE          [[3 2 5][0m
[1m[31mE           [5 3 3]]][0m
[1m[31mE       [0m
[1m[31mE       [0m
[1m[31mE         [[[0 1 4][0m
[1m[31mE           [1 1 4]][0m
[1m[31mE       [0m
[1m[31mE          [[6 3 1][0m
[1m[31mE           [4 2 5]]]][0m
[1m[31mE       [0m
[1m[31mE       [0m
[1m[31mE       [0m
[1m[31mE        [[[[2 1 2][0m
[1m[31mE           [0 2 4]][0m
[1m[31mE       [0m
[1m[31mE          [[5 1 4][0m
[1m[31mE           [2 4 5]]][0m
[1m[31mE       [0m
[1m[31mE       [0m
[1m[31mE         [[[1 2 2][0m
[1m[31mE           [1 1 4]][0m
[1m[31mE       [0m
[1m[31mE          [[1 4 5][0m
[1m[31mE           [2 7 2]]][0m
[1m[31mE       [0m
[1m[31mE       [0m
[1m[31mE         [[[1 1 3][0m
[1m[31mE           [1 1 4]][0m
[1m[31mE       [0m
[1m[31mE          [[1 4 5][0m
[1m[31mE           [2 5 4]]]]][0m
[1m[31mE       (shapes (2, 3, 2, 2), (1, 1, 2, 2) mismatch)[0m
[1m[31mE        ACTUAL: array([[[[-3.7297, -2.1848],[0m
[1m[31mE                [-4.1465, -3.8609]],[0m
[1m[31mE       ...[0m
[1m[31mE        DESIRED: array([[[[-334.5879, -332.7962],[0m
[1m[31mE                [-324.271 , -321.8731]]]])[0m

[1m[31mtests/distributions/test_multivariate.py[0m:690: AssertionError
[31m[1m_______ TestMatchesScipy.test_multinomial_vectorized[extra_size2-p1-10] ________[0m

self = <pytensor.compile.function.types.Function object at 0x7f0b9d5ae0f0>
output_subset = None, args = (), kwargs = {}, trust_input = False
vm = <pytensor.link.c.cvm.CVM object at 0x7f0ba293be30>, profile = None

    [0m[94mdef[39;49;00m[90m [39;49;00m[92m__call__[39;49;00m([96mself[39;49;00m, *args, output_subset=[94mNone[39;49;00m, **kwargs):[90m[39;49;00m
    [90m    [39;49;00m[33m"""[39;49;00m
    [33m    Evaluates value of a function on given arguments.[39;49;00m
    [33m[39;49;00m
    [33m    Parameters[39;49;00m
    [33m    ----------[39;49;00m
    [33m    args : list[39;49;00m
    [33m        List of inputs to the function. All inputs are required, even when[39;49;00m
    [33m        some of them are not necessary to calculate requested subset of[39;49;00m
    [33m        outputs.[39;49;00m
    [33m[39;49;00m
    [33m    kwargs : dict[39;49;00m
    [33m        The function inputs can be passed as keyword argument. For this, use[39;49;00m
    [33m        the name of the input or the input instance as the key.[39;49;00m
    [33m[39;49;00m
    [33m        Keyword argument ``output_subset`` is a list of either indices of the[39;49;00m
    [33m        function's outputs or the keys belonging to the `output_keys` dict[39;49;00m
    [33m        and represent outputs that are requested to be calculated. Regardless[39;49;00m
    [33m        of the presence of ``output_subset``, the updates are always calculated[39;49;00m
    [33m        and processed. To disable the updates, you should use the ``copy``[39;49;00m
    [33m        method with ``delete_updates=True``.[39;49;00m
    [33m[39;49;00m
    [33m    Returns[39;49;00m
    [33m    -------[39;49;00m
    [33m    list[39;49;00m
    [33m        List of outputs on indices/keys from ``output_subset`` or all of them,[39;49;00m
    [33m        if ``output_subset`` is not passed.[39;49;00m
    [33m    """[39;49;00m[90m[39;49;00m
        trust_input = [96mself[39;49;00m.trust_input[90m[39;49;00m
        input_storage = [96mself[39;49;00m.input_storage[90m[39;49;00m
        vm = [96mself[39;49;00m.vm[90m[39;49;00m
        profile = [96mself[39;49;00m.profile[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0 = time.perf_counter()[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m output_subset [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
            warnings.warn([33m"[39;49;00m[33moutput_subset is deprecated.[39;49;00m[33m"[39;49;00m, [96mFutureWarning[39;49;00m)[90m[39;49;00m
            [94mif[39;49;00m [96mself[39;49;00m.output_keys [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                output_subset = [[96mself[39;49;00m.output_keys.index(key) [94mfor[39;49;00m key [95min[39;49;00m output_subset][90m[39;49;00m
    [90m[39;49;00m
        [90m# Reinitialize each container's 'provided' counter[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m trust_input:[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
        [94melse[39;49;00m:[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                arg_container.provided = [94m0[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
            [94mif[39;49;00m [96mlen[39;49;00m(args) + [96mlen[39;49;00m(kwargs) > [96mlen[39;49;00m(input_storage):[90m[39;49;00m
                [94mraise[39;49;00m [96mTypeError[39;49;00m([33m"[39;49;00m[33mToo many parameter passed to pytensor function[39;49;00m[33m"[39;49;00m)[90m[39;49;00m
    [90m[39;49;00m
            [90m# Set positional arguments[39;49;00m[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                [90m# See discussion about None as input[39;49;00m[90m[39;49;00m
                [90m# https://groups.google.com/group/theano-dev/browse_thread/thread/920a5e904e8a8525/4f1b311a28fc27e5[39;49;00m[90m[39;49;00m
                [94mif[39;49;00m arg [95mis[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                    arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
                [94melse[39;49;00m:[90m[39;49;00m
                    [94mtry[39;49;00m:[90m[39;49;00m
                        arg_container.storage[[94m0[39;49;00m] = arg_container.type.filter([90m[39;49;00m
                            arg,[90m[39;49;00m
                            strict=arg_container.strict,[90m[39;49;00m
                            allow_downcast=arg_container.allow_downcast,[90m[39;49;00m
                        )[90m[39;49;00m
    [90m[39;49;00m
                    [94mexcept[39;49;00m [96mException[39;49;00m [94mas[39;49;00m e:[90m[39;49;00m
                        i = input_storage.index(arg_container)[90m[39;49;00m
                        function_name = [33m"[39;49;00m[33mpytensor function[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        argument_name = [33m"[39;49;00m[33margument[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mself[39;49;00m.name:[90m[39;49;00m
                            function_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + [96mself[39;49;00m.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mhasattr[39;49;00m(arg, [33m"[39;49;00m[33mname[39;49;00m[33m"[39;49;00m) [95mand[39;49;00m arg.name:[90m[39;49;00m
                            argument_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + arg.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        where = get_variable_trace_string([96mself[39;49;00m.maker.inputs[i].variable)[90m[39;49;00m
                        [94mif[39;49;00m [96mlen[39;49;00m(e.args) == [94m1[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + e.args[[94m0[39;49;00m],[90m[39;49;00m
                            )[90m[39;49;00m
                        [94melse[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                            ) + e.args[90m[39;49;00m
                        [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                        [94mraise[39;49;00m[90m[39;49;00m
                arg_container.provided += [94m1[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
        [90m# Set keyword arguments[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m kwargs:  [90m# for speed, skip the items for empty kwargs[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m k, arg [95min[39;49;00m kwargs.items():[90m[39;49;00m
                [96mself[39;49;00m[k] = arg[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m [95mnot[39;49;00m trust_input:[90m[39;49;00m
            [90m# Collect aliased inputs among the storage space[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m potential_group [95min[39;49;00m [96mself[39;49;00m._potential_aliased_input_groups:[90m[39;49;00m
                args_share_memory: [96mlist[39;49;00m[[96mlist[39;49;00m[[96mint[39;49;00m]] = [][90m[39;49;00m
                [94mfor[39;49;00m i [95min[39;49;00m potential_group:[90m[39;49;00m
                    i_type = [96mself[39;49;00m.maker.inputs[i].variable.type[90m[39;49;00m
                    i_val = input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
    [90m[39;49;00m
                    [90m# Check if value is aliased with any of the values in one of the groups[39;49;00m[90m[39;49;00m
                    [94mfor[39;49;00m j_group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                        [94mif[39;49;00m [96many[39;49;00m([90m[39;49;00m
                            i_type.may_share_memory(input_storage[j].storage[[94m0[39;49;00m], i_val)[90m[39;49;00m
                            [94mfor[39;49;00m j [95min[39;49;00m j_group[90m[39;49;00m
                        ):[90m[39;49;00m
                            j_group.append(i)[90m[39;49;00m
                            [94mbreak[39;49;00m[90m[39;49;00m
                    [94melse[39;49;00m:  [90m# no break[39;49;00m[90m[39;49;00m
                        [90m# Create a new group[39;49;00m[90m[39;49;00m
                        args_share_memory.append([i])[90m[39;49;00m
    [90m[39;49;00m
                [90m# Check for groups of more than one argument that share memory[39;49;00m[90m[39;49;00m
                [94mfor[39;49;00m group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                    [94mif[39;49;00m [96mlen[39;49;00m(group) > [94m1[39;49;00m:[90m[39;49;00m
                        [90m# copy all but the first[39;49;00m[90m[39;49;00m
                        [94mfor[39;49;00m i [95min[39;49;00m group[[94m1[39;49;00m:]:[90m[39;49;00m
                            input_storage[i].storage[[94m0[39;49;00m] = copy.copy([90m[39;49;00m
                                input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
                            )[90m[39;49;00m
    [90m[39;49;00m
            [90m# Check if inputs are missing, or if inputs were set more than once, or[39;49;00m[90m[39;49;00m
            [90m# if we tried to provide inputs that are supposed to be implicit.[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                [94mif[39;49;00m arg_container.required [95mand[39;49;00m [95mnot[39;49;00m arg_container.provided:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMissing required input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.provided > [94m1[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMultiple values for input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.implicit [95mand[39;49;00m arg_container.provided > [94m0[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mTried to provide value for implicit input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
    [90m[39;49;00m
        [90m# Do the actual work[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0_fn = time.perf_counter()[90m[39;49;00m
        [94mtry[39;49;00m:[90m[39;49;00m
>           outputs = vm() [94mif[39;49;00m output_subset [95mis[39;49;00m [94mNone[39;49;00m [94melse[39;49;00m vm(output_subset=output_subset)[90m[39;49;00m
                      ^^^^[90m[39;49;00m
[1m[31mE           pymc.logprob.utils.ParameterValueError[0m

[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/compile/function/types.py[0m:1038: ParameterValueError

[33mDuring handling of the above exception, another exception occurred:[0m

self = <tests.distributions.test_multivariate.TestMatchesScipy object at 0x7f0bb35c7840>
n = array(10), p = array([[0.2 , 0.3 , 0.5 ],
       [0.9 , 0.09, 0.01]])
extra_size = (2, 3)

    [0m[37m@pytest[39;49;00m.mark.parametrize([33m"[39;49;00m[33mn[39;49;00m[33m"[39;49;00m, [([94m10[39;49;00m), ([[94m10[39;49;00m, [94m11[39;49;00m]), ([[[94m5[39;49;00m, [94m6[39;49;00m], [[94m10[39;49;00m, [94m11[39;49;00m]])])[90m[39;49;00m
    [37m@pytest[39;49;00m.mark.parametrize([90m[39;49;00m
        [33m"[39;49;00m[33mp[39;49;00m[33m"[39;49;00m,[90m[39;49;00m
        [[90m[39;49;00m
            ([[94m0.2[39;49;00m, [94m0.3[39;49;00m, [94m0.5[39;49;00m]),[90m[39;49;00m
            ([[[94m0.2[39;49;00m, [94m0.3[39;49;00m, [94m0.5[39;49;00m], [[94m0.9[39;49;00m, [94m0.09[39;49;00m, [94m0.01[39;49;00m]]),[90m[39;49;00m
            (np.abs(np.random.randn([94m2[39;49;00m, [94m2[39;49;00m, [94m4[39;49;00m))),[90m[39;49;00m
        ],[90m[39;49;00m
    )[90m[39;49;00m
    [37m@pytest[39;49;00m.mark.parametrize([33m"[39;49;00m[33mextra_size[39;49;00m[33m"[39;49;00m, [([94m1[39;49;00m,), ([94m2[39;49;00m,), ([94m2[39;49;00m, [94m3[39;49;00m)])[90m[39;49;00m
    [94mdef[39;49;00m[90m [39;49;00m[92mtest_multinomial_vectorized[39;49;00m([96mself[39;49;00m, n, p, extra_size):[90m[39;49;00m
        n = np.array(n)[90m[39;49;00m
        p = np.array(p)[90m[39;49;00m
        p /= p.sum(axis=-[94m1[39;49;00m, keepdims=[94mTrue[39;49;00m)[90m[39;49;00m
    [90m[39;49;00m
        _, bcast_p = broadcast_params([n, p], ndims_params=[[94m0[39;49;00m, [94m1[39;49;00m])[90m[39;49;00m
        size = extra_size + bcast_p.shape[:-[94m1[39;49;00m][90m[39;49;00m
    [90m[39;49;00m
        mn = pm.Multinomial.dist(n=n, p=p, size=size)[90m[39;49;00m
        vals = mn.eval()[90m[39;49;00m
    [90m[39;49;00m
        npt.assert_almost_equal([90m[39;49;00m
            st.multinomial.logpmf(vals, n, p),[90m[39;49;00m
>           pm.logp(mn, vals).eval(),[90m[39;49;00m
            ^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
            decimal=[94m4[39;49;00m,[90m[39;49;00m
            err_msg=[33mf[39;49;00m[33m"[39;49;00m[33mvals=[39;49;00m[33m{[39;49;00mvals[33m}[39;49;00m[33m"[39;49;00m,[90m[39;49;00m
        )[90m[39;49;00m

[1m[31mtests/distributions/test_multivariate.py[0m:692:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/graph/basic.py[0m:668: in eval
    [0m[94mreturn[39;49;00m fn(*args)[90m[39;49;00m
           ^^^^^^^^^[90m[39;49;00m
[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/compile/function/types.py[0m:1048: in __call__
    [0mraise_with_op([90m[39;49;00m
[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/link/utils.py[0m:526: in raise_with_op
    [0m[94mraise[39;49;00m exc_value.with_traceback(exc_trace)[90m[39;49;00m
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <pytensor.compile.function.types.Function object at 0x7f0b9d5ae0f0>
output_subset = None, args = (), kwargs = {}, trust_input = False
vm = <pytensor.link.c.cvm.CVM object at 0x7f0ba293be30>, profile = None

    [0m[94mdef[39;49;00m[90m [39;49;00m[92m__call__[39;49;00m([96mself[39;49;00m, *args, output_subset=[94mNone[39;49;00m, **kwargs):[90m[39;49;00m
    [90m    [39;49;00m[33m"""[39;49;00m
    [33m    Evaluates value of a function on given arguments.[39;49;00m
    [33m[39;49;00m
    [33m    Parameters[39;49;00m
    [33m    ----------[39;49;00m
    [33m    args : list[39;49;00m
    [33m        List of inputs to the function. All inputs are required, even when[39;49;00m
    [33m        some of them are not necessary to calculate requested subset of[39;49;00m
    [33m        outputs.[39;49;00m
    [33m[39;49;00m
    [33m    kwargs : dict[39;49;00m
    [33m        The function inputs can be passed as keyword argument. For this, use[39;49;00m
    [33m        the name of the input or the input instance as the key.[39;49;00m
    [33m[39;49;00m
    [33m        Keyword argument ``output_subset`` is a list of either indices of the[39;49;00m
    [33m        function's outputs or the keys belonging to the `output_keys` dict[39;49;00m
    [33m        and represent outputs that are requested to be calculated. Regardless[39;49;00m
    [33m        of the presence of ``output_subset``, the updates are always calculated[39;49;00m
    [33m        and processed. To disable the updates, you should use the ``copy``[39;49;00m
    [33m        method with ``delete_updates=True``.[39;49;00m
    [33m[39;49;00m
    [33m    Returns[39;49;00m
    [33m    -------[39;49;00m
    [33m    list[39;49;00m
    [33m        List of outputs on indices/keys from ``output_subset`` or all of them,[39;49;00m
    [33m        if ``output_subset`` is not passed.[39;49;00m
    [33m    """[39;49;00m[90m[39;49;00m
        trust_input = [96mself[39;49;00m.trust_input[90m[39;49;00m
        input_storage = [96mself[39;49;00m.input_storage[90m[39;49;00m
        vm = [96mself[39;49;00m.vm[90m[39;49;00m
        profile = [96mself[39;49;00m.profile[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0 = time.perf_counter()[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m output_subset [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
            warnings.warn([33m"[39;49;00m[33moutput_subset is deprecated.[39;49;00m[33m"[39;49;00m, [96mFutureWarning[39;49;00m)[90m[39;49;00m
            [94mif[39;49;00m [96mself[39;49;00m.output_keys [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                output_subset = [[96mself[39;49;00m.output_keys.index(key) [94mfor[39;49;00m key [95min[39;49;00m output_subset][90m[39;49;00m
    [90m[39;49;00m
        [90m# Reinitialize each container's 'provided' counter[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m trust_input:[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
        [94melse[39;49;00m:[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                arg_container.provided = [94m0[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
            [94mif[39;49;00m [96mlen[39;49;00m(args) + [96mlen[39;49;00m(kwargs) > [96mlen[39;49;00m(input_storage):[90m[39;49;00m
                [94mraise[39;49;00m [96mTypeError[39;49;00m([33m"[39;49;00m[33mToo many parameter passed to pytensor function[39;49;00m[33m"[39;49;00m)[90m[39;49;00m
    [90m[39;49;00m
            [90m# Set positional arguments[39;49;00m[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                [90m# See discussion about None as input[39;49;00m[90m[39;49;00m
                [90m# https://groups.google.com/group/theano-dev/browse_thread/thread/920a5e904e8a8525/4f1b311a28fc27e5[39;49;00m[90m[39;49;00m
                [94mif[39;49;00m arg [95mis[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                    arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
                [94melse[39;49;00m:[90m[39;49;00m
                    [94mtry[39;49;00m:[90m[39;49;00m
                        arg_container.storage[[94m0[39;49;00m] = arg_container.type.filter([90m[39;49;00m
                            arg,[90m[39;49;00m
                            strict=arg_container.strict,[90m[39;49;00m
                            allow_downcast=arg_container.allow_downcast,[90m[39;49;00m
                        )[90m[39;49;00m
    [90m[39;49;00m
                    [94mexcept[39;49;00m [96mException[39;49;00m [94mas[39;49;00m e:[90m[39;49;00m
                        i = input_storage.index(arg_container)[90m[39;49;00m
                        function_name = [33m"[39;49;00m[33mpytensor function[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        argument_name = [33m"[39;49;00m[33margument[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mself[39;49;00m.name:[90m[39;49;00m
                            function_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + [96mself[39;49;00m.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mhasattr[39;49;00m(arg, [33m"[39;49;00m[33mname[39;49;00m[33m"[39;49;00m) [95mand[39;49;00m arg.name:[90m[39;49;00m
                            argument_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + arg.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        where = get_variable_trace_string([96mself[39;49;00m.maker.inputs[i].variable)[90m[39;49;00m
                        [94mif[39;49;00m [96mlen[39;49;00m(e.args) == [94m1[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + e.args[[94m0[39;49;00m],[90m[39;49;00m
                            )[90m[39;49;00m
                        [94melse[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                            ) + e.args[90m[39;49;00m
                        [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                        [94mraise[39;49;00m[90m[39;49;00m
                arg_container.provided += [94m1[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
        [90m# Set keyword arguments[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m kwargs:  [90m# for speed, skip the items for empty kwargs[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m k, arg [95min[39;49;00m kwargs.items():[90m[39;49;00m
                [96mself[39;49;00m[k] = arg[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m [95mnot[39;49;00m trust_input:[90m[39;49;00m
            [90m# Collect aliased inputs among the storage space[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m potential_group [95min[39;49;00m [96mself[39;49;00m._potential_aliased_input_groups:[90m[39;49;00m
                args_share_memory: [96mlist[39;49;00m[[96mlist[39;49;00m[[96mint[39;49;00m]] = [][90m[39;49;00m
                [94mfor[39;49;00m i [95min[39;49;00m potential_group:[90m[39;49;00m
                    i_type = [96mself[39;49;00m.maker.inputs[i].variable.type[90m[39;49;00m
                    i_val = input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
    [90m[39;49;00m
                    [90m# Check if value is aliased with any of the values in one of the groups[39;49;00m[90m[39;49;00m
                    [94mfor[39;49;00m j_group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                        [94mif[39;49;00m [96many[39;49;00m([90m[39;49;00m
                            i_type.may_share_memory(input_storage[j].storage[[94m0[39;49;00m], i_val)[90m[39;49;00m
                            [94mfor[39;49;00m j [95min[39;49;00m j_group[90m[39;49;00m
                        ):[90m[39;49;00m
                            j_group.append(i)[90m[39;49;00m
                            [94mbreak[39;49;00m[90m[39;49;00m
                    [94melse[39;49;00m:  [90m# no break[39;49;00m[90m[39;49;00m
                        [90m# Create a new group[39;49;00m[90m[39;49;00m
                        args_share_memory.append([i])[90m[39;49;00m
    [90m[39;49;00m
                [90m# Check for groups of more than one argument that share memory[39;49;00m[90m[39;49;00m
                [94mfor[39;49;00m group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                    [94mif[39;49;00m [96mlen[39;49;00m(group) > [94m1[39;49;00m:[90m[39;49;00m
                        [90m# copy all but the first[39;49;00m[90m[39;49;00m
                        [94mfor[39;49;00m i [95min[39;49;00m group[[94m1[39;49;00m:]:[90m[39;49;00m
                            input_storage[i].storage[[94m0[39;49;00m] = copy.copy([90m[39;49;00m
                                input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
                            )[90m[39;49;00m
    [90m[39;49;00m
            [90m# Check if inputs are missing, or if inputs were set more than once, or[39;49;00m[90m[39;49;00m
            [90m# if we tried to provide inputs that are supposed to be implicit.[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                [94mif[39;49;00m arg_container.required [95mand[39;49;00m [95mnot[39;49;00m arg_container.provided:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMissing required input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.provided > [94m1[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMultiple values for input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.implicit [95mand[39;49;00m arg_container.provided > [94m0[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mTried to provide value for implicit input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
    [90m[39;49;00m
        [90m# Do the actual work[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0_fn = time.perf_counter()[90m[39;49;00m
        [94mtry[39;49;00m:[90m[39;49;00m
>           outputs = vm() [94mif[39;49;00m output_subset [95mis[39;49;00m [94mNone[39;49;00m [94melse[39;49;00m vm(output_subset=output_subset)[90m[39;49;00m
                      ^^^^[90m[39;49;00m
[1m[31mE           pymc.logprob.utils.ParameterValueError: [0m
[1m[31mE           Apply node that caused the error: Check{}([[[-198.08501146]]], False)[0m
[1m[31mE           Toposort index: 0[0m
[1m[31mE           Inputs types: [TensorType(float64, shape=(1, 1, 1)), ScalarType(bool)][0m
[1m[31mE           Inputs shapes: [(1, 1, 1), ()][0m
[1m[31mE           Inputs strides: [(8, 8, 8), ()][0m
[1m[31mE           Inputs values: [array([[[-198.08501146]]]), np.False_][0m
[1m[31mE           Inputs type_num: [12, 0][0m
[1m[31mE           Outputs clients: [[DeepCopyOp(Check{}.0)]][0m
[1m[31mE           [0m
[1m[31mE           Backtrace when the node is created (use PyTensor flag traceback__limit=N to make it longer):[0m
[1m[31mE             File "/app/pymc/logprob/basic.py", line 193, in logp[0m
[1m[31mE               return _logprob_helper(rv, value, **kwargs)[0m
[1m[31mE             File "/app/pymc/logprob/abstract.py", line 70, in _logprob_helper[0m
[1m[31mE               logprob = _logprob(rv.owner.op, values, *rv.owner.inputs, **kwargs)[0m
[1m[31mE             File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/functools.py", line 982, in wrapper[0m
[1m[31mE               return dispatch(args[0].__class__)(*args, **kw)[0m
[1m[31mE             File "/app/pymc/distributions/distribution.py", line 140, in logp[0m
[1m[31mE               return class_logp(value, *dist_params)[0m
[1m[31mE             File "/app/tests/distributions/test_dist_math.py", line 96, in logp[0m
[1m[31mE               return check_parameters([0m
[1m[31mE             File "/app/pymc/distributions/dist_math.py", line 72, in check_parameters[0m
[1m[31mE               return CheckParameterValue(msg, can_be_replaced_by_ninf)(expr, all_true_scalar)[0m
[1m[31mE             File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/graph/op.py", line 294, in __call__[0m
[1m[31mE               node = self.make_node(*inputs, **kwargs)[0m
[1m[31mE             File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/raise_op.py", line 81, in make_node[0m
[1m[31mE               [value.type()],[0m
[1m[31mE           [0m
[1m[31mE           Debug print of the apply node: [0m
[1m[31mE           Check{} [id A] <Tensor3(float64, shape=(1, 1, 1))>[0m
[1m[31mE            ├─ [[[-198.08501146]]] [id B] <Tensor3(float64, shape=(1, 1, 1))>[0m
[1m[31mE            └─ False [id C] <bool>[0m
[1m[31mE           [0m
[1m[31mE           Storage map footprint:[0m
[1m[31mE            - [[[-198.08501146]]], Shape: (1, 1, 1), ElemSize: 8 Byte(s), TotalSize: 8 Byte(s)[0m
[1m[31mE            - False, Shape: (), ElemSize: 1 Byte(s), TotalSize: 1.0 Byte(s)[0m
[1m[31mE            TotalSize: 9.0 Byte(s) 0.000 GB[0m
[1m[31mE            TotalSize inputs: 9.0 Byte(s) 0.000 GB[0m

[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/compile/function/types.py[0m:1038: ParameterValueError
[31m[1m_______ TestMatchesScipy.test_multinomial_vectorized[extra_size2-p1-n1] ________[0m

self = <pytensor.compile.function.types.Function object at 0x7f0ba250ee70>
output_subset = None, args = (), kwargs = {}, trust_input = False
vm = <pytensor.link.c.cvm.CVM object at 0x7f0ba2939a70>, profile = None

    [0m[94mdef[39;49;00m[90m [39;49;00m[92m__call__[39;49;00m([96mself[39;49;00m, *args, output_subset=[94mNone[39;49;00m, **kwargs):[90m[39;49;00m
    [90m    [39;49;00m[33m"""[39;49;00m
    [33m    Evaluates value of a function on given arguments.[39;49;00m
    [33m[39;49;00m
    [33m    Parameters[39;49;00m
    [33m    ----------[39;49;00m
    [33m    args : list[39;49;00m
    [33m        List of inputs to the function. All inputs are required, even when[39;49;00m
    [33m        some of them are not necessary to calculate requested subset of[39;49;00m
    [33m        outputs.[39;49;00m
    [33m[39;49;00m
    [33m    kwargs : dict[39;49;00m
    [33m        The function inputs can be passed as keyword argument. For this, use[39;49;00m
    [33m        the name of the input or the input instance as the key.[39;49;00m
    [33m[39;49;00m
    [33m        Keyword argument ``output_subset`` is a list of either indices of the[39;49;00m
    [33m        function's outputs or the keys belonging to the `output_keys` dict[39;49;00m
    [33m        and represent outputs that are requested to be calculated. Regardless[39;49;00m
    [33m        of the presence of ``output_subset``, the updates are always calculated[39;49;00m
    [33m        and processed. To disable the updates, you should use the ``copy``[39;49;00m
    [33m        method with ``delete_updates=True``.[39;49;00m
    [33m[39;49;00m
    [33m    Returns[39;49;00m
    [33m    -------[39;49;00m
    [33m    list[39;49;00m
    [33m        List of outputs on indices/keys from ``output_subset`` or all of them,[39;49;00m
    [33m        if ``output_subset`` is not passed.[39;49;00m
    [33m    """[39;49;00m[90m[39;49;00m
        trust_input = [96mself[39;49;00m.trust_input[90m[39;49;00m
        input_storage = [96mself[39;49;00m.input_storage[90m[39;49;00m
        vm = [96mself[39;49;00m.vm[90m[39;49;00m
        profile = [96mself[39;49;00m.profile[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0 = time.perf_counter()[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m output_subset [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
            warnings.warn([33m"[39;49;00m[33moutput_subset is deprecated.[39;49;00m[33m"[39;49;00m, [96mFutureWarning[39;49;00m)[90m[39;49;00m
            [94mif[39;49;00m [96mself[39;49;00m.output_keys [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                output_subset = [[96mself[39;49;00m.output_keys.index(key) [94mfor[39;49;00m key [95min[39;49;00m output_subset][90m[39;49;00m
    [90m[39;49;00m
        [90m# Reinitialize each container's 'provided' counter[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m trust_input:[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
        [94melse[39;49;00m:[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                arg_container.provided = [94m0[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
            [94mif[39;49;00m [96mlen[39;49;00m(args) + [96mlen[39;49;00m(kwargs) > [96mlen[39;49;00m(input_storage):[90m[39;49;00m
                [94mraise[39;49;00m [96mTypeError[39;49;00m([33m"[39;49;00m[33mToo many parameter passed to pytensor function[39;49;00m[33m"[39;49;00m)[90m[39;49;00m
    [90m[39;49;00m
            [90m# Set positional arguments[39;49;00m[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                [90m# See discussion about None as input[39;49;00m[90m[39;49;00m
                [90m# https://groups.google.com/group/theano-dev/browse_thread/thread/920a5e904e8a8525/4f1b311a28fc27e5[39;49;00m[90m[39;49;00m
                [94mif[39;49;00m arg [95mis[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                    arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
                [94melse[39;49;00m:[90m[39;49;00m
                    [94mtry[39;49;00m:[90m[39;49;00m
                        arg_container.storage[[94m0[39;49;00m] = arg_container.type.filter([90m[39;49;00m
                            arg,[90m[39;49;00m
                            strict=arg_container.strict,[90m[39;49;00m
                            allow_downcast=arg_container.allow_downcast,[90m[39;49;00m
                        )[90m[39;49;00m
    [90m[39;49;00m
                    [94mexcept[39;49;00m [96mException[39;49;00m [94mas[39;49;00m e:[90m[39;49;00m
                        i = input_storage.index(arg_container)[90m[39;49;00m
                        function_name = [33m"[39;49;00m[33mpytensor function[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        argument_name = [33m"[39;49;00m[33margument[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mself[39;49;00m.name:[90m[39;49;00m
                            function_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + [96mself[39;49;00m.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mhasattr[39;49;00m(arg, [33m"[39;49;00m[33mname[39;49;00m[33m"[39;49;00m) [95mand[39;49;00m arg.name:[90m[39;49;00m
                            argument_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + arg.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        where = get_variable_trace_string([96mself[39;49;00m.maker.inputs[i].variable)[90m[39;49;00m
                        [94mif[39;49;00m [96mlen[39;49;00m(e.args) == [94m1[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + e.args[[94m0[39;49;00m],[90m[39;49;00m
                            )[90m[39;49;00m
                        [94melse[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                            ) + e.args[90m[39;49;00m
                        [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                        [94mraise[39;49;00m[90m[39;49;00m
                arg_container.provided += [94m1[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
        [90m# Set keyword arguments[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m kwargs:  [90m# for speed, skip the items for empty kwargs[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m k, arg [95min[39;49;00m kwargs.items():[90m[39;49;00m
                [96mself[39;49;00m[k] = arg[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m [95mnot[39;49;00m trust_input:[90m[39;49;00m
            [90m# Collect aliased inputs among the storage space[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m potential_group [95min[39;49;00m [96mself[39;49;00m._potential_aliased_input_groups:[90m[39;49;00m
                args_share_memory: [96mlist[39;49;00m[[96mlist[39;49;00m[[96mint[39;49;00m]] = [][90m[39;49;00m
                [94mfor[39;49;00m i [95min[39;49;00m potential_group:[90m[39;49;00m
                    i_type = [96mself[39;49;00m.maker.inputs[i].variable.type[90m[39;49;00m
                    i_val = input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
    [90m[39;49;00m
                    [90m# Check if value is aliased with any of the values in one of the groups[39;49;00m[90m[39;49;00m
                    [94mfor[39;49;00m j_group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                        [94mif[39;49;00m [96many[39;49;00m([90m[39;49;00m
                            i_type.may_share_memory(input_storage[j].storage[[94m0[39;49;00m], i_val)[90m[39;49;00m
                            [94mfor[39;49;00m j [95min[39;49;00m j_group[90m[39;49;00m
                        ):[90m[39;49;00m
                            j_group.append(i)[90m[39;49;00m
                            [94mbreak[39;49;00m[90m[39;49;00m
                    [94melse[39;49;00m:  [90m# no break[39;49;00m[90m[39;49;00m
                        [90m# Create a new group[39;49;00m[90m[39;49;00m
                        args_share_memory.append([i])[90m[39;49;00m
    [90m[39;49;00m
                [90m# Check for groups of more than one argument that share memory[39;49;00m[90m[39;49;00m
                [94mfor[39;49;00m group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                    [94mif[39;49;00m [96mlen[39;49;00m(group) > [94m1[39;49;00m:[90m[39;49;00m
                        [90m# copy all but the first[39;49;00m[90m[39;49;00m
                        [94mfor[39;49;00m i [95min[39;49;00m group[[94m1[39;49;00m:]:[90m[39;49;00m
                            input_storage[i].storage[[94m0[39;49;00m] = copy.copy([90m[39;49;00m
                                input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
                            )[90m[39;49;00m
    [90m[39;49;00m
            [90m# Check if inputs are missing, or if inputs were set more than once, or[39;49;00m[90m[39;49;00m
            [90m# if we tried to provide inputs that are supposed to be implicit.[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                [94mif[39;49;00m arg_container.required [95mand[39;49;00m [95mnot[39;49;00m arg_container.provided:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMissing required input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.provided > [94m1[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMultiple values for input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.implicit [95mand[39;49;00m arg_container.provided > [94m0[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mTried to provide value for implicit input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
    [90m[39;49;00m
        [90m# Do the actual work[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0_fn = time.perf_counter()[90m[39;49;00m
        [94mtry[39;49;00m:[90m[39;49;00m
>           outputs = vm() [94mif[39;49;00m output_subset [95mis[39;49;00m [94mNone[39;49;00m [94melse[39;49;00m vm(output_subset=output_subset)[90m[39;49;00m
                      ^^^^[90m[39;49;00m
[1m[31mE           pymc.logprob.utils.ParameterValueError[0m

[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/compile/function/types.py[0m:1038: ParameterValueError

[33mDuring handling of the above exception, another exception occurred:[0m

self = <tests.distributions.test_multivariate.TestMatchesScipy object at 0x7f0bb35c7890>
n = array([10, 11]), p = array([[0.2 , 0.3 , 0.5 ],
       [0.9 , 0.09, 0.01]])
extra_size = (2, 3)

    [0m[37m@pytest[39;49;00m.mark.parametrize([33m"[39;49;00m[33mn[39;49;00m[33m"[39;49;00m, [([94m10[39;49;00m), ([[94m10[39;49;00m, [94m11[39;49;00m]), ([[[94m5[39;49;00m, [94m6[39;49;00m], [[94m10[39;49;00m, [94m11[39;49;00m]])])[90m[39;49;00m
    [37m@pytest[39;49;00m.mark.parametrize([90m[39;49;00m
        [33m"[39;49;00m[33mp[39;49;00m[33m"[39;49;00m,[90m[39;49;00m
        [[90m[39;49;00m
            ([[94m0.2[39;49;00m, [94m0.3[39;49;00m, [94m0.5[39;49;00m]),[90m[39;49;00m
            ([[[94m0.2[39;49;00m, [94m0.3[39;49;00m, [94m0.5[39;49;00m], [[94m0.9[39;49;00m, [94m0.09[39;49;00m, [94m0.01[39;49;00m]]),[90m[39;49;00m
            (np.abs(np.random.randn([94m2[39;49;00m, [94m2[39;49;00m, [94m4[39;49;00m))),[90m[39;49;00m
        ],[90m[39;49;00m
    )[90m[39;49;00m
    [37m@pytest[39;49;00m.mark.parametrize([33m"[39;49;00m[33mextra_size[39;49;00m[33m"[39;49;00m, [([94m1[39;49;00m,), ([94m2[39;49;00m,), ([94m2[39;49;00m, [94m3[39;49;00m)])[90m[39;49;00m
    [94mdef[39;49;00m[90m [39;49;00m[92mtest_multinomial_vectorized[39;49;00m([96mself[39;49;00m, n, p, extra_size):[90m[39;49;00m
        n = np.array(n)[90m[39;49;00m
        p = np.array(p)[90m[39;49;00m
        p /= p.sum(axis=-[94m1[39;49;00m, keepdims=[94mTrue[39;49;00m)[90m[39;49;00m
    [90m[39;49;00m
        _, bcast_p = broadcast_params([n, p], ndims_params=[[94m0[39;49;00m, [94m1[39;49;00m])[90m[39;49;00m
        size = extra_size + bcast_p.shape[:-[94m1[39;49;00m][90m[39;49;00m
    [90m[39;49;00m
        mn = pm.Multinomial.dist(n=n, p=p, size=size)[90m[39;49;00m
        vals = mn.eval()[90m[39;49;00m
    [90m[39;49;00m
        npt.assert_almost_equal([90m[39;49;00m
            st.multinomial.logpmf(vals, n, p),[90m[39;49;00m
>           pm.logp(mn, vals).eval(),[90m[39;49;00m
            ^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
            decimal=[94m4[39;49;00m,[90m[39;49;00m
            err_msg=[33mf[39;49;00m[33m"[39;49;00m[33mvals=[39;49;00m[33m{[39;49;00mvals[33m}[39;49;00m[33m"[39;49;00m,[90m[39;49;00m
        )[90m[39;49;00m

[1m[31mtests/distributions/test_multivariate.py[0m:692:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/graph/basic.py[0m:668: in eval
    [0m[94mreturn[39;49;00m fn(*args)[90m[39;49;00m
           ^^^^^^^^^[90m[39;49;00m
[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/compile/function/types.py[0m:1048: in __call__
    [0mraise_with_op([90m[39;49;00m
[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/link/utils.py[0m:526: in raise_with_op
    [0m[94mraise[39;49;00m exc_value.with_traceback(exc_trace)[90m[39;49;00m
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <pytensor.compile.function.types.Function object at 0x7f0ba250ee70>
output_subset = None, args = (), kwargs = {}, trust_input = False
vm = <pytensor.link.c.cvm.CVM object at 0x7f0ba2939a70>, profile = None

    [0m[94mdef[39;49;00m[90m [39;49;00m[92m__call__[39;49;00m([96mself[39;49;00m, *args, output_subset=[94mNone[39;49;00m, **kwargs):[90m[39;49;00m
    [90m    [39;49;00m[33m"""[39;49;00m
    [33m    Evaluates value of a function on given arguments.[39;49;00m
    [33m[39;49;00m
    [33m    Parameters[39;49;00m
    [33m    ----------[39;49;00m
    [33m    args : list[39;49;00m
    [33m        List of inputs to the function. All inputs are required, even when[39;49;00m
    [33m        some of them are not necessary to calculate requested subset of[39;49;00m
    [33m        outputs.[39;49;00m
    [33m[39;49;00m
    [33m    kwargs : dict[39;49;00m
    [33m        The function inputs can be passed as keyword argument. For this, use[39;49;00m
    [33m        the name of the input or the input instance as the key.[39;49;00m
    [33m[39;49;00m
    [33m        Keyword argument ``output_subset`` is a list of either indices of the[39;49;00m
    [33m        function's outputs or the keys belonging to the `output_keys` dict[39;49;00m
    [33m        and represent outputs that are requested to be calculated. Regardless[39;49;00m
    [33m        of the presence of ``output_subset``, the updates are always calculated[39;49;00m
    [33m        and processed. To disable the updates, you should use the ``copy``[39;49;00m
    [33m        method with ``delete_updates=True``.[39;49;00m
    [33m[39;49;00m
    [33m    Returns[39;49;00m
    [33m    -------[39;49;00m
    [33m    list[39;49;00m
    [33m        List of outputs on indices/keys from ``output_subset`` or all of them,[39;49;00m
    [33m        if ``output_subset`` is not passed.[39;49;00m
    [33m    """[39;49;00m[90m[39;49;00m
        trust_input = [96mself[39;49;00m.trust_input[90m[39;49;00m
        input_storage = [96mself[39;49;00m.input_storage[90m[39;49;00m
        vm = [96mself[39;49;00m.vm[90m[39;49;00m
        profile = [96mself[39;49;00m.profile[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0 = time.perf_counter()[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m output_subset [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
            warnings.warn([33m"[39;49;00m[33moutput_subset is deprecated.[39;49;00m[33m"[39;49;00m, [96mFutureWarning[39;49;00m)[90m[39;49;00m
            [94mif[39;49;00m [96mself[39;49;00m.output_keys [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                output_subset = [[96mself[39;49;00m.output_keys.index(key) [94mfor[39;49;00m key [95min[39;49;00m output_subset][90m[39;49;00m
    [90m[39;49;00m
        [90m# Reinitialize each container's 'provided' counter[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m trust_input:[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
        [94melse[39;49;00m:[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                arg_container.provided = [94m0[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
            [94mif[39;49;00m [96mlen[39;49;00m(args) + [96mlen[39;49;00m(kwargs) > [96mlen[39;49;00m(input_storage):[90m[39;49;00m
                [94mraise[39;49;00m [96mTypeError[39;49;00m([33m"[39;49;00m[33mToo many parameter passed to pytensor function[39;49;00m[33m"[39;49;00m)[90m[39;49;00m
    [90m[39;49;00m
            [90m# Set positional arguments[39;49;00m[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                [90m# See discussion about None as input[39;49;00m[90m[39;49;00m
                [90m# https://groups.google.com/group/theano-dev/browse_thread/thread/920a5e904e8a8525/4f1b311a28fc27e5[39;49;00m[90m[39;49;00m
                [94mif[39;49;00m arg [95mis[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                    arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
                [94melse[39;49;00m:[90m[39;49;00m
                    [94mtry[39;49;00m:[90m[39;49;00m
                        arg_container.storage[[94m0[39;49;00m] = arg_container.type.filter([90m[39;49;00m
                            arg,[90m[39;49;00m
                            strict=arg_container.strict,[90m[39;49;00m
                            allow_downcast=arg_container.allow_downcast,[90m[39;49;00m
                        )[90m[39;49;00m
    [90m[39;49;00m
                    [94mexcept[39;49;00m [96mException[39;49;00m [94mas[39;49;00m e:[90m[39;49;00m
                        i = input_storage.index(arg_container)[90m[39;49;00m
                        function_name = [33m"[39;49;00m[33mpytensor function[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        argument_name = [33m"[39;49;00m[33margument[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mself[39;49;00m.name:[90m[39;49;00m
                            function_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + [96mself[39;49;00m.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mhasattr[39;49;00m(arg, [33m"[39;49;00m[33mname[39;49;00m[33m"[39;49;00m) [95mand[39;49;00m arg.name:[90m[39;49;00m
                            argument_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + arg.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        where = get_variable_trace_string([96mself[39;49;00m.maker.inputs[i].variable)[90m[39;49;00m
                        [94mif[39;49;00m [96mlen[39;49;00m(e.args) == [94m1[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + e.args[[94m0[39;49;00m],[90m[39;49;00m
                            )[90m[39;49;00m
                        [94melse[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                            ) + e.args[90m[39;49;00m
                        [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                        [94mraise[39;49;00m[90m[39;49;00m
                arg_container.provided += [94m1[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
        [90m# Set keyword arguments[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m kwargs:  [90m# for speed, skip the items for empty kwargs[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m k, arg [95min[39;49;00m kwargs.items():[90m[39;49;00m
                [96mself[39;49;00m[k] = arg[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m [95mnot[39;49;00m trust_input:[90m[39;49;00m
            [90m# Collect aliased inputs among the storage space[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m potential_group [95min[39;49;00m [96mself[39;49;00m._potential_aliased_input_groups:[90m[39;49;00m
                args_share_memory: [96mlist[39;49;00m[[96mlist[39;49;00m[[96mint[39;49;00m]] = [][90m[39;49;00m
                [94mfor[39;49;00m i [95min[39;49;00m potential_group:[90m[39;49;00m
                    i_type = [96mself[39;49;00m.maker.inputs[i].variable.type[90m[39;49;00m
                    i_val = input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
    [90m[39;49;00m
                    [90m# Check if value is aliased with any of the values in one of the groups[39;49;00m[90m[39;49;00m
                    [94mfor[39;49;00m j_group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                        [94mif[39;49;00m [96many[39;49;00m([90m[39;49;00m
                            i_type.may_share_memory(input_storage[j].storage[[94m0[39;49;00m], i_val)[90m[39;49;00m
                            [94mfor[39;49;00m j [95min[39;49;00m j_group[90m[39;49;00m
                        ):[90m[39;49;00m
                            j_group.append(i)[90m[39;49;00m
                            [94mbreak[39;49;00m[90m[39;49;00m
                    [94melse[39;49;00m:  [90m# no break[39;49;00m[90m[39;49;00m
                        [90m# Create a new group[39;49;00m[90m[39;49;00m
                        args_share_memory.append([i])[90m[39;49;00m
    [90m[39;49;00m
                [90m# Check for groups of more than one argument that share memory[39;49;00m[90m[39;49;00m
                [94mfor[39;49;00m group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                    [94mif[39;49;00m [96mlen[39;49;00m(group) > [94m1[39;49;00m:[90m[39;49;00m
                        [90m# copy all but the first[39;49;00m[90m[39;49;00m
                        [94mfor[39;49;00m i [95min[39;49;00m group[[94m1[39;49;00m:]:[90m[39;49;00m
                            input_storage[i].storage[[94m0[39;49;00m] = copy.copy([90m[39;49;00m
                                input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
                            )[90m[39;49;00m
    [90m[39;49;00m
            [90m# Check if inputs are missing, or if inputs were set more than once, or[39;49;00m[90m[39;49;00m
            [90m# if we tried to provide inputs that are supposed to be implicit.[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                [94mif[39;49;00m arg_container.required [95mand[39;49;00m [95mnot[39;49;00m arg_container.provided:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMissing required input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.provided > [94m1[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMultiple values for input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.implicit [95mand[39;49;00m arg_container.provided > [94m0[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mTried to provide value for implicit input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
    [90m[39;49;00m
        [90m# Do the actual work[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0_fn = time.perf_counter()[90m[39;49;00m
        [94mtry[39;49;00m:[90m[39;49;00m
>           outputs = vm() [94mif[39;49;00m output_subset [95mis[39;49;00m [94mNone[39;49;00m [94melse[39;49;00m vm(output_subset=output_subset)[90m[39;49;00m
                      ^^^^[90m[39;49;00m
[1m[31mE           pymc.logprob.utils.ParameterValueError: [0m
[1m[31mE           Apply node that caused the error: Check{}([[[-220.70 ... 1082784]]], False)[0m
[1m[31mE           Toposort index: 0[0m
[1m[31mE           Inputs types: [TensorType(float64, shape=(1, 1, 2)), ScalarType(bool)][0m
[1m[31mE           Inputs shapes: [(1, 1, 2), ()][0m
[1m[31mE           Inputs strides: [(16, 16, 8), ()][0m
[1m[31mE           Inputs values: [array([[[-220.70872312, -218.31082784]]]), np.False_][0m
[1m[31mE           Inputs type_num: [12, 0][0m
[1m[31mE           Outputs clients: [[DeepCopyOp(Check{}.0)]][0m
[1m[31mE           [0m
[1m[31mE           Backtrace when the node is created (use PyTensor flag traceback__limit=N to make it longer):[0m
[1m[31mE             File "/app/pymc/logprob/basic.py", line 193, in logp[0m
[1m[31mE               return _logprob_helper(rv, value, **kwargs)[0m
[1m[31mE             File "/app/pymc/logprob/abstract.py", line 70, in _logprob_helper[0m
[1m[31mE               logprob = _logprob(rv.owner.op, values, *rv.owner.inputs, **kwargs)[0m
[1m[31mE             File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/functools.py", line 982, in wrapper[0m
[1m[31mE               return dispatch(args[0].__class__)(*args, **kw)[0m
[1m[31mE             File "/app/pymc/distributions/distribution.py", line 140, in logp[0m
[1m[31mE               return class_logp(value, *dist_params)[0m
[1m[31mE             File "/app/tests/distributions/test_dist_math.py", line 96, in logp[0m
[1m[31mE               return check_parameters([0m
[1m[31mE             File "/app/pymc/distributions/dist_math.py", line 72, in check_parameters[0m
[1m[31mE               return CheckParameterValue(msg, can_be_replaced_by_ninf)(expr, all_true_scalar)[0m
[1m[31mE             File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/graph/op.py", line 294, in __call__[0m
[1m[31mE               node = self.make_node(*inputs, **kwargs)[0m
[1m[31mE             File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/raise_op.py", line 81, in make_node[0m
[1m[31mE               [value.type()],[0m
[1m[31mE           [0m
[1m[31mE           Debug print of the apply node: [0m
[1m[31mE           Check{} [id A] <Tensor3(float64, shape=(1, 1, 2))>[0m
[1m[31mE            ├─ [[[-220.70 ... 1082784]]] [id B] <Tensor3(float64, shape=(1, 1, 2))>[0m
[1m[31mE            └─ False [id C] <bool>[0m
[1m[31mE           [0m
[1m[31mE           Storage map footprint:[0m
[1m[31mE            - [[[-220.70 ... 1082784]]], Shape: (1, 1, 2), ElemSize: 8 Byte(s), TotalSize: 16 Byte(s)[0m
[1m[31mE            - False, Shape: (), ElemSize: 1 Byte(s), TotalSize: 1.0 Byte(s)[0m
[1m[31mE            TotalSize: 17.0 Byte(s) 0.000 GB[0m
[1m[31mE            TotalSize inputs: 17.0 Byte(s) 0.000 GB[0m

[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/compile/function/types.py[0m:1038: ParameterValueError
[31m[1m_______ TestMatchesScipy.test_multinomial_vectorized[extra_size2-p1-n2] ________[0m

self = <pytensor.compile.function.types.Function object at 0x7f0b9aff2450>
output_subset = None, args = (), kwargs = {}, trust_input = False
vm = <pytensor.link.c.cvm.CVM object at 0x7f0ba2939ff0>, profile = None

    [0m[94mdef[39;49;00m[90m [39;49;00m[92m__call__[39;49;00m([96mself[39;49;00m, *args, output_subset=[94mNone[39;49;00m, **kwargs):[90m[39;49;00m
    [90m    [39;49;00m[33m"""[39;49;00m
    [33m    Evaluates value of a function on given arguments.[39;49;00m
    [33m[39;49;00m
    [33m    Parameters[39;49;00m
    [33m    ----------[39;49;00m
    [33m    args : list[39;49;00m
    [33m        List of inputs to the function. All inputs are required, even when[39;49;00m
    [33m        some of them are not necessary to calculate requested subset of[39;49;00m
    [33m        outputs.[39;49;00m
    [33m[39;49;00m
    [33m    kwargs : dict[39;49;00m
    [33m        The function inputs can be passed as keyword argument. For this, use[39;49;00m
    [33m        the name of the input or the input instance as the key.[39;49;00m
    [33m[39;49;00m
    [33m        Keyword argument ``output_subset`` is a list of either indices of the[39;49;00m
    [33m        function's outputs or the keys belonging to the `output_keys` dict[39;49;00m
    [33m        and represent outputs that are requested to be calculated. Regardless[39;49;00m
    [33m        of the presence of ``output_subset``, the updates are always calculated[39;49;00m
    [33m        and processed. To disable the updates, you should use the ``copy``[39;49;00m
    [33m        method with ``delete_updates=True``.[39;49;00m
    [33m[39;49;00m
    [33m    Returns[39;49;00m
    [33m    -------[39;49;00m
    [33m    list[39;49;00m
    [33m        List of outputs on indices/keys from ``output_subset`` or all of them,[39;49;00m
    [33m        if ``output_subset`` is not passed.[39;49;00m
    [33m    """[39;49;00m[90m[39;49;00m
        trust_input = [96mself[39;49;00m.trust_input[90m[39;49;00m
        input_storage = [96mself[39;49;00m.input_storage[90m[39;49;00m
        vm = [96mself[39;49;00m.vm[90m[39;49;00m
        profile = [96mself[39;49;00m.profile[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0 = time.perf_counter()[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m output_subset [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
            warnings.warn([33m"[39;49;00m[33moutput_subset is deprecated.[39;49;00m[33m"[39;49;00m, [96mFutureWarning[39;49;00m)[90m[39;49;00m
            [94mif[39;49;00m [96mself[39;49;00m.output_keys [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                output_subset = [[96mself[39;49;00m.output_keys.index(key) [94mfor[39;49;00m key [95min[39;49;00m output_subset][90m[39;49;00m
    [90m[39;49;00m
        [90m# Reinitialize each container's 'provided' counter[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m trust_input:[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
        [94melse[39;49;00m:[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                arg_container.provided = [94m0[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
            [94mif[39;49;00m [96mlen[39;49;00m(args) + [96mlen[39;49;00m(kwargs) > [96mlen[39;49;00m(input_storage):[90m[39;49;00m
                [94mraise[39;49;00m [96mTypeError[39;49;00m([33m"[39;49;00m[33mToo many parameter passed to pytensor function[39;49;00m[33m"[39;49;00m)[90m[39;49;00m
    [90m[39;49;00m
            [90m# Set positional arguments[39;49;00m[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                [90m# See discussion about None as input[39;49;00m[90m[39;49;00m
                [90m# https://groups.google.com/group/theano-dev/browse_thread/thread/920a5e904e8a8525/4f1b311a28fc27e5[39;49;00m[90m[39;49;00m
                [94mif[39;49;00m arg [95mis[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                    arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
                [94melse[39;49;00m:[90m[39;49;00m
                    [94mtry[39;49;00m:[90m[39;49;00m
                        arg_container.storage[[94m0[39;49;00m] = arg_container.type.filter([90m[39;49;00m
                            arg,[90m[39;49;00m
                            strict=arg_container.strict,[90m[39;49;00m
                            allow_downcast=arg_container.allow_downcast,[90m[39;49;00m
                        )[90m[39;49;00m
    [90m[39;49;00m
                    [94mexcept[39;49;00m [96mException[39;49;00m [94mas[39;49;00m e:[90m[39;49;00m
                        i = input_storage.index(arg_container)[90m[39;49;00m
                        function_name = [33m"[39;49;00m[33mpytensor function[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        argument_name = [33m"[39;49;00m[33margument[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mself[39;49;00m.name:[90m[39;49;00m
                            function_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + [96mself[39;49;00m.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mhasattr[39;49;00m(arg, [33m"[39;49;00m[33mname[39;49;00m[33m"[39;49;00m) [95mand[39;49;00m arg.name:[90m[39;49;00m
                            argument_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + arg.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        where = get_variable_trace_string([96mself[39;49;00m.maker.inputs[i].variable)[90m[39;49;00m
                        [94mif[39;49;00m [96mlen[39;49;00m(e.args) == [94m1[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + e.args[[94m0[39;49;00m],[90m[39;49;00m
                            )[90m[39;49;00m
                        [94melse[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                            ) + e.args[90m[39;49;00m
                        [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                        [94mraise[39;49;00m[90m[39;49;00m
                arg_container.provided += [94m1[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
        [90m# Set keyword arguments[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m kwargs:  [90m# for speed, skip the items for empty kwargs[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m k, arg [95min[39;49;00m kwargs.items():[90m[39;49;00m
                [96mself[39;49;00m[k] = arg[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m [95mnot[39;49;00m trust_input:[90m[39;49;00m
            [90m# Collect aliased inputs among the storage space[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m potential_group [95min[39;49;00m [96mself[39;49;00m._potential_aliased_input_groups:[90m[39;49;00m
                args_share_memory: [96mlist[39;49;00m[[96mlist[39;49;00m[[96mint[39;49;00m]] = [][90m[39;49;00m
                [94mfor[39;49;00m i [95min[39;49;00m potential_group:[90m[39;49;00m
                    i_type = [96mself[39;49;00m.maker.inputs[i].variable.type[90m[39;49;00m
                    i_val = input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
    [90m[39;49;00m
                    [90m# Check if value is aliased with any of the values in one of the groups[39;49;00m[90m[39;49;00m
                    [94mfor[39;49;00m j_group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                        [94mif[39;49;00m [96many[39;49;00m([90m[39;49;00m
                            i_type.may_share_memory(input_storage[j].storage[[94m0[39;49;00m], i_val)[90m[39;49;00m
                            [94mfor[39;49;00m j [95min[39;49;00m j_group[90m[39;49;00m
                        ):[90m[39;49;00m
                            j_group.append(i)[90m[39;49;00m
                            [94mbreak[39;49;00m[90m[39;49;00m
                    [94melse[39;49;00m:  [90m# no break[39;49;00m[90m[39;49;00m
                        [90m# Create a new group[39;49;00m[90m[39;49;00m
                        args_share_memory.append([i])[90m[39;49;00m
    [90m[39;49;00m
                [90m# Check for groups of more than one argument that share memory[39;49;00m[90m[39;49;00m
                [94mfor[39;49;00m group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                    [94mif[39;49;00m [96mlen[39;49;00m(group) > [94m1[39;49;00m:[90m[39;49;00m
                        [90m# copy all but the first[39;49;00m[90m[39;49;00m
                        [94mfor[39;49;00m i [95min[39;49;00m group[[94m1[39;49;00m:]:[90m[39;49;00m
                            input_storage[i].storage[[94m0[39;49;00m] = copy.copy([90m[39;49;00m
                                input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
                            )[90m[39;49;00m
    [90m[39;49;00m
            [90m# Check if inputs are missing, or if inputs were set more than once, or[39;49;00m[90m[39;49;00m
            [90m# if we tried to provide inputs that are supposed to be implicit.[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                [94mif[39;49;00m arg_container.required [95mand[39;49;00m [95mnot[39;49;00m arg_container.provided:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMissing required input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.provided > [94m1[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMultiple values for input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.implicit [95mand[39;49;00m arg_container.provided > [94m0[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mTried to provide value for implicit input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
    [90m[39;49;00m
        [90m# Do the actual work[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0_fn = time.perf_counter()[90m[39;49;00m
        [94mtry[39;49;00m:[90m[39;49;00m
>           outputs = vm() [94mif[39;49;00m output_subset [95mis[39;49;00m [94mNone[39;49;00m [94melse[39;49;00m vm(output_subset=output_subset)[90m[39;49;00m
                      ^^^^[90m[39;49;00m
[1m[31mE           pymc.logprob.utils.ParameterValueError[0m

[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/compile/function/types.py[0m:1038: ParameterValueError

[33mDuring handling of the above exception, another exception occurred:[0m

self = <tests.distributions.test_multivariate.TestMatchesScipy object at 0x7f0bb35c78e0>
n = array([[ 5,  6],
       [10, 11]])
p = array([[0.2 , 0.3 , 0.5 ],
       [0.9 , 0.09, 0.01]]), extra_size = (2, 3)

    [0m[37m@pytest[39;49;00m.mark.parametrize([33m"[39;49;00m[33mn[39;49;00m[33m"[39;49;00m, [([94m10[39;49;00m), ([[94m10[39;49;00m, [94m11[39;49;00m]), ([[[94m5[39;49;00m, [94m6[39;49;00m], [[94m10[39;49;00m, [94m11[39;49;00m]])])[90m[39;49;00m
    [37m@pytest[39;49;00m.mark.parametrize([90m[39;49;00m
        [33m"[39;49;00m[33mp[39;49;00m[33m"[39;49;00m,[90m[39;49;00m
        [[90m[39;49;00m
            ([[94m0.2[39;49;00m, [94m0.3[39;49;00m, [94m0.5[39;49;00m]),[90m[39;49;00m
            ([[[94m0.2[39;49;00m, [94m0.3[39;49;00m, [94m0.5[39;49;00m], [[94m0.9[39;49;00m, [94m0.09[39;49;00m, [94m0.01[39;49;00m]]),[90m[39;49;00m
            (np.abs(np.random.randn([94m2[39;49;00m, [94m2[39;49;00m, [94m4[39;49;00m))),[90m[39;49;00m
        ],[90m[39;49;00m
    )[90m[39;49;00m
    [37m@pytest[39;49;00m.mark.parametrize([33m"[39;49;00m[33mextra_size[39;49;00m[33m"[39;49;00m, [([94m1[39;49;00m,), ([94m2[39;49;00m,), ([94m2[39;49;00m, [94m3[39;49;00m)])[90m[39;49;00m
    [94mdef[39;49;00m[90m [39;49;00m[92mtest_multinomial_vectorized[39;49;00m([96mself[39;49;00m, n, p, extra_size):[90m[39;49;00m
        n = np.array(n)[90m[39;49;00m
        p = np.array(p)[90m[39;49;00m
        p /= p.sum(axis=-[94m1[39;49;00m, keepdims=[94mTrue[39;49;00m)[90m[39;49;00m
    [90m[39;49;00m
        _, bcast_p = broadcast_params([n, p], ndims_params=[[94m0[39;49;00m, [94m1[39;49;00m])[90m[39;49;00m
        size = extra_size + bcast_p.shape[:-[94m1[39;49;00m][90m[39;49;00m
    [90m[39;49;00m
        mn = pm.Multinomial.dist(n=n, p=p, size=size)[90m[39;49;00m
        vals = mn.eval()[90m[39;49;00m
    [90m[39;49;00m
        npt.assert_almost_equal([90m[39;49;00m
            st.multinomial.logpmf(vals, n, p),[90m[39;49;00m
>           pm.logp(mn, vals).eval(),[90m[39;49;00m
            ^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
            decimal=[94m4[39;49;00m,[90m[39;49;00m
            err_msg=[33mf[39;49;00m[33m"[39;49;00m[33mvals=[39;49;00m[33m{[39;49;00mvals[33m}[39;49;00m[33m"[39;49;00m,[90m[39;49;00m
        )[90m[39;49;00m

[1m[31mtests/distributions/test_multivariate.py[0m:692:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/graph/basic.py[0m:668: in eval
    [0m[94mreturn[39;49;00m fn(*args)[90m[39;49;00m
           ^^^^^^^^^[90m[39;49;00m
[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/compile/function/types.py[0m:1048: in __call__
    [0mraise_with_op([90m[39;49;00m
[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/link/utils.py[0m:526: in raise_with_op
    [0m[94mraise[39;49;00m exc_value.with_traceback(exc_trace)[90m[39;49;00m
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <pytensor.compile.function.types.Function object at 0x7f0b9aff2450>
output_subset = None, args = (), kwargs = {}, trust_input = False
vm = <pytensor.link.c.cvm.CVM object at 0x7f0ba2939ff0>, profile = None

    [0m[94mdef[39;49;00m[90m [39;49;00m[92m__call__[39;49;00m([96mself[39;49;00m, *args, output_subset=[94mNone[39;49;00m, **kwargs):[90m[39;49;00m
    [90m    [39;49;00m[33m"""[39;49;00m
    [33m    Evaluates value of a function on given arguments.[39;49;00m
    [33m[39;49;00m
    [33m    Parameters[39;49;00m
    [33m    ----------[39;49;00m
    [33m    args : list[39;49;00m
    [33m        List of inputs to the function. All inputs are required, even when[39;49;00m
    [33m        some of them are not necessary to calculate requested subset of[39;49;00m
    [33m        outputs.[39;49;00m
    [33m[39;49;00m
    [33m    kwargs : dict[39;49;00m
    [33m        The function inputs can be passed as keyword argument. For this, use[39;49;00m
    [33m        the name of the input or the input instance as the key.[39;49;00m
    [33m[39;49;00m
    [33m        Keyword argument ``output_subset`` is a list of either indices of the[39;49;00m
    [33m        function's outputs or the keys belonging to the `output_keys` dict[39;49;00m
    [33m        and represent outputs that are requested to be calculated. Regardless[39;49;00m
    [33m        of the presence of ``output_subset``, the updates are always calculated[39;49;00m
    [33m        and processed. To disable the updates, you should use the ``copy``[39;49;00m
    [33m        method with ``delete_updates=True``.[39;49;00m
    [33m[39;49;00m
    [33m    Returns[39;49;00m
    [33m    -------[39;49;00m
    [33m    list[39;49;00m
    [33m        List of outputs on indices/keys from ``output_subset`` or all of them,[39;49;00m
    [33m        if ``output_subset`` is not passed.[39;49;00m
    [33m    """[39;49;00m[90m[39;49;00m
        trust_input = [96mself[39;49;00m.trust_input[90m[39;49;00m
        input_storage = [96mself[39;49;00m.input_storage[90m[39;49;00m
        vm = [96mself[39;49;00m.vm[90m[39;49;00m
        profile = [96mself[39;49;00m.profile[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0 = time.perf_counter()[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m output_subset [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
            warnings.warn([33m"[39;49;00m[33moutput_subset is deprecated.[39;49;00m[33m"[39;49;00m, [96mFutureWarning[39;49;00m)[90m[39;49;00m
            [94mif[39;49;00m [96mself[39;49;00m.output_keys [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                output_subset = [[96mself[39;49;00m.output_keys.index(key) [94mfor[39;49;00m key [95min[39;49;00m output_subset][90m[39;49;00m
    [90m[39;49;00m
        [90m# Reinitialize each container's 'provided' counter[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m trust_input:[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
        [94melse[39;49;00m:[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                arg_container.provided = [94m0[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
            [94mif[39;49;00m [96mlen[39;49;00m(args) + [96mlen[39;49;00m(kwargs) > [96mlen[39;49;00m(input_storage):[90m[39;49;00m
                [94mraise[39;49;00m [96mTypeError[39;49;00m([33m"[39;49;00m[33mToo many parameter passed to pytensor function[39;49;00m[33m"[39;49;00m)[90m[39;49;00m
    [90m[39;49;00m
            [90m# Set positional arguments[39;49;00m[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                [90m# See discussion about None as input[39;49;00m[90m[39;49;00m
                [90m# https://groups.google.com/group/theano-dev/browse_thread/thread/920a5e904e8a8525/4f1b311a28fc27e5[39;49;00m[90m[39;49;00m
                [94mif[39;49;00m arg [95mis[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                    arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
                [94melse[39;49;00m:[90m[39;49;00m
                    [94mtry[39;49;00m:[90m[39;49;00m
                        arg_container.storage[[94m0[39;49;00m] = arg_container.type.filter([90m[39;49;00m
                            arg,[90m[39;49;00m
                            strict=arg_container.strict,[90m[39;49;00m
                            allow_downcast=arg_container.allow_downcast,[90m[39;49;00m
                        )[90m[39;49;00m
    [90m[39;49;00m
                    [94mexcept[39;49;00m [96mException[39;49;00m [94mas[39;49;00m e:[90m[39;49;00m
                        i = input_storage.index(arg_container)[90m[39;49;00m
                        function_name = [33m"[39;49;00m[33mpytensor function[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        argument_name = [33m"[39;49;00m[33margument[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mself[39;49;00m.name:[90m[39;49;00m
                            function_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + [96mself[39;49;00m.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mhasattr[39;49;00m(arg, [33m"[39;49;00m[33mname[39;49;00m[33m"[39;49;00m) [95mand[39;49;00m arg.name:[90m[39;49;00m
                            argument_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + arg.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        where = get_variable_trace_string([96mself[39;49;00m.maker.inputs[i].variable)[90m[39;49;00m
                        [94mif[39;49;00m [96mlen[39;49;00m(e.args) == [94m1[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + e.args[[94m0[39;49;00m],[90m[39;49;00m
                            )[90m[39;49;00m
                        [94melse[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                            ) + e.args[90m[39;49;00m
                        [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                        [94mraise[39;49;00m[90m[39;49;00m
                arg_container.provided += [94m1[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
        [90m# Set keyword arguments[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m kwargs:  [90m# for speed, skip the items for empty kwargs[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m k, arg [95min[39;49;00m kwargs.items():[90m[39;49;00m
                [96mself[39;49;00m[k] = arg[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m [95mnot[39;49;00m trust_input:[90m[39;49;00m
            [90m# Collect aliased inputs among the storage space[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m potential_group [95min[39;49;00m [96mself[39;49;00m._potential_aliased_input_groups:[90m[39;49;00m
                args_share_memory: [96mlist[39;49;00m[[96mlist[39;49;00m[[96mint[39;49;00m]] = [][90m[39;49;00m
                [94mfor[39;49;00m i [95min[39;49;00m potential_group:[90m[39;49;00m
                    i_type = [96mself[39;49;00m.maker.inputs[i].variable.type[90m[39;49;00m
                    i_val = input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
    [90m[39;49;00m
                    [90m# Check if value is aliased with any of the values in one of the groups[39;49;00m[90m[39;49;00m
                    [94mfor[39;49;00m j_group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                        [94mif[39;49;00m [96many[39;49;00m([90m[39;49;00m
                            i_type.may_share_memory(input_storage[j].storage[[94m0[39;49;00m], i_val)[90m[39;49;00m
                            [94mfor[39;49;00m j [95min[39;49;00m j_group[90m[39;49;00m
                        ):[90m[39;49;00m
                            j_group.append(i)[90m[39;49;00m
                            [94mbreak[39;49;00m[90m[39;49;00m
                    [94melse[39;49;00m:  [90m# no break[39;49;00m[90m[39;49;00m
                        [90m# Create a new group[39;49;00m[90m[39;49;00m
                        args_share_memory.append([i])[90m[39;49;00m
    [90m[39;49;00m
                [90m# Check for groups of more than one argument that share memory[39;49;00m[90m[39;49;00m
                [94mfor[39;49;00m group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                    [94mif[39;49;00m [96mlen[39;49;00m(group) > [94m1[39;49;00m:[90m[39;49;00m
                        [90m# copy all but the first[39;49;00m[90m[39;49;00m
                        [94mfor[39;49;00m i [95min[39;49;00m group[[94m1[39;49;00m:]:[90m[39;49;00m
                            input_storage[i].storage[[94m0[39;49;00m] = copy.copy([90m[39;49;00m
                                input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
                            )[90m[39;49;00m
    [90m[39;49;00m
            [90m# Check if inputs are missing, or if inputs were set more than once, or[39;49;00m[90m[39;49;00m
            [90m# if we tried to provide inputs that are supposed to be implicit.[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                [94mif[39;49;00m arg_container.required [95mand[39;49;00m [95mnot[39;49;00m arg_container.provided:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMissing required input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.provided > [94m1[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMultiple values for input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.implicit [95mand[39;49;00m arg_container.provided > [94m0[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mTried to provide value for implicit input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
    [90m[39;49;00m
        [90m# Do the actual work[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0_fn = time.perf_counter()[90m[39;49;00m
        [94mtry[39;49;00m:[90m[39;49;00m
>           outputs = vm() [94mif[39;49;00m output_subset [95mis[39;49;00m [94mNone[39;49;00m [94melse[39;49;00m vm(output_subset=output_subset)[90m[39;49;00m
                      ^^^^[90m[39;49;00m
[1m[31mE           pymc.logprob.utils.ParameterValueError: [0m
[1m[31mE           Apply node that caused the error: Check{}([[[[-305.6 ... 357418]]]], False)[0m
[1m[31mE           Toposort index: 0[0m
[1m[31mE           Inputs types: [TensorType(float64, shape=(1, 1, 2, 2)), ScalarType(bool)][0m
[1m[31mE           Inputs shapes: [(1, 1, 2, 2), ()][0m
[1m[31mE           Inputs strides: [(32, 32, 16, 8), ()][0m
[1m[31mE           Inputs values: [array([[[[-305.69839028, -303.90663081],[0m
[1m[31mE                    [-295.38146945, -292.98357418]]]]), np.False_][0m
[1m[31mE           Inputs type_num: [12, 0][0m
[1m[31mE           Outputs clients: [[DeepCopyOp(Check{}.0)]][0m
[1m[31mE           [0m
[1m[31mE           Backtrace when the node is created (use PyTensor flag traceback__limit=N to make it longer):[0m
[1m[31mE             File "/app/pymc/logprob/basic.py", line 193, in logp[0m
[1m[31mE               return _logprob_helper(rv, value, **kwargs)[0m
[1m[31mE             File "/app/pymc/logprob/abstract.py", line 70, in _logprob_helper[0m
[1m[31mE               logprob = _logprob(rv.owner.op, values, *rv.owner.inputs, **kwargs)[0m
[1m[31mE             File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/functools.py", line 982, in wrapper[0m
[1m[31mE               return dispatch(args[0].__class__)(*args, **kw)[0m
[1m[31mE             File "/app/pymc/distributions/distribution.py", line 140, in logp[0m
[1m[31mE               return class_logp(value, *dist_params)[0m
[1m[31mE             File "/app/tests/distributions/test_dist_math.py", line 96, in logp[0m
[1m[31mE               return check_parameters([0m
[1m[31mE             File "/app/pymc/distributions/dist_math.py", line 72, in check_parameters[0m
[1m[31mE               return CheckParameterValue(msg, can_be_replaced_by_ninf)(expr, all_true_scalar)[0m
[1m[31mE             File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/graph/op.py", line 294, in __call__[0m
[1m[31mE               node = self.make_node(*inputs, **kwargs)[0m
[1m[31mE             File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/raise_op.py", line 81, in make_node[0m
[1m[31mE               [value.type()],[0m
[1m[31mE           [0m
[1m[31mE           Debug print of the apply node: [0m
[1m[31mE           Check{} [id A] <Tensor4(float64, shape=(1, 1, 2, 2))>[0m
[1m[31mE            ├─ [[[[-305.6 ... 357418]]]] [id B] <Tensor4(float64, shape=(1, 1, 2, 2))>[0m
[1m[31mE            └─ False [id C] <bool>[0m
[1m[31mE           [0m
[1m[31mE           Storage map footprint:[0m
[1m[31mE            - [[[[-305.6 ... 357418]]]], Shape: (1, 1, 2, 2), ElemSize: 8 Byte(s), TotalSize: 32 Byte(s)[0m
[1m[31mE            - False, Shape: (), ElemSize: 1 Byte(s), TotalSize: 1.0 Byte(s)[0m
[1m[31mE            TotalSize: 33.0 Byte(s) 0.000 GB[0m
[1m[31mE            TotalSize inputs: 33.0 Byte(s) 0.000 GB[0m

[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/compile/function/types.py[0m:1038: ParameterValueError
[31m[1m_______ TestMatchesScipy.test_multinomial_vectorized[extra_size2-p2-10] ________[0m

self = <pytensor.compile.function.types.Function object at 0x7f0b9c937650>
output_subset = None, args = (), kwargs = {}, trust_input = False
vm = <pytensor.link.c.cvm.CVM object at 0x7f0ba29381b0>, profile = None

    [0m[94mdef[39;49;00m[90m [39;49;00m[92m__call__[39;49;00m([96mself[39;49;00m, *args, output_subset=[94mNone[39;49;00m, **kwargs):[90m[39;49;00m
    [90m    [39;49;00m[33m"""[39;49;00m
    [33m    Evaluates value of a function on given arguments.[39;49;00m
    [33m[39;49;00m
    [33m    Parameters[39;49;00m
    [33m    ----------[39;49;00m
    [33m    args : list[39;49;00m
    [33m        List of inputs to the function. All inputs are required, even when[39;49;00m
    [33m        some of them are not necessary to calculate requested subset of[39;49;00m
    [33m        outputs.[39;49;00m
    [33m[39;49;00m
    [33m    kwargs : dict[39;49;00m
    [33m        The function inputs can be passed as keyword argument. For this, use[39;49;00m
    [33m        the name of the input or the input instance as the key.[39;49;00m
    [33m[39;49;00m
    [33m        Keyword argument ``output_subset`` is a list of either indices of the[39;49;00m
    [33m        function's outputs or the keys belonging to the `output_keys` dict[39;49;00m
    [33m        and represent outputs that are requested to be calculated. Regardless[39;49;00m
    [33m        of the presence of ``output_subset``, the updates are always calculated[39;49;00m
    [33m        and processed. To disable the updates, you should use the ``copy``[39;49;00m
    [33m        method with ``delete_updates=True``.[39;49;00m
    [33m[39;49;00m
    [33m    Returns[39;49;00m
    [33m    -------[39;49;00m
    [33m    list[39;49;00m
    [33m        List of outputs on indices/keys from ``output_subset`` or all of them,[39;49;00m
    [33m        if ``output_subset`` is not passed.[39;49;00m
    [33m    """[39;49;00m[90m[39;49;00m
        trust_input = [96mself[39;49;00m.trust_input[90m[39;49;00m
        input_storage = [96mself[39;49;00m.input_storage[90m[39;49;00m
        vm = [96mself[39;49;00m.vm[90m[39;49;00m
        profile = [96mself[39;49;00m.profile[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0 = time.perf_counter()[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m output_subset [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
            warnings.warn([33m"[39;49;00m[33moutput_subset is deprecated.[39;49;00m[33m"[39;49;00m, [96mFutureWarning[39;49;00m)[90m[39;49;00m
            [94mif[39;49;00m [96mself[39;49;00m.output_keys [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                output_subset = [[96mself[39;49;00m.output_keys.index(key) [94mfor[39;49;00m key [95min[39;49;00m output_subset][90m[39;49;00m
    [90m[39;49;00m
        [90m# Reinitialize each container's 'provided' counter[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m trust_input:[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
        [94melse[39;49;00m:[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                arg_container.provided = [94m0[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
            [94mif[39;49;00m [96mlen[39;49;00m(args) + [96mlen[39;49;00m(kwargs) > [96mlen[39;49;00m(input_storage):[90m[39;49;00m
                [94mraise[39;49;00m [96mTypeError[39;49;00m([33m"[39;49;00m[33mToo many parameter passed to pytensor function[39;49;00m[33m"[39;49;00m)[90m[39;49;00m
    [90m[39;49;00m
            [90m# Set positional arguments[39;49;00m[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                [90m# See discussion about None as input[39;49;00m[90m[39;49;00m
                [90m# https://groups.google.com/group/theano-dev/browse_thread/thread/920a5e904e8a8525/4f1b311a28fc27e5[39;49;00m[90m[39;49;00m
                [94mif[39;49;00m arg [95mis[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                    arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
                [94melse[39;49;00m:[90m[39;49;00m
                    [94mtry[39;49;00m:[90m[39;49;00m
                        arg_container.storage[[94m0[39;49;00m] = arg_container.type.filter([90m[39;49;00m
                            arg,[90m[39;49;00m
                            strict=arg_container.strict,[90m[39;49;00m
                            allow_downcast=arg_container.allow_downcast,[90m[39;49;00m
                        )[90m[39;49;00m
    [90m[39;49;00m
                    [94mexcept[39;49;00m [96mException[39;49;00m [94mas[39;49;00m e:[90m[39;49;00m
                        i = input_storage.index(arg_container)[90m[39;49;00m
                        function_name = [33m"[39;49;00m[33mpytensor function[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        argument_name = [33m"[39;49;00m[33margument[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mself[39;49;00m.name:[90m[39;49;00m
                            function_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + [96mself[39;49;00m.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mhasattr[39;49;00m(arg, [33m"[39;49;00m[33mname[39;49;00m[33m"[39;49;00m) [95mand[39;49;00m arg.name:[90m[39;49;00m
                            argument_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + arg.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        where = get_variable_trace_string([96mself[39;49;00m.maker.inputs[i].variable)[90m[39;49;00m
                        [94mif[39;49;00m [96mlen[39;49;00m(e.args) == [94m1[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + e.args[[94m0[39;49;00m],[90m[39;49;00m
                            )[90m[39;49;00m
                        [94melse[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                            ) + e.args[90m[39;49;00m
                        [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                        [94mraise[39;49;00m[90m[39;49;00m
                arg_container.provided += [94m1[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
        [90m# Set keyword arguments[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m kwargs:  [90m# for speed, skip the items for empty kwargs[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m k, arg [95min[39;49;00m kwargs.items():[90m[39;49;00m
                [96mself[39;49;00m[k] = arg[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m [95mnot[39;49;00m trust_input:[90m[39;49;00m
            [90m# Collect aliased inputs among the storage space[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m potential_group [95min[39;49;00m [96mself[39;49;00m._potential_aliased_input_groups:[90m[39;49;00m
                args_share_memory: [96mlist[39;49;00m[[96mlist[39;49;00m[[96mint[39;49;00m]] = [][90m[39;49;00m
                [94mfor[39;49;00m i [95min[39;49;00m potential_group:[90m[39;49;00m
                    i_type = [96mself[39;49;00m.maker.inputs[i].variable.type[90m[39;49;00m
                    i_val = input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
    [90m[39;49;00m
                    [90m# Check if value is aliased with any of the values in one of the groups[39;49;00m[90m[39;49;00m
                    [94mfor[39;49;00m j_group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                        [94mif[39;49;00m [96many[39;49;00m([90m[39;49;00m
                            i_type.may_share_memory(input_storage[j].storage[[94m0[39;49;00m], i_val)[90m[39;49;00m
                            [94mfor[39;49;00m j [95min[39;49;00m j_group[90m[39;49;00m
                        ):[90m[39;49;00m
                            j_group.append(i)[90m[39;49;00m
                            [94mbreak[39;49;00m[90m[39;49;00m
                    [94melse[39;49;00m:  [90m# no break[39;49;00m[90m[39;49;00m
                        [90m# Create a new group[39;49;00m[90m[39;49;00m
                        args_share_memory.append([i])[90m[39;49;00m
    [90m[39;49;00m
                [90m# Check for groups of more than one argument that share memory[39;49;00m[90m[39;49;00m
                [94mfor[39;49;00m group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                    [94mif[39;49;00m [96mlen[39;49;00m(group) > [94m1[39;49;00m:[90m[39;49;00m
                        [90m# copy all but the first[39;49;00m[90m[39;49;00m
                        [94mfor[39;49;00m i [95min[39;49;00m group[[94m1[39;49;00m:]:[90m[39;49;00m
                            input_storage[i].storage[[94m0[39;49;00m] = copy.copy([90m[39;49;00m
                                input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
                            )[90m[39;49;00m
    [90m[39;49;00m
            [90m# Check if inputs are missing, or if inputs were set more than once, or[39;49;00m[90m[39;49;00m
            [90m# if we tried to provide inputs that are supposed to be implicit.[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                [94mif[39;49;00m arg_container.required [95mand[39;49;00m [95mnot[39;49;00m arg_container.provided:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMissing required input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.provided > [94m1[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMultiple values for input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.implicit [95mand[39;49;00m arg_container.provided > [94m0[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mTried to provide value for implicit input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
    [90m[39;49;00m
        [90m# Do the actual work[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0_fn = time.perf_counter()[90m[39;49;00m
        [94mtry[39;49;00m:[90m[39;49;00m
>           outputs = vm() [94mif[39;49;00m output_subset [95mis[39;49;00m [94mNone[39;49;00m [94melse[39;49;00m vm(output_subset=output_subset)[90m[39;49;00m
                      ^^^^[90m[39;49;00m
[1m[31mE           pymc.logprob.utils.ParameterValueError[0m

[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/compile/function/types.py[0m:1038: ParameterValueError

[33mDuring handling of the above exception, another exception occurred:[0m

self = <tests.distributions.test_multivariate.TestMatchesScipy object at 0x7f0bb35c7930>
n = array(10)
p = array([[[0.17876157, 0.39760757, 0.0449895 , 0.37864137],
        [0.06511207, 0.35563681, 0.30921865, 0.27003247]],

       [[0.2899355 , 0.11278839, 0.36678067, 0.23049544],
        [0.13152157, 0.0916917 , 0.25354174, 0.52324499]]])
extra_size = (2, 3)

    [0m[37m@pytest[39;49;00m.mark.parametrize([33m"[39;49;00m[33mn[39;49;00m[33m"[39;49;00m, [([94m10[39;49;00m), ([[94m10[39;49;00m, [94m11[39;49;00m]), ([[[94m5[39;49;00m, [94m6[39;49;00m], [[94m10[39;49;00m, [94m11[39;49;00m]])])[90m[39;49;00m
    [37m@pytest[39;49;00m.mark.parametrize([90m[39;49;00m
        [33m"[39;49;00m[33mp[39;49;00m[33m"[39;49;00m,[90m[39;49;00m
        [[90m[39;49;00m
            ([[94m0.2[39;49;00m, [94m0.3[39;49;00m, [94m0.5[39;49;00m]),[90m[39;49;00m
            ([[[94m0.2[39;49;00m, [94m0.3[39;49;00m, [94m0.5[39;49;00m], [[94m0.9[39;49;00m, [94m0.09[39;49;00m, [94m0.01[39;49;00m]]),[90m[39;49;00m
            (np.abs(np.random.randn([94m2[39;49;00m, [94m2[39;49;00m, [94m4[39;49;00m))),[90m[39;49;00m
        ],[90m[39;49;00m
    )[90m[39;49;00m
    [37m@pytest[39;49;00m.mark.parametrize([33m"[39;49;00m[33mextra_size[39;49;00m[33m"[39;49;00m, [([94m1[39;49;00m,), ([94m2[39;49;00m,), ([94m2[39;49;00m, [94m3[39;49;00m)])[90m[39;49;00m
    [94mdef[39;49;00m[90m [39;49;00m[92mtest_multinomial_vectorized[39;49;00m([96mself[39;49;00m, n, p, extra_size):[90m[39;49;00m
        n = np.array(n)[90m[39;49;00m
        p = np.array(p)[90m[39;49;00m
        p /= p.sum(axis=-[94m1[39;49;00m, keepdims=[94mTrue[39;49;00m)[90m[39;49;00m
    [90m[39;49;00m
        _, bcast_p = broadcast_params([n, p], ndims_params=[[94m0[39;49;00m, [94m1[39;49;00m])[90m[39;49;00m
        size = extra_size + bcast_p.shape[:-[94m1[39;49;00m][90m[39;49;00m
    [90m[39;49;00m
        mn = pm.Multinomial.dist(n=n, p=p, size=size)[90m[39;49;00m
        vals = mn.eval()[90m[39;49;00m
    [90m[39;49;00m
        npt.assert_almost_equal([90m[39;49;00m
            st.multinomial.logpmf(vals, n, p),[90m[39;49;00m
>           pm.logp(mn, vals).eval(),[90m[39;49;00m
            ^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
            decimal=[94m4[39;49;00m,[90m[39;49;00m
            err_msg=[33mf[39;49;00m[33m"[39;49;00m[33mvals=[39;49;00m[33m{[39;49;00mvals[33m}[39;49;00m[33m"[39;49;00m,[90m[39;49;00m
        )[90m[39;49;00m

[1m[31mtests/distributions/test_multivariate.py[0m:692:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/graph/basic.py[0m:668: in eval
    [0m[94mreturn[39;49;00m fn(*args)[90m[39;49;00m
           ^^^^^^^^^[90m[39;49;00m
[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/compile/function/types.py[0m:1048: in __call__
    [0mraise_with_op([90m[39;49;00m
[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/link/utils.py[0m:526: in raise_with_op
    [0m[94mraise[39;49;00m exc_value.with_traceback(exc_trace)[90m[39;49;00m
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <pytensor.compile.function.types.Function object at 0x7f0b9c937650>
output_subset = None, args = (), kwargs = {}, trust_input = False
vm = <pytensor.link.c.cvm.CVM object at 0x7f0ba29381b0>, profile = None

    [0m[94mdef[39;49;00m[90m [39;49;00m[92m__call__[39;49;00m([96mself[39;49;00m, *args, output_subset=[94mNone[39;49;00m, **kwargs):[90m[39;49;00m
    [90m    [39;49;00m[33m"""[39;49;00m
    [33m    Evaluates value of a function on given arguments.[39;49;00m
    [33m[39;49;00m
    [33m    Parameters[39;49;00m
    [33m    ----------[39;49;00m
    [33m    args : list[39;49;00m
    [33m        List of inputs to the function. All inputs are required, even when[39;49;00m
    [33m        some of them are not necessary to calculate requested subset of[39;49;00m
    [33m        outputs.[39;49;00m
    [33m[39;49;00m
    [33m    kwargs : dict[39;49;00m
    [33m        The function inputs can be passed as keyword argument. For this, use[39;49;00m
    [33m        the name of the input or the input instance as the key.[39;49;00m
    [33m[39;49;00m
    [33m        Keyword argument ``output_subset`` is a list of either indices of the[39;49;00m
    [33m        function's outputs or the keys belonging to the `output_keys` dict[39;49;00m
    [33m        and represent outputs that are requested to be calculated. Regardless[39;49;00m
    [33m        of the presence of ``output_subset``, the updates are always calculated[39;49;00m
    [33m        and processed. To disable the updates, you should use the ``copy``[39;49;00m
    [33m        method with ``delete_updates=True``.[39;49;00m
    [33m[39;49;00m
    [33m    Returns[39;49;00m
    [33m    -------[39;49;00m
    [33m    list[39;49;00m
    [33m        List of outputs on indices/keys from ``output_subset`` or all of them,[39;49;00m
    [33m        if ``output_subset`` is not passed.[39;49;00m
    [33m    """[39;49;00m[90m[39;49;00m
        trust_input = [96mself[39;49;00m.trust_input[90m[39;49;00m
        input_storage = [96mself[39;49;00m.input_storage[90m[39;49;00m
        vm = [96mself[39;49;00m.vm[90m[39;49;00m
        profile = [96mself[39;49;00m.profile[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0 = time.perf_counter()[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m output_subset [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
            warnings.warn([33m"[39;49;00m[33moutput_subset is deprecated.[39;49;00m[33m"[39;49;00m, [96mFutureWarning[39;49;00m)[90m[39;49;00m
            [94mif[39;49;00m [96mself[39;49;00m.output_keys [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                output_subset = [[96mself[39;49;00m.output_keys.index(key) [94mfor[39;49;00m key [95min[39;49;00m output_subset][90m[39;49;00m
    [90m[39;49;00m
        [90m# Reinitialize each container's 'provided' counter[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m trust_input:[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
        [94melse[39;49;00m:[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                arg_container.provided = [94m0[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
            [94mif[39;49;00m [96mlen[39;49;00m(args) + [96mlen[39;49;00m(kwargs) > [96mlen[39;49;00m(input_storage):[90m[39;49;00m
                [94mraise[39;49;00m [96mTypeError[39;49;00m([33m"[39;49;00m[33mToo many parameter passed to pytensor function[39;49;00m[33m"[39;49;00m)[90m[39;49;00m
    [90m[39;49;00m
            [90m# Set positional arguments[39;49;00m[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                [90m# See discussion about None as input[39;49;00m[90m[39;49;00m
                [90m# https://groups.google.com/group/theano-dev/browse_thread/thread/920a5e904e8a8525/4f1b311a28fc27e5[39;49;00m[90m[39;49;00m
                [94mif[39;49;00m arg [95mis[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                    arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
                [94melse[39;49;00m:[90m[39;49;00m
                    [94mtry[39;49;00m:[90m[39;49;00m
                        arg_container.storage[[94m0[39;49;00m] = arg_container.type.filter([90m[39;49;00m
                            arg,[90m[39;49;00m
                            strict=arg_container.strict,[90m[39;49;00m
                            allow_downcast=arg_container.allow_downcast,[90m[39;49;00m
                        )[90m[39;49;00m
    [90m[39;49;00m
                    [94mexcept[39;49;00m [96mException[39;49;00m [94mas[39;49;00m e:[90m[39;49;00m
                        i = input_storage.index(arg_container)[90m[39;49;00m
                        function_name = [33m"[39;49;00m[33mpytensor function[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        argument_name = [33m"[39;49;00m[33margument[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mself[39;49;00m.name:[90m[39;49;00m
                            function_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + [96mself[39;49;00m.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mhasattr[39;49;00m(arg, [33m"[39;49;00m[33mname[39;49;00m[33m"[39;49;00m) [95mand[39;49;00m arg.name:[90m[39;49;00m
                            argument_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + arg.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        where = get_variable_trace_string([96mself[39;49;00m.maker.inputs[i].variable)[90m[39;49;00m
                        [94mif[39;49;00m [96mlen[39;49;00m(e.args) == [94m1[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + e.args[[94m0[39;49;00m],[90m[39;49;00m
                            )[90m[39;49;00m
                        [94melse[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                            ) + e.args[90m[39;49;00m
                        [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                        [94mraise[39;49;00m[90m[39;49;00m
                arg_container.provided += [94m1[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
        [90m# Set keyword arguments[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m kwargs:  [90m# for speed, skip the items for empty kwargs[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m k, arg [95min[39;49;00m kwargs.items():[90m[39;49;00m
                [96mself[39;49;00m[k] = arg[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m [95mnot[39;49;00m trust_input:[90m[39;49;00m
            [90m# Collect aliased inputs among the storage space[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m potential_group [95min[39;49;00m [96mself[39;49;00m._potential_aliased_input_groups:[90m[39;49;00m
                args_share_memory: [96mlist[39;49;00m[[96mlist[39;49;00m[[96mint[39;49;00m]] = [][90m[39;49;00m
                [94mfor[39;49;00m i [95min[39;49;00m potential_group:[90m[39;49;00m
                    i_type = [96mself[39;49;00m.maker.inputs[i].variable.type[90m[39;49;00m
                    i_val = input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
    [90m[39;49;00m
                    [90m# Check if value is aliased with any of the values in one of the groups[39;49;00m[90m[39;49;00m
                    [94mfor[39;49;00m j_group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                        [94mif[39;49;00m [96many[39;49;00m([90m[39;49;00m
                            i_type.may_share_memory(input_storage[j].storage[[94m0[39;49;00m], i_val)[90m[39;49;00m
                            [94mfor[39;49;00m j [95min[39;49;00m j_group[90m[39;49;00m
                        ):[90m[39;49;00m
                            j_group.append(i)[90m[39;49;00m
                            [94mbreak[39;49;00m[90m[39;49;00m
                    [94melse[39;49;00m:  [90m# no break[39;49;00m[90m[39;49;00m
                        [90m# Create a new group[39;49;00m[90m[39;49;00m
                        args_share_memory.append([i])[90m[39;49;00m
    [90m[39;49;00m
                [90m# Check for groups of more than one argument that share memory[39;49;00m[90m[39;49;00m
                [94mfor[39;49;00m group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                    [94mif[39;49;00m [96mlen[39;49;00m(group) > [94m1[39;49;00m:[90m[39;49;00m
                        [90m# copy all but the first[39;49;00m[90m[39;49;00m
                        [94mfor[39;49;00m i [95min[39;49;00m group[[94m1[39;49;00m:]:[90m[39;49;00m
                            input_storage[i].storage[[94m0[39;49;00m] = copy.copy([90m[39;49;00m
                                input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
                            )[90m[39;49;00m
    [90m[39;49;00m
            [90m# Check if inputs are missing, or if inputs were set more than once, or[39;49;00m[90m[39;49;00m
            [90m# if we tried to provide inputs that are supposed to be implicit.[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                [94mif[39;49;00m arg_container.required [95mand[39;49;00m [95mnot[39;49;00m arg_container.provided:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMissing required input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.provided > [94m1[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMultiple values for input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.implicit [95mand[39;49;00m arg_container.provided > [94m0[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mTried to provide value for implicit input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
    [90m[39;49;00m
        [90m# Do the actual work[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0_fn = time.perf_counter()[90m[39;49;00m
        [94mtry[39;49;00m:[90m[39;49;00m
>           outputs = vm() [94mif[39;49;00m output_subset [95mis[39;49;00m [94mNone[39;49;00m [94melse[39;49;00m vm(output_subset=output_subset)[90m[39;49;00m
                      ^^^^[90m[39;49;00m
[1m[31mE           pymc.logprob.utils.ParameterValueError: [0m
[1m[31mE           Apply node that caused the error: Check{}([[[[-452.1 ... 023861]]]], False)[0m
[1m[31mE           Toposort index: 0[0m
[1m[31mE           Inputs types: [TensorType(float64, shape=(1, 1, 1, 1)), ScalarType(bool)][0m
[1m[31mE           Inputs shapes: [(1, 1, 1, 1), ()][0m
[1m[31mE           Inputs strides: [(8, 8, 8, 8), ()][0m
[1m[31mE           Inputs values: [array([[[[-452.19023861]]]]), np.False_][0m
[1m[31mE           Inputs type_num: [12, 0][0m
[1m[31mE           Outputs clients: [[DeepCopyOp(Check{}.0)]][0m
[1m[31mE           [0m
[1m[31mE           Backtrace when the node is created (use PyTensor flag traceback__limit=N to make it longer):[0m
[1m[31mE             File "/app/pymc/logprob/basic.py", line 193, in logp[0m
[1m[31mE               return _logprob_helper(rv, value, **kwargs)[0m
[1m[31mE             File "/app/pymc/logprob/abstract.py", line 70, in _logprob_helper[0m
[1m[31mE               logprob = _logprob(rv.owner.op, values, *rv.owner.inputs, **kwargs)[0m
[1m[31mE             File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/functools.py", line 982, in wrapper[0m
[1m[31mE               return dispatch(args[0].__class__)(*args, **kw)[0m
[1m[31mE             File "/app/pymc/distributions/distribution.py", line 140, in logp[0m
[1m[31mE               return class_logp(value, *dist_params)[0m
[1m[31mE             File "/app/tests/distributions/test_dist_math.py", line 96, in logp[0m
[1m[31mE               return check_parameters([0m
[1m[31mE             File "/app/pymc/distributions/dist_math.py", line 72, in check_parameters[0m
[1m[31mE               return CheckParameterValue(msg, can_be_replaced_by_ninf)(expr, all_true_scalar)[0m
[1m[31mE             File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/graph/op.py", line 294, in __call__[0m
[1m[31mE               node = self.make_node(*inputs, **kwargs)[0m
[1m[31mE             File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/raise_op.py", line 81, in make_node[0m
[1m[31mE               [value.type()],[0m
[1m[31mE           [0m
[1m[31mE           Debug print of the apply node: [0m
[1m[31mE           Check{} [id A] <Tensor4(float64, shape=(1, 1, 1, 1))>[0m
[1m[31mE            ├─ [[[[-452.1 ... 023861]]]] [id B] <Tensor4(float64, shape=(1, 1, 1, 1))>[0m
[1m[31mE            └─ False [id C] <bool>[0m
[1m[31mE           [0m
[1m[31mE           Storage map footprint:[0m
[1m[31mE            - [[[[-452.1 ... 023861]]]], Shape: (1, 1, 1, 1), ElemSize: 8 Byte(s), TotalSize: 8 Byte(s)[0m
[1m[31mE            - False, Shape: (), ElemSize: 1 Byte(s), TotalSize: 1.0 Byte(s)[0m
[1m[31mE            TotalSize: 9.0 Byte(s) 0.000 GB[0m
[1m[31mE            TotalSize inputs: 9.0 Byte(s) 0.000 GB[0m

[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/compile/function/types.py[0m:1038: ParameterValueError
[31m[1m_______ TestMatchesScipy.test_multinomial_vectorized[extra_size2-p2-n1] ________[0m

self = <pytensor.compile.function.types.Function object at 0x7f0ba35a7bf0>
output_subset = None, args = (), kwargs = {}, trust_input = False
vm = <pytensor.link.c.cvm.CVM object at 0x7f0ba293ac50>, profile = None

    [0m[94mdef[39;49;00m[90m [39;49;00m[92m__call__[39;49;00m([96mself[39;49;00m, *args, output_subset=[94mNone[39;49;00m, **kwargs):[90m[39;49;00m
    [90m    [39;49;00m[33m"""[39;49;00m
    [33m    Evaluates value of a function on given arguments.[39;49;00m
    [33m[39;49;00m
    [33m    Parameters[39;49;00m
    [33m    ----------[39;49;00m
    [33m    args : list[39;49;00m
    [33m        List of inputs to the function. All inputs are required, even when[39;49;00m
    [33m        some of them are not necessary to calculate requested subset of[39;49;00m
    [33m        outputs.[39;49;00m
    [33m[39;49;00m
    [33m    kwargs : dict[39;49;00m
    [33m        The function inputs can be passed as keyword argument. For this, use[39;49;00m
    [33m        the name of the input or the input instance as the key.[39;49;00m
    [33m[39;49;00m
    [33m        Keyword argument ``output_subset`` is a list of either indices of the[39;49;00m
    [33m        function's outputs or the keys belonging to the `output_keys` dict[39;49;00m
    [33m        and represent outputs that are requested to be calculated. Regardless[39;49;00m
    [33m        of the presence of ``output_subset``, the updates are always calculated[39;49;00m
    [33m        and processed. To disable the updates, you should use the ``copy``[39;49;00m
    [33m        method with ``delete_updates=True``.[39;49;00m
    [33m[39;49;00m
    [33m    Returns[39;49;00m
    [33m    -------[39;49;00m
    [33m    list[39;49;00m
    [33m        List of outputs on indices/keys from ``output_subset`` or all of them,[39;49;00m
    [33m        if ``output_subset`` is not passed.[39;49;00m
    [33m    """[39;49;00m[90m[39;49;00m
        trust_input = [96mself[39;49;00m.trust_input[90m[39;49;00m
        input_storage = [96mself[39;49;00m.input_storage[90m[39;49;00m
        vm = [96mself[39;49;00m.vm[90m[39;49;00m
        profile = [96mself[39;49;00m.profile[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0 = time.perf_counter()[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m output_subset [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
            warnings.warn([33m"[39;49;00m[33moutput_subset is deprecated.[39;49;00m[33m"[39;49;00m, [96mFutureWarning[39;49;00m)[90m[39;49;00m
            [94mif[39;49;00m [96mself[39;49;00m.output_keys [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                output_subset = [[96mself[39;49;00m.output_keys.index(key) [94mfor[39;49;00m key [95min[39;49;00m output_subset][90m[39;49;00m
    [90m[39;49;00m
        [90m# Reinitialize each container's 'provided' counter[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m trust_input:[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
        [94melse[39;49;00m:[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                arg_container.provided = [94m0[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
            [94mif[39;49;00m [96mlen[39;49;00m(args) + [96mlen[39;49;00m(kwargs) > [96mlen[39;49;00m(input_storage):[90m[39;49;00m
                [94mraise[39;49;00m [96mTypeError[39;49;00m([33m"[39;49;00m[33mToo many parameter passed to pytensor function[39;49;00m[33m"[39;49;00m)[90m[39;49;00m
    [90m[39;49;00m
            [90m# Set positional arguments[39;49;00m[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                [90m# See discussion about None as input[39;49;00m[90m[39;49;00m
                [90m# https://groups.google.com/group/theano-dev/browse_thread/thread/920a5e904e8a8525/4f1b311a28fc27e5[39;49;00m[90m[39;49;00m
                [94mif[39;49;00m arg [95mis[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                    arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
                [94melse[39;49;00m:[90m[39;49;00m
                    [94mtry[39;49;00m:[90m[39;49;00m
                        arg_container.storage[[94m0[39;49;00m] = arg_container.type.filter([90m[39;49;00m
                            arg,[90m[39;49;00m
                            strict=arg_container.strict,[90m[39;49;00m
                            allow_downcast=arg_container.allow_downcast,[90m[39;49;00m
                        )[90m[39;49;00m
    [90m[39;49;00m
                    [94mexcept[39;49;00m [96mException[39;49;00m [94mas[39;49;00m e:[90m[39;49;00m
                        i = input_storage.index(arg_container)[90m[39;49;00m
                        function_name = [33m"[39;49;00m[33mpytensor function[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        argument_name = [33m"[39;49;00m[33margument[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mself[39;49;00m.name:[90m[39;49;00m
                            function_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + [96mself[39;49;00m.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mhasattr[39;49;00m(arg, [33m"[39;49;00m[33mname[39;49;00m[33m"[39;49;00m) [95mand[39;49;00m arg.name:[90m[39;49;00m
                            argument_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + arg.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        where = get_variable_trace_string([96mself[39;49;00m.maker.inputs[i].variable)[90m[39;49;00m
                        [94mif[39;49;00m [96mlen[39;49;00m(e.args) == [94m1[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + e.args[[94m0[39;49;00m],[90m[39;49;00m
                            )[90m[39;49;00m
                        [94melse[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                            ) + e.args[90m[39;49;00m
                        [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                        [94mraise[39;49;00m[90m[39;49;00m
                arg_container.provided += [94m1[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
        [90m# Set keyword arguments[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m kwargs:  [90m# for speed, skip the items for empty kwargs[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m k, arg [95min[39;49;00m kwargs.items():[90m[39;49;00m
                [96mself[39;49;00m[k] = arg[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m [95mnot[39;49;00m trust_input:[90m[39;49;00m
            [90m# Collect aliased inputs among the storage space[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m potential_group [95min[39;49;00m [96mself[39;49;00m._potential_aliased_input_groups:[90m[39;49;00m
                args_share_memory: [96mlist[39;49;00m[[96mlist[39;49;00m[[96mint[39;49;00m]] = [][90m[39;49;00m
                [94mfor[39;49;00m i [95min[39;49;00m potential_group:[90m[39;49;00m
                    i_type = [96mself[39;49;00m.maker.inputs[i].variable.type[90m[39;49;00m
                    i_val = input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
    [90m[39;49;00m
                    [90m# Check if value is aliased with any of the values in one of the groups[39;49;00m[90m[39;49;00m
                    [94mfor[39;49;00m j_group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                        [94mif[39;49;00m [96many[39;49;00m([90m[39;49;00m
                            i_type.may_share_memory(input_storage[j].storage[[94m0[39;49;00m], i_val)[90m[39;49;00m
                            [94mfor[39;49;00m j [95min[39;49;00m j_group[90m[39;49;00m
                        ):[90m[39;49;00m
                            j_group.append(i)[90m[39;49;00m
                            [94mbreak[39;49;00m[90m[39;49;00m
                    [94melse[39;49;00m:  [90m# no break[39;49;00m[90m[39;49;00m
                        [90m# Create a new group[39;49;00m[90m[39;49;00m
                        args_share_memory.append([i])[90m[39;49;00m
    [90m[39;49;00m
                [90m# Check for groups of more than one argument that share memory[39;49;00m[90m[39;49;00m
                [94mfor[39;49;00m group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                    [94mif[39;49;00m [96mlen[39;49;00m(group) > [94m1[39;49;00m:[90m[39;49;00m
                        [90m# copy all but the first[39;49;00m[90m[39;49;00m
                        [94mfor[39;49;00m i [95min[39;49;00m group[[94m1[39;49;00m:]:[90m[39;49;00m
                            input_storage[i].storage[[94m0[39;49;00m] = copy.copy([90m[39;49;00m
                                input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
                            )[90m[39;49;00m
    [90m[39;49;00m
            [90m# Check if inputs are missing, or if inputs were set more than once, or[39;49;00m[90m[39;49;00m
            [90m# if we tried to provide inputs that are supposed to be implicit.[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                [94mif[39;49;00m arg_container.required [95mand[39;49;00m [95mnot[39;49;00m arg_container.provided:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMissing required input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.provided > [94m1[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMultiple values for input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.implicit [95mand[39;49;00m arg_container.provided > [94m0[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mTried to provide value for implicit input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
    [90m[39;49;00m
        [90m# Do the actual work[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0_fn = time.perf_counter()[90m[39;49;00m
        [94mtry[39;49;00m:[90m[39;49;00m
>           outputs = vm() [94mif[39;49;00m output_subset [95mis[39;49;00m [94mNone[39;49;00m [94melse[39;49;00m vm(output_subset=output_subset)[90m[39;49;00m
                      ^^^^[90m[39;49;00m
[1m[31mE           pymc.logprob.utils.ParameterValueError[0m

[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/compile/function/types.py[0m:1038: ParameterValueError

[33mDuring handling of the above exception, another exception occurred:[0m

self = <tests.distributions.test_multivariate.TestMatchesScipy object at 0x7f0bb35c7980>
n = array([10, 11])
p = array([[[0.17876157, 0.39760757, 0.0449895 , 0.37864137],
        [0.06511207, 0.35563681, 0.30921865, 0.27003247]],

       [[0.2899355 , 0.11278839, 0.36678067, 0.23049544],
        [0.13152157, 0.0916917 , 0.25354174, 0.52324499]]])
extra_size = (2, 3)

    [0m[37m@pytest[39;49;00m.mark.parametrize([33m"[39;49;00m[33mn[39;49;00m[33m"[39;49;00m, [([94m10[39;49;00m), ([[94m10[39;49;00m, [94m11[39;49;00m]), ([[[94m5[39;49;00m, [94m6[39;49;00m], [[94m10[39;49;00m, [94m11[39;49;00m]])])[90m[39;49;00m
    [37m@pytest[39;49;00m.mark.parametrize([90m[39;49;00m
        [33m"[39;49;00m[33mp[39;49;00m[33m"[39;49;00m,[90m[39;49;00m
        [[90m[39;49;00m
            ([[94m0.2[39;49;00m, [94m0.3[39;49;00m, [94m0.5[39;49;00m]),[90m[39;49;00m
            ([[[94m0.2[39;49;00m, [94m0.3[39;49;00m, [94m0.5[39;49;00m], [[94m0.9[39;49;00m, [94m0.09[39;49;00m, [94m0.01[39;49;00m]]),[90m[39;49;00m
            (np.abs(np.random.randn([94m2[39;49;00m, [94m2[39;49;00m, [94m4[39;49;00m))),[90m[39;49;00m
        ],[90m[39;49;00m
    )[90m[39;49;00m
    [37m@pytest[39;49;00m.mark.parametrize([33m"[39;49;00m[33mextra_size[39;49;00m[33m"[39;49;00m, [([94m1[39;49;00m,), ([94m2[39;49;00m,), ([94m2[39;49;00m, [94m3[39;49;00m)])[90m[39;49;00m
    [94mdef[39;49;00m[90m [39;49;00m[92mtest_multinomial_vectorized[39;49;00m([96mself[39;49;00m, n, p, extra_size):[90m[39;49;00m
        n = np.array(n)[90m[39;49;00m
        p = np.array(p)[90m[39;49;00m
        p /= p.sum(axis=-[94m1[39;49;00m, keepdims=[94mTrue[39;49;00m)[90m[39;49;00m
    [90m[39;49;00m
        _, bcast_p = broadcast_params([n, p], ndims_params=[[94m0[39;49;00m, [94m1[39;49;00m])[90m[39;49;00m
        size = extra_size + bcast_p.shape[:-[94m1[39;49;00m][90m[39;49;00m
    [90m[39;49;00m
        mn = pm.Multinomial.dist(n=n, p=p, size=size)[90m[39;49;00m
        vals = mn.eval()[90m[39;49;00m
    [90m[39;49;00m
        npt.assert_almost_equal([90m[39;49;00m
            st.multinomial.logpmf(vals, n, p),[90m[39;49;00m
>           pm.logp(mn, vals).eval(),[90m[39;49;00m
            ^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
            decimal=[94m4[39;49;00m,[90m[39;49;00m
            err_msg=[33mf[39;49;00m[33m"[39;49;00m[33mvals=[39;49;00m[33m{[39;49;00mvals[33m}[39;49;00m[33m"[39;49;00m,[90m[39;49;00m
        )[90m[39;49;00m

[1m[31mtests/distributions/test_multivariate.py[0m:692:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/graph/basic.py[0m:668: in eval
    [0m[94mreturn[39;49;00m fn(*args)[90m[39;49;00m
           ^^^^^^^^^[90m[39;49;00m
[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/compile/function/types.py[0m:1048: in __call__
    [0mraise_with_op([90m[39;49;00m
[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/link/utils.py[0m:526: in raise_with_op
    [0m[94mraise[39;49;00m exc_value.with_traceback(exc_trace)[90m[39;49;00m
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <pytensor.compile.function.types.Function object at 0x7f0ba35a7bf0>
output_subset = None, args = (), kwargs = {}, trust_input = False
vm = <pytensor.link.c.cvm.CVM object at 0x7f0ba293ac50>, profile = None

    [0m[94mdef[39;49;00m[90m [39;49;00m[92m__call__[39;49;00m([96mself[39;49;00m, *args, output_subset=[94mNone[39;49;00m, **kwargs):[90m[39;49;00m
    [90m    [39;49;00m[33m"""[39;49;00m
    [33m    Evaluates value of a function on given arguments.[39;49;00m
    [33m[39;49;00m
    [33m    Parameters[39;49;00m
    [33m    ----------[39;49;00m
    [33m    args : list[39;49;00m
    [33m        List of inputs to the function. All inputs are required, even when[39;49;00m
    [33m        some of them are not necessary to calculate requested subset of[39;49;00m
    [33m        outputs.[39;49;00m
    [33m[39;49;00m
    [33m    kwargs : dict[39;49;00m
    [33m        The function inputs can be passed as keyword argument. For this, use[39;49;00m
    [33m        the name of the input or the input instance as the key.[39;49;00m
    [33m[39;49;00m
    [33m        Keyword argument ``output_subset`` is a list of either indices of the[39;49;00m
    [33m        function's outputs or the keys belonging to the `output_keys` dict[39;49;00m
    [33m        and represent outputs that are requested to be calculated. Regardless[39;49;00m
    [33m        of the presence of ``output_subset``, the updates are always calculated[39;49;00m
    [33m        and processed. To disable the updates, you should use the ``copy``[39;49;00m
    [33m        method with ``delete_updates=True``.[39;49;00m
    [33m[39;49;00m
    [33m    Returns[39;49;00m
    [33m    -------[39;49;00m
    [33m    list[39;49;00m
    [33m        List of outputs on indices/keys from ``output_subset`` or all of them,[39;49;00m
    [33m        if ``output_subset`` is not passed.[39;49;00m
    [33m    """[39;49;00m[90m[39;49;00m
        trust_input = [96mself[39;49;00m.trust_input[90m[39;49;00m
        input_storage = [96mself[39;49;00m.input_storage[90m[39;49;00m
        vm = [96mself[39;49;00m.vm[90m[39;49;00m
        profile = [96mself[39;49;00m.profile[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0 = time.perf_counter()[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m output_subset [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
            warnings.warn([33m"[39;49;00m[33moutput_subset is deprecated.[39;49;00m[33m"[39;49;00m, [96mFutureWarning[39;49;00m)[90m[39;49;00m
            [94mif[39;49;00m [96mself[39;49;00m.output_keys [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                output_subset = [[96mself[39;49;00m.output_keys.index(key) [94mfor[39;49;00m key [95min[39;49;00m output_subset][90m[39;49;00m
    [90m[39;49;00m
        [90m# Reinitialize each container's 'provided' counter[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m trust_input:[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
        [94melse[39;49;00m:[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                arg_container.provided = [94m0[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
            [94mif[39;49;00m [96mlen[39;49;00m(args) + [96mlen[39;49;00m(kwargs) > [96mlen[39;49;00m(input_storage):[90m[39;49;00m
                [94mraise[39;49;00m [96mTypeError[39;49;00m([33m"[39;49;00m[33mToo many parameter passed to pytensor function[39;49;00m[33m"[39;49;00m)[90m[39;49;00m
    [90m[39;49;00m
            [90m# Set positional arguments[39;49;00m[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                [90m# See discussion about None as input[39;49;00m[90m[39;49;00m
                [90m# https://groups.google.com/group/theano-dev/browse_thread/thread/920a5e904e8a8525/4f1b311a28fc27e5[39;49;00m[90m[39;49;00m
                [94mif[39;49;00m arg [95mis[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                    arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
                [94melse[39;49;00m:[90m[39;49;00m
                    [94mtry[39;49;00m:[90m[39;49;00m
                        arg_container.storage[[94m0[39;49;00m] = arg_container.type.filter([90m[39;49;00m
                            arg,[90m[39;49;00m
                            strict=arg_container.strict,[90m[39;49;00m
                            allow_downcast=arg_container.allow_downcast,[90m[39;49;00m
                        )[90m[39;49;00m
    [90m[39;49;00m
                    [94mexcept[39;49;00m [96mException[39;49;00m [94mas[39;49;00m e:[90m[39;49;00m
                        i = input_storage.index(arg_container)[90m[39;49;00m
                        function_name = [33m"[39;49;00m[33mpytensor function[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        argument_name = [33m"[39;49;00m[33margument[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mself[39;49;00m.name:[90m[39;49;00m
                            function_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + [96mself[39;49;00m.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mhasattr[39;49;00m(arg, [33m"[39;49;00m[33mname[39;49;00m[33m"[39;49;00m) [95mand[39;49;00m arg.name:[90m[39;49;00m
                            argument_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + arg.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        where = get_variable_trace_string([96mself[39;49;00m.maker.inputs[i].variable)[90m[39;49;00m
                        [94mif[39;49;00m [96mlen[39;49;00m(e.args) == [94m1[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + e.args[[94m0[39;49;00m],[90m[39;49;00m
                            )[90m[39;49;00m
                        [94melse[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                            ) + e.args[90m[39;49;00m
                        [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                        [94mraise[39;49;00m[90m[39;49;00m
                arg_container.provided += [94m1[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
        [90m# Set keyword arguments[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m kwargs:  [90m# for speed, skip the items for empty kwargs[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m k, arg [95min[39;49;00m kwargs.items():[90m[39;49;00m
                [96mself[39;49;00m[k] = arg[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m [95mnot[39;49;00m trust_input:[90m[39;49;00m
            [90m# Collect aliased inputs among the storage space[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m potential_group [95min[39;49;00m [96mself[39;49;00m._potential_aliased_input_groups:[90m[39;49;00m
                args_share_memory: [96mlist[39;49;00m[[96mlist[39;49;00m[[96mint[39;49;00m]] = [][90m[39;49;00m
                [94mfor[39;49;00m i [95min[39;49;00m potential_group:[90m[39;49;00m
                    i_type = [96mself[39;49;00m.maker.inputs[i].variable.type[90m[39;49;00m
                    i_val = input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
    [90m[39;49;00m
                    [90m# Check if value is aliased with any of the values in one of the groups[39;49;00m[90m[39;49;00m
                    [94mfor[39;49;00m j_group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                        [94mif[39;49;00m [96many[39;49;00m([90m[39;49;00m
                            i_type.may_share_memory(input_storage[j].storage[[94m0[39;49;00m], i_val)[90m[39;49;00m
                            [94mfor[39;49;00m j [95min[39;49;00m j_group[90m[39;49;00m
                        ):[90m[39;49;00m
                            j_group.append(i)[90m[39;49;00m
                            [94mbreak[39;49;00m[90m[39;49;00m
                    [94melse[39;49;00m:  [90m# no break[39;49;00m[90m[39;49;00m
                        [90m# Create a new group[39;49;00m[90m[39;49;00m
                        args_share_memory.append([i])[90m[39;49;00m
    [90m[39;49;00m
                [90m# Check for groups of more than one argument that share memory[39;49;00m[90m[39;49;00m
                [94mfor[39;49;00m group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                    [94mif[39;49;00m [96mlen[39;49;00m(group) > [94m1[39;49;00m:[90m[39;49;00m
                        [90m# copy all but the first[39;49;00m[90m[39;49;00m
                        [94mfor[39;49;00m i [95min[39;49;00m group[[94m1[39;49;00m:]:[90m[39;49;00m
                            input_storage[i].storage[[94m0[39;49;00m] = copy.copy([90m[39;49;00m
                                input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
                            )[90m[39;49;00m
    [90m[39;49;00m
            [90m# Check if inputs are missing, or if inputs were set more than once, or[39;49;00m[90m[39;49;00m
            [90m# if we tried to provide inputs that are supposed to be implicit.[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                [94mif[39;49;00m arg_container.required [95mand[39;49;00m [95mnot[39;49;00m arg_container.provided:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMissing required input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.provided > [94m1[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMultiple values for input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.implicit [95mand[39;49;00m arg_container.provided > [94m0[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mTried to provide value for implicit input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
    [90m[39;49;00m
        [90m# Do the actual work[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0_fn = time.perf_counter()[90m[39;49;00m
        [94mtry[39;49;00m:[90m[39;49;00m
>           outputs = vm() [94mif[39;49;00m output_subset [95mis[39;49;00m [94mNone[39;49;00m [94melse[39;49;00m vm(output_subset=output_subset)[90m[39;49;00m
                      ^^^^[90m[39;49;00m
[1m[31mE           pymc.logprob.utils.ParameterValueError: [0m
[1m[31mE           Apply node that caused the error: Check{}([[[[-476.4 ... 402034]]]], False)[0m
[1m[31mE           Toposort index: 0[0m
[1m[31mE           Inputs types: [TensorType(float64, shape=(1, 1, 1, 2)), ScalarType(bool)][0m
[1m[31mE           Inputs shapes: [(1, 1, 1, 2), ()][0m
[1m[31mE           Inputs strides: [(16, 16, 16, 8), ()][0m
[1m[31mE           Inputs values: [array([[[[-476.41191561, -474.01402034]]]]), np.False_][0m
[1m[31mE           Inputs type_num: [12, 0][0m
[1m[31mE           Outputs clients: [[DeepCopyOp(Check{}.0)]][0m
[1m[31mE           [0m
[1m[31mE           Backtrace when the node is created (use PyTensor flag traceback__limit=N to make it longer):[0m
[1m[31mE             File "/app/pymc/logprob/basic.py", line 193, in logp[0m
[1m[31mE               return _logprob_helper(rv, value, **kwargs)[0m
[1m[31mE             File "/app/pymc/logprob/abstract.py", line 70, in _logprob_helper[0m
[1m[31mE               logprob = _logprob(rv.owner.op, values, *rv.owner.inputs, **kwargs)[0m
[1m[31mE             File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/functools.py", line 982, in wrapper[0m
[1m[31mE               return dispatch(args[0].__class__)(*args, **kw)[0m
[1m[31mE             File "/app/pymc/distributions/distribution.py", line 140, in logp[0m
[1m[31mE               return class_logp(value, *dist_params)[0m
[1m[31mE             File "/app/tests/distributions/test_dist_math.py", line 96, in logp[0m
[1m[31mE               return check_parameters([0m
[1m[31mE             File "/app/pymc/distributions/dist_math.py", line 72, in check_parameters[0m
[1m[31mE               return CheckParameterValue(msg, can_be_replaced_by_ninf)(expr, all_true_scalar)[0m
[1m[31mE             File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/graph/op.py", line 294, in __call__[0m
[1m[31mE               node = self.make_node(*inputs, **kwargs)[0m
[1m[31mE             File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/raise_op.py", line 81, in make_node[0m
[1m[31mE               [value.type()],[0m
[1m[31mE           [0m
[1m[31mE           Debug print of the apply node: [0m
[1m[31mE           Check{} [id A] <Tensor4(float64, shape=(1, 1, 1, 2))>[0m
[1m[31mE            ├─ [[[[-476.4 ... 402034]]]] [id B] <Tensor4(float64, shape=(1, 1, 1, 2))>[0m
[1m[31mE            └─ False [id C] <bool>[0m
[1m[31mE           [0m
[1m[31mE           Storage map footprint:[0m
[1m[31mE            - [[[[-476.4 ... 402034]]]], Shape: (1, 1, 1, 2), ElemSize: 8 Byte(s), TotalSize: 16 Byte(s)[0m
[1m[31mE            - False, Shape: (), ElemSize: 1 Byte(s), TotalSize: 1.0 Byte(s)[0m
[1m[31mE            TotalSize: 17.0 Byte(s) 0.000 GB[0m
[1m[31mE            TotalSize inputs: 17.0 Byte(s) 0.000 GB[0m

[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/compile/function/types.py[0m:1038: ParameterValueError
[31m[1m_______ TestMatchesScipy.test_multinomial_vectorized[extra_size2-p2-n2] ________[0m

self = <pytensor.compile.function.types.Function object at 0x7f0ba2ab2c30>
output_subset = None, args = (), kwargs = {}, trust_input = False
vm = <pytensor.link.c.cvm.CVM object at 0x7f0ba293a990>, profile = None

    [0m[94mdef[39;49;00m[90m [39;49;00m[92m__call__[39;49;00m([96mself[39;49;00m, *args, output_subset=[94mNone[39;49;00m, **kwargs):[90m[39;49;00m
    [90m    [39;49;00m[33m"""[39;49;00m
    [33m    Evaluates value of a function on given arguments.[39;49;00m
    [33m[39;49;00m
    [33m    Parameters[39;49;00m
    [33m    ----------[39;49;00m
    [33m    args : list[39;49;00m
    [33m        List of inputs to the function. All inputs are required, even when[39;49;00m
    [33m        some of them are not necessary to calculate requested subset of[39;49;00m
    [33m        outputs.[39;49;00m
    [33m[39;49;00m
    [33m    kwargs : dict[39;49;00m
    [33m        The function inputs can be passed as keyword argument. For this, use[39;49;00m
    [33m        the name of the input or the input instance as the key.[39;49;00m
    [33m[39;49;00m
    [33m        Keyword argument ``output_subset`` is a list of either indices of the[39;49;00m
    [33m        function's outputs or the keys belonging to the `output_keys` dict[39;49;00m
    [33m        and represent outputs that are requested to be calculated. Regardless[39;49;00m
    [33m        of the presence of ``output_subset``, the updates are always calculated[39;49;00m
    [33m        and processed. To disable the updates, you should use the ``copy``[39;49;00m
    [33m        method with ``delete_updates=True``.[39;49;00m
    [33m[39;49;00m
    [33m    Returns[39;49;00m
    [33m    -------[39;49;00m
    [33m    list[39;49;00m
    [33m        List of outputs on indices/keys from ``output_subset`` or all of them,[39;49;00m
    [33m        if ``output_subset`` is not passed.[39;49;00m
    [33m    """[39;49;00m[90m[39;49;00m
        trust_input = [96mself[39;49;00m.trust_input[90m[39;49;00m
        input_storage = [96mself[39;49;00m.input_storage[90m[39;49;00m
        vm = [96mself[39;49;00m.vm[90m[39;49;00m
        profile = [96mself[39;49;00m.profile[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0 = time.perf_counter()[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m output_subset [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
            warnings.warn([33m"[39;49;00m[33moutput_subset is deprecated.[39;49;00m[33m"[39;49;00m, [96mFutureWarning[39;49;00m)[90m[39;49;00m
            [94mif[39;49;00m [96mself[39;49;00m.output_keys [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                output_subset = [[96mself[39;49;00m.output_keys.index(key) [94mfor[39;49;00m key [95min[39;49;00m output_subset][90m[39;49;00m
    [90m[39;49;00m
        [90m# Reinitialize each container's 'provided' counter[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m trust_input:[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
        [94melse[39;49;00m:[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                arg_container.provided = [94m0[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
            [94mif[39;49;00m [96mlen[39;49;00m(args) + [96mlen[39;49;00m(kwargs) > [96mlen[39;49;00m(input_storage):[90m[39;49;00m
                [94mraise[39;49;00m [96mTypeError[39;49;00m([33m"[39;49;00m[33mToo many parameter passed to pytensor function[39;49;00m[33m"[39;49;00m)[90m[39;49;00m
    [90m[39;49;00m
            [90m# Set positional arguments[39;49;00m[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                [90m# See discussion about None as input[39;49;00m[90m[39;49;00m
                [90m# https://groups.google.com/group/theano-dev/browse_thread/thread/920a5e904e8a8525/4f1b311a28fc27e5[39;49;00m[90m[39;49;00m
                [94mif[39;49;00m arg [95mis[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                    arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
                [94melse[39;49;00m:[90m[39;49;00m
                    [94mtry[39;49;00m:[90m[39;49;00m
                        arg_container.storage[[94m0[39;49;00m] = arg_container.type.filter([90m[39;49;00m
                            arg,[90m[39;49;00m
                            strict=arg_container.strict,[90m[39;49;00m
                            allow_downcast=arg_container.allow_downcast,[90m[39;49;00m
                        )[90m[39;49;00m
    [90m[39;49;00m
                    [94mexcept[39;49;00m [96mException[39;49;00m [94mas[39;49;00m e:[90m[39;49;00m
                        i = input_storage.index(arg_container)[90m[39;49;00m
                        function_name = [33m"[39;49;00m[33mpytensor function[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        argument_name = [33m"[39;49;00m[33margument[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mself[39;49;00m.name:[90m[39;49;00m
                            function_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + [96mself[39;49;00m.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mhasattr[39;49;00m(arg, [33m"[39;49;00m[33mname[39;49;00m[33m"[39;49;00m) [95mand[39;49;00m arg.name:[90m[39;49;00m
                            argument_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + arg.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        where = get_variable_trace_string([96mself[39;49;00m.maker.inputs[i].variable)[90m[39;49;00m
                        [94mif[39;49;00m [96mlen[39;49;00m(e.args) == [94m1[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + e.args[[94m0[39;49;00m],[90m[39;49;00m
                            )[90m[39;49;00m
                        [94melse[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                            ) + e.args[90m[39;49;00m
                        [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                        [94mraise[39;49;00m[90m[39;49;00m
                arg_container.provided += [94m1[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
        [90m# Set keyword arguments[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m kwargs:  [90m# for speed, skip the items for empty kwargs[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m k, arg [95min[39;49;00m kwargs.items():[90m[39;49;00m
                [96mself[39;49;00m[k] = arg[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m [95mnot[39;49;00m trust_input:[90m[39;49;00m
            [90m# Collect aliased inputs among the storage space[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m potential_group [95min[39;49;00m [96mself[39;49;00m._potential_aliased_input_groups:[90m[39;49;00m
                args_share_memory: [96mlist[39;49;00m[[96mlist[39;49;00m[[96mint[39;49;00m]] = [][90m[39;49;00m
                [94mfor[39;49;00m i [95min[39;49;00m potential_group:[90m[39;49;00m
                    i_type = [96mself[39;49;00m.maker.inputs[i].variable.type[90m[39;49;00m
                    i_val = input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
    [90m[39;49;00m
                    [90m# Check if value is aliased with any of the values in one of the groups[39;49;00m[90m[39;49;00m
                    [94mfor[39;49;00m j_group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                        [94mif[39;49;00m [96many[39;49;00m([90m[39;49;00m
                            i_type.may_share_memory(input_storage[j].storage[[94m0[39;49;00m], i_val)[90m[39;49;00m
                            [94mfor[39;49;00m j [95min[39;49;00m j_group[90m[39;49;00m
                        ):[90m[39;49;00m
                            j_group.append(i)[90m[39;49;00m
                            [94mbreak[39;49;00m[90m[39;49;00m
                    [94melse[39;49;00m:  [90m# no break[39;49;00m[90m[39;49;00m
                        [90m# Create a new group[39;49;00m[90m[39;49;00m
                        args_share_memory.append([i])[90m[39;49;00m
    [90m[39;49;00m
                [90m# Check for groups of more than one argument that share memory[39;49;00m[90m[39;49;00m
                [94mfor[39;49;00m group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                    [94mif[39;49;00m [96mlen[39;49;00m(group) > [94m1[39;49;00m:[90m[39;49;00m
                        [90m# copy all but the first[39;49;00m[90m[39;49;00m
                        [94mfor[39;49;00m i [95min[39;49;00m group[[94m1[39;49;00m:]:[90m[39;49;00m
                            input_storage[i].storage[[94m0[39;49;00m] = copy.copy([90m[39;49;00m
                                input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
                            )[90m[39;49;00m
    [90m[39;49;00m
            [90m# Check if inputs are missing, or if inputs were set more than once, or[39;49;00m[90m[39;49;00m
            [90m# if we tried to provide inputs that are supposed to be implicit.[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                [94mif[39;49;00m arg_container.required [95mand[39;49;00m [95mnot[39;49;00m arg_container.provided:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMissing required input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.provided > [94m1[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMultiple values for input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.implicit [95mand[39;49;00m arg_container.provided > [94m0[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mTried to provide value for implicit input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
    [90m[39;49;00m
        [90m# Do the actual work[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0_fn = time.perf_counter()[90m[39;49;00m
        [94mtry[39;49;00m:[90m[39;49;00m
>           outputs = vm() [94mif[39;49;00m output_subset [95mis[39;49;00m [94mNone[39;49;00m [94melse[39;49;00m vm(output_subset=output_subset)[90m[39;49;00m
                      ^^^^[90m[39;49;00m
[1m[31mE           pymc.logprob.utils.ParameterValueError[0m

[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/compile/function/types.py[0m:1038: ParameterValueError

[33mDuring handling of the above exception, another exception occurred:[0m

self = <tests.distributions.test_multivariate.TestMatchesScipy object at 0x7f0bb35c79d0>
n = array([[ 5,  6],
       [10, 11]])
p = array([[[0.17876157, 0.39760757, 0.0449895 , 0.37864137],
        [0.06511207, 0.35563681, 0.30921865, 0.27003247]],

       [[0.2899355 , 0.11278839, 0.36678067, 0.23049544],
        [0.13152157, 0.0916917 , 0.25354174, 0.52324499]]])
extra_size = (2, 3)

    [0m[37m@pytest[39;49;00m.mark.parametrize([33m"[39;49;00m[33mn[39;49;00m[33m"[39;49;00m, [([94m10[39;49;00m), ([[94m10[39;49;00m, [94m11[39;49;00m]), ([[[94m5[39;49;00m, [94m6[39;49;00m], [[94m10[39;49;00m, [94m11[39;49;00m]])])[90m[39;49;00m
    [37m@pytest[39;49;00m.mark.parametrize([90m[39;49;00m
        [33m"[39;49;00m[33mp[39;49;00m[33m"[39;49;00m,[90m[39;49;00m
        [[90m[39;49;00m
            ([[94m0.2[39;49;00m, [94m0.3[39;49;00m, [94m0.5[39;49;00m]),[90m[39;49;00m
            ([[[94m0.2[39;49;00m, [94m0.3[39;49;00m, [94m0.5[39;49;00m], [[94m0.9[39;49;00m, [94m0.09[39;49;00m, [94m0.01[39;49;00m]]),[90m[39;49;00m
            (np.abs(np.random.randn([94m2[39;49;00m, [94m2[39;49;00m, [94m4[39;49;00m))),[90m[39;49;00m
        ],[90m[39;49;00m
    )[90m[39;49;00m
    [37m@pytest[39;49;00m.mark.parametrize([33m"[39;49;00m[33mextra_size[39;49;00m[33m"[39;49;00m, [([94m1[39;49;00m,), ([94m2[39;49;00m,), ([94m2[39;49;00m, [94m3[39;49;00m)])[90m[39;49;00m
    [94mdef[39;49;00m[90m [39;49;00m[92mtest_multinomial_vectorized[39;49;00m([96mself[39;49;00m, n, p, extra_size):[90m[39;49;00m
        n = np.array(n)[90m[39;49;00m
        p = np.array(p)[90m[39;49;00m
        p /= p.sum(axis=-[94m1[39;49;00m, keepdims=[94mTrue[39;49;00m)[90m[39;49;00m
    [90m[39;49;00m
        _, bcast_p = broadcast_params([n, p], ndims_params=[[94m0[39;49;00m, [94m1[39;49;00m])[90m[39;49;00m
        size = extra_size + bcast_p.shape[:-[94m1[39;49;00m][90m[39;49;00m
    [90m[39;49;00m
        mn = pm.Multinomial.dist(n=n, p=p, size=size)[90m[39;49;00m
        vals = mn.eval()[90m[39;49;00m
    [90m[39;49;00m
        npt.assert_almost_equal([90m[39;49;00m
            st.multinomial.logpmf(vals, n, p),[90m[39;49;00m
>           pm.logp(mn, vals).eval(),[90m[39;49;00m
            ^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
            decimal=[94m4[39;49;00m,[90m[39;49;00m
            err_msg=[33mf[39;49;00m[33m"[39;49;00m[33mvals=[39;49;00m[33m{[39;49;00mvals[33m}[39;49;00m[33m"[39;49;00m,[90m[39;49;00m
        )[90m[39;49;00m

[1m[31mtests/distributions/test_multivariate.py[0m:692:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/graph/basic.py[0m:668: in eval
    [0m[94mreturn[39;49;00m fn(*args)[90m[39;49;00m
           ^^^^^^^^^[90m[39;49;00m
[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/compile/function/types.py[0m:1048: in __call__
    [0mraise_with_op([90m[39;49;00m
[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/link/utils.py[0m:526: in raise_with_op
    [0m[94mraise[39;49;00m exc_value.with_traceback(exc_trace)[90m[39;49;00m
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <pytensor.compile.function.types.Function object at 0x7f0ba2ab2c30>
output_subset = None, args = (), kwargs = {}, trust_input = False
vm = <pytensor.link.c.cvm.CVM object at 0x7f0ba293a990>, profile = None

    [0m[94mdef[39;49;00m[90m [39;49;00m[92m__call__[39;49;00m([96mself[39;49;00m, *args, output_subset=[94mNone[39;49;00m, **kwargs):[90m[39;49;00m
    [90m    [39;49;00m[33m"""[39;49;00m
    [33m    Evaluates value of a function on given arguments.[39;49;00m
    [33m[39;49;00m
    [33m    Parameters[39;49;00m
    [33m    ----------[39;49;00m
    [33m    args : list[39;49;00m
    [33m        List of inputs to the function. All inputs are required, even when[39;49;00m
    [33m        some of them are not necessary to calculate requested subset of[39;49;00m
    [33m        outputs.[39;49;00m
    [33m[39;49;00m
    [33m    kwargs : dict[39;49;00m
    [33m        The function inputs can be passed as keyword argument. For this, use[39;49;00m
    [33m        the name of the input or the input instance as the key.[39;49;00m
    [33m[39;49;00m
    [33m        Keyword argument ``output_subset`` is a list of either indices of the[39;49;00m
    [33m        function's outputs or the keys belonging to the `output_keys` dict[39;49;00m
    [33m        and represent outputs that are requested to be calculated. Regardless[39;49;00m
    [33m        of the presence of ``output_subset``, the updates are always calculated[39;49;00m
    [33m        and processed. To disable the updates, you should use the ``copy``[39;49;00m
    [33m        method with ``delete_updates=True``.[39;49;00m
    [33m[39;49;00m
    [33m    Returns[39;49;00m
    [33m    -------[39;49;00m
    [33m    list[39;49;00m
    [33m        List of outputs on indices/keys from ``output_subset`` or all of them,[39;49;00m
    [33m        if ``output_subset`` is not passed.[39;49;00m
    [33m    """[39;49;00m[90m[39;49;00m
        trust_input = [96mself[39;49;00m.trust_input[90m[39;49;00m
        input_storage = [96mself[39;49;00m.input_storage[90m[39;49;00m
        vm = [96mself[39;49;00m.vm[90m[39;49;00m
        profile = [96mself[39;49;00m.profile[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0 = time.perf_counter()[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m output_subset [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
            warnings.warn([33m"[39;49;00m[33moutput_subset is deprecated.[39;49;00m[33m"[39;49;00m, [96mFutureWarning[39;49;00m)[90m[39;49;00m
            [94mif[39;49;00m [96mself[39;49;00m.output_keys [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                output_subset = [[96mself[39;49;00m.output_keys.index(key) [94mfor[39;49;00m key [95min[39;49;00m output_subset][90m[39;49;00m
    [90m[39;49;00m
        [90m# Reinitialize each container's 'provided' counter[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m trust_input:[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
        [94melse[39;49;00m:[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                arg_container.provided = [94m0[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
            [94mif[39;49;00m [96mlen[39;49;00m(args) + [96mlen[39;49;00m(kwargs) > [96mlen[39;49;00m(input_storage):[90m[39;49;00m
                [94mraise[39;49;00m [96mTypeError[39;49;00m([33m"[39;49;00m[33mToo many parameter passed to pytensor function[39;49;00m[33m"[39;49;00m)[90m[39;49;00m
    [90m[39;49;00m
            [90m# Set positional arguments[39;49;00m[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                [90m# See discussion about None as input[39;49;00m[90m[39;49;00m
                [90m# https://groups.google.com/group/theano-dev/browse_thread/thread/920a5e904e8a8525/4f1b311a28fc27e5[39;49;00m[90m[39;49;00m
                [94mif[39;49;00m arg [95mis[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                    arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
                [94melse[39;49;00m:[90m[39;49;00m
                    [94mtry[39;49;00m:[90m[39;49;00m
                        arg_container.storage[[94m0[39;49;00m] = arg_container.type.filter([90m[39;49;00m
                            arg,[90m[39;49;00m
                            strict=arg_container.strict,[90m[39;49;00m
                            allow_downcast=arg_container.allow_downcast,[90m[39;49;00m
                        )[90m[39;49;00m
    [90m[39;49;00m
                    [94mexcept[39;49;00m [96mException[39;49;00m [94mas[39;49;00m e:[90m[39;49;00m
                        i = input_storage.index(arg_container)[90m[39;49;00m
                        function_name = [33m"[39;49;00m[33mpytensor function[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        argument_name = [33m"[39;49;00m[33margument[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mself[39;49;00m.name:[90m[39;49;00m
                            function_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + [96mself[39;49;00m.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mhasattr[39;49;00m(arg, [33m"[39;49;00m[33mname[39;49;00m[33m"[39;49;00m) [95mand[39;49;00m arg.name:[90m[39;49;00m
                            argument_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + arg.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        where = get_variable_trace_string([96mself[39;49;00m.maker.inputs[i].variable)[90m[39;49;00m
                        [94mif[39;49;00m [96mlen[39;49;00m(e.args) == [94m1[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + e.args[[94m0[39;49;00m],[90m[39;49;00m
                            )[90m[39;49;00m
                        [94melse[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                            ) + e.args[90m[39;49;00m
                        [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                        [94mraise[39;49;00m[90m[39;49;00m
                arg_container.provided += [94m1[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
        [90m# Set keyword arguments[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m kwargs:  [90m# for speed, skip the items for empty kwargs[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m k, arg [95min[39;49;00m kwargs.items():[90m[39;49;00m
                [96mself[39;49;00m[k] = arg[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m [95mnot[39;49;00m trust_input:[90m[39;49;00m
            [90m# Collect aliased inputs among the storage space[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m potential_group [95min[39;49;00m [96mself[39;49;00m._potential_aliased_input_groups:[90m[39;49;00m
                args_share_memory: [96mlist[39;49;00m[[96mlist[39;49;00m[[96mint[39;49;00m]] = [][90m[39;49;00m
                [94mfor[39;49;00m i [95min[39;49;00m potential_group:[90m[39;49;00m
                    i_type = [96mself[39;49;00m.maker.inputs[i].variable.type[90m[39;49;00m
                    i_val = input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
    [90m[39;49;00m
                    [90m# Check if value is aliased with any of the values in one of the groups[39;49;00m[90m[39;49;00m
                    [94mfor[39;49;00m j_group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                        [94mif[39;49;00m [96many[39;49;00m([90m[39;49;00m
                            i_type.may_share_memory(input_storage[j].storage[[94m0[39;49;00m], i_val)[90m[39;49;00m
                            [94mfor[39;49;00m j [95min[39;49;00m j_group[90m[39;49;00m
                        ):[90m[39;49;00m
                            j_group.append(i)[90m[39;49;00m
                            [94mbreak[39;49;00m[90m[39;49;00m
                    [94melse[39;49;00m:  [90m# no break[39;49;00m[90m[39;49;00m
                        [90m# Create a new group[39;49;00m[90m[39;49;00m
                        args_share_memory.append([i])[90m[39;49;00m
    [90m[39;49;00m
                [90m# Check for groups of more than one argument that share memory[39;49;00m[90m[39;49;00m
                [94mfor[39;49;00m group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                    [94mif[39;49;00m [96mlen[39;49;00m(group) > [94m1[39;49;00m:[90m[39;49;00m
                        [90m# copy all but the first[39;49;00m[90m[39;49;00m
                        [94mfor[39;49;00m i [95min[39;49;00m group[[94m1[39;49;00m:]:[90m[39;49;00m
                            input_storage[i].storage[[94m0[39;49;00m] = copy.copy([90m[39;49;00m
                                input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
                            )[90m[39;49;00m
    [90m[39;49;00m
            [90m# Check if inputs are missing, or if inputs were set more than once, or[39;49;00m[90m[39;49;00m
            [90m# if we tried to provide inputs that are supposed to be implicit.[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                [94mif[39;49;00m arg_container.required [95mand[39;49;00m [95mnot[39;49;00m arg_container.provided:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMissing required input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.provided > [94m1[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMultiple values for input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.implicit [95mand[39;49;00m arg_container.provided > [94m0[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mTried to provide value for implicit input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
    [90m[39;49;00m
        [90m# Do the actual work[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0_fn = time.perf_counter()[90m[39;49;00m
        [94mtry[39;49;00m:[90m[39;49;00m
>           outputs = vm() [94mif[39;49;00m output_subset [95mis[39;49;00m [94mNone[39;49;00m [94melse[39;49;00m vm(output_subset=output_subset)[90m[39;49;00m
                      ^^^^[90m[39;49;00m
[1m[31mE           pymc.logprob.utils.ParameterValueError: [0m
[1m[31mE           Apply node that caused the error: Check{}([[[[-356.7 ... 410387]]]], False)[0m
[1m[31mE           Toposort index: 0[0m
[1m[31mE           Inputs types: [TensorType(float64, shape=(1, 1, 2, 2)), ScalarType(bool)][0m
[1m[31mE           Inputs shapes: [(1, 1, 2, 2), ()][0m
[1m[31mE           Inputs strides: [(32, 32, 16, 8), ()][0m
[1m[31mE           Inputs values: [array([[[[-356.73891998, -354.94716051],[0m
[1m[31mE                    [-346.42199915, -344.02410387]]]]), np.False_][0m
[1m[31mE           Inputs type_num: [12, 0][0m
[1m[31mE           Outputs clients: [[DeepCopyOp(Check{}.0)]][0m
[1m[31mE           [0m
[1m[31mE           Backtrace when the node is created (use PyTensor flag traceback__limit=N to make it longer):[0m
[1m[31mE             File "/app/pymc/logprob/basic.py", line 193, in logp[0m
[1m[31mE               return _logprob_helper(rv, value, **kwargs)[0m
[1m[31mE             File "/app/pymc/logprob/abstract.py", line 70, in _logprob_helper[0m
[1m[31mE               logprob = _logprob(rv.owner.op, values, *rv.owner.inputs, **kwargs)[0m
[1m[31mE             File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/functools.py", line 982, in wrapper[0m
[1m[31mE               return dispatch(args[0].__class__)(*args, **kw)[0m
[1m[31mE             File "/app/pymc/distributions/distribution.py", line 140, in logp[0m
[1m[31mE               return class_logp(value, *dist_params)[0m
[1m[31mE             File "/app/tests/distributions/test_dist_math.py", line 96, in logp[0m
[1m[31mE               return check_parameters([0m
[1m[31mE             File "/app/pymc/distributions/dist_math.py", line 72, in check_parameters[0m
[1m[31mE               return CheckParameterValue(msg, can_be_replaced_by_ninf)(expr, all_true_scalar)[0m
[1m[31mE             File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/graph/op.py", line 294, in __call__[0m
[1m[31mE               node = self.make_node(*inputs, **kwargs)[0m
[1m[31mE             File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/raise_op.py", line 81, in make_node[0m
[1m[31mE               [value.type()],[0m
[1m[31mE           [0m
[1m[31mE           Debug print of the apply node: [0m
[1m[31mE           Check{} [id A] <Tensor4(float64, shape=(1, 1, 2, 2))>[0m
[1m[31mE            ├─ [[[[-356.7 ... 410387]]]] [id B] <Tensor4(float64, shape=(1, 1, 2, 2))>[0m
[1m[31mE            └─ False [id C] <bool>[0m
[1m[31mE           [0m
[1m[31mE           Storage map footprint:[0m
[1m[31mE            - [[[[-356.7 ... 410387]]]], Shape: (1, 1, 2, 2), ElemSize: 8 Byte(s), TotalSize: 32 Byte(s)[0m
[1m[31mE            - False, Shape: (), ElemSize: 1 Byte(s), TotalSize: 1.0 Byte(s)[0m
[1m[31mE            TotalSize: 33.0 Byte(s) 0.000 GB[0m
[1m[31mE            TotalSize inputs: 33.0 Byte(s) 0.000 GB[0m

[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/compile/function/types.py[0m:1038: ParameterValueError
[31m[1m_________________ TestMatchesScipy.test_multinomial_zero_probs _________________[0m

self = <tests.distributions.test_multivariate.TestMatchesScipy object at 0x7f0bb35c7a20>

    [0m[94mdef[39;49;00m[90m [39;49;00m[92mtest_multinomial_zero_probs[39;49;00m([96mself[39;49;00m):[90m[39;49;00m
        [90m# test multinomial accepts 0 probabilities / observations:[39;49;00m[90m[39;49;00m
        mn = pm.Multinomial.dist(n=[94m100[39;49;00m, p=[[94m0.0[39;49;00m, [94m0.0[39;49;00m, [94m1.0[39;49;00m])[90m[39;49;00m
>       [94massert[39;49;00m pm.logp(mn, np.array([[94m0[39;49;00m, [94m0[39;49;00m, [94m100[39;49;00m])).eval() >= [94m0[39;49;00m[90m[39;49;00m
[1m[31mE       assert array(nan) >= 0[0m
[1m[31mE        +  where array(nan) = eval()[0m
[1m[31mE        +    where eval = Check{}.0.eval[0m
[1m[31mE        +      where Check{}.0 = <function logp at 0x7f0bb7ab61f0>(multinomial_rv{"(),(p)->(p)"}.out, array([  0,   0, 100]))[0m
[1m[31mE        +        where <function logp at 0x7f0bb7ab61f0> = pm.logp[0m
[1m[31mE        +        and   array([  0,   0, 100]) = <built-in function array>([0, 0, 100])[0m
[1m[31mE        +          where <built-in function array> = np.array[0m

[1m[31mtests/distributions/test_multivariate.py[0m:700: AssertionError
[31m[1m_______ TestMoments.test_multinomial_support_point[p3-10-None-expected3] _______[0m

self = <pytensor.compile.function.types.Function object at 0x7f0b9b2dc290>
output_subset = None, args = (), kwargs = {}, trust_input = False
vm = <pytensor.link.c.cvm.CVM object at 0x7f0ba148d4f0>, profile = None

    [0m[94mdef[39;49;00m[90m [39;49;00m[92m__call__[39;49;00m([96mself[39;49;00m, *args, output_subset=[94mNone[39;49;00m, **kwargs):[90m[39;49;00m
    [90m    [39;49;00m[33m"""[39;49;00m
    [33m    Evaluates value of a function on given arguments.[39;49;00m
    [33m[39;49;00m
    [33m    Parameters[39;49;00m
    [33m    ----------[39;49;00m
    [33m    args : list[39;49;00m
    [33m        List of inputs to the function. All inputs are required, even when[39;49;00m
    [33m        some of them are not necessary to calculate requested subset of[39;49;00m
    [33m        outputs.[39;49;00m
    [33m[39;49;00m
    [33m    kwargs : dict[39;49;00m
    [33m        The function inputs can be passed as keyword argument. For this, use[39;49;00m
    [33m        the name of the input or the input instance as the key.[39;49;00m
    [33m[39;49;00m
    [33m        Keyword argument ``output_subset`` is a list of either indices of the[39;49;00m
    [33m        function's outputs or the keys belonging to the `output_keys` dict[39;49;00m
    [33m        and represent outputs that are requested to be calculated. Regardless[39;49;00m
    [33m        of the presence of ``output_subset``, the updates are always calculated[39;49;00m
    [33m        and processed. To disable the updates, you should use the ``copy``[39;49;00m
    [33m        method with ``delete_updates=True``.[39;49;00m
    [33m[39;49;00m
    [33m    Returns[39;49;00m
    [33m    -------[39;49;00m
    [33m    list[39;49;00m
    [33m        List of outputs on indices/keys from ``output_subset`` or all of them,[39;49;00m
    [33m        if ``output_subset`` is not passed.[39;49;00m
    [33m    """[39;49;00m[90m[39;49;00m
        trust_input = [96mself[39;49;00m.trust_input[90m[39;49;00m
        input_storage = [96mself[39;49;00m.input_storage[90m[39;49;00m
        vm = [96mself[39;49;00m.vm[90m[39;49;00m
        profile = [96mself[39;49;00m.profile[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0 = time.perf_counter()[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m output_subset [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
            warnings.warn([33m"[39;49;00m[33moutput_subset is deprecated.[39;49;00m[33m"[39;49;00m, [96mFutureWarning[39;49;00m)[90m[39;49;00m
            [94mif[39;49;00m [96mself[39;49;00m.output_keys [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                output_subset = [[96mself[39;49;00m.output_keys.index(key) [94mfor[39;49;00m key [95min[39;49;00m output_subset][90m[39;49;00m
    [90m[39;49;00m
        [90m# Reinitialize each container's 'provided' counter[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m trust_input:[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
        [94melse[39;49;00m:[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                arg_container.provided = [94m0[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
            [94mif[39;49;00m [96mlen[39;49;00m(args) + [96mlen[39;49;00m(kwargs) > [96mlen[39;49;00m(input_storage):[90m[39;49;00m
                [94mraise[39;49;00m [96mTypeError[39;49;00m([33m"[39;49;00m[33mToo many parameter passed to pytensor function[39;49;00m[33m"[39;49;00m)[90m[39;49;00m
    [90m[39;49;00m
            [90m# Set positional arguments[39;49;00m[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                [90m# See discussion about None as input[39;49;00m[90m[39;49;00m
                [90m# https://groups.google.com/group/theano-dev/browse_thread/thread/920a5e904e8a8525/4f1b311a28fc27e5[39;49;00m[90m[39;49;00m
                [94mif[39;49;00m arg [95mis[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                    arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
                [94melse[39;49;00m:[90m[39;49;00m
                    [94mtry[39;49;00m:[90m[39;49;00m
                        arg_container.storage[[94m0[39;49;00m] = arg_container.type.filter([90m[39;49;00m
                            arg,[90m[39;49;00m
                            strict=arg_container.strict,[90m[39;49;00m
                            allow_downcast=arg_container.allow_downcast,[90m[39;49;00m
                        )[90m[39;49;00m
    [90m[39;49;00m
                    [94mexcept[39;49;00m [96mException[39;49;00m [94mas[39;49;00m e:[90m[39;49;00m
                        i = input_storage.index(arg_container)[90m[39;49;00m
                        function_name = [33m"[39;49;00m[33mpytensor function[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        argument_name = [33m"[39;49;00m[33margument[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mself[39;49;00m.name:[90m[39;49;00m
                            function_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + [96mself[39;49;00m.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mhasattr[39;49;00m(arg, [33m"[39;49;00m[33mname[39;49;00m[33m"[39;49;00m) [95mand[39;49;00m arg.name:[90m[39;49;00m
                            argument_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + arg.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        where = get_variable_trace_string([96mself[39;49;00m.maker.inputs[i].variable)[90m[39;49;00m
                        [94mif[39;49;00m [96mlen[39;49;00m(e.args) == [94m1[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + e.args[[94m0[39;49;00m],[90m[39;49;00m
                            )[90m[39;49;00m
                        [94melse[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                            ) + e.args[90m[39;49;00m
                        [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                        [94mraise[39;49;00m[90m[39;49;00m
                arg_container.provided += [94m1[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
        [90m# Set keyword arguments[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m kwargs:  [90m# for speed, skip the items for empty kwargs[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m k, arg [95min[39;49;00m kwargs.items():[90m[39;49;00m
                [96mself[39;49;00m[k] = arg[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m [95mnot[39;49;00m trust_input:[90m[39;49;00m
            [90m# Collect aliased inputs among the storage space[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m potential_group [95min[39;49;00m [96mself[39;49;00m._potential_aliased_input_groups:[90m[39;49;00m
                args_share_memory: [96mlist[39;49;00m[[96mlist[39;49;00m[[96mint[39;49;00m]] = [][90m[39;49;00m
                [94mfor[39;49;00m i [95min[39;49;00m potential_group:[90m[39;49;00m
                    i_type = [96mself[39;49;00m.maker.inputs[i].variable.type[90m[39;49;00m
                    i_val = input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
    [90m[39;49;00m
                    [90m# Check if value is aliased with any of the values in one of the groups[39;49;00m[90m[39;49;00m
                    [94mfor[39;49;00m j_group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                        [94mif[39;49;00m [96many[39;49;00m([90m[39;49;00m
                            i_type.may_share_memory(input_storage[j].storage[[94m0[39;49;00m], i_val)[90m[39;49;00m
                            [94mfor[39;49;00m j [95min[39;49;00m j_group[90m[39;49;00m
                        ):[90m[39;49;00m
                            j_group.append(i)[90m[39;49;00m
                            [94mbreak[39;49;00m[90m[39;49;00m
                    [94melse[39;49;00m:  [90m# no break[39;49;00m[90m[39;49;00m
                        [90m# Create a new group[39;49;00m[90m[39;49;00m
                        args_share_memory.append([i])[90m[39;49;00m
    [90m[39;49;00m
                [90m# Check for groups of more than one argument that share memory[39;49;00m[90m[39;49;00m
                [94mfor[39;49;00m group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                    [94mif[39;49;00m [96mlen[39;49;00m(group) > [94m1[39;49;00m:[90m[39;49;00m
                        [90m# copy all but the first[39;49;00m[90m[39;49;00m
                        [94mfor[39;49;00m i [95min[39;49;00m group[[94m1[39;49;00m:]:[90m[39;49;00m
                            input_storage[i].storage[[94m0[39;49;00m] = copy.copy([90m[39;49;00m
                                input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
                            )[90m[39;49;00m
    [90m[39;49;00m
            [90m# Check if inputs are missing, or if inputs were set more than once, or[39;49;00m[90m[39;49;00m
            [90m# if we tried to provide inputs that are supposed to be implicit.[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                [94mif[39;49;00m arg_container.required [95mand[39;49;00m [95mnot[39;49;00m arg_container.provided:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMissing required input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.provided > [94m1[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMultiple values for input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.implicit [95mand[39;49;00m arg_container.provided > [94m0[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mTried to provide value for implicit input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
    [90m[39;49;00m
        [90m# Do the actual work[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0_fn = time.perf_counter()[90m[39;49;00m
        [94mtry[39;49;00m:[90m[39;49;00m
>           outputs = vm() [94mif[39;49;00m output_subset [95mis[39;49;00m [94mNone[39;49;00m [94melse[39;49;00m vm(output_subset=output_subset)[90m[39;49;00m
                      ^^^^[90m[39;49;00m
[1m[31mE           pymc.logprob.utils.ParameterValueError[0m

[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/compile/function/types.py[0m:1038: ParameterValueError

[33mDuring handling of the above exception, another exception occurred:[0m

self = <tests.distributions.test_multivariate.TestMoments object at 0x7f0bb3567360>
p = array([[0.3 , 0.6 , 0.05, 0.05],
       [0.25, 0.25, 0.25, 0.25]]), n = 10
size = None, expected = array([[3, 7, 0, 0],
       [4, 2, 2, 2]])

    [0m[37m@pytest[39;49;00m.mark.parametrize([90m[39;49;00m
        [33m"[39;49;00m[33mp, n, size, expected[39;49;00m[33m"[39;49;00m,[90m[39;49;00m
        [[90m[39;49;00m
            (np.array([[94m0.25[39;49;00m, [94m0.25[39;49;00m, [94m0.25[39;49;00m, [94m0.25[39;49;00m]), [94m1[39;49;00m, [94mNone[39;49;00m, np.array([[94m1[39;49;00m, [94m0[39;49;00m, [94m0[39;49;00m, [94m0[39;49;00m])),[90m[39;49;00m
            (np.array([[94m0.3[39;49;00m, [94m0.6[39;49;00m, [94m0.05[39;49;00m, [94m0.05[39;49;00m]), [94m2[39;49;00m, [94mNone[39;49;00m, np.array([[94m1[39;49;00m, [94m1[39;49;00m, [94m0[39;49;00m, [94m0[39;49;00m])),[90m[39;49;00m
            (np.array([[94m0.3[39;49;00m, [94m0.6[39;49;00m, [94m0.05[39;49;00m, [94m0.05[39;49;00m]), [94m10[39;49;00m, [94mNone[39;49;00m, np.array([[94m3[39;49;00m, [94m7[39;49;00m, [94m0[39;49;00m, [94m0[39;49;00m])),[90m[39;49;00m
            ([90m[39;49;00m
                np.array([[[94m0.3[39;49;00m, [94m0.6[39;49;00m, [94m0.05[39;49;00m, [94m0.05[39;49;00m], [[94m0.25[39;49;00m, [94m0.25[39;49;00m, [94m0.25[39;49;00m, [94m0.25[39;49;00m]]),[90m[39;49;00m
                [94m10[39;49;00m,[90m[39;49;00m
                [94mNone[39;49;00m,[90m[39;49;00m
                np.array([[[94m3[39;49;00m, [94m7[39;49;00m, [94m0[39;49;00m, [94m0[39;49;00m], [[94m4[39;49;00m, [94m2[39;49;00m, [94m2[39;49;00m, [94m2[39;49;00m]]),[90m[39;49;00m
            ),[90m[39;49;00m
            ([90m[39;49;00m
                np.array([[94m0.3[39;49;00m, [94m0.6[39;49;00m, [94m0.05[39;49;00m, [94m0.05[39;49;00m]),[90m[39;49;00m
                np.array([[94m2[39;49;00m, [94m10[39;49;00m]),[90m[39;49;00m
                ([94m1[39;49;00m, [94m2[39;49;00m),[90m[39;49;00m
                np.array([[[[94m1[39;49;00m, [94m1[39;49;00m, [94m0[39;49;00m, [94m0[39;49;00m], [[94m3[39;49;00m, [94m7[39;49;00m, [94m0[39;49;00m, [94m0[39;49;00m]]]),[90m[39;49;00m
            ),[90m[39;49;00m
            ([90m[39;49;00m
                np.array([[[94m0.25[39;49;00m, [94m0.25[39;49;00m, [94m0.25[39;49;00m, [94m0.25[39;49;00m], [[94m0.26[39;49;00m, [94m0.26[39;49;00m, [94m0.26[39;49;00m, [94m0.22[39;49;00m]]),[90m[39;49;00m
                np.array([[94m1[39;49;00m, [94m10[39;49;00m]),[90m[39;49;00m
                [94mNone[39;49;00m,[90m[39;49;00m
                np.array([[[94m1[39;49;00m, [94m0[39;49;00m, [94m0[39;49;00m, [94m0[39;49;00m], [[94m2[39;49;00m, [94m3[39;49;00m, [94m3[39;49;00m, [94m2[39;49;00m]]),[90m[39;49;00m
            ),[90m[39;49;00m
            ([90m[39;49;00m
                np.array([[[94m0.25[39;49;00m, [94m0.25[39;49;00m, [94m0.25[39;49;00m, [94m0.25[39;49;00m], [[94m0.26[39;49;00m, [94m0.26[39;49;00m, [94m0.26[39;49;00m, [94m0.22[39;49;00m]]),[90m[39;49;00m
                np.array([[94m1[39;49;00m, [94m10[39;49;00m]),[90m[39;49;00m
                ([94m3[39;49;00m, [94m2[39;49;00m),[90m[39;49;00m
                np.full(([94m3[39;49;00m, [94m2[39;49;00m, [94m4[39;49;00m), [[[94m1[39;49;00m, [94m0[39;49;00m, [94m0[39;49;00m, [94m0[39;49;00m], [[94m2[39;49;00m, [94m3[39;49;00m, [94m3[39;49;00m, [94m2[39;49;00m]]),[90m[39;49;00m
            ),[90m[39;49;00m
            ([90m[39;49;00m
                np.array([[94m0.0[39;49;00m, [94m0.25[39;49;00m, [94m0.25[39;49;00m, [94m0.25[39;49;00m, [94m0.25[39;49;00m]),[90m[39;49;00m
                [94m1[39;49;00m,[90m[39;49;00m
                [94mNone[39;49;00m,[90m[39;49;00m
                np.array([[94m0[39;49;00m, [94m1[39;49;00m, [94m0[39;49;00m, [94m0[39;49;00m, [94m0[39;49;00m]),[90m[39;49;00m
            ),[90m[39;49;00m
            pytest.param([90m[39;49;00m
                np.array([[94m0.1441[39;49;00m, [94m0.1363[39;49;00m, [94m0.1385[39;49;00m, [94m0.1348[39;49;00m, [94m0.1521[39;49;00m, [94m0.1500[39;49;00m, [94m0.1442[39;49;00m]),[90m[39;49;00m
                [94m4[39;49;00m,[90m[39;49;00m
                [94mNone[39;49;00m,[90m[39;49;00m
                np.array([[94m1[39;49;00m, [94m1[39;49;00m, [94m1[39;49;00m, [94m1[39;49;00m, [94m0[39;49;00m, [94m0[39;49;00m, [94m0[39;49;00m]),[90m[39;49;00m
                marks=pytest.mark.xfail([90m[39;49;00m
                    rises=[96mAssertionError[39;49;00m, reason=[33m"[39;49;00m[33mKnown failure in mode approximation [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                ),[90m[39;49;00m
            ),[90m[39;49;00m
        ],[90m[39;49;00m
    )[90m[39;49;00m
    [94mdef[39;49;00m[90m [39;49;00m[92mtest_multinomial_support_point[39;49;00m([96mself[39;49;00m, p, n, size, expected):[90m[39;49;00m
        [94mwith[39;49;00m pm.Model() [94mas[39;49;00m model:[90m[39;49;00m
            pm.Multinomial([33m"[39;49;00m[33mx[39;49;00m[33m"[39;49;00m, n=n, p=p, size=size)[90m[39;49;00m
>       assert_support_point_is_expected(model, expected)[90m[39;49;00m

[1m[31mtests/distributions/test_multivariate.py[0m:1065:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
[1m[31mpymc/testing.py[0m:742: in assert_support_point_is_expected
    [0m.eval()[90m[39;49;00m
     ^^^^^^[90m[39;49;00m
[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/graph/basic.py[0m:668: in eval
    [0m[94mreturn[39;49;00m fn(*args)[90m[39;49;00m
           ^^^^^^^^^[90m[39;49;00m
[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/compile/function/types.py[0m:1048: in __call__
    [0mraise_with_op([90m[39;49;00m
[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/link/utils.py[0m:526: in raise_with_op
    [0m[94mraise[39;49;00m exc_value.with_traceback(exc_trace)[90m[39;49;00m
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <pytensor.compile.function.types.Function object at 0x7f0b9b2dc290>
output_subset = None, args = (), kwargs = {}, trust_input = False
vm = <pytensor.link.c.cvm.CVM object at 0x7f0ba148d4f0>, profile = None

    [0m[94mdef[39;49;00m[90m [39;49;00m[92m__call__[39;49;00m([96mself[39;49;00m, *args, output_subset=[94mNone[39;49;00m, **kwargs):[90m[39;49;00m
    [90m    [39;49;00m[33m"""[39;49;00m
    [33m    Evaluates value of a function on given arguments.[39;49;00m
    [33m[39;49;00m
    [33m    Parameters[39;49;00m
    [33m    ----------[39;49;00m
    [33m    args : list[39;49;00m
    [33m        List of inputs to the function. All inputs are required, even when[39;49;00m
    [33m        some of them are not necessary to calculate requested subset of[39;49;00m
    [33m        outputs.[39;49;00m
    [33m[39;49;00m
    [33m    kwargs : dict[39;49;00m
    [33m        The function inputs can be passed as keyword argument. For this, use[39;49;00m
    [33m        the name of the input or the input instance as the key.[39;49;00m
    [33m[39;49;00m
    [33m        Keyword argument ``output_subset`` is a list of either indices of the[39;49;00m
    [33m        function's outputs or the keys belonging to the `output_keys` dict[39;49;00m
    [33m        and represent outputs that are requested to be calculated. Regardless[39;49;00m
    [33m        of the presence of ``output_subset``, the updates are always calculated[39;49;00m
    [33m        and processed. To disable the updates, you should use the ``copy``[39;49;00m
    [33m        method with ``delete_updates=True``.[39;49;00m
    [33m[39;49;00m
    [33m    Returns[39;49;00m
    [33m    -------[39;49;00m
    [33m    list[39;49;00m
    [33m        List of outputs on indices/keys from ``output_subset`` or all of them,[39;49;00m
    [33m        if ``output_subset`` is not passed.[39;49;00m
    [33m    """[39;49;00m[90m[39;49;00m
        trust_input = [96mself[39;49;00m.trust_input[90m[39;49;00m
        input_storage = [96mself[39;49;00m.input_storage[90m[39;49;00m
        vm = [96mself[39;49;00m.vm[90m[39;49;00m
        profile = [96mself[39;49;00m.profile[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0 = time.perf_counter()[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m output_subset [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
            warnings.warn([33m"[39;49;00m[33moutput_subset is deprecated.[39;49;00m[33m"[39;49;00m, [96mFutureWarning[39;49;00m)[90m[39;49;00m
            [94mif[39;49;00m [96mself[39;49;00m.output_keys [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                output_subset = [[96mself[39;49;00m.output_keys.index(key) [94mfor[39;49;00m key [95min[39;49;00m output_subset][90m[39;49;00m
    [90m[39;49;00m
        [90m# Reinitialize each container's 'provided' counter[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m trust_input:[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
        [94melse[39;49;00m:[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                arg_container.provided = [94m0[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
            [94mif[39;49;00m [96mlen[39;49;00m(args) + [96mlen[39;49;00m(kwargs) > [96mlen[39;49;00m(input_storage):[90m[39;49;00m
                [94mraise[39;49;00m [96mTypeError[39;49;00m([33m"[39;49;00m[33mToo many parameter passed to pytensor function[39;49;00m[33m"[39;49;00m)[90m[39;49;00m
    [90m[39;49;00m
            [90m# Set positional arguments[39;49;00m[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                [90m# See discussion about None as input[39;49;00m[90m[39;49;00m
                [90m# https://groups.google.com/group/theano-dev/browse_thread/thread/920a5e904e8a8525/4f1b311a28fc27e5[39;49;00m[90m[39;49;00m
                [94mif[39;49;00m arg [95mis[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                    arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
                [94melse[39;49;00m:[90m[39;49;00m
                    [94mtry[39;49;00m:[90m[39;49;00m
                        arg_container.storage[[94m0[39;49;00m] = arg_container.type.filter([90m[39;49;00m
                            arg,[90m[39;49;00m
                            strict=arg_container.strict,[90m[39;49;00m
                            allow_downcast=arg_container.allow_downcast,[90m[39;49;00m
                        )[90m[39;49;00m
    [90m[39;49;00m
                    [94mexcept[39;49;00m [96mException[39;49;00m [94mas[39;49;00m e:[90m[39;49;00m
                        i = input_storage.index(arg_container)[90m[39;49;00m
                        function_name = [33m"[39;49;00m[33mpytensor function[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        argument_name = [33m"[39;49;00m[33margument[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mself[39;49;00m.name:[90m[39;49;00m
                            function_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + [96mself[39;49;00m.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mhasattr[39;49;00m(arg, [33m"[39;49;00m[33mname[39;49;00m[33m"[39;49;00m) [95mand[39;49;00m arg.name:[90m[39;49;00m
                            argument_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + arg.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        where = get_variable_trace_string([96mself[39;49;00m.maker.inputs[i].variable)[90m[39;49;00m
                        [94mif[39;49;00m [96mlen[39;49;00m(e.args) == [94m1[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + e.args[[94m0[39;49;00m],[90m[39;49;00m
                            )[90m[39;49;00m
                        [94melse[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                            ) + e.args[90m[39;49;00m
                        [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                        [94mraise[39;49;00m[90m[39;49;00m
                arg_container.provided += [94m1[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
        [90m# Set keyword arguments[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m kwargs:  [90m# for speed, skip the items for empty kwargs[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m k, arg [95min[39;49;00m kwargs.items():[90m[39;49;00m
                [96mself[39;49;00m[k] = arg[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m [95mnot[39;49;00m trust_input:[90m[39;49;00m
            [90m# Collect aliased inputs among the storage space[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m potential_group [95min[39;49;00m [96mself[39;49;00m._potential_aliased_input_groups:[90m[39;49;00m
                args_share_memory: [96mlist[39;49;00m[[96mlist[39;49;00m[[96mint[39;49;00m]] = [][90m[39;49;00m
                [94mfor[39;49;00m i [95min[39;49;00m potential_group:[90m[39;49;00m
                    i_type = [96mself[39;49;00m.maker.inputs[i].variable.type[90m[39;49;00m
                    i_val = input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
    [90m[39;49;00m
                    [90m# Check if value is aliased with any of the values in one of the groups[39;49;00m[90m[39;49;00m
                    [94mfor[39;49;00m j_group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                        [94mif[39;49;00m [96many[39;49;00m([90m[39;49;00m
                            i_type.may_share_memory(input_storage[j].storage[[94m0[39;49;00m], i_val)[90m[39;49;00m
                            [94mfor[39;49;00m j [95min[39;49;00m j_group[90m[39;49;00m
                        ):[90m[39;49;00m
                            j_group.append(i)[90m[39;49;00m
                            [94mbreak[39;49;00m[90m[39;49;00m
                    [94melse[39;49;00m:  [90m# no break[39;49;00m[90m[39;49;00m
                        [90m# Create a new group[39;49;00m[90m[39;49;00m
                        args_share_memory.append([i])[90m[39;49;00m
    [90m[39;49;00m
                [90m# Check for groups of more than one argument that share memory[39;49;00m[90m[39;49;00m
                [94mfor[39;49;00m group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                    [94mif[39;49;00m [96mlen[39;49;00m(group) > [94m1[39;49;00m:[90m[39;49;00m
                        [90m# copy all but the first[39;49;00m[90m[39;49;00m
                        [94mfor[39;49;00m i [95min[39;49;00m group[[94m1[39;49;00m:]:[90m[39;49;00m
                            input_storage[i].storage[[94m0[39;49;00m] = copy.copy([90m[39;49;00m
                                input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
                            )[90m[39;49;00m
    [90m[39;49;00m
            [90m# Check if inputs are missing, or if inputs were set more than once, or[39;49;00m[90m[39;49;00m
            [90m# if we tried to provide inputs that are supposed to be implicit.[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                [94mif[39;49;00m arg_container.required [95mand[39;49;00m [95mnot[39;49;00m arg_container.provided:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMissing required input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.provided > [94m1[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMultiple values for input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.implicit [95mand[39;49;00m arg_container.provided > [94m0[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mTried to provide value for implicit input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
    [90m[39;49;00m
        [90m# Do the actual work[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0_fn = time.perf_counter()[90m[39;49;00m
        [94mtry[39;49;00m:[90m[39;49;00m
>           outputs = vm() [94mif[39;49;00m output_subset [95mis[39;49;00m [94mNone[39;49;00m [94melse[39;49;00m vm(output_subset=output_subset)[90m[39;49;00m
                      ^^^^[90m[39;49;00m
[1m[31mE           pymc.logprob.utils.ParameterValueError: [0m
[1m[31mE           Apply node that caused the error: Check{}([-21.52064456], False)[0m
[1m[31mE           Toposort index: 0[0m
[1m[31mE           Inputs types: [TensorType(float64, shape=(1,)), ScalarType(bool)][0m
[1m[31mE           Inputs shapes: [(1,), ()][0m
[1m[31mE           Inputs strides: [(8,), ()][0m
[1m[31mE           Inputs values: [array([-21.52064456]), np.False_][0m
[1m[31mE           Inputs type_num: [12, 0][0m
[1m[31mE           Outputs clients: [[Squeeze{axis=0}(Check{}.0)]][0m
[1m[31mE           [0m
[1m[31mE           Backtrace when the node is created (use PyTensor flag traceback__limit=N to make it longer):[0m
[1m[31mE             File "/app/pymc/logprob/basic.py", line 574, in transformed_conditional_logp[0m
[1m[31mE               temp_logp_terms = conditional_logp([0m
[1m[31mE             File "/app/pymc/logprob/basic.py", line 504, in conditional_logp[0m
[1m[31mE               node_logprobs = _logprob([0m
[1m[31mE             File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/functools.py", line 982, in wrapper[0m
[1m[31mE               return dispatch(args[0].__class__)(*args, **kw)[0m
[1m[31mE             File "/app/pymc/distributions/distribution.py", line 140, in logp[0m
[1m[31mE               return class_logp(value, *dist_params)[0m
[1m[31mE             File "/app/tests/distributions/test_dist_math.py", line 96, in logp[0m
[1m[31mE               return check_parameters([0m
[1m[31mE             File "/app/pymc/distributions/dist_math.py", line 72, in check_parameters[0m
[1m[31mE               return CheckParameterValue(msg, can_be_replaced_by_ninf)(expr, all_true_scalar)[0m
[1m[31mE             File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/graph/op.py", line 294, in __call__[0m
[1m[31mE               node = self.make_node(*inputs, **kwargs)[0m
[1m[31mE             File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/raise_op.py", line 81, in make_node[0m
[1m[31mE               [value.type()],[0m
[1m[31mE           [0m
[1m[31mE           Debug print of the apply node: [0m
[1m[31mE           Check{} [id A] <Vector(float64, shape=(1,))>[0m
[1m[31mE            ├─ [-21.52064456] [id B] <Vector(float64, shape=(1,))>[0m
[1m[31mE            └─ False [id C] <bool>[0m
[1m[31mE           [0m
[1m[31mE           Storage map footprint:[0m
[1m[31mE            - [-21.52064456], Shape: (1,), ElemSize: 8 Byte(s), TotalSize: 8 Byte(s)[0m
[1m[31mE            - False, Shape: (), ElemSize: 1 Byte(s), TotalSize: 1.0 Byte(s)[0m
[1m[31mE            TotalSize: 9.0 Byte(s) 0.000 GB[0m
[1m[31mE            TotalSize inputs: 9.0 Byte(s) 0.000 GB[0m

[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/compile/function/types.py[0m:1038: ParameterValueError
[31m[1m_______ TestMoments.test_multinomial_support_point[p5-n5-None-expected5] _______[0m

self = <pytensor.compile.function.types.Function object at 0x7f0b9db817f0>
output_subset = None, args = (), kwargs = {}, trust_input = False
vm = <pytensor.link.c.cvm.CVM object at 0x7f0ba293b1d0>, profile = None

    [0m[94mdef[39;49;00m[90m [39;49;00m[92m__call__[39;49;00m([96mself[39;49;00m, *args, output_subset=[94mNone[39;49;00m, **kwargs):[90m[39;49;00m
    [90m    [39;49;00m[33m"""[39;49;00m
    [33m    Evaluates value of a function on given arguments.[39;49;00m
    [33m[39;49;00m
    [33m    Parameters[39;49;00m
    [33m    ----------[39;49;00m
    [33m    args : list[39;49;00m
    [33m        List of inputs to the function. All inputs are required, even when[39;49;00m
    [33m        some of them are not necessary to calculate requested subset of[39;49;00m
    [33m        outputs.[39;49;00m
    [33m[39;49;00m
    [33m    kwargs : dict[39;49;00m
    [33m        The function inputs can be passed as keyword argument. For this, use[39;49;00m
    [33m        the name of the input or the input instance as the key.[39;49;00m
    [33m[39;49;00m
    [33m        Keyword argument ``output_subset`` is a list of either indices of the[39;49;00m
    [33m        function's outputs or the keys belonging to the `output_keys` dict[39;49;00m
    [33m        and represent outputs that are requested to be calculated. Regardless[39;49;00m
    [33m        of the presence of ``output_subset``, the updates are always calculated[39;49;00m
    [33m        and processed. To disable the updates, you should use the ``copy``[39;49;00m
    [33m        method with ``delete_updates=True``.[39;49;00m
    [33m[39;49;00m
    [33m    Returns[39;49;00m
    [33m    -------[39;49;00m
    [33m    list[39;49;00m
    [33m        List of outputs on indices/keys from ``output_subset`` or all of them,[39;49;00m
    [33m        if ``output_subset`` is not passed.[39;49;00m
    [33m    """[39;49;00m[90m[39;49;00m
        trust_input = [96mself[39;49;00m.trust_input[90m[39;49;00m
        input_storage = [96mself[39;49;00m.input_storage[90m[39;49;00m
        vm = [96mself[39;49;00m.vm[90m[39;49;00m
        profile = [96mself[39;49;00m.profile[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0 = time.perf_counter()[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m output_subset [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
            warnings.warn([33m"[39;49;00m[33moutput_subset is deprecated.[39;49;00m[33m"[39;49;00m, [96mFutureWarning[39;49;00m)[90m[39;49;00m
            [94mif[39;49;00m [96mself[39;49;00m.output_keys [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                output_subset = [[96mself[39;49;00m.output_keys.index(key) [94mfor[39;49;00m key [95min[39;49;00m output_subset][90m[39;49;00m
    [90m[39;49;00m
        [90m# Reinitialize each container's 'provided' counter[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m trust_input:[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
        [94melse[39;49;00m:[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                arg_container.provided = [94m0[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
            [94mif[39;49;00m [96mlen[39;49;00m(args) + [96mlen[39;49;00m(kwargs) > [96mlen[39;49;00m(input_storage):[90m[39;49;00m
                [94mraise[39;49;00m [96mTypeError[39;49;00m([33m"[39;49;00m[33mToo many parameter passed to pytensor function[39;49;00m[33m"[39;49;00m)[90m[39;49;00m
    [90m[39;49;00m
            [90m# Set positional arguments[39;49;00m[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                [90m# See discussion about None as input[39;49;00m[90m[39;49;00m
                [90m# https://groups.google.com/group/theano-dev/browse_thread/thread/920a5e904e8a8525/4f1b311a28fc27e5[39;49;00m[90m[39;49;00m
                [94mif[39;49;00m arg [95mis[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                    arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
                [94melse[39;49;00m:[90m[39;49;00m
                    [94mtry[39;49;00m:[90m[39;49;00m
                        arg_container.storage[[94m0[39;49;00m] = arg_container.type.filter([90m[39;49;00m
                            arg,[90m[39;49;00m
                            strict=arg_container.strict,[90m[39;49;00m
                            allow_downcast=arg_container.allow_downcast,[90m[39;49;00m
                        )[90m[39;49;00m
    [90m[39;49;00m
                    [94mexcept[39;49;00m [96mException[39;49;00m [94mas[39;49;00m e:[90m[39;49;00m
                        i = input_storage.index(arg_container)[90m[39;49;00m
                        function_name = [33m"[39;49;00m[33mpytensor function[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        argument_name = [33m"[39;49;00m[33margument[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mself[39;49;00m.name:[90m[39;49;00m
                            function_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + [96mself[39;49;00m.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mhasattr[39;49;00m(arg, [33m"[39;49;00m[33mname[39;49;00m[33m"[39;49;00m) [95mand[39;49;00m arg.name:[90m[39;49;00m
                            argument_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + arg.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        where = get_variable_trace_string([96mself[39;49;00m.maker.inputs[i].variable)[90m[39;49;00m
                        [94mif[39;49;00m [96mlen[39;49;00m(e.args) == [94m1[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + e.args[[94m0[39;49;00m],[90m[39;49;00m
                            )[90m[39;49;00m
                        [94melse[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                            ) + e.args[90m[39;49;00m
                        [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                        [94mraise[39;49;00m[90m[39;49;00m
                arg_container.provided += [94m1[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
        [90m# Set keyword arguments[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m kwargs:  [90m# for speed, skip the items for empty kwargs[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m k, arg [95min[39;49;00m kwargs.items():[90m[39;49;00m
                [96mself[39;49;00m[k] = arg[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m [95mnot[39;49;00m trust_input:[90m[39;49;00m
            [90m# Collect aliased inputs among the storage space[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m potential_group [95min[39;49;00m [96mself[39;49;00m._potential_aliased_input_groups:[90m[39;49;00m
                args_share_memory: [96mlist[39;49;00m[[96mlist[39;49;00m[[96mint[39;49;00m]] = [][90m[39;49;00m
                [94mfor[39;49;00m i [95min[39;49;00m potential_group:[90m[39;49;00m
                    i_type = [96mself[39;49;00m.maker.inputs[i].variable.type[90m[39;49;00m
                    i_val = input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
    [90m[39;49;00m
                    [90m# Check if value is aliased with any of the values in one of the groups[39;49;00m[90m[39;49;00m
                    [94mfor[39;49;00m j_group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                        [94mif[39;49;00m [96many[39;49;00m([90m[39;49;00m
                            i_type.may_share_memory(input_storage[j].storage[[94m0[39;49;00m], i_val)[90m[39;49;00m
                            [94mfor[39;49;00m j [95min[39;49;00m j_group[90m[39;49;00m
                        ):[90m[39;49;00m
                            j_group.append(i)[90m[39;49;00m
                            [94mbreak[39;49;00m[90m[39;49;00m
                    [94melse[39;49;00m:  [90m# no break[39;49;00m[90m[39;49;00m
                        [90m# Create a new group[39;49;00m[90m[39;49;00m
                        args_share_memory.append([i])[90m[39;49;00m
    [90m[39;49;00m
                [90m# Check for groups of more than one argument that share memory[39;49;00m[90m[39;49;00m
                [94mfor[39;49;00m group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                    [94mif[39;49;00m [96mlen[39;49;00m(group) > [94m1[39;49;00m:[90m[39;49;00m
                        [90m# copy all but the first[39;49;00m[90m[39;49;00m
                        [94mfor[39;49;00m i [95min[39;49;00m group[[94m1[39;49;00m:]:[90m[39;49;00m
                            input_storage[i].storage[[94m0[39;49;00m] = copy.copy([90m[39;49;00m
                                input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
                            )[90m[39;49;00m
    [90m[39;49;00m
            [90m# Check if inputs are missing, or if inputs were set more than once, or[39;49;00m[90m[39;49;00m
            [90m# if we tried to provide inputs that are supposed to be implicit.[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                [94mif[39;49;00m arg_container.required [95mand[39;49;00m [95mnot[39;49;00m arg_container.provided:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMissing required input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.provided > [94m1[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMultiple values for input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.implicit [95mand[39;49;00m arg_container.provided > [94m0[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mTried to provide value for implicit input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
    [90m[39;49;00m
        [90m# Do the actual work[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0_fn = time.perf_counter()[90m[39;49;00m
        [94mtry[39;49;00m:[90m[39;49;00m
>           outputs = vm() [94mif[39;49;00m output_subset [95mis[39;49;00m [94mNone[39;49;00m [94melse[39;49;00m vm(output_subset=output_subset)[90m[39;49;00m
                      ^^^^[90m[39;49;00m
[1m[31mE           pymc.logprob.utils.ParameterValueError[0m

[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/compile/function/types.py[0m:1038: ParameterValueError

[33mDuring handling of the above exception, another exception occurred:[0m

self = <tests.distributions.test_multivariate.TestMoments object at 0x7f0bb4fc2690>
p = array([[0.25, 0.25, 0.25, 0.25],
       [0.26, 0.26, 0.26, 0.22]])
n = array([ 1, 10]), size = None
expected = array([[1, 0, 0, 0],
       [2, 3, 3, 2]])

    [0m[37m@pytest[39;49;00m.mark.parametrize([90m[39;49;00m
        [33m"[39;49;00m[33mp, n, size, expected[39;49;00m[33m"[39;49;00m,[90m[39;49;00m
        [[90m[39;49;00m
            (np.array([[94m0.25[39;49;00m, [94m0.25[39;49;00m, [94m0.25[39;49;00m, [94m0.25[39;49;00m]), [94m1[39;49;00m, [94mNone[39;49;00m, np.array([[94m1[39;49;00m, [94m0[39;49;00m, [94m0[39;49;00m, [94m0[39;49;00m])),[90m[39;49;00m
            (np.array([[94m0.3[39;49;00m, [94m0.6[39;49;00m, [94m0.05[39;49;00m, [94m0.05[39;49;00m]), [94m2[39;49;00m, [94mNone[39;49;00m, np.array([[94m1[39;49;00m, [94m1[39;49;00m, [94m0[39;49;00m, [94m0[39;49;00m])),[90m[39;49;00m
            (np.array([[94m0.3[39;49;00m, [94m0.6[39;49;00m, [94m0.05[39;49;00m, [94m0.05[39;49;00m]), [94m10[39;49;00m, [94mNone[39;49;00m, np.array([[94m3[39;49;00m, [94m7[39;49;00m, [94m0[39;49;00m, [94m0[39;49;00m])),[90m[39;49;00m
            ([90m[39;49;00m
                np.array([[[94m0.3[39;49;00m, [94m0.6[39;49;00m, [94m0.05[39;49;00m, [94m0.05[39;49;00m], [[94m0.25[39;49;00m, [94m0.25[39;49;00m, [94m0.25[39;49;00m, [94m0.25[39;49;00m]]),[90m[39;49;00m
                [94m10[39;49;00m,[90m[39;49;00m
                [94mNone[39;49;00m,[90m[39;49;00m
                np.array([[[94m3[39;49;00m, [94m7[39;49;00m, [94m0[39;49;00m, [94m0[39;49;00m], [[94m4[39;49;00m, [94m2[39;49;00m, [94m2[39;49;00m, [94m2[39;49;00m]]),[90m[39;49;00m
            ),[90m[39;49;00m
            ([90m[39;49;00m
                np.array([[94m0.3[39;49;00m, [94m0.6[39;49;00m, [94m0.05[39;49;00m, [94m0.05[39;49;00m]),[90m[39;49;00m
                np.array([[94m2[39;49;00m, [94m10[39;49;00m]),[90m[39;49;00m
                ([94m1[39;49;00m, [94m2[39;49;00m),[90m[39;49;00m
                np.array([[[[94m1[39;49;00m, [94m1[39;49;00m, [94m0[39;49;00m, [94m0[39;49;00m], [[94m3[39;49;00m, [94m7[39;49;00m, [94m0[39;49;00m, [94m0[39;49;00m]]]),[90m[39;49;00m
            ),[90m[39;49;00m
            ([90m[39;49;00m
                np.array([[[94m0.25[39;49;00m, [94m0.25[39;49;00m, [94m0.25[39;49;00m, [94m0.25[39;49;00m], [[94m0.26[39;49;00m, [94m0.26[39;49;00m, [94m0.26[39;49;00m, [94m0.22[39;49;00m]]),[90m[39;49;00m
                np.array([[94m1[39;49;00m, [94m10[39;49;00m]),[90m[39;49;00m
                [94mNone[39;49;00m,[90m[39;49;00m
                np.array([[[94m1[39;49;00m, [94m0[39;49;00m, [94m0[39;49;00m, [94m0[39;49;00m], [[94m2[39;49;00m, [94m3[39;49;00m, [94m3[39;49;00m, [94m2[39;49;00m]]),[90m[39;49;00m
            ),[90m[39;49;00m
            ([90m[39;49;00m
                np.array([[[94m0.25[39;49;00m, [94m0.25[39;49;00m, [94m0.25[39;49;00m, [94m0.25[39;49;00m], [[94m0.26[39;49;00m, [94m0.26[39;49;00m, [94m0.26[39;49;00m, [94m0.22[39;49;00m]]),[90m[39;49;00m
                np.array([[94m1[39;49;00m, [94m10[39;49;00m]),[90m[39;49;00m
                ([94m3[39;49;00m, [94m2[39;49;00m),[90m[39;49;00m
                np.full(([94m3[39;49;00m, [94m2[39;49;00m, [94m4[39;49;00m), [[[94m1[39;49;00m, [94m0[39;49;00m, [94m0[39;49;00m, [94m0[39;49;00m], [[94m2[39;49;00m, [94m3[39;49;00m, [94m3[39;49;00m, [94m2[39;49;00m]]),[90m[39;49;00m
            ),[90m[39;49;00m
            ([90m[39;49;00m
                np.array([[94m0.0[39;49;00m, [94m0.25[39;49;00m, [94m0.25[39;49;00m, [94m0.25[39;49;00m, [94m0.25[39;49;00m]),[90m[39;49;00m
                [94m1[39;49;00m,[90m[39;49;00m
                [94mNone[39;49;00m,[90m[39;49;00m
                np.array([[94m0[39;49;00m, [94m1[39;49;00m, [94m0[39;49;00m, [94m0[39;49;00m, [94m0[39;49;00m]),[90m[39;49;00m
            ),[90m[39;49;00m
            pytest.param([90m[39;49;00m
                np.array([[94m0.1441[39;49;00m, [94m0.1363[39;49;00m, [94m0.1385[39;49;00m, [94m0.1348[39;49;00m, [94m0.1521[39;49;00m, [94m0.1500[39;49;00m, [94m0.1442[39;49;00m]),[90m[39;49;00m
                [94m4[39;49;00m,[90m[39;49;00m
                [94mNone[39;49;00m,[90m[39;49;00m
                np.array([[94m1[39;49;00m, [94m1[39;49;00m, [94m1[39;49;00m, [94m1[39;49;00m, [94m0[39;49;00m, [94m0[39;49;00m, [94m0[39;49;00m]),[90m[39;49;00m
                marks=pytest.mark.xfail([90m[39;49;00m
                    rises=[96mAssertionError[39;49;00m, reason=[33m"[39;49;00m[33mKnown failure in mode approximation [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                ),[90m[39;49;00m
            ),[90m[39;49;00m
        ],[90m[39;49;00m
    )[90m[39;49;00m
    [94mdef[39;49;00m[90m [39;49;00m[92mtest_multinomial_support_point[39;49;00m([96mself[39;49;00m, p, n, size, expected):[90m[39;49;00m
        [94mwith[39;49;00m pm.Model() [94mas[39;49;00m model:[90m[39;49;00m
            pm.Multinomial([33m"[39;49;00m[33mx[39;49;00m[33m"[39;49;00m, n=n, p=p, size=size)[90m[39;49;00m
>       assert_support_point_is_expected(model, expected)[90m[39;49;00m

[1m[31mtests/distributions/test_multivariate.py[0m:1065:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
[1m[31mpymc/testing.py[0m:742: in assert_support_point_is_expected
    [0m.eval()[90m[39;49;00m
     ^^^^^^[90m[39;49;00m
[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/graph/basic.py[0m:668: in eval
    [0m[94mreturn[39;49;00m fn(*args)[90m[39;49;00m
           ^^^^^^^^^[90m[39;49;00m
[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/compile/function/types.py[0m:1048: in __call__
    [0mraise_with_op([90m[39;49;00m
[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/link/utils.py[0m:526: in raise_with_op
    [0m[94mraise[39;49;00m exc_value.with_traceback(exc_trace)[90m[39;49;00m
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <pytensor.compile.function.types.Function object at 0x7f0b9db817f0>
output_subset = None, args = (), kwargs = {}, trust_input = False
vm = <pytensor.link.c.cvm.CVM object at 0x7f0ba293b1d0>, profile = None

    [0m[94mdef[39;49;00m[90m [39;49;00m[92m__call__[39;49;00m([96mself[39;49;00m, *args, output_subset=[94mNone[39;49;00m, **kwargs):[90m[39;49;00m
    [90m    [39;49;00m[33m"""[39;49;00m
    [33m    Evaluates value of a function on given arguments.[39;49;00m
    [33m[39;49;00m
    [33m    Parameters[39;49;00m
    [33m    ----------[39;49;00m
    [33m    args : list[39;49;00m
    [33m        List of inputs to the function. All inputs are required, even when[39;49;00m
    [33m        some of them are not necessary to calculate requested subset of[39;49;00m
    [33m        outputs.[39;49;00m
    [33m[39;49;00m
    [33m    kwargs : dict[39;49;00m
    [33m        The function inputs can be passed as keyword argument. For this, use[39;49;00m
    [33m        the name of the input or the input instance as the key.[39;49;00m
    [33m[39;49;00m
    [33m        Keyword argument ``output_subset`` is a list of either indices of the[39;49;00m
    [33m        function's outputs or the keys belonging to the `output_keys` dict[39;49;00m
    [33m        and represent outputs that are requested to be calculated. Regardless[39;49;00m
    [33m        of the presence of ``output_subset``, the updates are always calculated[39;49;00m
    [33m        and processed. To disable the updates, you should use the ``copy``[39;49;00m
    [33m        method with ``delete_updates=True``.[39;49;00m
    [33m[39;49;00m
    [33m    Returns[39;49;00m
    [33m    -------[39;49;00m
    [33m    list[39;49;00m
    [33m        List of outputs on indices/keys from ``output_subset`` or all of them,[39;49;00m
    [33m        if ``output_subset`` is not passed.[39;49;00m
    [33m    """[39;49;00m[90m[39;49;00m
        trust_input = [96mself[39;49;00m.trust_input[90m[39;49;00m
        input_storage = [96mself[39;49;00m.input_storage[90m[39;49;00m
        vm = [96mself[39;49;00m.vm[90m[39;49;00m
        profile = [96mself[39;49;00m.profile[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0 = time.perf_counter()[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m output_subset [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
            warnings.warn([33m"[39;49;00m[33moutput_subset is deprecated.[39;49;00m[33m"[39;49;00m, [96mFutureWarning[39;49;00m)[90m[39;49;00m
            [94mif[39;49;00m [96mself[39;49;00m.output_keys [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                output_subset = [[96mself[39;49;00m.output_keys.index(key) [94mfor[39;49;00m key [95min[39;49;00m output_subset][90m[39;49;00m
    [90m[39;49;00m
        [90m# Reinitialize each container's 'provided' counter[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m trust_input:[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
        [94melse[39;49;00m:[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                arg_container.provided = [94m0[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
            [94mif[39;49;00m [96mlen[39;49;00m(args) + [96mlen[39;49;00m(kwargs) > [96mlen[39;49;00m(input_storage):[90m[39;49;00m
                [94mraise[39;49;00m [96mTypeError[39;49;00m([33m"[39;49;00m[33mToo many parameter passed to pytensor function[39;49;00m[33m"[39;49;00m)[90m[39;49;00m
    [90m[39;49;00m
            [90m# Set positional arguments[39;49;00m[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                [90m# See discussion about None as input[39;49;00m[90m[39;49;00m
                [90m# https://groups.google.com/group/theano-dev/browse_thread/thread/920a5e904e8a8525/4f1b311a28fc27e5[39;49;00m[90m[39;49;00m
                [94mif[39;49;00m arg [95mis[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                    arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
                [94melse[39;49;00m:[90m[39;49;00m
                    [94mtry[39;49;00m:[90m[39;49;00m
                        arg_container.storage[[94m0[39;49;00m] = arg_container.type.filter([90m[39;49;00m
                            arg,[90m[39;49;00m
                            strict=arg_container.strict,[90m[39;49;00m
                            allow_downcast=arg_container.allow_downcast,[90m[39;49;00m
                        )[90m[39;49;00m
    [90m[39;49;00m
                    [94mexcept[39;49;00m [96mException[39;49;00m [94mas[39;49;00m e:[90m[39;49;00m
                        i = input_storage.index(arg_container)[90m[39;49;00m
                        function_name = [33m"[39;49;00m[33mpytensor function[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        argument_name = [33m"[39;49;00m[33margument[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mself[39;49;00m.name:[90m[39;49;00m
                            function_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + [96mself[39;49;00m.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mhasattr[39;49;00m(arg, [33m"[39;49;00m[33mname[39;49;00m[33m"[39;49;00m) [95mand[39;49;00m arg.name:[90m[39;49;00m
                            argument_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + arg.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        where = get_variable_trace_string([96mself[39;49;00m.maker.inputs[i].variable)[90m[39;49;00m
                        [94mif[39;49;00m [96mlen[39;49;00m(e.args) == [94m1[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + e.args[[94m0[39;49;00m],[90m[39;49;00m
                            )[90m[39;49;00m
                        [94melse[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                            ) + e.args[90m[39;49;00m
                        [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                        [94mraise[39;49;00m[90m[39;49;00m
                arg_container.provided += [94m1[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
        [90m# Set keyword arguments[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m kwargs:  [90m# for speed, skip the items for empty kwargs[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m k, arg [95min[39;49;00m kwargs.items():[90m[39;49;00m
                [96mself[39;49;00m[k] = arg[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m [95mnot[39;49;00m trust_input:[90m[39;49;00m
            [90m# Collect aliased inputs among the storage space[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m potential_group [95min[39;49;00m [96mself[39;49;00m._potential_aliased_input_groups:[90m[39;49;00m
                args_share_memory: [96mlist[39;49;00m[[96mlist[39;49;00m[[96mint[39;49;00m]] = [][90m[39;49;00m
                [94mfor[39;49;00m i [95min[39;49;00m potential_group:[90m[39;49;00m
                    i_type = [96mself[39;49;00m.maker.inputs[i].variable.type[90m[39;49;00m
                    i_val = input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
    [90m[39;49;00m
                    [90m# Check if value is aliased with any of the values in one of the groups[39;49;00m[90m[39;49;00m
                    [94mfor[39;49;00m j_group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                        [94mif[39;49;00m [96many[39;49;00m([90m[39;49;00m
                            i_type.may_share_memory(input_storage[j].storage[[94m0[39;49;00m], i_val)[90m[39;49;00m
                            [94mfor[39;49;00m j [95min[39;49;00m j_group[90m[39;49;00m
                        ):[90m[39;49;00m
                            j_group.append(i)[90m[39;49;00m
                            [94mbreak[39;49;00m[90m[39;49;00m
                    [94melse[39;49;00m:  [90m# no break[39;49;00m[90m[39;49;00m
                        [90m# Create a new group[39;49;00m[90m[39;49;00m
                        args_share_memory.append([i])[90m[39;49;00m
    [90m[39;49;00m
                [90m# Check for groups of more than one argument that share memory[39;49;00m[90m[39;49;00m
                [94mfor[39;49;00m group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                    [94mif[39;49;00m [96mlen[39;49;00m(group) > [94m1[39;49;00m:[90m[39;49;00m
                        [90m# copy all but the first[39;49;00m[90m[39;49;00m
                        [94mfor[39;49;00m i [95min[39;49;00m group[[94m1[39;49;00m:]:[90m[39;49;00m
                            input_storage[i].storage[[94m0[39;49;00m] = copy.copy([90m[39;49;00m
                                input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
                            )[90m[39;49;00m
    [90m[39;49;00m
            [90m# Check if inputs are missing, or if inputs were set more than once, or[39;49;00m[90m[39;49;00m
            [90m# if we tried to provide inputs that are supposed to be implicit.[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                [94mif[39;49;00m arg_container.required [95mand[39;49;00m [95mnot[39;49;00m arg_container.provided:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMissing required input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.provided > [94m1[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMultiple values for input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.implicit [95mand[39;49;00m arg_container.provided > [94m0[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mTried to provide value for implicit input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
    [90m[39;49;00m
        [90m# Do the actual work[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0_fn = time.perf_counter()[90m[39;49;00m
        [94mtry[39;49;00m:[90m[39;49;00m
>           outputs = vm() [94mif[39;49;00m output_subset [95mis[39;49;00m [94mNone[39;49;00m [94melse[39;49;00m vm(output_subset=output_subset)[90m[39;49;00m
                      ^^^^[90m[39;49;00m
[1m[31mE           pymc.logprob.utils.ParameterValueError: [0m
[1m[31mE           Apply node that caused the error: Check{}([-20.16095 ... .05653974], False)[0m
[1m[31mE           Toposort index: 0[0m
[1m[31mE           Inputs types: [TensorType(float64, shape=(2,)), ScalarType(bool)][0m
[1m[31mE           Inputs shapes: [(2,), ()][0m
[1m[31mE           Inputs strides: [(8,), ()][0m
[1m[31mE           Inputs values: [array([-20.16095231,  -5.05653974]), np.False_][0m
[1m[31mE           Inputs type_num: [12, 0][0m
[1m[31mE           Outputs clients: [[Sum{axes=None}(Check{}.0)]][0m
[1m[31mE           [0m
[1m[31mE           Backtrace when the node is created (use PyTensor flag traceback__limit=N to make it longer):[0m
[1m[31mE             File "/app/pymc/logprob/basic.py", line 574, in transformed_conditional_logp[0m
[1m[31mE               temp_logp_terms = conditional_logp([0m
[1m[31mE             File "/app/pymc/logprob/basic.py", line 504, in conditional_logp[0m
[1m[31mE               node_logprobs = _logprob([0m
[1m[31mE             File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/functools.py", line 982, in wrapper[0m
[1m[31mE               return dispatch(args[0].__class__)(*args, **kw)[0m
[1m[31mE             File "/app/pymc/distributions/distribution.py", line 140, in logp[0m
[1m[31mE               return class_logp(value, *dist_params)[0m
[1m[31mE             File "/app/tests/distributions/test_dist_math.py", line 96, in logp[0m
[1m[31mE               return check_parameters([0m
[1m[31mE             File "/app/pymc/distributions/dist_math.py", line 72, in check_parameters[0m
[1m[31mE               return CheckParameterValue(msg, can_be_replaced_by_ninf)(expr, all_true_scalar)[0m
[1m[31mE             File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/graph/op.py", line 294, in __call__[0m
[1m[31mE               node = self.make_node(*inputs, **kwargs)[0m
[1m[31mE             File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/raise_op.py", line 81, in make_node[0m
[1m[31mE               [value.type()],[0m
[1m[31mE           [0m
[1m[31mE           Debug print of the apply node: [0m
[1m[31mE           Check{} [id A] <Vector(float64, shape=(2,))>[0m
[1m[31mE            ├─ [-20.16095 ... .05653974] [id B] <Vector(float64, shape=(2,))>[0m
[1m[31mE            └─ False [id C] <bool>[0m
[1m[31mE           [0m
[1m[31mE           Storage map footprint:[0m
[1m[31mE            - [-20.16095 ... .05653974], Shape: (2,), ElemSize: 8 Byte(s), TotalSize: 16 Byte(s)[0m
[1m[31mE            - False, Shape: (), ElemSize: 1 Byte(s), TotalSize: 1.0 Byte(s)[0m
[1m[31mE            TotalSize: 17.0 Byte(s) 0.000 GB[0m
[1m[31mE            TotalSize inputs: 17.0 Byte(s) 0.000 GB[0m

[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/compile/function/types.py[0m:1038: ParameterValueError
[31m[1m______ TestMoments.test_multinomial_support_point[p6-n6-size6-expected6] _______[0m

self = <pytensor.compile.function.types.Function object at 0x7f0b9de83e30>
output_subset = None, args = (), kwargs = {}, trust_input = False
vm = <pytensor.link.c.cvm.CVM object at 0x7f0ba293ac50>, profile = None

    [0m[94mdef[39;49;00m[90m [39;49;00m[92m__call__[39;49;00m([96mself[39;49;00m, *args, output_subset=[94mNone[39;49;00m, **kwargs):[90m[39;49;00m
    [90m    [39;49;00m[33m"""[39;49;00m
    [33m    Evaluates value of a function on given arguments.[39;49;00m
    [33m[39;49;00m
    [33m    Parameters[39;49;00m
    [33m    ----------[39;49;00m
    [33m    args : list[39;49;00m
    [33m        List of inputs to the function. All inputs are required, even when[39;49;00m
    [33m        some of them are not necessary to calculate requested subset of[39;49;00m
    [33m        outputs.[39;49;00m
    [33m[39;49;00m
    [33m    kwargs : dict[39;49;00m
    [33m        The function inputs can be passed as keyword argument. For this, use[39;49;00m
    [33m        the name of the input or the input instance as the key.[39;49;00m
    [33m[39;49;00m
    [33m        Keyword argument ``output_subset`` is a list of either indices of the[39;49;00m
    [33m        function's outputs or the keys belonging to the `output_keys` dict[39;49;00m
    [33m        and represent outputs that are requested to be calculated. Regardless[39;49;00m
    [33m        of the presence of ``output_subset``, the updates are always calculated[39;49;00m
    [33m        and processed. To disable the updates, you should use the ``copy``[39;49;00m
    [33m        method with ``delete_updates=True``.[39;49;00m
    [33m[39;49;00m
    [33m    Returns[39;49;00m
    [33m    -------[39;49;00m
    [33m    list[39;49;00m
    [33m        List of outputs on indices/keys from ``output_subset`` or all of them,[39;49;00m
    [33m        if ``output_subset`` is not passed.[39;49;00m
    [33m    """[39;49;00m[90m[39;49;00m
        trust_input = [96mself[39;49;00m.trust_input[90m[39;49;00m
        input_storage = [96mself[39;49;00m.input_storage[90m[39;49;00m
        vm = [96mself[39;49;00m.vm[90m[39;49;00m
        profile = [96mself[39;49;00m.profile[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0 = time.perf_counter()[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m output_subset [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
            warnings.warn([33m"[39;49;00m[33moutput_subset is deprecated.[39;49;00m[33m"[39;49;00m, [96mFutureWarning[39;49;00m)[90m[39;49;00m
            [94mif[39;49;00m [96mself[39;49;00m.output_keys [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                output_subset = [[96mself[39;49;00m.output_keys.index(key) [94mfor[39;49;00m key [95min[39;49;00m output_subset][90m[39;49;00m
    [90m[39;49;00m
        [90m# Reinitialize each container's 'provided' counter[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m trust_input:[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
        [94melse[39;49;00m:[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                arg_container.provided = [94m0[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
            [94mif[39;49;00m [96mlen[39;49;00m(args) + [96mlen[39;49;00m(kwargs) > [96mlen[39;49;00m(input_storage):[90m[39;49;00m
                [94mraise[39;49;00m [96mTypeError[39;49;00m([33m"[39;49;00m[33mToo many parameter passed to pytensor function[39;49;00m[33m"[39;49;00m)[90m[39;49;00m
    [90m[39;49;00m
            [90m# Set positional arguments[39;49;00m[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                [90m# See discussion about None as input[39;49;00m[90m[39;49;00m
                [90m# https://groups.google.com/group/theano-dev/browse_thread/thread/920a5e904e8a8525/4f1b311a28fc27e5[39;49;00m[90m[39;49;00m
                [94mif[39;49;00m arg [95mis[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                    arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
                [94melse[39;49;00m:[90m[39;49;00m
                    [94mtry[39;49;00m:[90m[39;49;00m
                        arg_container.storage[[94m0[39;49;00m] = arg_container.type.filter([90m[39;49;00m
                            arg,[90m[39;49;00m
                            strict=arg_container.strict,[90m[39;49;00m
                            allow_downcast=arg_container.allow_downcast,[90m[39;49;00m
                        )[90m[39;49;00m
    [90m[39;49;00m
                    [94mexcept[39;49;00m [96mException[39;49;00m [94mas[39;49;00m e:[90m[39;49;00m
                        i = input_storage.index(arg_container)[90m[39;49;00m
                        function_name = [33m"[39;49;00m[33mpytensor function[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        argument_name = [33m"[39;49;00m[33margument[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mself[39;49;00m.name:[90m[39;49;00m
                            function_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + [96mself[39;49;00m.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mhasattr[39;49;00m(arg, [33m"[39;49;00m[33mname[39;49;00m[33m"[39;49;00m) [95mand[39;49;00m arg.name:[90m[39;49;00m
                            argument_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + arg.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        where = get_variable_trace_string([96mself[39;49;00m.maker.inputs[i].variable)[90m[39;49;00m
                        [94mif[39;49;00m [96mlen[39;49;00m(e.args) == [94m1[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + e.args[[94m0[39;49;00m],[90m[39;49;00m
                            )[90m[39;49;00m
                        [94melse[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                            ) + e.args[90m[39;49;00m
                        [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                        [94mraise[39;49;00m[90m[39;49;00m
                arg_container.provided += [94m1[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
        [90m# Set keyword arguments[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m kwargs:  [90m# for speed, skip the items for empty kwargs[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m k, arg [95min[39;49;00m kwargs.items():[90m[39;49;00m
                [96mself[39;49;00m[k] = arg[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m [95mnot[39;49;00m trust_input:[90m[39;49;00m
            [90m# Collect aliased inputs among the storage space[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m potential_group [95min[39;49;00m [96mself[39;49;00m._potential_aliased_input_groups:[90m[39;49;00m
                args_share_memory: [96mlist[39;49;00m[[96mlist[39;49;00m[[96mint[39;49;00m]] = [][90m[39;49;00m
                [94mfor[39;49;00m i [95min[39;49;00m potential_group:[90m[39;49;00m
                    i_type = [96mself[39;49;00m.maker.inputs[i].variable.type[90m[39;49;00m
                    i_val = input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
    [90m[39;49;00m
                    [90m# Check if value is aliased with any of the values in one of the groups[39;49;00m[90m[39;49;00m
                    [94mfor[39;49;00m j_group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                        [94mif[39;49;00m [96many[39;49;00m([90m[39;49;00m
                            i_type.may_share_memory(input_storage[j].storage[[94m0[39;49;00m], i_val)[90m[39;49;00m
                            [94mfor[39;49;00m j [95min[39;49;00m j_group[90m[39;49;00m
                        ):[90m[39;49;00m
                            j_group.append(i)[90m[39;49;00m
                            [94mbreak[39;49;00m[90m[39;49;00m
                    [94melse[39;49;00m:  [90m# no break[39;49;00m[90m[39;49;00m
                        [90m# Create a new group[39;49;00m[90m[39;49;00m
                        args_share_memory.append([i])[90m[39;49;00m
    [90m[39;49;00m
                [90m# Check for groups of more than one argument that share memory[39;49;00m[90m[39;49;00m
                [94mfor[39;49;00m group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                    [94mif[39;49;00m [96mlen[39;49;00m(group) > [94m1[39;49;00m:[90m[39;49;00m
                        [90m# copy all but the first[39;49;00m[90m[39;49;00m
                        [94mfor[39;49;00m i [95min[39;49;00m group[[94m1[39;49;00m:]:[90m[39;49;00m
                            input_storage[i].storage[[94m0[39;49;00m] = copy.copy([90m[39;49;00m
                                input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
                            )[90m[39;49;00m
    [90m[39;49;00m
            [90m# Check if inputs are missing, or if inputs were set more than once, or[39;49;00m[90m[39;49;00m
            [90m# if we tried to provide inputs that are supposed to be implicit.[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                [94mif[39;49;00m arg_container.required [95mand[39;49;00m [95mnot[39;49;00m arg_container.provided:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMissing required input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.provided > [94m1[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMultiple values for input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.implicit [95mand[39;49;00m arg_container.provided > [94m0[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mTried to provide value for implicit input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
    [90m[39;49;00m
        [90m# Do the actual work[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0_fn = time.perf_counter()[90m[39;49;00m
        [94mtry[39;49;00m:[90m[39;49;00m
>           outputs = vm() [94mif[39;49;00m output_subset [95mis[39;49;00m [94mNone[39;49;00m [94melse[39;49;00m vm(output_subset=output_subset)[90m[39;49;00m
                      ^^^^[90m[39;49;00m
[1m[31mE           pymc.logprob.utils.ParameterValueError[0m

[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/compile/function/types.py[0m:1038: ParameterValueError

[33mDuring handling of the above exception, another exception occurred:[0m

self = <tests.distributions.test_multivariate.TestMoments object at 0x7f0bb4fc2470>
p = array([[0.25, 0.25, 0.25, 0.25],
       [0.26, 0.26, 0.26, 0.22]])
n = array([ 1, 10]), size = (3, 2)
expected = array([[[1, 0, 0, 0],
        [2, 3, 3, 2]],

       [[1, 0, 0, 0],
        [2, 3, 3, 2]],

       [[1, 0, 0, 0],
        [2, 3, 3, 2]]])

    [0m[37m@pytest[39;49;00m.mark.parametrize([90m[39;49;00m
        [33m"[39;49;00m[33mp, n, size, expected[39;49;00m[33m"[39;49;00m,[90m[39;49;00m
        [[90m[39;49;00m
            (np.array([[94m0.25[39;49;00m, [94m0.25[39;49;00m, [94m0.25[39;49;00m, [94m0.25[39;49;00m]), [94m1[39;49;00m, [94mNone[39;49;00m, np.array([[94m1[39;49;00m, [94m0[39;49;00m, [94m0[39;49;00m, [94m0[39;49;00m])),[90m[39;49;00m
            (np.array([[94m0.3[39;49;00m, [94m0.6[39;49;00m, [94m0.05[39;49;00m, [94m0.05[39;49;00m]), [94m2[39;49;00m, [94mNone[39;49;00m, np.array([[94m1[39;49;00m, [94m1[39;49;00m, [94m0[39;49;00m, [94m0[39;49;00m])),[90m[39;49;00m
            (np.array([[94m0.3[39;49;00m, [94m0.6[39;49;00m, [94m0.05[39;49;00m, [94m0.05[39;49;00m]), [94m10[39;49;00m, [94mNone[39;49;00m, np.array([[94m3[39;49;00m, [94m7[39;49;00m, [94m0[39;49;00m, [94m0[39;49;00m])),[90m[39;49;00m
            ([90m[39;49;00m
                np.array([[[94m0.3[39;49;00m, [94m0.6[39;49;00m, [94m0.05[39;49;00m, [94m0.05[39;49;00m], [[94m0.25[39;49;00m, [94m0.25[39;49;00m, [94m0.25[39;49;00m, [94m0.25[39;49;00m]]),[90m[39;49;00m
                [94m10[39;49;00m,[90m[39;49;00m
                [94mNone[39;49;00m,[90m[39;49;00m
                np.array([[[94m3[39;49;00m, [94m7[39;49;00m, [94m0[39;49;00m, [94m0[39;49;00m], [[94m4[39;49;00m, [94m2[39;49;00m, [94m2[39;49;00m, [94m2[39;49;00m]]),[90m[39;49;00m
            ),[90m[39;49;00m
            ([90m[39;49;00m
                np.array([[94m0.3[39;49;00m, [94m0.6[39;49;00m, [94m0.05[39;49;00m, [94m0.05[39;49;00m]),[90m[39;49;00m
                np.array([[94m2[39;49;00m, [94m10[39;49;00m]),[90m[39;49;00m
                ([94m1[39;49;00m, [94m2[39;49;00m),[90m[39;49;00m
                np.array([[[[94m1[39;49;00m, [94m1[39;49;00m, [94m0[39;49;00m, [94m0[39;49;00m], [[94m3[39;49;00m, [94m7[39;49;00m, [94m0[39;49;00m, [94m0[39;49;00m]]]),[90m[39;49;00m
            ),[90m[39;49;00m
            ([90m[39;49;00m
                np.array([[[94m0.25[39;49;00m, [94m0.25[39;49;00m, [94m0.25[39;49;00m, [94m0.25[39;49;00m], [[94m0.26[39;49;00m, [94m0.26[39;49;00m, [94m0.26[39;49;00m, [94m0.22[39;49;00m]]),[90m[39;49;00m
                np.array([[94m1[39;49;00m, [94m10[39;49;00m]),[90m[39;49;00m
                [94mNone[39;49;00m,[90m[39;49;00m
                np.array([[[94m1[39;49;00m, [94m0[39;49;00m, [94m0[39;49;00m, [94m0[39;49;00m], [[94m2[39;49;00m, [94m3[39;49;00m, [94m3[39;49;00m, [94m2[39;49;00m]]),[90m[39;49;00m
            ),[90m[39;49;00m
            ([90m[39;49;00m
                np.array([[[94m0.25[39;49;00m, [94m0.25[39;49;00m, [94m0.25[39;49;00m, [94m0.25[39;49;00m], [[94m0.26[39;49;00m, [94m0.26[39;49;00m, [94m0.26[39;49;00m, [94m0.22[39;49;00m]]),[90m[39;49;00m
                np.array([[94m1[39;49;00m, [94m10[39;49;00m]),[90m[39;49;00m
                ([94m3[39;49;00m, [94m2[39;49;00m),[90m[39;49;00m
                np.full(([94m3[39;49;00m, [94m2[39;49;00m, [94m4[39;49;00m), [[[94m1[39;49;00m, [94m0[39;49;00m, [94m0[39;49;00m, [94m0[39;49;00m], [[94m2[39;49;00m, [94m3[39;49;00m, [94m3[39;49;00m, [94m2[39;49;00m]]),[90m[39;49;00m
            ),[90m[39;49;00m
            ([90m[39;49;00m
                np.array([[94m0.0[39;49;00m, [94m0.25[39;49;00m, [94m0.25[39;49;00m, [94m0.25[39;49;00m, [94m0.25[39;49;00m]),[90m[39;49;00m
                [94m1[39;49;00m,[90m[39;49;00m
                [94mNone[39;49;00m,[90m[39;49;00m
                np.array([[94m0[39;49;00m, [94m1[39;49;00m, [94m0[39;49;00m, [94m0[39;49;00m, [94m0[39;49;00m]),[90m[39;49;00m
            ),[90m[39;49;00m
            pytest.param([90m[39;49;00m
                np.array([[94m0.1441[39;49;00m, [94m0.1363[39;49;00m, [94m0.1385[39;49;00m, [94m0.1348[39;49;00m, [94m0.1521[39;49;00m, [94m0.1500[39;49;00m, [94m0.1442[39;49;00m]),[90m[39;49;00m
                [94m4[39;49;00m,[90m[39;49;00m
                [94mNone[39;49;00m,[90m[39;49;00m
                np.array([[94m1[39;49;00m, [94m1[39;49;00m, [94m1[39;49;00m, [94m1[39;49;00m, [94m0[39;49;00m, [94m0[39;49;00m, [94m0[39;49;00m]),[90m[39;49;00m
                marks=pytest.mark.xfail([90m[39;49;00m
                    rises=[96mAssertionError[39;49;00m, reason=[33m"[39;49;00m[33mKnown failure in mode approximation [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                ),[90m[39;49;00m
            ),[90m[39;49;00m
        ],[90m[39;49;00m
    )[90m[39;49;00m
    [94mdef[39;49;00m[90m [39;49;00m[92mtest_multinomial_support_point[39;49;00m([96mself[39;49;00m, p, n, size, expected):[90m[39;49;00m
        [94mwith[39;49;00m pm.Model() [94mas[39;49;00m model:[90m[39;49;00m
            pm.Multinomial([33m"[39;49;00m[33mx[39;49;00m[33m"[39;49;00m, n=n, p=p, size=size)[90m[39;49;00m
>       assert_support_point_is_expected(model, expected)[90m[39;49;00m

[1m[31mtests/distributions/test_multivariate.py[0m:1065:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _
[1m[31mpymc/testing.py[0m:742: in assert_support_point_is_expected
    [0m.eval()[90m[39;49;00m
     ^^^^^^[90m[39;49;00m
[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/graph/basic.py[0m:668: in eval
    [0m[94mreturn[39;49;00m fn(*args)[90m[39;49;00m
           ^^^^^^^^^[90m[39;49;00m
[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/compile/function/types.py[0m:1048: in __call__
    [0mraise_with_op([90m[39;49;00m
[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/link/utils.py[0m:526: in raise_with_op
    [0m[94mraise[39;49;00m exc_value.with_traceback(exc_trace)[90m[39;49;00m
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

self = <pytensor.compile.function.types.Function object at 0x7f0b9de83e30>
output_subset = None, args = (), kwargs = {}, trust_input = False
vm = <pytensor.link.c.cvm.CVM object at 0x7f0ba293ac50>, profile = None

    [0m[94mdef[39;49;00m[90m [39;49;00m[92m__call__[39;49;00m([96mself[39;49;00m, *args, output_subset=[94mNone[39;49;00m, **kwargs):[90m[39;49;00m
    [90m    [39;49;00m[33m"""[39;49;00m
    [33m    Evaluates value of a function on given arguments.[39;49;00m
    [33m[39;49;00m
    [33m    Parameters[39;49;00m
    [33m    ----------[39;49;00m
    [33m    args : list[39;49;00m
    [33m        List of inputs to the function. All inputs are required, even when[39;49;00m
    [33m        some of them are not necessary to calculate requested subset of[39;49;00m
    [33m        outputs.[39;49;00m
    [33m[39;49;00m
    [33m    kwargs : dict[39;49;00m
    [33m        The function inputs can be passed as keyword argument. For this, use[39;49;00m
    [33m        the name of the input or the input instance as the key.[39;49;00m
    [33m[39;49;00m
    [33m        Keyword argument ``output_subset`` is a list of either indices of the[39;49;00m
    [33m        function's outputs or the keys belonging to the `output_keys` dict[39;49;00m
    [33m        and represent outputs that are requested to be calculated. Regardless[39;49;00m
    [33m        of the presence of ``output_subset``, the updates are always calculated[39;49;00m
    [33m        and processed. To disable the updates, you should use the ``copy``[39;49;00m
    [33m        method with ``delete_updates=True``.[39;49;00m
    [33m[39;49;00m
    [33m    Returns[39;49;00m
    [33m    -------[39;49;00m
    [33m    list[39;49;00m
    [33m        List of outputs on indices/keys from ``output_subset`` or all of them,[39;49;00m
    [33m        if ``output_subset`` is not passed.[39;49;00m
    [33m    """[39;49;00m[90m[39;49;00m
        trust_input = [96mself[39;49;00m.trust_input[90m[39;49;00m
        input_storage = [96mself[39;49;00m.input_storage[90m[39;49;00m
        vm = [96mself[39;49;00m.vm[90m[39;49;00m
        profile = [96mself[39;49;00m.profile[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0 = time.perf_counter()[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m output_subset [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
            warnings.warn([33m"[39;49;00m[33moutput_subset is deprecated.[39;49;00m[33m"[39;49;00m, [96mFutureWarning[39;49;00m)[90m[39;49;00m
            [94mif[39;49;00m [96mself[39;49;00m.output_keys [95mis[39;49;00m [95mnot[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                output_subset = [[96mself[39;49;00m.output_keys.index(key) [94mfor[39;49;00m key [95min[39;49;00m output_subset][90m[39;49;00m
    [90m[39;49;00m
        [90m# Reinitialize each container's 'provided' counter[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m trust_input:[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
        [94melse[39;49;00m:[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                arg_container.provided = [94m0[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
            [94mif[39;49;00m [96mlen[39;49;00m(args) + [96mlen[39;49;00m(kwargs) > [96mlen[39;49;00m(input_storage):[90m[39;49;00m
                [94mraise[39;49;00m [96mTypeError[39;49;00m([33m"[39;49;00m[33mToo many parameter passed to pytensor function[39;49;00m[33m"[39;49;00m)[90m[39;49;00m
    [90m[39;49;00m
            [90m# Set positional arguments[39;49;00m[90m[39;49;00m
            [90m# zip strict not specified because we are in a hot loop[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container, arg [95min[39;49;00m [96mzip[39;49;00m(input_storage, args):[90m[39;49;00m
                [90m# See discussion about None as input[39;49;00m[90m[39;49;00m
                [90m# https://groups.google.com/group/theano-dev/browse_thread/thread/920a5e904e8a8525/4f1b311a28fc27e5[39;49;00m[90m[39;49;00m
                [94mif[39;49;00m arg [95mis[39;49;00m [94mNone[39;49;00m:[90m[39;49;00m
                    arg_container.storage[[94m0[39;49;00m] = arg[90m[39;49;00m
                [94melse[39;49;00m:[90m[39;49;00m
                    [94mtry[39;49;00m:[90m[39;49;00m
                        arg_container.storage[[94m0[39;49;00m] = arg_container.type.filter([90m[39;49;00m
                            arg,[90m[39;49;00m
                            strict=arg_container.strict,[90m[39;49;00m
                            allow_downcast=arg_container.allow_downcast,[90m[39;49;00m
                        )[90m[39;49;00m
    [90m[39;49;00m
                    [94mexcept[39;49;00m [96mException[39;49;00m [94mas[39;49;00m e:[90m[39;49;00m
                        i = input_storage.index(arg_container)[90m[39;49;00m
                        function_name = [33m"[39;49;00m[33mpytensor function[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        argument_name = [33m"[39;49;00m[33margument[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mself[39;49;00m.name:[90m[39;49;00m
                            function_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + [96mself[39;49;00m.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        [94mif[39;49;00m [96mhasattr[39;49;00m(arg, [33m"[39;49;00m[33mname[39;49;00m[33m"[39;49;00m) [95mand[39;49;00m arg.name:[90m[39;49;00m
                            argument_name += [33m'[39;49;00m[33m with name [39;49;00m[33m"[39;49;00m[33m'[39;49;00m + arg.name + [33m'[39;49;00m[33m"[39;49;00m[33m'[39;49;00m[90m[39;49;00m
                        where = get_variable_trace_string([96mself[39;49;00m.maker.inputs[i].variable)[90m[39;49;00m
                        [94mif[39;49;00m [96mlen[39;49;00m(e.args) == [94m1[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + e.args[[94m0[39;49;00m],[90m[39;49;00m
                            )[90m[39;49;00m
                        [94melse[39;49;00m:[90m[39;49;00m
                            e.args = ([90m[39;49;00m
                                [33m"[39;49;00m[33mBad input [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + argument_name[90m[39;49;00m
                                + [33m"[39;49;00m[33m to [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                                + function_name[90m[39;49;00m
                                + [33mf[39;49;00m[33m"[39;49;00m[33m at index [39;49;00m[33m{[39;49;00m[96mint[39;49;00m(i)[33m}[39;49;00m[33m (0-based). [39;49;00m[33m{[39;49;00mwhere[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                            ) + e.args[90m[39;49;00m
                        [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                        [94mraise[39;49;00m[90m[39;49;00m
                arg_container.provided += [94m1[39;49;00m[90m[39;49;00m
    [90m[39;49;00m
        [90m# Set keyword arguments[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m kwargs:  [90m# for speed, skip the items for empty kwargs[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m k, arg [95min[39;49;00m kwargs.items():[90m[39;49;00m
                [96mself[39;49;00m[k] = arg[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m [95mnot[39;49;00m trust_input:[90m[39;49;00m
            [90m# Collect aliased inputs among the storage space[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m potential_group [95min[39;49;00m [96mself[39;49;00m._potential_aliased_input_groups:[90m[39;49;00m
                args_share_memory: [96mlist[39;49;00m[[96mlist[39;49;00m[[96mint[39;49;00m]] = [][90m[39;49;00m
                [94mfor[39;49;00m i [95min[39;49;00m potential_group:[90m[39;49;00m
                    i_type = [96mself[39;49;00m.maker.inputs[i].variable.type[90m[39;49;00m
                    i_val = input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
    [90m[39;49;00m
                    [90m# Check if value is aliased with any of the values in one of the groups[39;49;00m[90m[39;49;00m
                    [94mfor[39;49;00m j_group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                        [94mif[39;49;00m [96many[39;49;00m([90m[39;49;00m
                            i_type.may_share_memory(input_storage[j].storage[[94m0[39;49;00m], i_val)[90m[39;49;00m
                            [94mfor[39;49;00m j [95min[39;49;00m j_group[90m[39;49;00m
                        ):[90m[39;49;00m
                            j_group.append(i)[90m[39;49;00m
                            [94mbreak[39;49;00m[90m[39;49;00m
                    [94melse[39;49;00m:  [90m# no break[39;49;00m[90m[39;49;00m
                        [90m# Create a new group[39;49;00m[90m[39;49;00m
                        args_share_memory.append([i])[90m[39;49;00m
    [90m[39;49;00m
                [90m# Check for groups of more than one argument that share memory[39;49;00m[90m[39;49;00m
                [94mfor[39;49;00m group [95min[39;49;00m args_share_memory:[90m[39;49;00m
                    [94mif[39;49;00m [96mlen[39;49;00m(group) > [94m1[39;49;00m:[90m[39;49;00m
                        [90m# copy all but the first[39;49;00m[90m[39;49;00m
                        [94mfor[39;49;00m i [95min[39;49;00m group[[94m1[39;49;00m:]:[90m[39;49;00m
                            input_storage[i].storage[[94m0[39;49;00m] = copy.copy([90m[39;49;00m
                                input_storage[i].storage[[94m0[39;49;00m][90m[39;49;00m
                            )[90m[39;49;00m
    [90m[39;49;00m
            [90m# Check if inputs are missing, or if inputs were set more than once, or[39;49;00m[90m[39;49;00m
            [90m# if we tried to provide inputs that are supposed to be implicit.[39;49;00m[90m[39;49;00m
            [94mfor[39;49;00m arg_container [95min[39;49;00m input_storage:[90m[39;49;00m
                [94mif[39;49;00m arg_container.required [95mand[39;49;00m [95mnot[39;49;00m arg_container.provided:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMissing required input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.provided > [94m1[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mMultiple values for input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
                [94mif[39;49;00m arg_container.implicit [95mand[39;49;00m arg_container.provided > [94m0[39;49;00m:[90m[39;49;00m
                    [96mself[39;49;00m._restore_defaults()[90m[39;49;00m
                    [94mraise[39;49;00m [96mTypeError[39;49;00m([90m[39;49;00m
                        [33mf[39;49;00m[33m"[39;49;00m[33mTried to provide value for implicit input: [39;49;00m[33m{[39;49;00m[96mgetattr[39;49;00m([96mself[39;49;00m.inv_finder[arg_container],[90m [39;49;00m[33m'[39;49;00m[33mvariable[39;49;00m[33m'[39;49;00m,[90m [39;49;00m[96mself[39;49;00m.inv_finder[arg_container])[33m}[39;49;00m[33m"[39;49;00m[90m[39;49;00m
                    )[90m[39;49;00m
    [90m[39;49;00m
        [90m# Do the actual work[39;49;00m[90m[39;49;00m
        [94mif[39;49;00m profile:[90m[39;49;00m
            t0_fn = time.perf_counter()[90m[39;49;00m
        [94mtry[39;49;00m:[90m[39;49;00m
>           outputs = vm() [94mif[39;49;00m output_subset [95mis[39;49;00m [94mNone[39;49;00m [94melse[39;49;00m vm(output_subset=output_subset)[90m[39;49;00m
                      ^^^^[90m[39;49;00m
[1m[31mE           pymc.logprob.utils.ParameterValueError: [0m
[1m[31mE           Apply node that caused the error: Check{}([[-60.4828 ... 37844436]], False)[0m
[1m[31mE           Toposort index: 0[0m
[1m[31mE           Inputs types: [TensorType(float64, shape=(1, 2)), ScalarType(bool)][0m
[1m[31mE           Inputs shapes: [(1, 2), ()][0m
[1m[31mE           Inputs strides: [(16, 8), ()][0m
[1m[31mE           Inputs values: [array([[-60.48285693, -45.37844436]]), np.False_][0m
[1m[31mE           Inputs type_num: [12, 0][0m
[1m[31mE           Outputs clients: [[Sum{axes=None}(Check{}.0)]][0m
[1m[31mE           [0m
[1m[31mE           Backtrace when the node is created (use PyTensor flag traceback__limit=N to make it longer):[0m
[1m[31mE             File "/app/pymc/logprob/basic.py", line 574, in transformed_conditional_logp[0m
[1m[31mE               temp_logp_terms = conditional_logp([0m
[1m[31mE             File "/app/pymc/logprob/basic.py", line 504, in conditional_logp[0m
[1m[31mE               node_logprobs = _logprob([0m
[1m[31mE             File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/functools.py", line 982, in wrapper[0m
[1m[31mE               return dispatch(args[0].__class__)(*args, **kw)[0m
[1m[31mE             File "/app/pymc/distributions/distribution.py", line 140, in logp[0m
[1m[31mE               return class_logp(value, *dist_params)[0m
[1m[31mE             File "/app/tests/distributions/test_dist_math.py", line 96, in logp[0m
[1m[31mE               return check_parameters([0m
[1m[31mE             File "/app/pymc/distributions/dist_math.py", line 72, in check_parameters[0m
[1m[31mE               return CheckParameterValue(msg, can_be_replaced_by_ninf)(expr, all_true_scalar)[0m
[1m[31mE             File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/graph/op.py", line 294, in __call__[0m
[1m[31mE               node = self.make_node(*inputs, **kwargs)[0m
[1m[31mE             File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/raise_op.py", line 81, in make_node[0m
[1m[31mE               [value.type()],[0m
[1m[31mE           [0m
[1m[31mE           Debug print of the apply node: [0m
[1m[31mE           Check{} [id A] <Matrix(float64, shape=(1, 2))>[0m
[1m[31mE            ├─ [[-60.4828 ... 37844436]] [id B] <Matrix(float64, shape=(1, 2))>[0m
[1m[31mE            └─ False [id C] <bool>[0m
[1m[31mE           [0m
[1m[31mE           Storage map footprint:[0m
[1m[31mE            - [[-60.4828 ... 37844436]], Shape: (1, 2), ElemSize: 8 Byte(s), TotalSize: 16 Byte(s)[0m
[1m[31mE            - False, Shape: (), ElemSize: 1 Byte(s), TotalSize: 1.0 Byte(s)[0m
[1m[31mE            TotalSize: 17.0 Byte(s) 0.000 GB[0m
[1m[31mE            TotalSize inputs: 17.0 Byte(s) 0.000 GB[0m

[1m[31m/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/compile/function/types.py[0m:1038: ParameterValueError
[31m[1m_______ TestMoments.test_multinomial_support_point[p7-1-None-expected7] ________[0m

self = <tests.distributions.test_multivariate.TestMoments object at 0x7f0bb36e2b50>
p = array([0.  , 0.25, 0.25, 0.25, 0.25]), n = 1, size = None
expected = array([0, 1, 0, 0, 0])

    [0m[37m@pytest[39;49;00m.mark.parametrize([90m[39;49;00m
        [33m"[39;49;00m[33mp, n, size, expected[39;49;00m[33m"[39;49;00m,[90m[39;49;00m
        [[90m[39;49;00m
            (np.array([[94m0.25[39;49;00m, [94m0.25[39;49;00m, [94m0.25[39;49;00m, [94m0.25[39;49;00m]), [94m1[39;49;00m, [94mNone[39;49;00m, np.array([[94m1[39;49;00m, [94m0[39;49;00m, [94m0[39;49;00m, [94m0[39;49;00m])),[90m[39;49;00m
            (np.array([[94m0.3[39;49;00m, [94m0.6[39;49;00m, [94m0.05[39;49;00m, [94m0.05[39;49;00m]), [94m2[39;49;00m, [94mNone[39;49;00m, np.array([[94m1[39;49;00m, [94m1[39;49;00m, [94m0[39;49;00m, [94m0[39;49;00m])),[90m[39;49;00m
            (np.array([[94m0.3[39;49;00m, [94m0.6[39;49;00m, [94m0.05[39;49;00m, [94m0.05[39;49;00m]), [94m10[39;49;00m, [94mNone[39;49;00m, np.array([[94m3[39;49;00m, [94m7[39;49;00m, [94m0[39;49;00m, [94m0[39;49;00m])),[90m[39;49;00m
            ([90m[39;49;00m
                np.array([[[94m0.3[39;49;00m, [94m0.6[39;49;00m, [94m0.05[39;49;00m, [94m0.05[39;49;00m], [[94m0.25[39;49;00m, [94m0.25[39;49;00m, [94m0.25[39;49;00m, [94m0.25[39;49;00m]]),[90m[39;49;00m
                [94m10[39;49;00m,[90m[39;49;00m
                [94mNone[39;49;00m,[90m[39;49;00m
                np.array([[[94m3[39;49;00m, [94m7[39;49;00m, [94m0[39;49;00m, [94m0[39;49;00m], [[94m4[39;49;00m, [94m2[39;49;00m, [94m2[39;49;00m, [94m2[39;49;00m]]),[90m[39;49;00m
            ),[90m[39;49;00m
            ([90m[39;49;00m
                np.array([[94m0.3[39;49;00m, [94m0.6[39;49;00m, [94m0.05[39;49;00m, [94m0.05[39;49;00m]),[90m[39;49;00m
                np.array([[94m2[39;49;00m, [94m10[39;49;00m]),[90m[39;49;00m
                ([94m1[39;49;00m, [94m2[39;49;00m),[90m[39;49;00m
                np.array([[[[94m1[39;49;00m, [94m1[39;49;00m, [94m0[39;49;00m, [94m0[39;49;00m], [[94m3[39;49;00m, [94m7[39;49;00m, [94m0[39;49;00m, [94m0[39;49;00m]]]),[90m[39;49;00m
            ),[90m[39;49;00m
            ([90m[39;49;00m
                np.array([[[94m0.25[39;49;00m, [94m0.25[39;49;00m, [94m0.25[39;49;00m, [94m0.25[39;49;00m], [[94m0.26[39;49;00m, [94m0.26[39;49;00m, [94m0.26[39;49;00m, [94m0.22[39;49;00m]]),[90m[39;49;00m
                np.array([[94m1[39;49;00m, [94m10[39;49;00m]),[90m[39;49;00m
                [94mNone[39;49;00m,[90m[39;49;00m
                np.array([[[94m1[39;49;00m, [94m0[39;49;00m, [94m0[39;49;00m, [94m0[39;49;00m], [[94m2[39;49;00m, [94m3[39;49;00m, [94m3[39;49;00m, [94m2[39;49;00m]]),[90m[39;49;00m
            ),[90m[39;49;00m
            ([90m[39;49;00m
                np.array([[[94m0.25[39;49;00m, [94m0.25[39;49;00m, [94m0.25[39;49;00m, [94m0.25[39;49;00m], [[94m0.26[39;49;00m, [94m0.26[39;49;00m, [94m0.26[39;49;00m, [94m0.22[39;49;00m]]),[90m[39;49;00m
                np.array([[94m1[39;49;00m, [94m10[39;49;00m]),[90m[39;49;00m
                ([94m3[39;49;00m, [94m2[39;49;00m),[90m[39;49;00m
                np.full(([94m3[39;49;00m, [94m2[39;49;00m, [94m4[39;49;00m), [[[94m1[39;49;00m, [94m0[39;49;00m, [94m0[39;49;00m, [94m0[39;49;00m], [[94m2[39;49;00m, [94m3[39;49;00m, [94m3[39;49;00m, [94m2[39;49;00m]]),[90m[39;49;00m
            ),[90m[39;49;00m
            ([90m[39;49;00m
                np.array([[94m0.0[39;49;00m, [94m0.25[39;49;00m, [94m0.25[39;49;00m, [94m0.25[39;49;00m, [94m0.25[39;49;00m]),[90m[39;49;00m
                [94m1[39;49;00m,[90m[39;49;00m
                [94mNone[39;49;00m,[90m[39;49;00m
                np.array([[94m0[39;49;00m, [94m1[39;49;00m, [94m0[39;49;00m, [94m0[39;49;00m, [94m0[39;49;00m]),[90m[39;49;00m
            ),[90m[39;49;00m
            pytest.param([90m[39;49;00m
                np.array([[94m0.1441[39;49;00m, [94m0.1363[39;49;00m, [94m0.1385[39;49;00m, [94m0.1348[39;49;00m, [94m0.1521[39;49;00m, [94m0.1500[39;49;00m, [94m0.1442[39;49;00m]),[90m[39;49;00m
                [94m4[39;49;00m,[90m[39;49;00m
                [94mNone[39;49;00m,[90m[39;49;00m
                np.array([[94m1[39;49;00m, [94m1[39;49;00m, [94m1[39;49;00m, [94m1[39;49;00m, [94m0[39;49;00m, [94m0[39;49;00m, [94m0[39;49;00m]),[90m[39;49;00m
                marks=pytest.mark.xfail([90m[39;49;00m
                    rises=[96mAssertionError[39;49;00m, reason=[33m"[39;49;00m[33mKnown failure in mode approximation [39;49;00m[33m"[39;49;00m[90m[39;49;00m
                ),[90m[39;49;00m
            ),[90m[39;49;00m
        ],[90m[39;49;00m
    )[90m[39;49;00m
    [94mdef[39;49;00m[90m [39;49;00m[92mtest_multinomial_support_point[39;49;00m([96mself[39;49;00m, p, n, size, expected):[90m[39;49;00m
        [94mwith[39;49;00m pm.Model() [94mas[39;49;00m model:[90m[39;49;00m
            pm.Multinomial([33m"[39;49;00m[33mx[39;49;00m[33m"[39;49;00m, n=n, p=p, size=size)[90m[39;49;00m
>       assert_support_point_is_expected(model, expected)[90m[39;49;00m

[1m[31mtests/distributions/test_multivariate.py[0m:1065:
_ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _ _

model = <pymc.model.core.Model object at 0x7f0ba0cd83e0>
expected = array([0, 1, 0, 0, 0]), check_finite_logp = True

    [0m[94mdef[39;49;00m[90m [39;49;00m[92massert_support_point_is_expected[39;49;00m(model, expected, check_finite_logp=[94mTrue[39;49;00m):[90m[39;49;00m
        fn = make_initial_point_fn([90m[39;49;00m
            model=model,[90m[39;49;00m
            return_transformed=[94mFalse[39;49;00m,[90m[39;49;00m
            default_strategy=[33m"[39;49;00m[33msupport_point[39;49;00m[33m"[39;49;00m,[90m[39;49;00m
        )[90m[39;49;00m
        support_point = fn([94m0[39;49;00m)[[33m"[39;49;00m[33mx[39;49;00m[33m"[39;49;00m][90m[39;49;00m
        expected = np.asarray(expected)[90m[39;49;00m
        [94mtry[39;49;00m:[90m[39;49;00m
            random_draw = model[[33m"[39;49;00m[33mx[39;49;00m[33m"[39;49;00m].eval()[90m[39;49;00m
        [94mexcept[39;49;00m [96mNotImplementedError[39;49;00m:[90m[39;49;00m
            random_draw = support_point[90m[39;49;00m
    [90m[39;49;00m
        [94massert[39;49;00m support_point.shape == expected.shape[90m[39;49;00m
        [94massert[39;49;00m expected.shape == random_draw.shape[90m[39;49;00m
        [94massert[39;49;00m np.allclose(support_point, expected)[90m[39;49;00m
    [90m[39;49;00m
        [94mif[39;49;00m check_finite_logp:[90m[39;49;00m
            logp_support_point = ([90m[39;49;00m
                transformed_conditional_logp([90m[39;49;00m
                    (model[[33m"[39;49;00m[33mx[39;49;00m[33m"[39;49;00m],),[90m[39;49;00m
                    rvs_to_values={model[[33m"[39;49;00m[33mx[39;49;00m[33m"[39;49;00m]: pt.constant(support_point)},[90m[39;49;00m
                    rvs_to_transforms={},[90m[39;49;00m
                )[[94m0[39;49;00m][90m[39;49;00m
                .sum()[90m[39;49;00m
                .eval()[90m[39;49;00m
            )[90m[39;49;00m
>           [94massert[39;49;00m np.isfinite(logp_support_point)[90m[39;49;00m
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^[90m[39;49;00m
[1m[31mE           AssertionError[0m

[1m[31mpymc/testing.py[0m:744: AssertionError
[33m=============================== warnings summary ===============================[0m
../root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/arviz/__init__.py:39
  /root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/arviz/__init__.py:39: FutureWarning:
  ArviZ is undergoing a major refactor to improve flexibility and extensibility while maintaining a user-friendly interface.
  Some upcoming changes may be backward incompatible.
  For details and migration guidance, visit: https://python.arviz.org/en/latest/user_guide/migration_guide.html
    warn(

pymc/dims/__init__.py:66
  /app/pymc/dims/__init__.py:66: UserWarning: The `pymc.dims` module is experimental and may contain critical bugs (p=0.117).
  Please report any issues you encounter at https://github.com/pymc-devs/pymc/issues.
  API changes are expected in future releases.

    __init__()

tests/sampling/test_parallel.py:75
  /app/tests/sampling/test_parallel.py:75: FutureWarning: pytensor.as_op is deprecated and will be removed in a future release. Please use pytensor.wrap_py instead.
    @as_op([at_vector, pt.iscalar], [at_vector])

tests/backends/test_mcbackend.py::TestMcBackendSampling::test_return_multitrace[False]
  /app/tests/backends/test_mcbackend.py:285: UserWarning: Tuning samples will be included in the returned `MultiTrace` object, which can lead to complications in your downstream analysis. Please consider to switch to `InferenceData`:
  `pm.sample(..., return_inferencedata=True)`
    mtrace = pm.sample(

tests/backends/test_zarr.py::test_sample[compound_step-include_transformed-keep_tuning-return_zarr-keep_warning_stat-sequential_sampling-compute_loglike-sparse_writes]
tests/backends/test_zarr.py::test_sample[compound_step-discard_transformed-discard_tuning-return_idata-discard_warning_stat-sequential_sampling-no_loglike-sparse_writes]
  /app/pymc/step_methods/metropolis.py:321: RuntimeWarning: overflow encountered in exp
    "accept": np.mean(np.exp(self.accept_rate_iter)),

tests/distributions/moments/test_means.py: 2 warnings
tests/distributions/test_distribution.py: 3 warnings
tests/distributions/test_multivariate.py: 11 warnings
  /app/pymc/distributions/multivariate.py:468: FutureWarning: Use the scale argument to specify the scale matrix. cov will be removed in future versions.
    warnings.warn(

tests/distributions/test_continuous.py::TestMatchesScipy::test_skewstudentt_logcdf
  /root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/scipy/stats/_continuous_distns.py:5743: RuntimeWarning: divide by zero encountered in divide
    return d2 / d3

tests/distributions/test_continuous.py::TestMatchesScipy::test_interpolated_transform[None]
tests/logprob/test_utils.py::TestReplaceRVsByValues::test_basic[False-False]
tests/logprob/test_utils.py::TestReplaceRVsByValues::test_basic[False-True]
tests/stats/test_log_density.py::TestComputeLogLikelihood::test_basic[False]
tests/stats/test_log_density.py::TestComputeLogLikelihood::test_basic_log_prior[False]
  /app/pymc/model/core.py:1409: UserWarning: To disable default transform, please use default_transform=None instead of transform=None. Setting transform to None will not have any effect in future.
    warnings.warn(

tests/distributions/test_continuous.py::TestMoments::test_interpolated_support_point[x_points2-pdf_points2-size2-expected2]
tests/distributions/test_continuous.py::TestMoments::test_interpolated_support_point[x_points2-pdf_points2-size2-expected2]
tests/distributions/test_continuous.py::TestMoments::test_interpolated_support_point[x_points3-pdf_points3-size3-expected3]
tests/distributions/test_continuous.py::TestMoments::test_interpolated_support_point[x_points3-pdf_points3-size3-expected3]
  /root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/scipy/interpolate/_fitpack_impl.py:352: DeprecationWarning: Conversion of an array with ndim > 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
    aint, wrk = dfitpack.splint(t, c, k, a, b)

tests/distributions/test_continuous.py::TestMoments::test_polyagamma_support_point[1.0-0.0-None-0.25]
tests/distributions/test_transform.py::TestElementWiseLogp::test_triangular[lower2-c2-upper2-size2]
tests/distributions/test_transform.py::TestElementWiseLogp::test_triangular[lower2-c2-upper2-size2]
  /root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/tensor/rewriting/math.py:1421: RuntimeWarning: divide by zero encountered in scalar divide
    v = reduce(np.multiply, num, one) / reduce(np.multiply, denum, one)

tests/distributions/test_discrete.py::TestMatchesScipy::test_orderedlogistic[2]
tests/distributions/test_discrete.py::TestMatchesScipy::test_orderedlogistic[3]
tests/distributions/test_discrete.py::TestMatchesScipy::test_orderedlogistic[4]
tests/distributions/test_discrete.py::TestMatchesScipy::test_orderedprobit[2]
tests/distributions/test_discrete.py::TestMatchesScipy::test_orderedprobit[3]
tests/distributions/test_discrete.py::TestMatchesScipy::test_orderedprobit[4]
  /root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/numpy/_core/numeric.py:476: RuntimeWarning: invalid value encountered in cast
    multiarray.copyto(res, fill_value, casting='unsafe')

tests/distributions/test_discrete.py::TestOrderedLogistic::test_compute_p
tests/distributions/test_discrete.py::TestOrderedProbit::test_compute_p
  /app/pymc/model/core.py:1302: RuntimeWarning: invalid value encountered in cast
    data = convert_observed_data(data).astype(rv_var.dtype)

tests/distributions/test_mixture.py::TestMixtureMoments::test_list_univariate_components[weights2-comp_dists2-size2-expected2]
tests/distributions/test_mixture.py::TestMixtureMoments::test_list_multivariate_components[weights1-comp_dists1-size1-expected1]
tests/distributions/test_mixture.py::TestMixtureMoments::test_list_multivariate_components[weights2-comp_dists2-None-expected2]
  /app/pymc/distributions/mixture.py:312: MixtureTransformWarning: No safe default transform found for Mixture distribution x. This can happen when components have different supports or default transforms.
  If appropriate, you can specify a custom transform for more efficient sampling.
    transform_warning()

tests/distributions/test_mixture.py::TestMixtureDefaultTransforms::test_expected[comp_dists4-NoneType]
  /app/pymc/distributions/mixture.py:312: MixtureTransformWarning: No safe default transform found for Mixture distribution MixtureRV{inline=True}.out. This can happen when components have different supports or default transforms.
  If appropriate, you can specify a custom transform for more efficient sampling.
    transform_warning()

tests/distributions/test_mixture.py::TestMixtureDefaultTransforms::test_expected[comp_dists8-NoneType]
  /app/pymc/distributions/mixture.py:336: MixtureTransformWarning: No safe default transform found for Mixture distribution MixtureRV{inline=True}.out. This can happen when components have different supports or default transforms.
  If appropriate, you can specify a custom transform for more efficient sampling.
    transform_warning()

tests/distributions/test_mixture.py: 80 warnings
tests/distributions/test_truncated.py: 114 warnings
  /app/pymc/distributions/truncated.py:163: DeprecationWarning: Scan return signature will change. Updates dict will not be returned, only the first argument. Pass `return_updates=False` to conform to the new API and avoid this warning
    (truncated_rv_, reject_draws_), updates = scan(

tests/distributions/test_multivariate.py: 17 warnings
tests/logprob/test_linalg.py: 2 warnings
  /root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/tensor/nlinalg.py:200: FutureWarning: pytensor.tensor.linalg.trace is deprecated. Use pytensor.tensor.trace instead.
    warnings.warn(

tests/distributions/test_multivariate.py: 29 warnings
tests/gp/test_gp.py: 1 warning
  /root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/tensor/blas.py:1727: FutureWarning: batched_dot is deprecated. Use `dot` in conjunction with `tensor.vectorize` or `graph.replace.vectorize_graph`
    warnings.warn(

tests/distributions/test_multivariate.py::TestMatchesScipy::test_car_logp[True-()]
tests/distributions/test_multivariate.py::TestMatchesScipy::test_car_logp[True-()]
tests/distributions/test_multivariate.py::TestMatchesScipy::test_car_logp[True-(4,)]
tests/distributions/test_multivariate.py::TestMatchesScipy::test_car_logp[True-(4,)]
tests/distributions/test_multivariate.py::test_car_matrix_check[True]
tests/distributions/test_multivariate.py::test_car_matrix_check[True]
tests/distributions/test_multivariate.py::test_car_rng_fn[True]
tests/distributions/test_multivariate.py::test_car_rng_fn[True]
  /root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/sparse/variable.py:91: DeprecationWarning: pytensor.sparse.sub is deprecated and will be removed in a future version. Use pytensor.sparse.subtract instead.
    return sub(left, right)

tests/distributions/test_multivariate.py::TestMatchesScipy::test_car_logp[True-()]
tests/distributions/test_multivariate.py::TestMatchesScipy::test_car_logp[True-(4,)]
tests/distributions/test_multivariate.py::test_car_matrix_check[True]
tests/distributions/test_multivariate.py::test_car_rng_fn[True]
  /root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/sparse/variable.py:97: DeprecationWarning: pytensor.sparse.mul is deprecated and will be removed in a future version. Use pytensor.sparse.multiply instead.
    return mul(left, right)

tests/distributions/test_multivariate.py::TestMatchesScipy::test_car_logp[True-(4,)]
tests/distributions/test_multivariate.py::test_car_rng_fn[True]
  /root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/sparse/variable.py:64: UserWarning: Method <function _sparse_py_operators.dimshuffle at 0x7f0bca4da090> is not implemented for sparse variables. The variable will be converted to dense.
    warn(

tests/distributions/test_multivariate.py::TestWishart::test_distribution
tests/distributions/test_multivariate.py::TestWishart::test_distribution
tests/distributions/test_multivariate.py::TestWishart::test_distribution
  /app/pymc/distributions/multivariate.py:967: DeprecationWarning: Conversion of an array with ndim > 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
    result = stats.wishart.rvs(int(nu), V, size=scipy_size, random_state=rng)

tests/distributions/test_multivariate.py::test_mvnormal_no_cholesky_in_model_logp
tests/model/transform/test_conditioning.py::test_change_value_transforms
  /root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/configparser.py:44: FutureWarning: hessian will stop negating the output in a future version of PyMC.
  To suppress this warning set `negate_output=False`
    return f(*args, **kwargs)

tests/distributions/test_random_alternative_backends.py::test_dirichlet_multinomial[JAX]
  /root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/link/jax/linker.py:50: UserWarning: The RandomType SharedVariables [RNG(<Generator(PCG64) at 0x7F0B97C7DFC0>)] will not be used in the compiled JAX graph. Instead a copy will be used.
    warnings.warn(

tests/distributions/test_random_alternative_backends.py::test_dirichlet_multinomial_dims[JAX]
  /root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/link/jax/linker.py:50: UserWarning: The RandomType SharedVariables [RNG(<Generator(PCG64) at 0x7F0B92F32F80>)] will not be used in the compiled JAX graph. Instead a copy will be used.
    warnings.warn(

tests/distributions/test_random_alternative_backends.py::test_dirichlet_multinomial_dims[JAX]
  /root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/link/jax/linker.py:50: UserWarning: The RandomType SharedVariables [RNG(<Generator(PCG64) at 0x7F0B92F83A00>)] will not be used in the compiled JAX graph. Instead a copy will be used.
    warnings.warn(

tests/distributions/test_random_alternative_backends.py::test_mvstudentt[JAX]
  /root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/link/jax/linker.py:50: UserWarning: The RandomType SharedVariables [RNG(<Generator(PCG64) at 0x7F0B40181EE0>)] will not be used in the compiled JAX graph. Instead a copy will be used.
    warnings.warn(

tests/distributions/test_random_alternative_backends.py::test_repeated_arguments[JAX]
  /root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/link/jax/linker.py:50: UserWarning: The RandomType SharedVariables [RNG(<Generator(PCG64) at 0x7F0A8033B4C0>)] will not be used in the compiled JAX graph. Instead a copy will be used.
    warnings.warn(

tests/gp/test_cov.py::TestCovAdd::test_leftprod_matrix
  /app/tests/gp/test_cov.py:89: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
    cov = M + pm.gp.cov.ExpQuad(1, 0.1)

tests/gp/test_cov.py::TestCovProd::test_leftprod_matrix
  /app/tests/gp/test_cov.py:164: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
    cov = M * pm.gp.cov.ExpQuad(1, 0.1)

tests/gp/test_cov.py::TestCovProd::test_multiops
  /app/tests/gp/test_cov.py:177: DeprecationWarning: __array_wrap__ must accept context and return_scalar arguments (positionally) in the future. (Deprecated NumPy 2.0)
    + M * pm.gp.cov.ExpQuad(1, 0.1) * M * pm.gp.cov.ExpQuad(1, 0.1)

tests/gp/test_cov.py::TestCoregion::test_fullB
  /app/pymc/gp/cov.py:188: UserWarning: Only 1 column(s) out of 2 are being used to compute the covariance function. If this is not intended, increase 'input_dim' parameter to the number of columns to use. Ignore otherwise.
    warnings.warn(

tests/gp/test_hsgp_approx.py::TestHSGP::test_parametrization_drop_first[True-cov_func0]
  /app/pymc/gp/hsgp_approx.py:297: DeprecationWarning: The drop_first argument will be deprecated in future versions. See https://github.com/pymc-devs/pymc/pull/6877
    warnings.warn(

tests/logprob/test_basic.py::test_persist_inputs
  /app/pymc/logprob/basic.py:541: UserWarning: Random variables detected in the logp graph: {y_vv2}.
  This can happen when not all random variables have a corresponding value variable.
    warnings.warn(

tests/logprob/test_binary.py::test_potentially_measurable_operand
  /app/pymc/logprob/basic.py:541: UserWarning: Random variables detected in the logp graph: {normal_rv{"(),()->()"}.out}.
  This can happen when not all random variables have a corresponding value variable.
    warnings.warn(

tests/logprob/test_checks.py::test_assert_logprob
  /app/pymc/logprob/basic.py:541: UserWarning: Random variables detected in the logp graph: {MeasurableGt.0, MeasurableCheckAndRaise{raises=AssertionError, msg='Test assert'}.0}.
  This can happen when not all random variables have a corresponding value variable.
    warnings.warn(

tests/logprob/test_order.py::test_categorical[max]
tests/logprob/test_order.py::test_categorical[min]
  /app/pymc/distributions/discrete.py:1142: UserWarning: `p` parameters sum to [4], instead of 1.0. They will be automatically rescaled. You can rescale them directly to get rid of this warning.
    warnings.warn(

tests/logprob/test_scan.py::test_scan_joint_logprob[False]
tests/logprob/test_scan.py::test_scan_joint_logprob[True]
  /app/tests/logprob/test_scan.py:326: DeprecationWarning: Scan return signature will change. Updates dict will not be returned, only the first argument. Pass `return_updates=False` to conform to the new API and avoid this warning
    (Y_rv, S_rv), _ = pytensor.scan(

tests/logprob/test_transform_value.py::test_default_value_transform_logprob[gamma-dist_params9-<lambda>-size9]
tests/logprob/test_transforms.py::TestPowerRVTransform::test_reciprocal_rv_transform[1.0]
tests/logprob/test_transforms.py::TestPowerRVTransform::test_reciprocal_rv_transform[2.0]
  /root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/tensor/random/basic.py:477: FutureWarning: Gamma rate argument is deprecated and will stop working, use scale instead
    warnings.warn(

tests/logprob/test_transforms.py: 1 warning
tests/ode/test_ode.py: 12 warnings
  /root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/gradient.py:2107: DeprecationWarning: Scan return signature will change. Updates dict will not be returned, only the first argument. Pass `return_updates=False` to conform to the new API and avoid this warning
    jacobian_matrices, updates = pytensor.scan(

tests/model/test_core.py::test_empty_observed
  /app/pymc/model/core.py:1316: ImputationWarning: Data in a contains missing values and will be automatically imputed from the sampling distribution.
    warnings.warn(impute_message, ImputationWarning)

tests/model/test_core.py::TestModelCopy::test_copy_model[copy]
tests/model/test_core.py::TestModelCopy::test_copy_model[copy]
tests/model/test_core.py::TestModelCopy::test_copy_model[deepcopy]
tests/model/test_core.py::TestModelCopy::test_copy_model[deepcopy]
  /app/pymc/sampling/forward.py:428: DeprecationWarning: The samples argument has been deprecated in favor of draws. Use draws=1 going forward.
    warnings.warn(

tests/model/transform/test_optimization.py::test_freeze_dim_after_do_intervention
  /app/pymc/model/transform/conditioning.py:210: UserWarning: Intervention expression references the variable that is being intervened: mu. Intervention will be given the name: do_mu
    warnings.warn(

tests/model/transform/test_optimization.py::test_freeze_dims_and_data_partially_observed_rv
  /app/pymc/model/core.py:1316: ImputationWarning: Data in y contains missing values and will be automatically imputed from the sampling distribution.
    warnings.warn(impute_message, ImputationWarning)

tests/sampling/test_mcmc.py: 24 warnings
  /app/pymc/sampling/mcmc.py:757: UserWarning: A list or tuple of random_seed no longer specifies the specific random_seed of each chain. Use a single seed instead.
    warnings.warn(

tests/sampling/test_mcmc.py::test_step_args
  /root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/arviz/stats/diagnostics.py:596: RuntimeWarning: invalid value encountered in scalar divide
    (between_chain_variance / within_chain_variance + num_samples - 1) / (num_samples)

tests/sampling/test_mcmc.py::TestAssignStepMethods::test_normal_nograd_op
  /app/tests/sampling/test_mcmc.py:784: FutureWarning: pytensor.as_op is deprecated and will be removed in a future release. Please use pytensor.wrap_py instead.
    @as_op(itypes, otypes)

tests/sampling/test_parallel.py::test_explicit_sample[fork]
  /root/.local/share/mamba/envs/pymc-test/lib/python3.14/multiprocessing/popen_fork.py:70: RuntimeWarning: os.fork() was called. os.fork() is incompatible with multithreaded code, and JAX is multithreaded, so this will likely lead to a deadlock.
    self.pid = os.fork()

tests/sampling/test_parallel.py::test_explicit_sample[fork]
  /root/.local/share/mamba/envs/pymc-test/lib/python3.14/multiprocessing/popen_fork.py:70: DeprecationWarning: This process (pid=12) is multi-threaded, use of fork() may lead to deadlocks in the child.
    self.pid = os.fork()

tests/sampling/test_population.py: 300 warnings
  /app/pymc/backends/ndarray.py:116: DeprecationWarning: Conversion of an array with ndim > 0 to a scalar is deprecated, and will error in future. Ensure you extract a single element from your array before performing this operation. (Deprecated NumPy 1.25.)
    data[key][draw_idx] = val

tests/sampling/test_population.py::TestPopulationSamplers::test_demcmc_warning_on_small_populations
tests/sampling/test_population.py::TestPopulationSamplers::test_demcmc_warning_on_small_populations
tests/sampling/test_population.py::TestPopulationSamplers::test_demcmc_warning_on_small_populations
tests/sampling/test_population.py::TestPopulationSamplers::test_demcmc_warning_on_small_populations
tests/sampling/test_population.py::TestPopulationSamplers::test_demcmc_warning_on_small_populations
  /root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/arviz/data/base.py:272: UserWarning: More chains (6) than draws (5). Passed array should have shape (chains, draws, *shape)
    warnings.warn(

tests/smc/test_smc.py::TestSMC::test_convergence_checks
  /root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/arviz/data/base.py:272: UserWarning: More chains (32) than draws (1). Passed array should have shape (chains, draws, *shape)
    warnings.warn(

tests/stats/test_convergence.py::test_warn_treedepth_multiple_samplers
  /root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/arviz/data/base.py:272: UserWarning: More chains (3) than draws (2). Passed array should have shape (chains, draws, *shape)
    warnings.warn(

tests/step_methods/hmc/test_quadpotential.py::test_full_adapt_not_invertible
  /app/pymc/step_methods/hmc/quadpotential.py:900: RuntimeWarning: invalid value encountered in divide
    return np.divide(self.raw_cov, self.n_samples - 1, out=out)

tests/test_func_utils.py: 27 warnings
  /app/tests/test_func_utils.py:39: FutureWarning: find_constrained_prior is deprecated and will be removed in a future version. Please use maxent function from PreliZ. https://preliz.readthedocs.io/en/latest/api_reference.html#preliz.unidimensional.maxent
    opt_params = pm.find_constrained_prior(

tests/test_func_utils.py::test_find_constrained_prior_error_too_large[Gamma-0.1-0.4-init_guess0-fixed_params0]
tests/test_func_utils.py::test_find_constrained_prior_error_too_large[Exponential-0.1-1-init_guess1-fixed_params1]
tests/test_func_utils.py::test_find_constrained_prior_error_too_large[Binomial-0-2-init_guess2-fixed_params2]
  /app/tests/test_func_utils.py:71: FutureWarning: find_constrained_prior is deprecated and will be removed in a future version. Please use maxent function from PreliZ. https://preliz.readthedocs.io/en/latest/api_reference.html#preliz.unidimensional.maxent
    pm.find_constrained_prior(

tests/test_func_utils.py::test_find_constrained_prior_input_errors
  /app/tests/test_func_utils.py:84: FutureWarning: find_constrained_prior is deprecated and will be removed in a future version. Please use maxent function from PreliZ. https://preliz.readthedocs.io/en/latest/api_reference.html#preliz.unidimensional.maxent
    pm.find_constrained_prior(

tests/test_func_utils.py::test_find_constrained_prior_input_errors
  /app/tests/test_func_utils.py:94: FutureWarning: find_constrained_prior is deprecated and will be removed in a future version. Please use maxent function from PreliZ. https://preliz.readthedocs.io/en/latest/api_reference.html#preliz.unidimensional.maxent
    pm.find_constrained_prior(

tests/test_func_utils.py::test_find_constrained_prior_input_errors
  /app/tests/test_func_utils.py:105: FutureWarning: find_constrained_prior is deprecated and will be removed in a future version. Please use maxent function from PreliZ. https://preliz.readthedocs.io/en/latest/api_reference.html#preliz.unidimensional.maxent
    pm.find_constrained_prior(

tests/test_func_utils.py::test_find_constrained_prior_input_errors
  /app/tests/test_func_utils.py:116: FutureWarning: find_constrained_prior is deprecated and will be removed in a future version. Please use maxent function from PreliZ. https://preliz.readthedocs.io/en/latest/api_reference.html#preliz.unidimensional.maxent
    pm.find_constrained_prior(

tests/tuning/test_starting.py::test_find_MAP_no_gradient
  /app/tests/models.py:67: FutureWarning: pytensor.as_op is deprecated and will be removed in a future release. Please use pytensor.wrap_py instead.
    @as_op(itypes=[scalar_type], otypes=[scalar_type])

-- Docs: https://docs.pytest.org/en/stable/how-to/capture-warnings.html
============================= slowest 50 durations =============================
80.24s call     tests/smc/test_smc.py::TestMHKernel::test_normal_model
78.44s call     tests/smc/test_smc.py::TestSMC::test_sample
65.88s call     tests/sampling/test_mcmc.py::test_step_args
65.08s call     tests/smc/test_smc.py::TestSMC::test_convergence_checks
58.42s call     tests/distributions/test_multivariate.py::test_mvnormal_no_cholesky_in_model_logp
55.81s call     tests/distributions/test_simulator.py::TestSimulator::test_multiple_simulators
51.06s call     tests/test_progress_bar.py::test_progressbar_nested_compound
50.59s call     tests/logprob/test_transform_value.py::test_weakref_leak
50.56s call     tests/dims/test_model.py::test_complex_model
42.77s call     tests/distributions/test_simulator.py::TestSimulator::test_nested_simulators
40.19s call     tests/distributions/test_simulator.py::TestSimulator::test_custom_dist_sum_stat[float32]
35.51s call     tests/backends/test_arviz.py::TestDataPyMC::test_mv_missing_data_model
32.94s call     tests/distributions/test_simulator.py::TestSimulator::test_custom_dist_sum_stat[float64]
32.75s call     tests/sampling/test_mcmc.py::test_sample_var_names
31.16s call     tests/gp/test_hsgp_approx.py::TestHSGPPeriodic::test_conditional_periodic[cov_func0]
30.61s call     tests/test_func_utils.py::test_find_constrained_prior[0.5-StudentT-0-1-init_guess3-fixed_params3-None]
28.46s call     tests/variational/test_inference.py::test_replacements[FullRankADVI]
28.09s call     tests/gp/test_hsgp_approx.py::TestHSGP::test_prior[cov_func0-centered]
28.00s setup    tests/step_methods/test_metropolis.py::TestMetropolisUniform::test_kstest
27.55s call     tests/sampling/test_mcmc_external.py::test_external_nuts_sampler[pymc]
26.84s call     tests/gp/test_hsgp_approx.py::TestHSGPPeriodic::test_prior[100.0-cov_func0]
26.36s call     tests/variational/test_inference.py::test_replacements[ASVGD]
26.07s call     tests/dims/test_model.py::test_simple_model
24.89s call     tests/distributions/test_mixture.py::TestNormalMixture::test_normal_mixture_nd[(3, 3)-5]
24.74s call     tests/distributions/test_timeseries.py::TestAR::test_batched_sigma
23.50s call     tests/variational/test_inference.py::test_replacements[ADVI]
23.46s setup    tests/step_methods/hmc/test_nuts.py::TestNUTSLKJCholeskyCov::test_kstest
23.23s call     tests/gp/test_hsgp_approx.py::TestHSGP::test_conditional[cov_func1-noncentered]
23.12s call     tests/variational/test_inference.py::test_fit_oo[SVGD-full]
22.85s call     tests/gp/test_hsgp_approx.py::TestHSGP::test_prior[cov_func1-noncentered]
22.74s call     tests/gp/test_hsgp_approx.py::TestHSGP::test_conditional[cov_func0-centered]
22.47s call     tests/test_func_utils.py::test_find_constrained_prior[0.5-Gamma-0.1-0.4-init_guess0-fixed_params0-None]
21.76s call     tests/step_methods/test_metropolis.py::TestMetropolis::test_elemwise_update[batched_dist4]
21.61s call     tests/dims/test_model.py::test_zerosumnormal_model
20.72s call     tests/step_methods/test_metropolis.py::TestMetropolis::test_elemwise_update[batched_dist3]
20.48s call     tests/distributions/test_continuous.py::TestMatchesScipy::test_interpolated
20.42s call     tests/sampling/test_mcmc.py::test_blas_cores
20.28s call     tests/distributions/test_multivariate.py::TestLKJCorr::test_distribution
20.27s setup    tests/step_methods/hmc/test_nuts.py::TestNUTSUniform::test_kstest
19.79s setup    tests/gp/test_gp.py::TestMarginalVsMarginalApprox::test_fits_and_preds[FITC]
19.37s call     tests/logprob/test_transforms.py::TestTransform::test_check_jac_det[transform2]
19.33s setup    tests/backends/test_arviz.py::TestDataPyMC::test_to_idata
19.12s call     tests/gp/test_gp.py::TestMarginalVsMarginalApprox::test_fits_and_preds[FITC]
18.95s call     tests/sampling/test_mcmc.py::test_sample_find_MAP_does_not_modify_start
18.70s call     tests/variational/test_inference.py::test_replacements[SVGD]
18.61s setup    tests/step_methods/hmc/test_nuts.py::TestNUTSUniform2::test_kstest
18.59s setup    tests/step_methods/hmc/test_nuts.py::TestNUTSUniform3::test_kstest
18.19s call     tests/distributions/test_timeseries.py::TestEulerMaruyama::test_linear_model
17.95s call     tests/backends/test_arviz.py::TestDataPyMC::test_multivariate_observations
17.84s call     tests/logprob/test_transform_value.py::test_default_value_transform_logprob[pt_dist17-dist_params17-<lambda>-size17]
[36m[1m=========================== short test summary info ============================[0m
[31mFAILED[0m tests/backends/test_arviz.py::[1mTestDataPyMC::test_multivariate_observations[0m - assert (2, 50, 1) == (2, 50, 20)

  At index 2 diff: [0m[94m1[39;49;00m[90m[39;49;00m != [0m[94m20[39;49;00m[90m[39;49;00m

  Full diff:
  [0m[90m [39;49;00m ([90m[39;49;00m
  [90m [39;49;00m     2,[90m[39;49;00m
  [90m [39;49;00m     50,[90m[39;49;00m
  [91m-     20,[39;49;00m[90m[39;49;00m
  ?     ^^[90m[39;49;00m
  [92m+     1,[39;49;00m[90m[39;49;00m
  ?     ^[90m[39;49;00m
  [90m [39;49;00m )[90m[39;49;00m
[31mFAILED[0m tests/distributions/test_mixture.py::[1mTestMixtureSameFamily::test_with_multinomial[(3, 4)][0m - pymc.logprob.utils.ParameterValueError:
Apply node that caused the error: Check{}([[[-17642. ... 4381612]]], False)
Toposort index: 0
Inputs types: [TensorType(float64, shape=(3, 4, 1)), ScalarType(bool)]
Inputs shapes: [(3, 4, 1), ()]
Inputs strides: [(32, 8, 8), ()]
Inputs values: ['not shown', np.False_]
Inputs type_num: [12, 0]
Outputs clients: [[DeepCopyOp(Check{}.0)]]

Backtrace when the node is created (use PyTensor flag traceback__limit=N to make it longer):
  File "/app/pymc/logprob/basic.py", line 193, in logp
    return _logprob_helper(rv, value, **kwargs)
  File "/app/pymc/logprob/abstract.py", line 70, in _logprob_helper
    logprob = _logprob(rv.owner.op, values, *rv.owner.inputs, **kwargs)
  File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/functools.py", line 982, in wrapper
    return dispatch(args[0].__class__)(*args, **kw)
  File "/app/pymc/distributions/distribution.py", line 140, in logp
    return class_logp(value, *dist_params)
  File "/app/tests/distributions/test_dist_math.py", line 96, in logp
    return check_parameters(
  File "/app/pymc/distributions/dist_math.py", line 72, in check_parameters
    return CheckParameterValue(msg, can_be_replaced_by_ninf)(expr, all_true_scalar)
  File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/graph/op.py", line 294, in __call__
    node = self.make_node(*inputs, **kwargs)
  File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/raise_op.py", line 81, in make_node
    [value.type()],

Debug print of the apply node:
Check{} [id A] <Tensor3(float64, shape=(3, 4, 1))>
 ├─ [[[-17642. ... 4381612]]] [id B] <Tensor3(float64, shape=(3, 4, 1))>
 └─ False [id C] <bool>

Storage map footprint:
 - [[[-17642. ... 4381612]]], Shape: (3, 4, 1), ElemSize: 8 Byte(s), TotalSize: 96 Byte(s)
 - False, Shape: (), ElemSize: 1 Byte(s), TotalSize: 1.0 Byte(s)
 TotalSize: 97.0 Byte(s) 0.000 GB
 TotalSize inputs: 97.0 Byte(s) 0.000 GB
[31mFAILED[0m tests/distributions/test_mixture.py::[1mTestMixtureSameFamily::test_with_multinomial[(20,)][0m - pymc.logprob.utils.ParameterValueError:
Apply node that caused the error: Check{}([[-30495.1 ... 11099217]], False)
Toposort index: 0
Inputs types: [TensorType(float64, shape=(20, 1)), ScalarType(bool)]
Inputs shapes: [(20, 1), ()]
Inputs strides: [(8, 8), ()]
Inputs values: ['not shown', np.False_]
Inputs type_num: [12, 0]
Outputs clients: [[DeepCopyOp(Check{}.0)]]

Backtrace when the node is created (use PyTensor flag traceback__limit=N to make it longer):
  File "/app/pymc/logprob/basic.py", line 193, in logp
    return _logprob_helper(rv, value, **kwargs)
  File "/app/pymc/logprob/abstract.py", line 70, in _logprob_helper
    logprob = _logprob(rv.owner.op, values, *rv.owner.inputs, **kwargs)
  File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/functools.py", line 982, in wrapper
    return dispatch(args[0].__class__)(*args, **kw)
  File "/app/pymc/distributions/distribution.py", line 140, in logp
    return class_logp(value, *dist_params)
  File "/app/tests/distributions/test_dist_math.py", line 96, in logp
    return check_parameters(
  File "/app/pymc/distributions/dist_math.py", line 72, in check_parameters
    return CheckParameterValue(msg, can_be_replaced_by_ninf)(expr, all_true_scalar)
  File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/graph/op.py", line 294, in __call__
    node = self.make_node(*inputs, **kwargs)
  File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/raise_op.py", line 81, in make_node
    [value.type()],

Debug print of the apply node:
Check{} [id A] <Matrix(float64, shape=(20, 1))>
 ├─ [[-30495.1 ... 11099217]] [id B] <Matrix(float64, shape=(20, 1))>
 └─ False [id C] <bool>

Storage map footprint:
 - [[-30495.1 ... 11099217]], Shape: (20, 1), ElemSize: 8 Byte(s), TotalSize: 160 Byte(s)
 - False, Shape: (), ElemSize: 1 Byte(s), TotalSize: 1.0 Byte(s)
 TotalSize: 161.0 Byte(s) 0.000 GB
 TotalSize inputs: 161.0 Byte(s) 0.000 GB
[31mFAILED[0m tests/distributions/test_multivariate.py::[1mTestMatchesScipy::test_multinomial[2][0m - AssertionError:
Arrays are not almost equal to 6 decimals
{'p': array([0.5, 0.5]), 'n': array(1), 'value': (array(3), array(2))}
-inf location mismatch:
 ACTUAL: array(-5.950643)
 DESIRED: array(-inf)
[31mFAILED[0m tests/distributions/test_multivariate.py::[1mTestMatchesScipy::test_multinomial[3][0m - AssertionError:
Arrays are not almost equal to 6 decimals
{'p': array([0.5  , 0.375, 0.125]), 'n': array(3), 'value': (array(2), array(3), array(1))}
-inf location mismatch:
 ACTUAL: array(-7.101371)
 DESIRED: array(-inf)
[31mFAILED[0m tests/distributions/test_multivariate.py::[1mTestMatchesScipy::test_multinomial_invalid_value[0m - pymc.logprob.utils.ParameterValueError:
Apply node that caused the error: Check{}(-inf, False)
Toposort index: 0
Inputs types: [TensorType(float64, shape=()), ScalarType(bool)]
Inputs shapes: [(), ()]
Inputs strides: [(), ()]
Inputs values: [array(-inf), np.False_]
Inputs type_num: [12, 0]
Outputs clients: [[DeepCopyOp(Check{}.0)]]

Backtrace when the node is created (use PyTensor flag traceback__limit=N to make it longer):
  File "/app/pymc/logprob/basic.py", line 193, in logp
    return _logprob_helper(rv, value, **kwargs)
  File "/app/pymc/logprob/abstract.py", line 70, in _logprob_helper
    logprob = _logprob(rv.owner.op, values, *rv.owner.inputs, **kwargs)
  File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/functools.py", line 982, in wrapper
    return dispatch(args[0].__class__)(*args, **kw)
  File "/app/pymc/distributions/distribution.py", line 140, in logp
    return class_logp(value, *dist_params)
  File "/app/tests/distributions/test_dist_math.py", line 96, in logp
    return check_parameters(
  File "/app/pymc/distributions/dist_math.py", line 72, in check_parameters
    return CheckParameterValue(msg, can_be_replaced_by_ninf)(expr, all_true_scalar)
  File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/graph/op.py", line 294, in __call__
    node = self.make_node(*inputs, **kwargs)
  File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/raise_op.py", line 81, in make_node
    [value.type()],

Debug print of the apply node:
Check{} [id A] <Scalar(float64, shape=())>
 ├─ -inf [id B] <Scalar(float64, shape=())>
 └─ False [id C] <bool>

Storage map footprint:
 - -inf, Shape: (), ElemSize: 8 Byte(s), TotalSize: 8.0 Byte(s)
 - False, Shape: (), ElemSize: 1 Byte(s), TotalSize: 1.0 Byte(s)
 TotalSize: 9.0 Byte(s) 0.000 GB
 TotalSize inputs: 9.0 Byte(s) 0.000 GB
[31mFAILED[0m tests/distributions/test_multivariate.py::[1mTestMatchesScipy::test_multinomial_vectorized[extra_size0-p0-n1][0m - AssertionError:
Arrays are not almost equal to 4 decimals
vals=[[[2 2 6]
  [1 5 5]]]
Mismatched elements: 2 / 2 (100%)
Max absolute difference among violations: 20.67002132
Max relative difference among violations: 0.88648396
 ACTUAL: array([[-2.6468, -3.1677]])
 DESIRED: array([[-23.3169, -20.919 ]])
[31mFAILED[0m tests/distributions/test_multivariate.py::[1mTestMatchesScipy::test_multinomial_vectorized[extra_size0-p0-n2][0m - AssertionError:
Arrays are not almost equal to 4 decimals
vals=[[[[0 3 2]
   [1 2 3]]

  [[2 3 5]
   [2 2 7]]]]
Mismatched elements: 4 / 4 (100%)
Max absolute difference among violations: 46.54096767
Max relative difference among violations: 0.9577935
 ACTUAL: array([[[-2.6956, -2.0025],
        [-2.4645, -2.888 ]]])
 DESIRED: array([[[-49.2366, -47.4448],
        [-38.9197, -36.5218]]])
[31mFAILED[0m tests/distributions/test_multivariate.py::[1mTestMatchesScipy::test_multinomial_vectorized[extra_size0-p1-10][0m - pymc.logprob.utils.ParameterValueError:
Apply node that caused the error: Check{}([[-21.74401717]], False)
Toposort index: 0
Inputs types: [TensorType(float64, shape=(1, 1)), ScalarType(bool)]
Inputs shapes: [(1, 1), ()]
Inputs strides: [(8, 8), ()]
Inputs values: [array([[-21.74401717]]), np.False_]
Inputs type_num: [12, 0]
Outputs clients: [[DeepCopyOp(Check{}.0)]]

Backtrace when the node is created (use PyTensor flag traceback__limit=N to make it longer):
  File "/app/pymc/logprob/basic.py", line 193, in logp
    return _logprob_helper(rv, value, **kwargs)
  File "/app/pymc/logprob/abstract.py", line 70, in _logprob_helper
    logprob = _logprob(rv.owner.op, values, *rv.owner.inputs, **kwargs)
  File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/functools.py", line 982, in wrapper
    return dispatch(args[0].__class__)(*args, **kw)
  File "/app/pymc/distributions/distribution.py", line 140, in logp
    return class_logp(value, *dist_params)
  File "/app/tests/distributions/test_dist_math.py", line 96, in logp
    return check_parameters(
  File "/app/pymc/distributions/dist_math.py", line 72, in check_parameters
    return CheckParameterValue(msg, can_be_replaced_by_ninf)(expr, all_true_scalar)
  File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/graph/op.py", line 294, in __call__
    node = self.make_node(*inputs, **kwargs)
  File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/raise_op.py", line 81, in make_node
    [value.type()],

Debug print of the apply node:
Check{} [id A] <Matrix(float64, shape=(1, 1))>
 ├─ [[-21.74401717]] [id B] <Matrix(float64, shape=(1, 1))>
 └─ False [id C] <bool>

Storage map footprint:
 - [[-21.74401717]], Shape: (1, 1), ElemSize: 8 Byte(s), TotalSize: 8 Byte(s)
 - False, Shape: (), ElemSize: 1 Byte(s), TotalSize: 1.0 Byte(s)
 TotalSize: 9.0 Byte(s) 0.000 GB
 TotalSize inputs: 9.0 Byte(s) 0.000 GB
[31mFAILED[0m tests/distributions/test_multivariate.py::[1mTestMatchesScipy::test_multinomial_vectorized[extra_size0-p1-n1][0m - pymc.logprob.utils.ParameterValueError:
Apply node that caused the error: Check{}([[-22.3377 ... 93983518]], False)
Toposort index: 0
Inputs types: [TensorType(float64, shape=(1, 2)), ScalarType(bool)]
Inputs shapes: [(1, 2), ()]
Inputs strides: [(16, 8), ()]
Inputs values: [array([[-22.33773045, -19.93983518]]), np.False_]
Inputs type_num: [12, 0]
Outputs clients: [[DeepCopyOp(Check{}.0)]]

Backtrace when the node is created (use PyTensor flag traceback__limit=N to make it longer):
  File "/app/pymc/logprob/basic.py", line 193, in logp
    return _logprob_helper(rv, value, **kwargs)
  File "/app/pymc/logprob/abstract.py", line 70, in _logprob_helper
    logprob = _logprob(rv.owner.op, values, *rv.owner.inputs, **kwargs)
  File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/functools.py", line 982, in wrapper
    return dispatch(args[0].__class__)(*args, **kw)
  File "/app/pymc/distributions/distribution.py", line 140, in logp
    return class_logp(value, *dist_params)
  File "/app/tests/distributions/test_dist_math.py", line 96, in logp
    return check_parameters(
  File "/app/pymc/distributions/dist_math.py", line 72, in check_parameters
    return CheckParameterValue(msg, can_be_replaced_by_ninf)(expr, all_true_scalar)
  File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/graph/op.py", line 294, in __call__
    node = self.make_node(*inputs, **kwargs)
  File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/raise_op.py", line 81, in make_node
    [value.type()],

Debug print of the apply node:
Check{} [id A] <Matrix(float64, shape=(1, 2))>
 ├─ [[-22.3377 ... 93983518]] [id B] <Matrix(float64, shape=(1, 2))>
 └─ False [id C] <bool>

Storage map footprint:
 - [[-22.3377 ... 93983518]], Shape: (1, 2), ElemSize: 8 Byte(s), TotalSize: 16 Byte(s)
 - False, Shape: (), ElemSize: 1 Byte(s), TotalSize: 1.0 Byte(s)
 TotalSize: 17.0 Byte(s) 0.000 GB
 TotalSize inputs: 17.0 Byte(s) 0.000 GB
[31mFAILED[0m tests/distributions/test_multivariate.py::[1mTestMatchesScipy::test_multinomial_vectorized[extra_size0-p1-n2][0m - pymc.logprob.utils.ParameterValueError:
Apply node that caused the error: Check{}([[[-46.838 ... 2354329]]], False)
Toposort index: 0
Inputs types: [TensorType(float64, shape=(1, 2, 2)), ScalarType(bool)]
Inputs shapes: [(1, 2, 2), ()]
Inputs strides: [(32, 16, 8), ()]
Inputs values: [array([[[-46.83835939, -45.04659992],
        [-36.52143856, -34.12354329]]]), np.False_]
Inputs type_num: [12, 0]
Outputs clients: [[DeepCopyOp(Check{}.0)]]

Backtrace when the node is created (use PyTensor flag traceback__limit=N to make it longer):
  File "/app/pymc/logprob/basic.py", line 193, in logp
    return _logprob_helper(rv, value, **kwargs)
  File "/app/pymc/logprob/abstract.py", line 70, in _logprob_helper
    logprob = _logprob(rv.owner.op, values, *rv.owner.inputs, **kwargs)
  File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/functools.py", line 982, in wrapper
    return dispatch(args[0].__class__)(*args, **kw)
  File "/app/pymc/distributions/distribution.py", line 140, in logp
    return class_logp(value, *dist_params)
  File "/app/tests/distributions/test_dist_math.py", line 96, in logp
    return check_parameters(
  File "/app/pymc/distributions/dist_math.py", line 72, in check_parameters
    return CheckParameterValue(msg, can_be_replaced_by_ninf)(expr, all_true_scalar)
  File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/graph/op.py", line 294, in __call__
    node = self.make_node(*inputs, **kwargs)
  File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/raise_op.py", line 81, in make_node
    [value.type()],

Debug print of the apply node:
Check{} [id A] <Tensor3(float64, shape=(1, 2, 2))>
 ├─ [[[-46.838 ... 2354329]]] [id B] <Tensor3(float64, shape=(1, 2, 2))>
 └─ False [id C] <bool>

Storage map footprint:
 - [[[-46.838 ... 2354329]]], Shape: (1, 2, 2), ElemSize: 8 Byte(s), TotalSize: 32 Byte(s)
 - False, Shape: (), ElemSize: 1 Byte(s), TotalSize: 1.0 Byte(s)
 TotalSize: 33.0 Byte(s) 0.000 GB
 TotalSize inputs: 33.0 Byte(s) 0.000 GB
[31mFAILED[0m tests/distributions/test_multivariate.py::[1mTestMatchesScipy::test_multinomial_vectorized[extra_size0-p2-10][0m - pymc.logprob.utils.ParameterValueError:
Apply node that caused the error: Check{}([[[-64.31255676]]], False)
Toposort index: 0
Inputs types: [TensorType(float64, shape=(1, 1, 1)), ScalarType(bool)]
Inputs shapes: [(1, 1, 1), ()]
Inputs strides: [(8, 8, 8), ()]
Inputs values: [array([[[-64.31255676]]]), np.False_]
Inputs type_num: [12, 0]
Outputs clients: [[DeepCopyOp(Check{}.0)]]

Backtrace when the node is created (use PyTensor flag traceback__limit=N to make it longer):
  File "/app/pymc/logprob/basic.py", line 193, in logp
    return _logprob_helper(rv, value, **kwargs)
  File "/app/pymc/logprob/abstract.py", line 70, in _logprob_helper
    logprob = _logprob(rv.owner.op, values, *rv.owner.inputs, **kwargs)
  File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/functools.py", line 982, in wrapper
    return dispatch(args[0].__class__)(*args, **kw)
  File "/app/pymc/distributions/distribution.py", line 140, in logp
    return class_logp(value, *dist_params)
  File "/app/tests/distributions/test_dist_math.py", line 96, in logp
    return check_parameters(
  File "/app/pymc/distributions/dist_math.py", line 72, in check_parameters
    return CheckParameterValue(msg, can_be_replaced_by_ninf)(expr, all_true_scalar)
  File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/graph/op.py", line 294, in __call__
    node = self.make_node(*inputs, **kwargs)
  File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/raise_op.py", line 81, in make_node
    [value.type()],

Debug print of the apply node:
Check{} [id A] <Tensor3(float64, shape=(1, 1, 1))>
 ├─ [[[-64.31255676]]] [id B] <Tensor3(float64, shape=(1, 1, 1))>
 └─ False [id C] <bool>

Storage map footprint:
 - [[[-64.31255676]]], Shape: (1, 1, 1), ElemSize: 8 Byte(s), TotalSize: 8 Byte(s)
 - False, Shape: (), ElemSize: 1 Byte(s), TotalSize: 1.0 Byte(s)
 TotalSize: 9.0 Byte(s) 0.000 GB
 TotalSize inputs: 9.0 Byte(s) 0.000 GB
[31mFAILED[0m tests/distributions/test_multivariate.py::[1mTestMatchesScipy::test_multinomial_vectorized[extra_size0-p2-n1][0m - pymc.logprob.utils.ParameterValueError:
Apply node that caused the error: Check{}([[[-65.447 ... 4930532]]], False)
Toposort index: 0
Inputs types: [TensorType(float64, shape=(1, 1, 2)), ScalarType(bool)]
Inputs shapes: [(1, 1, 2), ()]
Inputs strides: [(16, 16, 8), ()]
Inputs values: [array([[[-65.44720059, -63.04930532]]]), np.False_]
Inputs type_num: [12, 0]
Outputs clients: [[DeepCopyOp(Check{}.0)]]

Backtrace when the node is created (use PyTensor flag traceback__limit=N to make it longer):
  File "/app/pymc/logprob/basic.py", line 193, in logp
    return _logprob_helper(rv, value, **kwargs)
  File "/app/pymc/logprob/abstract.py", line 70, in _logprob_helper
    logprob = _logprob(rv.owner.op, values, *rv.owner.inputs, **kwargs)
  File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/functools.py", line 982, in wrapper
    return dispatch(args[0].__class__)(*args, **kw)
  File "/app/pymc/distributions/distribution.py", line 140, in logp
    return class_logp(value, *dist_params)
  File "/app/tests/distributions/test_dist_math.py", line 96, in logp
    return check_parameters(
  File "/app/pymc/distributions/dist_math.py", line 72, in check_parameters
    return CheckParameterValue(msg, can_be_replaced_by_ninf)(expr, all_true_scalar)
  File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/graph/op.py", line 294, in __call__
    node = self.make_node(*inputs, **kwargs)
  File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/raise_op.py", line 81, in make_node
    [value.type()],

Debug print of the apply node:
Check{} [id A] <Tensor3(float64, shape=(1, 1, 2))>
 ├─ [[[-65.447 ... 4930532]]] [id B] <Tensor3(float64, shape=(1, 1, 2))>
 └─ False [id C] <bool>

Storage map footprint:
 - [[[-65.447 ... 4930532]]], Shape: (1, 1, 2), ElemSize: 8 Byte(s), TotalSize: 16 Byte(s)
 - False, Shape: (), ElemSize: 1 Byte(s), TotalSize: 1.0 Byte(s)
 TotalSize: 17.0 Byte(s) 0.000 GB
 TotalSize inputs: 17.0 Byte(s) 0.000 GB
[31mFAILED[0m tests/distributions/test_multivariate.py::[1mTestMatchesScipy::test_multinomial_vectorized[extra_size0-p2-n2][0m - pymc.logprob.utils.ParameterValueError:
Apply node that caused the error: Check{}([[[-53.709 ... 9479654]]], False)
Toposort index: 0
Inputs types: [TensorType(float64, shape=(1, 2, 2)), ScalarType(bool)]
Inputs shapes: [(1, 2, 2), ()]
Inputs strides: [(32, 16, 8), ()]
Inputs values: [array([[[-53.70961264, -51.91785317],
        [-43.39269181, -40.99479654]]]), np.False_]
Inputs type_num: [12, 0]
Outputs clients: [[DeepCopyOp(Check{}.0)]]

Backtrace when the node is created (use PyTensor flag traceback__limit=N to make it longer):
  File "/app/pymc/logprob/basic.py", line 193, in logp
    return _logprob_helper(rv, value, **kwargs)
  File "/app/pymc/logprob/abstract.py", line 70, in _logprob_helper
    logprob = _logprob(rv.owner.op, values, *rv.owner.inputs, **kwargs)
  File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/functools.py", line 982, in wrapper
    return dispatch(args[0].__class__)(*args, **kw)
  File "/app/pymc/distributions/distribution.py", line 140, in logp
    return class_logp(value, *dist_params)
  File "/app/tests/distributions/test_dist_math.py", line 96, in logp
    return check_parameters(
  File "/app/pymc/distributions/dist_math.py", line 72, in check_parameters
    return CheckParameterValue(msg, can_be_replaced_by_ninf)(expr, all_true_scalar)
  File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/graph/op.py", line 294, in __call__
    node = self.make_node(*inputs, **kwargs)
  File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/raise_op.py", line 81, in make_node
    [value.type()],

Debug print of the apply node:
Check{} [id A] <Tensor3(float64, shape=(1, 2, 2))>
 ├─ [[[-53.709 ... 9479654]]] [id B] <Tensor3(float64, shape=(1, 2, 2))>
 └─ False [id C] <bool>

Storage map footprint:
 - [[[-53.709 ... 9479654]]], Shape: (1, 2, 2), ElemSize: 8 Byte(s), TotalSize: 32 Byte(s)
 - False, Shape: (), ElemSize: 1 Byte(s), TotalSize: 1.0 Byte(s)
 TotalSize: 33.0 Byte(s) 0.000 GB
 TotalSize inputs: 33.0 Byte(s) 0.000 GB
[31mFAILED[0m tests/distributions/test_multivariate.py::[1mTestMatchesScipy::test_multinomial_vectorized[extra_size1-p0-10][0m - AssertionError:
Arrays are not almost equal to 4 decimals
vals=[[3 1 6]
 [0 1 9]]
(shapes (2,), (1,) mismatch)
 ACTUAL: array([-3.4578, -5.1397])
 DESIRED: array([-23.7019])
[31mFAILED[0m tests/distributions/test_multivariate.py::[1mTestMatchesScipy::test_multinomial_vectorized[extra_size1-p0-n1][0m - AssertionError:
Arrays are not almost equal to 4 decimals
vals=[[[3 2 5]
  [3 2 6]]

 [[2 3 5]
  [2 4 5]]]
(shapes (2, 2), (1, 2) mismatch)
 ACTUAL: array([[-2.87  , -2.957 ],
       [-2.4645, -2.6569]])
 DESIRED: array([[-61.0574, -58.6595]])
[31mFAILED[0m tests/distributions/test_multivariate.py::[1mTestMatchesScipy::test_multinomial_vectorized[extra_size1-p0-n2][0m - AssertionError:
Arrays are not almost equal to 4 decimals
vals=[[[[3 0 2]
   [2 0 4]]

  [[2 2 6]
   [1 2 8]]]


 [[[2 0 3]
   [4 1 1]]

  [[3 2 5]
   [2 2 7]]]]
(shapes (2, 2, 2), (1, 2, 2) mismatch)
 ACTUAL: array([[[-3.912 , -3.2834],
        [-2.6468, -3.358 ]],
...
 DESIRED: array([[[-110.0471, -108.2553],
        [ -99.7302,  -97.3323]]])
[31mFAILED[0m tests/distributions/test_multivariate.py::[1mTestMatchesScipy::test_multinomial_vectorized[extra_size1-p1-10][0m - pymc.logprob.utils.ParameterValueError:
Apply node that caused the error: Check{}([[-54.71660357]], False)
Toposort index: 0
Inputs types: [TensorType(float64, shape=(1, 1)), ScalarType(bool)]
Inputs shapes: [(1, 1), ()]
Inputs strides: [(8, 8), ()]
Inputs values: [array([[-54.71660357]]), np.False_]
Inputs type_num: [12, 0]
Outputs clients: [[DeepCopyOp(Check{}.0)]]

Backtrace when the node is created (use PyTensor flag traceback__limit=N to make it longer):
  File "/app/pymc/logprob/basic.py", line 193, in logp
    return _logprob_helper(rv, value, **kwargs)
  File "/app/pymc/logprob/abstract.py", line 70, in _logprob_helper
    logprob = _logprob(rv.owner.op, values, *rv.owner.inputs, **kwargs)
  File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/functools.py", line 982, in wrapper
    return dispatch(args[0].__class__)(*args, **kw)
  File "/app/pymc/distributions/distribution.py", line 140, in logp
    return class_logp(value, *dist_params)
  File "/app/tests/distributions/test_dist_math.py", line 96, in logp
    return check_parameters(
  File "/app/pymc/distributions/dist_math.py", line 72, in check_parameters
    return CheckParameterValue(msg, can_be_replaced_by_ninf)(expr, all_true_scalar)
  File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/graph/op.py", line 294, in __call__
    node = self.make_node(*inputs, **kwargs)
  File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/raise_op.py", line 81, in make_node
    [value.type()],

Debug print of the apply node:
Check{} [id A] <Matrix(float64, shape=(1, 1))>
 ├─ [[-54.71660357]] [id B] <Matrix(float64, shape=(1, 1))>
 └─ False [id C] <bool>

Storage map footprint:
 - [[-54.71660357]], Shape: (1, 1), ElemSize: 8 Byte(s), TotalSize: 8 Byte(s)
 - False, Shape: (), ElemSize: 1 Byte(s), TotalSize: 1.0 Byte(s)
 TotalSize: 9.0 Byte(s) 0.000 GB
 TotalSize inputs: 9.0 Byte(s) 0.000 GB
[31mFAILED[0m tests/distributions/test_multivariate.py::[1mTestMatchesScipy::test_multinomial_vectorized[extra_size1-p1-n1][0m - pymc.logprob.utils.ParameterValueError:
Apply node that caused the error: Check{}([[-58.8476 ... 44975113]], False)
Toposort index: 0
Inputs types: [TensorType(float64, shape=(1, 2)), ScalarType(bool)]
Inputs shapes: [(1, 2), ()]
Inputs strides: [(16, 8), ()]
Inputs values: [array([[-58.84764641, -56.44975113]]), np.False_]
Inputs type_num: [12, 0]
Outputs clients: [[DeepCopyOp(Check{}.0)]]

Backtrace when the node is created (use PyTensor flag traceback__limit=N to make it longer):
  File "/app/pymc/logprob/basic.py", line 193, in logp
    return _logprob_helper(rv, value, **kwargs)
  File "/app/pymc/logprob/abstract.py", line 70, in _logprob_helper
    logprob = _logprob(rv.owner.op, values, *rv.owner.inputs, **kwargs)
  File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/functools.py", line 982, in wrapper
    return dispatch(args[0].__class__)(*args, **kw)
  File "/app/pymc/distributions/distribution.py", line 140, in logp
    return class_logp(value, *dist_params)
  File "/app/tests/distributions/test_dist_math.py", line 96, in logp
    return check_parameters(
  File "/app/pymc/distributions/dist_math.py", line 72, in check_parameters
    return CheckParameterValue(msg, can_be_replaced_by_ninf)(expr, all_true_scalar)
  File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/graph/op.py", line 294, in __call__
    node = self.make_node(*inputs, **kwargs)
  File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/raise_op.py", line 81, in make_node
    [value.type()],

Debug print of the apply node:
Check{} [id A] <Matrix(float64, shape=(1, 2))>
 ├─ [[-58.8476 ... 44975113]] [id B] <Matrix(float64, shape=(1, 2))>
 └─ False [id C] <bool>

Storage map footprint:
 - [[-58.8476 ... 44975113]], Shape: (1, 2), ElemSize: 8 Byte(s), TotalSize: 16 Byte(s)
 - False, Shape: (), ElemSize: 1 Byte(s), TotalSize: 1.0 Byte(s)
 TotalSize: 17.0 Byte(s) 0.000 GB
 TotalSize inputs: 17.0 Byte(s) 0.000 GB
[31mFAILED[0m tests/distributions/test_multivariate.py::[1mTestMatchesScipy::test_multinomial_vectorized[extra_size1-p1-n2][0m - pymc.logprob.utils.ParameterValueError:
Apply node that caused the error: Check{}([[[-99.471 ... 5715088]]], False)
Toposort index: 0
Inputs types: [TensorType(float64, shape=(1, 2, 2)), ScalarType(bool)]
Inputs shapes: [(1, 2, 2), ()]
Inputs strides: [(32, 16, 8), ()]
Inputs values: [array([[[-99.47196698, -97.68020751],
        [-89.15504615, -86.75715088]]]), np.False_]
Inputs type_num: [12, 0]
Outputs clients: [[DeepCopyOp(Check{}.0)]]

Backtrace when the node is created (use PyTensor flag traceback__limit=N to make it longer):
  File "/app/pymc/logprob/basic.py", line 193, in logp
    return _logprob_helper(rv, value, **kwargs)
  File "/app/pymc/logprob/abstract.py", line 70, in _logprob_helper
    logprob = _logprob(rv.owner.op, values, *rv.owner.inputs, **kwargs)
  File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/functools.py", line 982, in wrapper
    return dispatch(args[0].__class__)(*args, **kw)
  File "/app/pymc/distributions/distribution.py", line 140, in logp
    return class_logp(value, *dist_params)
  File "/app/tests/distributions/test_dist_math.py", line 96, in logp
    return check_parameters(
  File "/app/pymc/distributions/dist_math.py", line 72, in check_parameters
    return CheckParameterValue(msg, can_be_replaced_by_ninf)(expr, all_true_scalar)
  File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/graph/op.py", line 294, in __call__
    node = self.make_node(*inputs, **kwargs)
  File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/raise_op.py", line 81, in make_node
    [value.type()],

Debug print of the apply node:
Check{} [id A] <Tensor3(float64, shape=(1, 2, 2))>
 ├─ [[[-99.471 ... 5715088]]] [id B] <Tensor3(float64, shape=(1, 2, 2))>
 └─ False [id C] <bool>

Storage map footprint:
 - [[[-99.471 ... 5715088]]], Shape: (1, 2, 2), ElemSize: 8 Byte(s), TotalSize: 32 Byte(s)
 - False, Shape: (), ElemSize: 1 Byte(s), TotalSize: 1.0 Byte(s)
 TotalSize: 33.0 Byte(s) 0.000 GB
 TotalSize inputs: 33.0 Byte(s) 0.000 GB
[31mFAILED[0m tests/distributions/test_multivariate.py::[1mTestMatchesScipy::test_multinomial_vectorized[extra_size1-p2-10][0m - pymc.logprob.utils.ParameterValueError:
Apply node that caused the error: Check{}([[[-139.82760311]]], False)
Toposort index: 0
Inputs types: [TensorType(float64, shape=(1, 1, 1)), ScalarType(bool)]
Inputs shapes: [(1, 1, 1), ()]
Inputs strides: [(8, 8, 8), ()]
Inputs values: [array([[[-139.82760311]]]), np.False_]
Inputs type_num: [12, 0]
Outputs clients: [[DeepCopyOp(Check{}.0)]]

Backtrace when the node is created (use PyTensor flag traceback__limit=N to make it longer):
  File "/app/pymc/logprob/basic.py", line 193, in logp
    return _logprob_helper(rv, value, **kwargs)
  File "/app/pymc/logprob/abstract.py", line 70, in _logprob_helper
    logprob = _logprob(rv.owner.op, values, *rv.owner.inputs, **kwargs)
  File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/functools.py", line 982, in wrapper
    return dispatch(args[0].__class__)(*args, **kw)
  File "/app/pymc/distributions/distribution.py", line 140, in logp
    return class_logp(value, *dist_params)
  File "/app/tests/distributions/test_dist_math.py", line 96, in logp
    return check_parameters(
  File "/app/pymc/distributions/dist_math.py", line 72, in check_parameters
    return CheckParameterValue(msg, can_be_replaced_by_ninf)(expr, all_true_scalar)
  File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/graph/op.py", line 294, in __call__
    node = self.make_node(*inputs, **kwargs)
  File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/raise_op.py", line 81, in make_node
    [value.type()],

Debug print of the apply node:
Check{} [id A] <Tensor3(float64, shape=(1, 1, 1))>
 ├─ [[[-139.82760311]]] [id B] <Tensor3(float64, shape=(1, 1, 1))>
 └─ False [id C] <bool>

Storage map footprint:
 - [[[-139.82760311]]], Shape: (1, 1, 1), ElemSize: 8 Byte(s), TotalSize: 8 Byte(s)
 - False, Shape: (), ElemSize: 1 Byte(s), TotalSize: 1.0 Byte(s)
 TotalSize: 9.0 Byte(s) 0.000 GB
 TotalSize inputs: 9.0 Byte(s) 0.000 GB
[31mFAILED[0m tests/distributions/test_multivariate.py::[1mTestMatchesScipy::test_multinomial_vectorized[extra_size1-p2-n1][0m - pymc.logprob.utils.ParameterValueError:
Apply node that caused the error: Check{}([[[-151.84 ... 4390183]]], False)
Toposort index: 0
Inputs types: [TensorType(float64, shape=(1, 1, 2)), ScalarType(bool)]
Inputs shapes: [(1, 1, 2), ()]
Inputs strides: [(16, 16, 8), ()]
Inputs values: [array([[[-151.8417971 , -149.44390183]]]), np.False_]
Inputs type_num: [12, 0]
Outputs clients: [[DeepCopyOp(Check{}.0)]]

Backtrace when the node is created (use PyTensor flag traceback__limit=N to make it longer):
  File "/app/pymc/logprob/basic.py", line 193, in logp
    return _logprob_helper(rv, value, **kwargs)
  File "/app/pymc/logprob/abstract.py", line 70, in _logprob_helper
    logprob = _logprob(rv.owner.op, values, *rv.owner.inputs, **kwargs)
  File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/functools.py", line 982, in wrapper
    return dispatch(args[0].__class__)(*args, **kw)
  File "/app/pymc/distributions/distribution.py", line 140, in logp
    return class_logp(value, *dist_params)
  File "/app/tests/distributions/test_dist_math.py", line 96, in logp
    return check_parameters(
  File "/app/pymc/distributions/dist_math.py", line 72, in check_parameters
    return CheckParameterValue(msg, can_be_replaced_by_ninf)(expr, all_true_scalar)
  File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/graph/op.py", line 294, in __call__
    node = self.make_node(*inputs, **kwargs)
  File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/raise_op.py", line 81, in make_node
    [value.type()],

Debug print of the apply node:
Check{} [id A] <Tensor3(float64, shape=(1, 1, 2))>
 ├─ [[[-151.84 ... 4390183]]] [id B] <Tensor3(float64, shape=(1, 1, 2))>
 └─ False [id C] <bool>

Storage map footprint:
 - [[[-151.84 ... 4390183]]], Shape: (1, 1, 2), ElemSize: 8 Byte(s), TotalSize: 16 Byte(s)
 - False, Shape: (), ElemSize: 1 Byte(s), TotalSize: 1.0 Byte(s)
 TotalSize: 17.0 Byte(s) 0.000 GB
 TotalSize inputs: 17.0 Byte(s) 0.000 GB
[31mFAILED[0m tests/distributions/test_multivariate.py::[1mTestMatchesScipy::test_multinomial_vectorized[extra_size1-p2-n2][0m - pymc.logprob.utils.ParameterValueError:
Apply node that caused the error: Check{}([[[-116.77 ... 5722299]]], False)
Toposort index: 0
Inputs types: [TensorType(float64, shape=(1, 2, 2)), ScalarType(bool)]
Inputs shapes: [(1, 2, 2), ()]
Inputs strides: [(32, 16, 8), ()]
Inputs values: [array([[[-116.7720391 , -114.98027963],
        [-106.45511827, -104.05722299]]]), np.False_]
Inputs type_num: [12, 0]
Outputs clients: [[DeepCopyOp(Check{}.0)]]

Backtrace when the node is created (use PyTensor flag traceback__limit=N to make it longer):
  File "/app/pymc/logprob/basic.py", line 193, in logp
    return _logprob_helper(rv, value, **kwargs)
  File "/app/pymc/logprob/abstract.py", line 70, in _logprob_helper
    logprob = _logprob(rv.owner.op, values, *rv.owner.inputs, **kwargs)
  File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/functools.py", line 982, in wrapper
    return dispatch(args[0].__class__)(*args, **kw)
  File "/app/pymc/distributions/distribution.py", line 140, in logp
    return class_logp(value, *dist_params)
  File "/app/tests/distributions/test_dist_math.py", line 96, in logp
    return check_parameters(
  File "/app/pymc/distributions/dist_math.py", line 72, in check_parameters
    return CheckParameterValue(msg, can_be_replaced_by_ninf)(expr, all_true_scalar)
  File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/graph/op.py", line 294, in __call__
    node = self.make_node(*inputs, **kwargs)
  File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/raise_op.py", line 81, in make_node
    [value.type()],

Debug print of the apply node:
Check{} [id A] <Tensor3(float64, shape=(1, 2, 2))>
 ├─ [[[-116.77 ... 5722299]]] [id B] <Tensor3(float64, shape=(1, 2, 2))>
 └─ False [id C] <bool>

Storage map footprint:
 - [[[-116.77 ... 5722299]]], Shape: (1, 2, 2), ElemSize: 8 Byte(s), TotalSize: 32 Byte(s)
 - False, Shape: (), ElemSize: 1 Byte(s), TotalSize: 1.0 Byte(s)
 TotalSize: 33.0 Byte(s) 0.000 GB
 TotalSize inputs: 33.0 Byte(s) 0.000 GB
[31mFAILED[0m tests/distributions/test_multivariate.py::[1mTestMatchesScipy::test_multinomial_vectorized[extra_size2-p0-10][0m - AssertionError:
Arrays are not almost equal to 4 decimals
vals=[[[3 3 4]
  [3 2 5]
  [1 2 7]]

 [[3 4 3]
  [2 3 5]
  [0 6 4]]]
(shapes (2, 3), (1, 1) mismatch)
 ACTUAL: array([[-2.87  , -2.87  , -2.9833],
       [-3.3808, -2.4645, -4.6493]])
 DESIRED: array([[-94.74]])
[31mFAILED[0m tests/distributions/test_multivariate.py::[1mTestMatchesScipy::test_multinomial_vectorized[extra_size2-p0-n1][0m - AssertionError:
Arrays are not almost equal to 4 decimals
vals=[[[[3 4 3]
   [0 4 7]]

  [[2 4 4]
   [1 4 6]]

  [[1 5 4]
   [4 4 3]]]


 [[[1 1 8]
   [4 3 4]]

  [[5 1 4]
   [1 5 5]]

  [[4 3 3]
   [2 3 6]]]]
(shapes (2, 3, 2), (1, 1, 2) mismatch)
 ACTUAL: array([[[-3.3808, -3.8688],
        [-2.7522, -2.8392],
        [-3.263 , -3.9786]],...
 DESIRED: array([[[-222.3356, -219.9377]]])
[31mFAILED[0m tests/distributions/test_multivariate.py::[1mTestMatchesScipy::test_multinomial_vectorized[extra_size2-p0-n2][0m - AssertionError:
Arrays are not almost equal to 4 decimals
vals=[[[[[3 1 1]
    [1 1 4]]

   [[0 2 8]
    [1 6 4]]]


  [[[1 1 3]
    [1 1 4]]

   [[3 2 5]
    [5 3 3]]]


  [[[0 1 4]
    [1 1 4]]

   [[6 3 1]
    [4 2 5]]]]



 [[[[2 1 2]
    [0 2 4]]

   [[5 1 4]
    [2 4 5]]]


  [[[1 2 2]
    [1 1 4]]

   [[1 4 5]
    [2 7 2]]]


  [[[1 1 3]
    [1 1 4]]

   [[1 4 5]
    [2 5 4]]]]]
(shapes (2, 3, 2, 2), (1, 1, 2, 2) mismatch)
 ACTUAL: array([[[[-3.7297, -2.1848],
         [-4.1465, -3.8609]],
...
 DESIRED: array([[[[-334.5879, -332.7962],
         [-324.271 , -321.8731]]]])
[31mFAILED[0m tests/distributions/test_multivariate.py::[1mTestMatchesScipy::test_multinomial_vectorized[extra_size2-p1-10][0m - pymc.logprob.utils.ParameterValueError:
Apply node that caused the error: Check{}([[[-198.08501146]]], False)
Toposort index: 0
Inputs types: [TensorType(float64, shape=(1, 1, 1)), ScalarType(bool)]
Inputs shapes: [(1, 1, 1), ()]
Inputs strides: [(8, 8, 8), ()]
Inputs values: [array([[[-198.08501146]]]), np.False_]
Inputs type_num: [12, 0]
Outputs clients: [[DeepCopyOp(Check{}.0)]]

Backtrace when the node is created (use PyTensor flag traceback__limit=N to make it longer):
  File "/app/pymc/logprob/basic.py", line 193, in logp
    return _logprob_helper(rv, value, **kwargs)
  File "/app/pymc/logprob/abstract.py", line 70, in _logprob_helper
    logprob = _logprob(rv.owner.op, values, *rv.owner.inputs, **kwargs)
  File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/functools.py", line 982, in wrapper
    return dispatch(args[0].__class__)(*args, **kw)
  File "/app/pymc/distributions/distribution.py", line 140, in logp
    return class_logp(value, *dist_params)
  File "/app/tests/distributions/test_dist_math.py", line 96, in logp
    return check_parameters(
  File "/app/pymc/distributions/dist_math.py", line 72, in check_parameters
    return CheckParameterValue(msg, can_be_replaced_by_ninf)(expr, all_true_scalar)
  File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/graph/op.py", line 294, in __call__
    node = self.make_node(*inputs, **kwargs)
  File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/raise_op.py", line 81, in make_node
    [value.type()],

Debug print of the apply node:
Check{} [id A] <Tensor3(float64, shape=(1, 1, 1))>
 ├─ [[[-198.08501146]]] [id B] <Tensor3(float64, shape=(1, 1, 1))>
 └─ False [id C] <bool>

Storage map footprint:
 - [[[-198.08501146]]], Shape: (1, 1, 1), ElemSize: 8 Byte(s), TotalSize: 8 Byte(s)
 - False, Shape: (), ElemSize: 1 Byte(s), TotalSize: 1.0 Byte(s)
 TotalSize: 9.0 Byte(s) 0.000 GB
 TotalSize inputs: 9.0 Byte(s) 0.000 GB
[31mFAILED[0m tests/distributions/test_multivariate.py::[1mTestMatchesScipy::test_multinomial_vectorized[extra_size2-p1-n1][0m - pymc.logprob.utils.ParameterValueError:
Apply node that caused the error: Check{}([[[-220.70 ... 1082784]]], False)
Toposort index: 0
Inputs types: [TensorType(float64, shape=(1, 1, 2)), ScalarType(bool)]
Inputs shapes: [(1, 1, 2), ()]
Inputs strides: [(16, 16, 8), ()]
Inputs values: [array([[[-220.70872312, -218.31082784]]]), np.False_]
Inputs type_num: [12, 0]
Outputs clients: [[DeepCopyOp(Check{}.0)]]

Backtrace when the node is created (use PyTensor flag traceback__limit=N to make it longer):
  File "/app/pymc/logprob/basic.py", line 193, in logp
    return _logprob_helper(rv, value, **kwargs)
  File "/app/pymc/logprob/abstract.py", line 70, in _logprob_helper
    logprob = _logprob(rv.owner.op, values, *rv.owner.inputs, **kwargs)
  File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/functools.py", line 982, in wrapper
    return dispatch(args[0].__class__)(*args, **kw)
  File "/app/pymc/distributions/distribution.py", line 140, in logp
    return class_logp(value, *dist_params)
  File "/app/tests/distributions/test_dist_math.py", line 96, in logp
    return check_parameters(
  File "/app/pymc/distributions/dist_math.py", line 72, in check_parameters
    return CheckParameterValue(msg, can_be_replaced_by_ninf)(expr, all_true_scalar)
  File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/graph/op.py", line 294, in __call__
    node = self.make_node(*inputs, **kwargs)
  File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/raise_op.py", line 81, in make_node
    [value.type()],

Debug print of the apply node:
Check{} [id A] <Tensor3(float64, shape=(1, 1, 2))>
 ├─ [[[-220.70 ... 1082784]]] [id B] <Tensor3(float64, shape=(1, 1, 2))>
 └─ False [id C] <bool>

Storage map footprint:
 - [[[-220.70 ... 1082784]]], Shape: (1, 1, 2), ElemSize: 8 Byte(s), TotalSize: 16 Byte(s)
 - False, Shape: (), ElemSize: 1 Byte(s), TotalSize: 1.0 Byte(s)
 TotalSize: 17.0 Byte(s) 0.000 GB
 TotalSize inputs: 17.0 Byte(s) 0.000 GB
[31mFAILED[0m tests/distributions/test_multivariate.py::[1mTestMatchesScipy::test_multinomial_vectorized[extra_size2-p1-n2][0m - pymc.logprob.utils.ParameterValueError:
Apply node that caused the error: Check{}([[[[-305.6 ... 357418]]]], False)
Toposort index: 0
Inputs types: [TensorType(float64, shape=(1, 1, 2, 2)), ScalarType(bool)]
Inputs shapes: [(1, 1, 2, 2), ()]
Inputs strides: [(32, 32, 16, 8), ()]
Inputs values: [array([[[[-305.69839028, -303.90663081],
         [-295.38146945, -292.98357418]]]]), np.False_]
Inputs type_num: [12, 0]
Outputs clients: [[DeepCopyOp(Check{}.0)]]

Backtrace when the node is created (use PyTensor flag traceback__limit=N to make it longer):
  File "/app/pymc/logprob/basic.py", line 193, in logp
    return _logprob_helper(rv, value, **kwargs)
  File "/app/pymc/logprob/abstract.py", line 70, in _logprob_helper
    logprob = _logprob(rv.owner.op, values, *rv.owner.inputs, **kwargs)
  File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/functools.py", line 982, in wrapper
    return dispatch(args[0].__class__)(*args, **kw)
  File "/app/pymc/distributions/distribution.py", line 140, in logp
    return class_logp(value, *dist_params)
  File "/app/tests/distributions/test_dist_math.py", line 96, in logp
    return check_parameters(
  File "/app/pymc/distributions/dist_math.py", line 72, in check_parameters
    return CheckParameterValue(msg, can_be_replaced_by_ninf)(expr, all_true_scalar)
  File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/graph/op.py", line 294, in __call__
    node = self.make_node(*inputs, **kwargs)
  File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/raise_op.py", line 81, in make_node
    [value.type()],

Debug print of the apply node:
Check{} [id A] <Tensor4(float64, shape=(1, 1, 2, 2))>
 ├─ [[[[-305.6 ... 357418]]]] [id B] <Tensor4(float64, shape=(1, 1, 2, 2))>
 └─ False [id C] <bool>

Storage map footprint:
 - [[[[-305.6 ... 357418]]]], Shape: (1, 1, 2, 2), ElemSize: 8 Byte(s), TotalSize: 32 Byte(s)
 - False, Shape: (), ElemSize: 1 Byte(s), TotalSize: 1.0 Byte(s)
 TotalSize: 33.0 Byte(s) 0.000 GB
 TotalSize inputs: 33.0 Byte(s) 0.000 GB
[31mFAILED[0m tests/distributions/test_multivariate.py::[1mTestMatchesScipy::test_multinomial_vectorized[extra_size2-p2-10][0m - pymc.logprob.utils.ParameterValueError:
Apply node that caused the error: Check{}([[[[-452.1 ... 023861]]]], False)
Toposort index: 0
Inputs types: [TensorType(float64, shape=(1, 1, 1, 1)), ScalarType(bool)]
Inputs shapes: [(1, 1, 1, 1), ()]
Inputs strides: [(8, 8, 8, 8), ()]
Inputs values: [array([[[[-452.19023861]]]]), np.False_]
Inputs type_num: [12, 0]
Outputs clients: [[DeepCopyOp(Check{}.0)]]

Backtrace when the node is created (use PyTensor flag traceback__limit=N to make it longer):
  File "/app/pymc/logprob/basic.py", line 193, in logp
    return _logprob_helper(rv, value, **kwargs)
  File "/app/pymc/logprob/abstract.py", line 70, in _logprob_helper
    logprob = _logprob(rv.owner.op, values, *rv.owner.inputs, **kwargs)
  File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/functools.py", line 982, in wrapper
    return dispatch(args[0].__class__)(*args, **kw)
  File "/app/pymc/distributions/distribution.py", line 140, in logp
    return class_logp(value, *dist_params)
  File "/app/tests/distributions/test_dist_math.py", line 96, in logp
    return check_parameters(
  File "/app/pymc/distributions/dist_math.py", line 72, in check_parameters
    return CheckParameterValue(msg, can_be_replaced_by_ninf)(expr, all_true_scalar)
  File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/graph/op.py", line 294, in __call__
    node = self.make_node(*inputs, **kwargs)
  File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/raise_op.py", line 81, in make_node
    [value.type()],

Debug print of the apply node:
Check{} [id A] <Tensor4(float64, shape=(1, 1, 1, 1))>
 ├─ [[[[-452.1 ... 023861]]]] [id B] <Tensor4(float64, shape=(1, 1, 1, 1))>
 └─ False [id C] <bool>

Storage map footprint:
 - [[[[-452.1 ... 023861]]]], Shape: (1, 1, 1, 1), ElemSize: 8 Byte(s), TotalSize: 8 Byte(s)
 - False, Shape: (), ElemSize: 1 Byte(s), TotalSize: 1.0 Byte(s)
 TotalSize: 9.0 Byte(s) 0.000 GB
 TotalSize inputs: 9.0 Byte(s) 0.000 GB
[31mFAILED[0m tests/distributions/test_multivariate.py::[1mTestMatchesScipy::test_multinomial_vectorized[extra_size2-p2-n1][0m - pymc.logprob.utils.ParameterValueError:
Apply node that caused the error: Check{}([[[[-476.4 ... 402034]]]], False)
Toposort index: 0
Inputs types: [TensorType(float64, shape=(1, 1, 1, 2)), ScalarType(bool)]
Inputs shapes: [(1, 1, 1, 2), ()]
Inputs strides: [(16, 16, 16, 8), ()]
Inputs values: [array([[[[-476.41191561, -474.01402034]]]]), np.False_]
Inputs type_num: [12, 0]
Outputs clients: [[DeepCopyOp(Check{}.0)]]

Backtrace when the node is created (use PyTensor flag traceback__limit=N to make it longer):
  File "/app/pymc/logprob/basic.py", line 193, in logp
    return _logprob_helper(rv, value, **kwargs)
  File "/app/pymc/logprob/abstract.py", line 70, in _logprob_helper
    logprob = _logprob(rv.owner.op, values, *rv.owner.inputs, **kwargs)
  File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/functools.py", line 982, in wrapper
    return dispatch(args[0].__class__)(*args, **kw)
  File "/app/pymc/distributions/distribution.py", line 140, in logp
    return class_logp(value, *dist_params)
  File "/app/tests/distributions/test_dist_math.py", line 96, in logp
    return check_parameters(
  File "/app/pymc/distributions/dist_math.py", line 72, in check_parameters
    return CheckParameterValue(msg, can_be_replaced_by_ninf)(expr, all_true_scalar)
  File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/graph/op.py", line 294, in __call__
    node = self.make_node(*inputs, **kwargs)
  File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/raise_op.py", line 81, in make_node
    [value.type()],

Debug print of the apply node:
Check{} [id A] <Tensor4(float64, shape=(1, 1, 1, 2))>
 ├─ [[[[-476.4 ... 402034]]]] [id B] <Tensor4(float64, shape=(1, 1, 1, 2))>
 └─ False [id C] <bool>

Storage map footprint:
 - [[[[-476.4 ... 402034]]]], Shape: (1, 1, 1, 2), ElemSize: 8 Byte(s), TotalSize: 16 Byte(s)
 - False, Shape: (), ElemSize: 1 Byte(s), TotalSize: 1.0 Byte(s)
 TotalSize: 17.0 Byte(s) 0.000 GB
 TotalSize inputs: 17.0 Byte(s) 0.000 GB
[31mFAILED[0m tests/distributions/test_multivariate.py::[1mTestMatchesScipy::test_multinomial_vectorized[extra_size2-p2-n2][0m - pymc.logprob.utils.ParameterValueError:
Apply node that caused the error: Check{}([[[[-356.7 ... 410387]]]], False)
Toposort index: 0
Inputs types: [TensorType(float64, shape=(1, 1, 2, 2)), ScalarType(bool)]
Inputs shapes: [(1, 1, 2, 2), ()]
Inputs strides: [(32, 32, 16, 8), ()]
Inputs values: [array([[[[-356.73891998, -354.94716051],
         [-346.42199915, -344.02410387]]]]), np.False_]
Inputs type_num: [12, 0]
Outputs clients: [[DeepCopyOp(Check{}.0)]]

Backtrace when the node is created (use PyTensor flag traceback__limit=N to make it longer):
  File "/app/pymc/logprob/basic.py", line 193, in logp
    return _logprob_helper(rv, value, **kwargs)
  File "/app/pymc/logprob/abstract.py", line 70, in _logprob_helper
    logprob = _logprob(rv.owner.op, values, *rv.owner.inputs, **kwargs)
  File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/functools.py", line 982, in wrapper
    return dispatch(args[0].__class__)(*args, **kw)
  File "/app/pymc/distributions/distribution.py", line 140, in logp
    return class_logp(value, *dist_params)
  File "/app/tests/distributions/test_dist_math.py", line 96, in logp
    return check_parameters(
  File "/app/pymc/distributions/dist_math.py", line 72, in check_parameters
    return CheckParameterValue(msg, can_be_replaced_by_ninf)(expr, all_true_scalar)
  File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/graph/op.py", line 294, in __call__
    node = self.make_node(*inputs, **kwargs)
  File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/raise_op.py", line 81, in make_node
    [value.type()],

Debug print of the apply node:
Check{} [id A] <Tensor4(float64, shape=(1, 1, 2, 2))>
 ├─ [[[[-356.7 ... 410387]]]] [id B] <Tensor4(float64, shape=(1, 1, 2, 2))>
 └─ False [id C] <bool>

Storage map footprint:
 - [[[[-356.7 ... 410387]]]], Shape: (1, 1, 2, 2), ElemSize: 8 Byte(s), TotalSize: 32 Byte(s)
 - False, Shape: (), ElemSize: 1 Byte(s), TotalSize: 1.0 Byte(s)
 TotalSize: 33.0 Byte(s) 0.000 GB
 TotalSize inputs: 33.0 Byte(s) 0.000 GB
[31mFAILED[0m tests/distributions/test_multivariate.py::[1mTestMatchesScipy::test_multinomial_zero_probs[0m - assert array(nan) >= 0
 +  where array(nan) = eval()
 +    where eval = Check{}.0.eval
 +      where Check{}.0 = <function logp at 0x7f0bb7ab61f0>(multinomial_rv{"(),(p)->(p)"}.out, array([  0,   0, 100]))
 +        where <function logp at 0x7f0bb7ab61f0> = pm.logp
 +        and   array([  0,   0, 100]) = <built-in function array>([0, 0, 100])
 +          where <built-in function array> = np.array
[31mFAILED[0m tests/distributions/test_multivariate.py::[1mTestMoments::test_multinomial_support_point[p3-10-None-expected3][0m - pymc.logprob.utils.ParameterValueError:
Apply node that caused the error: Check{}([-21.52064456], False)
Toposort index: 0
Inputs types: [TensorType(float64, shape=(1,)), ScalarType(bool)]
Inputs shapes: [(1,), ()]
Inputs strides: [(8,), ()]
Inputs values: [array([-21.52064456]), np.False_]
Inputs type_num: [12, 0]
Outputs clients: [[Squeeze{axis=0}(Check{}.0)]]

Backtrace when the node is created (use PyTensor flag traceback__limit=N to make it longer):
  File "/app/pymc/logprob/basic.py", line 574, in transformed_conditional_logp
    temp_logp_terms = conditional_logp(
  File "/app/pymc/logprob/basic.py", line 504, in conditional_logp
    node_logprobs = _logprob(
  File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/functools.py", line 982, in wrapper
    return dispatch(args[0].__class__)(*args, **kw)
  File "/app/pymc/distributions/distribution.py", line 140, in logp
    return class_logp(value, *dist_params)
  File "/app/tests/distributions/test_dist_math.py", line 96, in logp
    return check_parameters(
  File "/app/pymc/distributions/dist_math.py", line 72, in check_parameters
    return CheckParameterValue(msg, can_be_replaced_by_ninf)(expr, all_true_scalar)
  File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/graph/op.py", line 294, in __call__
    node = self.make_node(*inputs, **kwargs)
  File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/raise_op.py", line 81, in make_node
    [value.type()],

Debug print of the apply node:
Check{} [id A] <Vector(float64, shape=(1,))>
 ├─ [-21.52064456] [id B] <Vector(float64, shape=(1,))>
 └─ False [id C] <bool>

Storage map footprint:
 - [-21.52064456], Shape: (1,), ElemSize: 8 Byte(s), TotalSize: 8 Byte(s)
 - False, Shape: (), ElemSize: 1 Byte(s), TotalSize: 1.0 Byte(s)
 TotalSize: 9.0 Byte(s) 0.000 GB
 TotalSize inputs: 9.0 Byte(s) 0.000 GB
[31mFAILED[0m tests/distributions/test_multivariate.py::[1mTestMoments::test_multinomial_support_point[p5-n5-None-expected5][0m - pymc.logprob.utils.ParameterValueError:
Apply node that caused the error: Check{}([-20.16095 ... .05653974], False)
Toposort index: 0
Inputs types: [TensorType(float64, shape=(2,)), ScalarType(bool)]
Inputs shapes: [(2,), ()]
Inputs strides: [(8,), ()]
Inputs values: [array([-20.16095231,  -5.05653974]), np.False_]
Inputs type_num: [12, 0]
Outputs clients: [[Sum{axes=None}(Check{}.0)]]

Backtrace when the node is created (use PyTensor flag traceback__limit=N to make it longer):
  File "/app/pymc/logprob/basic.py", line 574, in transformed_conditional_logp
    temp_logp_terms = conditional_logp(
  File "/app/pymc/logprob/basic.py", line 504, in conditional_logp
    node_logprobs = _logprob(
  File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/functools.py", line 982, in wrapper
    return dispatch(args[0].__class__)(*args, **kw)
  File "/app/pymc/distributions/distribution.py", line 140, in logp
    return class_logp(value, *dist_params)
  File "/app/tests/distributions/test_dist_math.py", line 96, in logp
    return check_parameters(
  File "/app/pymc/distributions/dist_math.py", line 72, in check_parameters
    return CheckParameterValue(msg, can_be_replaced_by_ninf)(expr, all_true_scalar)
  File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/graph/op.py", line 294, in __call__
    node = self.make_node(*inputs, **kwargs)
  File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/raise_op.py", line 81, in make_node
    [value.type()],

Debug print of the apply node:
Check{} [id A] <Vector(float64, shape=(2,))>
 ├─ [-20.16095 ... .05653974] [id B] <Vector(float64, shape=(2,))>
 └─ False [id C] <bool>

Storage map footprint:
 - [-20.16095 ... .05653974], Shape: (2,), ElemSize: 8 Byte(s), TotalSize: 16 Byte(s)
 - False, Shape: (), ElemSize: 1 Byte(s), TotalSize: 1.0 Byte(s)
 TotalSize: 17.0 Byte(s) 0.000 GB
 TotalSize inputs: 17.0 Byte(s) 0.000 GB
[31mFAILED[0m tests/distributions/test_multivariate.py::[1mTestMoments::test_multinomial_support_point[p6-n6-size6-expected6][0m - pymc.logprob.utils.ParameterValueError:
Apply node that caused the error: Check{}([[-60.4828 ... 37844436]], False)
Toposort index: 0
Inputs types: [TensorType(float64, shape=(1, 2)), ScalarType(bool)]
Inputs shapes: [(1, 2), ()]
Inputs strides: [(16, 8), ()]
Inputs values: [array([[-60.48285693, -45.37844436]]), np.False_]
Inputs type_num: [12, 0]
Outputs clients: [[Sum{axes=None}(Check{}.0)]]

Backtrace when the node is created (use PyTensor flag traceback__limit=N to make it longer):
  File "/app/pymc/logprob/basic.py", line 574, in transformed_conditional_logp
    temp_logp_terms = conditional_logp(
  File "/app/pymc/logprob/basic.py", line 504, in conditional_logp
    node_logprobs = _logprob(
  File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/functools.py", line 982, in wrapper
    return dispatch(args[0].__class__)(*args, **kw)
  File "/app/pymc/distributions/distribution.py", line 140, in logp
    return class_logp(value, *dist_params)
  File "/app/tests/distributions/test_dist_math.py", line 96, in logp
    return check_parameters(
  File "/app/pymc/distributions/dist_math.py", line 72, in check_parameters
    return CheckParameterValue(msg, can_be_replaced_by_ninf)(expr, all_true_scalar)
  File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/graph/op.py", line 294, in __call__
    node = self.make_node(*inputs, **kwargs)
  File "/root/.local/share/mamba/envs/pymc-test/lib/python3.14/site-packages/pytensor/raise_op.py", line 81, in make_node
    [value.type()],

Debug print of the apply node:
Check{} [id A] <Matrix(float64, shape=(1, 2))>
 ├─ [[-60.4828 ... 37844436]] [id B] <Matrix(float64, shape=(1, 2))>
 └─ False [id C] <bool>

Storage map footprint:
 - [[-60.4828 ... 37844436]], Shape: (1, 2), ElemSize: 8 Byte(s), TotalSize: 16 Byte(s)
 - False, Shape: (), ElemSize: 1 Byte(s), TotalSize: 1.0 Byte(s)
 TotalSize: 17.0 Byte(s) 0.000 GB
 TotalSize inputs: 17.0 Byte(s) 0.000 GB
[31mFAILED[0m tests/distributions/test_multivariate.py::[1mTestMoments::test_multinomial_support_point[p7-1-None-expected7][0m - AssertionError
[31m= [31m[1m37 failed[0m, [32m3532 passed[0m, [33m95 skipped[0m, [33m20 xfailed[0m, [33m721 warnings[0m[31m in 6014.62s (1:40:14)[0m[31m =[0m
